<!doctype html><html ⚡ lang=ru> <head><meta charset=utf-8><script async src=https://cdn.ampproject.org/v0.js></script><title>Форматы входных и выходных данных | Документация ClickHouse</title><link href=https://clickhouse.tech/docs/ru/interfaces/formats/ rel=canonical><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><script type=application/ld+json>[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "Форматы входных и выходных данных | Документация ClickHouse",
"mainEntityOfPage": "https://clickhouse.tech/docs/ru/interfaces/formats/",




"image": "https://clickhouse.tech/images/logo-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "Yandex LLC",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.tech/images/yandex.png",
    "width": 163,
    "height": 60
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "Форматы входных и выходных данных | Документация ClickHouse",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script><style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript><style amp-custom>:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--white:#fff;--gray:#6c757d;--gray-dark:#343a40;--primary:#007bff;--secondary:#6c757d;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f8f9fa;--dark:#343a40;--breakpoint-xs:0;--breakpoint-sm:576px;--breakpoint-md:768px;--breakpoint-lg:992px;--breakpoint-xl:1200px;--font-family-sans-serif:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,::after,::before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}article,footer,header{display:block}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem}p{margin-top:0;margin-bottom:1rem}ul{margin-top:0;margin-bottom:1rem}ul ul{margin-bottom:0}dd{margin-bottom:.5rem;margin-left:0}b,strong{font-weight:bolder}a{color:#007bff;text-decoration:none;background-color:transparent}a:hover{color:#0056b3;text-decoration:underline}a:not([href]){color:inherit;text-decoration:none}a:not([href]):hover{color:inherit;text-decoration:none}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}img{vertical-align:middle;border-style:none}svg{overflow:hidden;vertical-align:middle}table{border-collapse:collapse}caption{padding-top:.75rem;padding-bottom:.75rem;color:#6c757d;text-align:left;caption-side:bottom}th{text-align:inherit}input,select{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}input{overflow:visible}select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit]{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{padding:0;border-style:none}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=date],input[type=datetime-local],input[type=month],input[type=time]{-webkit-appearance:listbox}progress{vertical-align:baseline}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}template{display:none}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:.5rem;font-weight:500;line-height:1.2}.h1,h1{font-size:2rem}.h2,h2{font-size:1.5rem}.h3,h3{font-size:1.25rem}.h4,h4{font-size:1rem}.h5,h5{font-size:1rem}.h6,h6{font-size:1rem}.display-1{font-size:6rem;font-weight:300;line-height:1.2}.display-2{font-size:5.5rem;font-weight:300;line-height:1.2}.display-3{font-size:4.5rem;font-weight:300;line-height:1.2}.display-4{font-size:3.5rem;font-weight:300;line-height:1.2}.list-inline{padding-left:0;list-style:none}.img-fluid{max-width:100%;height:auto}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}pre{display:block;font-size:87.5%;color:#212529}pre code{font-size:inherit;color:inherit;word-break:normal}.container{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container{max-width:720px}}@media(min-width:992px){.container{max-width:960px}}@media(min-width:1200px){.container{max-width:1140px}}.container-fluid,.container-lg,.container-md{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container,.container-md{max-width:720px}}@media(min-width:992px){.container,.container-lg,.container-md{max-width:960px}}@media(min-width:1200px){.container,.container-lg,.container-md{max-width:1140px}}.row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-15px;margin-left:-15px}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9{position:relative;width:100%;padding-right:15px;padding-left:15px}.col{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-first{-ms-flex-order:-1;order:-1}.order-0{-ms-flex-order:0;order:0}.order-1{-ms-flex-order:1;order:1}.order-2{-ms-flex-order:2;order:2}.order-3{-ms-flex-order:3;order:3}.order-4{-ms-flex-order:4;order:4}.order-5{-ms-flex-order:5;order:5}.order-6{-ms-flex-order:6;order:6}.order-7{-ms-flex-order:7;order:7}.order-8{-ms-flex-order:8;order:8}.order-9{-ms-flex-order:9;order:9}.order-10{-ms-flex-order:10;order:10}.order-11{-ms-flex-order:11;order:11}.order-12{-ms-flex-order:12;order:12}@media(min-width:768px){.col-md{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-md-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-md-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-md-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-md-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-md-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-md-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-md-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-md-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-md-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-md-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-md-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-md-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-md-first{-ms-flex-order:-1;order:-1}.order-md-0{-ms-flex-order:0;order:0}.order-md-1{-ms-flex-order:1;order:1}.order-md-2{-ms-flex-order:2;order:2}.order-md-3{-ms-flex-order:3;order:3}.order-md-4{-ms-flex-order:4;order:4}.order-md-5{-ms-flex-order:5;order:5}.order-md-6{-ms-flex-order:6;order:6}.order-md-7{-ms-flex-order:7;order:7}.order-md-8{-ms-flex-order:8;order:8}.order-md-9{-ms-flex-order:9;order:9}.order-md-10{-ms-flex-order:10;order:10}.order-md-11{-ms-flex-order:11;order:11}.order-md-12{-ms-flex-order:12;order:12}}@media(min-width:992px){.col-lg{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-lg-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-lg-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-lg-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-lg-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-lg-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-lg-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-lg-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-lg-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-lg-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-lg-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-lg-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-lg-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-lg-first{-ms-flex-order:-1;order:-1}.order-lg-0{-ms-flex-order:0;order:0}.order-lg-1{-ms-flex-order:1;order:1}.order-lg-2{-ms-flex-order:2;order:2}.order-lg-3{-ms-flex-order:3;order:3}.order-lg-4{-ms-flex-order:4;order:4}.order-lg-5{-ms-flex-order:5;order:5}.order-lg-6{-ms-flex-order:6;order:6}.order-lg-7{-ms-flex-order:7;order:7}.order-lg-8{-ms-flex-order:8;order:8}.order-lg-9{-ms-flex-order:9;order:9}.order-lg-10{-ms-flex-order:10;order:10}.order-lg-11{-ms-flex-order:11;order:11}.order-lg-12{-ms-flex-order:12;order:12}}.table{width:100%;margin-bottom:1rem;color:#212529}.table td,.table th{padding:.75rem;vertical-align:top;border-top:1px solid #dee2e6}.table thead th{vertical-align:bottom;border-bottom:2px solid #dee2e6}.table tbody+tbody{border-top:2px solid #dee2e6}.table-primary,.table-primary>td,.table-primary>th{background-color:#b8daff}.table-primary tbody+tbody,.table-primary td,.table-primary th,.table-primary thead th{border-color:#7abaff}.table-light,.table-light>td,.table-light>th{background-color:#fdfdfe}.table-light tbody+tbody,.table-light td,.table-light th,.table-light thead th{border-color:#fbfcfc}.table-dark,.table-dark>td,.table-dark>th{background-color:#c6c8ca}.table-dark tbody+tbody,.table-dark td,.table-dark th,.table-dark thead th{border-color:#95999c}.table .thead-dark th{color:#fff;background-color:#343a40;border-color:#454d55}.table .thead-light th{color:#495057;background-color:#e9ecef;border-color:#dee2e6}.table-dark{color:#fff;background-color:#343a40}.table-dark td,.table-dark th,.table-dark thead th{border-color:#454d55}.form-control{display:block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;background-color:#fff;background-clip:padding-box;border:1px solid #ced4da;border-radius:.25rem}@media(prefers-reduced-motion:reduce){.form-control{transition:none}}.form-control::-ms-expand{background-color:transparent;border:0}.form-control:-moz-focusring{color:transparent;text-shadow:0 0 0 #495057}.form-control:focus{color:#495057;background-color:#fff;border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.form-control::-webkit-input-placeholder{color:#6c757d;opacity:1}.form-control::-moz-placeholder{color:#6c757d;opacity:1}.form-control:-ms-input-placeholder{color:#6c757d;opacity:1}.form-control::-ms-input-placeholder{color:#6c757d;opacity:1}.form-control::placeholder{color:#6c757d;opacity:1}.form-control:disabled,.form-control[readonly]{background-color:#e9ecef;opacity:1}select.form-control:focus::-ms-value{color:#495057;background-color:#fff}.form-control-file,.form-control-range{display:block;width:100%}.form-control-lg{height:calc(1.5em+1rem+2px);padding:.5rem 1rem;font-size:1.25rem;line-height:1.5;border-radius:.3rem}select.form-control[multiple],select.form-control[size]{height:auto}.form-group{margin-bottom:1rem}.form-text{display:block;margin-top:.25rem}.form-row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-5px;margin-left:-5px}.form-row>.col,.form-row>[class*=col-]{padding-right:5px;padding-left:5px}.form-inline{display:-ms-flexbox;display:flex;-ms-flex-flow:row wrap;flex-flow:row wrap;-ms-flex-align:center;align-items:center}@media(min-width:576px){.form-inline .form-group{display:-ms-flexbox;display:flex;-ms-flex:0 0 auto;flex:0 0 auto;-ms-flex-flow:row wrap;flex-flow:row wrap;-ms-flex-align:center;align-items:center;margin-bottom:0}.form-inline .form-control{display:inline-block;width:auto;vertical-align:middle}.form-inline .custom-select,.form-inline .input-group{width:auto}.form-inline .custom-control{-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}}.btn{display:inline-block;font-weight:400;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:.375rem .75rem;font-size:1rem;line-height:1.5;border-radius:.25rem}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus{outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.btn:disabled{opacity:.65}.btn-primary{color:#fff;background-color:#007bff;border-color:#007bff}.btn-primary:hover{color:#fff;background-color:#0069d9;border-color:#0062cc}.btn-primary:focus{color:#fff;background-color:#0069d9;border-color:#0062cc;box-shadow:0 0 0 .2rem rgba(38,143,255,.5)}.btn-primary:disabled{color:#fff;background-color:#007bff;border-color:#007bff}.btn-light{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-light:hover{color:#212529;background-color:#e2e6ea;border-color:#dae0e5}.btn-light:focus{color:#212529;background-color:#e2e6ea;border-color:#dae0e5;box-shadow:0 0 0 .2rem rgba(216,217,219,.5)}.btn-light:disabled{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-dark{color:#fff;background-color:#343a40;border-color:#343a40}.btn-dark:hover{color:#fff;background-color:#23272b;border-color:#1d2124}.btn-dark:focus{color:#fff;background-color:#23272b;border-color:#1d2124;box-shadow:0 0 0 .2rem rgba(82,88,93,.5)}.btn-dark:disabled{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-primary{color:#007bff;border-color:#007bff}.btn-outline-primary:hover{color:#fff;background-color:#007bff;border-color:#007bff}.btn-outline-primary:focus{box-shadow:0 0 0 .2rem rgba(0,123,255,.5)}.btn-outline-primary:disabled{color:#007bff;background-color:transparent}.btn-outline-light{color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:hover{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:focus{box-shadow:0 0 0 .2rem rgba(248,249,250,.5)}.btn-outline-light:disabled{color:#f8f9fa;background-color:transparent}.btn-outline-dark{color:#343a40;border-color:#343a40}.btn-outline-dark:hover{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-dark:focus{box-shadow:0 0 0 .2rem rgba(52,58,64,.5)}.btn-outline-dark:disabled{color:#343a40;background-color:transparent}.btn-link{font-weight:400;color:#007bff;text-decoration:none}.btn-link:hover{color:#0056b3;text-decoration:underline}.btn-link:focus{text-decoration:underline;box-shadow:none}.btn-link:disabled{color:#6c757d;pointer-events:none}.btn-group-lg>.btn,.btn-lg{padding:.5rem 1rem;font-size:1.25rem;line-height:1.5;border-radius:.3rem}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:.5rem}input[type=button].btn-block,input[type=reset].btn-block,input[type=submit].btn-block{width:100%}.btn-group,.btn-group-vertical{position:relative;display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle}.btn-group-vertical>.btn,.btn-group>.btn{position:relative;-ms-flex:1 1 auto;flex:1 1 auto}.btn-group-vertical>.btn:hover,.btn-group>.btn:hover{z-index:1}.btn-group-vertical>.btn:active,.btn-group-vertical>.btn:focus,.btn-group>.btn:active,.btn-group>.btn:focus{z-index:1}.btn-group>.btn-group:not(:first-child),.btn-group>.btn:not(:first-child){margin-left:-1px}.btn-group>.btn-group:not(:last-child)>.btn{border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn-group:not(:first-child)>.btn,.btn-group>.btn:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.btn-group-vertical{-ms-flex-direction:column;flex-direction:column;-ms-flex-align:start;align-items:flex-start;-ms-flex-pack:center;justify-content:center}.btn-group-vertical>.btn,.btn-group-vertical>.btn-group{width:100%}.btn-group-vertical>.btn-group:not(:first-child),.btn-group-vertical>.btn:not(:first-child){margin-top:-1px}.btn-group-vertical>.btn-group:not(:last-child)>.btn{border-bottom-right-radius:0;border-bottom-left-radius:0}.btn-group-vertical>.btn-group:not(:first-child)>.btn,.btn-group-vertical>.btn:not(:first-child){border-top-left-radius:0;border-top-right-radius:0}.input-group{position:relative;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-align:stretch;align-items:stretch;width:100%}.input-group>.custom-file,.input-group>.custom-select,.input-group>.form-control{position:relative;-ms-flex:1 1 0;flex:1 1 0;min-width:0;margin-bottom:0}.input-group>.custom-file+.custom-file,.input-group>.custom-file+.custom-select,.input-group>.custom-file+.form-control,.input-group>.custom-select+.custom-file,.input-group>.custom-select+.custom-select,.input-group>.custom-select+.form-control,.input-group>.form-control+.custom-file,.input-group>.form-control+.custom-select,.input-group>.form-control+.form-control{margin-left:-1px}.input-group>.custom-select:focus,.input-group>.form-control:focus{z-index:3}.input-group>.custom-file .custom-file-input:focus{z-index:4}.input-group>.custom-select:not(:last-child),.input-group>.form-control:not(:last-child){border-top-right-radius:0;border-bottom-right-radius:0}.input-group>.custom-select:not(:first-child),.input-group>.form-control:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.input-group>.custom-file{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.input-group-text{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;padding:.375rem .75rem;margin-bottom:0;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;text-align:center;white-space:nowrap;background-color:#e9ecef;border:1px solid #ced4da;border-radius:.25rem}.input-group-text input[type=checkbox],.input-group-text input[type=radio]{margin-top:0}.input-group-lg>.custom-select,.input-group-lg>.form-control:not(textarea){height:calc(1.5em+1rem+2px)}.input-group-lg>.custom-select,.input-group-lg>.form-control{padding:.5rem 1rem;font-size:1.25rem;line-height:1.5;border-radius:.3rem}.input-group-lg>.custom-select{padding-right:1.75rem}.custom-control{position:relative;display:block;min-height:1.5rem;padding-left:1.5rem}.custom-control-inline{display:-ms-inline-flexbox;display:inline-flex;margin-right:1rem}.custom-control-input{position:absolute;left:0;z-index:-1;width:1rem;height:1.25rem;opacity:0}.custom-select{display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;vertical-align:middle;background:#fff url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5' viewBox='0 0 4 5'%3e%3cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3e%3c/svg%3e") no-repeat right .75rem center/8px 10px;border:1px solid #ced4da;border-radius:.25rem;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.custom-select:focus::-ms-value{color:#495057;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #495057}.custom-select-lg{height:calc(1.5em+1rem+2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.25rem}.custom-file{position:relative;display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);margin-bottom:0}.custom-file-input{position:relative;z-index:2;width:100%;height:calc(1.5em+.75rem+2px);margin:0;opacity:0}.custom-range{width:100%;height:1.4rem;padding:0;background-color:transparent;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-range:focus{outline:0}.custom-range:focus::-webkit-slider-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .2rem rgba(0,123,255,.25)}.custom-range:focus::-moz-range-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .2rem rgba(0,123,255,.25)}.custom-range:focus::-ms-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .2rem rgba(0,123,255,.25)}.custom-range::-moz-focus-outer{border:0}.custom-range::-webkit-slider-thumb{width:1rem;height:1rem;margin-top:-.25rem;background-color:#007bff;border:0;border-radius:1rem;-webkit-appearance:none;appearance:none}@media(prefers-reduced-motion:reduce){.custom-range::-webkit-slider-thumb{-webkit-transition:none;transition:none}}.custom-range::-webkit-slider-thumb:active{background-color:#b3d7ff}.custom-range::-webkit-slider-runnable-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:#dee2e6;border-color:transparent;border-radius:1rem}.custom-range::-moz-range-thumb{width:1rem;height:1rem;background-color:#007bff;border:0;border-radius:1rem;-moz-appearance:none;appearance:none}@media(prefers-reduced-motion:reduce){.custom-range::-moz-range-thumb{-moz-transition:none;transition:none}}.custom-range::-moz-range-thumb:active{background-color:#b3d7ff}.custom-range::-moz-range-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:#dee2e6;border-color:transparent;border-radius:1rem}.custom-range::-ms-thumb{width:1rem;height:1rem;margin-top:0;margin-right:.2rem;margin-left:.2rem;background-color:#007bff;border:0;border-radius:1rem;appearance:none}@media(prefers-reduced-motion:reduce){.custom-range::-ms-thumb{-ms-transition:none;transition:none}}.custom-range::-ms-thumb:active{background-color:#b3d7ff}.custom-range::-ms-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:transparent;border-color:transparent;border-width:.5rem}.custom-range::-ms-fill-lower{background-color:#dee2e6;border-radius:1rem}.custom-range::-ms-fill-upper{margin-right:15px;background-color:#dee2e6;border-radius:1rem}.custom-range:disabled::-webkit-slider-thumb{background-color:#adb5bd}.custom-range:disabled::-webkit-slider-runnable-track{cursor:default}.custom-range:disabled::-moz-range-thumb{background-color:#adb5bd}.custom-range:disabled::-moz-range-track{cursor:default}.custom-range:disabled::-ms-thumb{background-color:#adb5bd}@media(prefers-reduced-motion:reduce){.custom-select{transition:none}}.page-link{position:relative;display:block;padding:.5rem .75rem;margin-left:-1px;line-height:1.25;color:#007bff;background-color:#fff;border:1px solid #dee2e6}.page-link:hover{z-index:2;color:#0056b3;text-decoration:none;background-color:#e9ecef;border-color:#dee2e6}.page-link:focus{z-index:3;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.alert{position:relative;padding:.75rem 1.25rem;margin-bottom:1rem;border:1px solid transparent;border-radius:.25rem}.alert-heading{color:inherit}.alert-link{font-weight:700}.alert-primary{color:#004085;background-color:#cce5ff;border-color:#b8daff}.alert-primary .alert-link{color:#002752}.alert-light{color:#818182;background-color:#fefefe;border-color:#fdfdfe}.alert-light .alert-link{color:#686868}.alert-dark{color:#1b1e21;background-color:#d6d8d9;border-color:#c6c8ca}.alert-dark .alert-link{color:#040505}@-webkit-keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}.progress{display:-ms-flexbox;display:flex;height:1rem;overflow:hidden;font-size:.75rem;background-color:#e9ecef;border-radius:.25rem}.progress-bar{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;overflow:hidden;color:#fff;text-align:center;white-space:nowrap;background-color:#007bff}@media(prefers-reduced-motion:reduce){.progress-bar{transition:none}}.list-group{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;padding-left:0;margin-bottom:0}.list-group-horizontal{-ms-flex-direction:row;flex-direction:row}@media(min-width:768px){.list-group-horizontal-md{-ms-flex-direction:row;flex-direction:row}}@media(min-width:992px){.list-group-horizontal-lg{-ms-flex-direction:row;flex-direction:row}}@-webkit-keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}@keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}.bg-primary{background-color:#007bff}a.bg-primary:focus,a.bg-primary:hover{background-color:#0062cc}.bg-light{background-color:#f8f9fa}a.bg-light:focus,a.bg-light:hover{background-color:#dae0e5}.bg-dark{background-color:#343a40}a.bg-dark:focus,a.bg-dark:hover{background-color:#1d2124}.bg-white{background-color:#fff}.border{border:1px solid #dee2e6}.border-right{border-right:1px solid #dee2e6}.border-bottom{border-bottom:1px solid #dee2e6}.border-0{border:0}.border-right-0{border-right:0}.border-bottom-0{border-bottom:0}.border-primary{border-color:#007bff}.border-light{border-color:#f8f9fa}.border-dark{border-color:#343a40}.border-white{border-color:#fff}.d-none{display:none}.d-inline{display:inline}.d-inline-block{display:inline-block}.d-block{display:block}.d-table{display:table}.d-table-row{display:table-row}@media(min-width:768px){.d-md-none{display:none}.d-md-inline{display:inline}.d-md-inline-block{display:inline-block}.d-md-block{display:block}.d-md-table{display:table}.d-md-table-row{display:table-row}}@media(min-width:992px){.d-lg-none{display:none}.d-lg-inline{display:inline}.d-lg-inline-block{display:inline-block}.d-lg-block{display:block}.d-lg-table{display:table}.d-lg-table-row{display:table-row}}.float-right{float:right}.float-none{float:none}@media(min-width:768px){.float-md-right{float:right}.float-md-none{float:none}}@media(min-width:992px){.float-lg-right{float:right}.float-lg-none{float:none}}.fixed-bottom{position:fixed;right:0;bottom:0;left:0;z-index:1030}.h-25{height:25%}.h-50{height:50%}.h-75{height:75%}.h-100{height:100%}.m-0{margin:0}.my-0{margin-top:0}.mr-0{margin-right:0}.mb-0,.my-0{margin-bottom:0}.m-1{margin:.25rem}.my-1{margin-top:.25rem}.mr-1{margin-right:.25rem}.mb-1,.my-1{margin-bottom:.25rem}.m-2{margin:.5rem}.my-2{margin-top:.5rem}.mr-2{margin-right:.5rem}.mb-2,.my-2{margin-bottom:.5rem}.m-3{margin:1rem}.my-3{margin-top:1rem}.mr-3{margin-right:1rem}.mb-3,.my-3{margin-bottom:1rem}.m-4{margin:1.5rem}.my-4{margin-top:1.5rem}.mr-4{margin-right:1.5rem}.mb-4,.my-4{margin-bottom:1.5rem}.m-5{margin:3rem}.my-5{margin-top:3rem}.mr-5{margin-right:3rem}.mb-5,.my-5{margin-bottom:3rem}.p-0{padding:0}.pt-0,.py-0{padding-top:0}.pb-0,.py-0{padding-bottom:0}.p-1{padding:.25rem}.pt-1,.py-1{padding-top:.25rem}.pb-1,.py-1{padding-bottom:.25rem}.p-2{padding:.5rem}.pt-2,.py-2{padding-top:.5rem}.pb-2,.py-2{padding-bottom:.5rem}.p-3{padding:1rem}.pt-3,.py-3{padding-top:1rem}.pb-3,.py-3{padding-bottom:1rem}.p-4{padding:1.5rem}.pt-4,.py-4{padding-top:1.5rem}.pb-4,.py-4{padding-bottom:1.5rem}.p-5{padding:3rem}.pt-5,.py-5{padding-top:3rem}.pb-5,.py-5{padding-bottom:3rem}.m-n1{margin:-.25rem}.my-n1{margin-top:-.25rem}.mr-n1{margin-right:-.25rem}.mb-n1,.my-n1{margin-bottom:-.25rem}.m-n2{margin:-.5rem}.my-n2{margin-top:-.5rem}.mr-n2{margin-right:-.5rem}.mb-n2,.my-n2{margin-bottom:-.5rem}.m-n3{margin:-1rem}.my-n3{margin-top:-1rem}.mr-n3{margin-right:-1rem}.mb-n3,.my-n3{margin-bottom:-1rem}.m-n4{margin:-1.5rem}.my-n4{margin-top:-1.5rem}.mr-n4{margin-right:-1.5rem}.mb-n4,.my-n4{margin-bottom:-1.5rem}.m-n5{margin:-3rem}.my-n5{margin-top:-3rem}.mr-n5{margin-right:-3rem}.mb-n5,.my-n5{margin-bottom:-3rem}@media(min-width:768px){.m-md-0{margin:0}.my-md-0{margin-top:0}.mr-md-0{margin-right:0}.mb-md-0,.my-md-0{margin-bottom:0}.m-md-1{margin:.25rem}.my-md-1{margin-top:.25rem}.mr-md-1{margin-right:.25rem}.mb-md-1,.my-md-1{margin-bottom:.25rem}.m-md-2{margin:.5rem}.my-md-2{margin-top:.5rem}.mr-md-2{margin-right:.5rem}.mb-md-2,.my-md-2{margin-bottom:.5rem}.m-md-3{margin:1rem}.my-md-3{margin-top:1rem}.mr-md-3{margin-right:1rem}.mb-md-3,.my-md-3{margin-bottom:1rem}.m-md-4{margin:1.5rem}.my-md-4{margin-top:1.5rem}.mr-md-4{margin-right:1.5rem}.mb-md-4,.my-md-4{margin-bottom:1.5rem}.m-md-5{margin:3rem}.my-md-5{margin-top:3rem}.mr-md-5{margin-right:3rem}.mb-md-5,.my-md-5{margin-bottom:3rem}.p-md-0{padding:0}.pt-md-0,.py-md-0{padding-top:0}.pb-md-0,.py-md-0{padding-bottom:0}.p-md-1{padding:.25rem}.pt-md-1,.py-md-1{padding-top:.25rem}.pb-md-1,.py-md-1{padding-bottom:.25rem}.p-md-2{padding:.5rem}.pt-md-2,.py-md-2{padding-top:.5rem}.pb-md-2,.py-md-2{padding-bottom:.5rem}.p-md-3{padding:1rem}.pt-md-3,.py-md-3{padding-top:1rem}.pb-md-3,.py-md-3{padding-bottom:1rem}.p-md-4{padding:1.5rem}.pt-md-4,.py-md-4{padding-top:1.5rem}.pb-md-4,.py-md-4{padding-bottom:1.5rem}.p-md-5{padding:3rem}.pt-md-5,.py-md-5{padding-top:3rem}.pb-md-5,.py-md-5{padding-bottom:3rem}.m-md-n1{margin:-.25rem}.my-md-n1{margin-top:-.25rem}.mr-md-n1{margin-right:-.25rem}.mb-md-n1,.my-md-n1{margin-bottom:-.25rem}.m-md-n2{margin:-.5rem}.my-md-n2{margin-top:-.5rem}.mr-md-n2{margin-right:-.5rem}.mb-md-n2,.my-md-n2{margin-bottom:-.5rem}.m-md-n3{margin:-1rem}.my-md-n3{margin-top:-1rem}.mr-md-n3{margin-right:-1rem}.mb-md-n3,.my-md-n3{margin-bottom:-1rem}.m-md-n4{margin:-1.5rem}.my-md-n4{margin-top:-1.5rem}.mr-md-n4{margin-right:-1.5rem}.mb-md-n4,.my-md-n4{margin-bottom:-1.5rem}.m-md-n5{margin:-3rem}.my-md-n5{margin-top:-3rem}.mr-md-n5{margin-right:-3rem}.mb-md-n5,.my-md-n5{margin-bottom:-3rem}}@media(min-width:992px){.m-lg-0{margin:0}.my-lg-0{margin-top:0}.mr-lg-0{margin-right:0}.mb-lg-0,.my-lg-0{margin-bottom:0}.m-lg-1{margin:.25rem}.my-lg-1{margin-top:.25rem}.mr-lg-1{margin-right:.25rem}.mb-lg-1,.my-lg-1{margin-bottom:.25rem}.m-lg-2{margin:.5rem}.my-lg-2{margin-top:.5rem}.mr-lg-2{margin-right:.5rem}.mb-lg-2,.my-lg-2{margin-bottom:.5rem}.m-lg-3{margin:1rem}.my-lg-3{margin-top:1rem}.mr-lg-3{margin-right:1rem}.mb-lg-3,.my-lg-3{margin-bottom:1rem}.m-lg-4{margin:1.5rem}.my-lg-4{margin-top:1.5rem}.mr-lg-4{margin-right:1.5rem}.mb-lg-4,.my-lg-4{margin-bottom:1.5rem}.m-lg-5{margin:3rem}.my-lg-5{margin-top:3rem}.mr-lg-5{margin-right:3rem}.mb-lg-5,.my-lg-5{margin-bottom:3rem}.p-lg-0{padding:0}.pt-lg-0,.py-lg-0{padding-top:0}.pb-lg-0,.py-lg-0{padding-bottom:0}.p-lg-1{padding:.25rem}.pt-lg-1,.py-lg-1{padding-top:.25rem}.pb-lg-1,.py-lg-1{padding-bottom:.25rem}.p-lg-2{padding:.5rem}.pt-lg-2,.py-lg-2{padding-top:.5rem}.pb-lg-2,.py-lg-2{padding-bottom:.5rem}.p-lg-3{padding:1rem}.pt-lg-3,.py-lg-3{padding-top:1rem}.pb-lg-3,.py-lg-3{padding-bottom:1rem}.p-lg-4{padding:1.5rem}.pt-lg-4,.py-lg-4{padding-top:1.5rem}.pb-lg-4,.py-lg-4{padding-bottom:1.5rem}.p-lg-5{padding:3rem}.pt-lg-5,.py-lg-5{padding-top:3rem}.pb-lg-5,.py-lg-5{padding-bottom:3rem}.m-lg-n1{margin:-.25rem}.my-lg-n1{margin-top:-.25rem}.mr-lg-n1{margin-right:-.25rem}.mb-lg-n1,.my-lg-n1{margin-bottom:-.25rem}.m-lg-n2{margin:-.5rem}.my-lg-n2{margin-top:-.5rem}.mr-lg-n2{margin-right:-.5rem}.mb-lg-n2,.my-lg-n2{margin-bottom:-.5rem}.m-lg-n3{margin:-1rem}.my-lg-n3{margin-top:-1rem}.mr-lg-n3{margin-right:-1rem}.mb-lg-n3,.my-lg-n3{margin-bottom:-1rem}.m-lg-n4{margin:-1.5rem}.my-lg-n4{margin-top:-1.5rem}.mr-lg-n4{margin-right:-1.5rem}.mb-lg-n4,.my-lg-n4{margin-bottom:-1.5rem}.m-lg-n5{margin:-3rem}.my-lg-n5{margin-top:-3rem}.mr-lg-n5{margin-right:-3rem}.mb-lg-n5,.my-lg-n5{margin-bottom:-3rem}}.text-right{text-align:right}.text-center{text-align:center}@media(min-width:768px){.text-md-right{text-align:right}.text-md-center{text-align:center}}@media(min-width:992px){.text-lg-right{text-align:right}.text-lg-center{text-align:center}}.text-white{color:#fff}.text-primary{color:#007bff}a.text-primary:focus,a.text-primary:hover{color:#0056b3}.text-light{color:#f8f9fa}a.text-light:focus,a.text-light:hover{color:#cbd3da}.text-dark{color:#343a40}a.text-dark:focus,a.text-dark:hover{color:#121416}.text-body{color:#212529}.text-muted{color:#6c757d}.text-black-50{color:rgba(0,0,0,.5)}.text-white-50{color:rgba(255,255,255,.5)}.text-decoration-none{text-decoration:none}.text-reset{color:inherit}.visible{visibility:visible}@media print{*,::after,::before{text-shadow:none;box-shadow:none}a:not(.btn){text-decoration:underline}pre{white-space:pre-wrap}pre{border:1px solid #adb5bd;page-break-inside:avoid}thead{display:table-header-group}img,tr{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}body{min-width:992px}.container{min-width:992px}.table{border-collapse:collapse}.table td,.table th{background-color:#fff}.table-dark{color:inherit}.table-dark tbody+tbody,.table-dark td,.table-dark th,.table-dark thead th{border-color:#dee2e6}.table .thead-dark th{color:inherit;border-color:#dee2e6}}@-webkit-keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}@keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"}a:link,a:visited{color:#f14600;text-decoration:none}a:active,a:hover{text-decoration:underline}.btn:disabled{cursor:default;opacity:.4}#logo-text{width:180px;margin-left:12px}.display-5{font-size:2rem;font-weight:300;line-height:1.2}.display-6{font-size:1.75rem;font-weight:300;line-height:1.2}.bg-dark-alt,.bg-dark-alt:focus{background:#36363f}.bg-orange,.bg-orange:focus{background:#f14600}.text-dark-alt{color:#36363f}.btn-dark-alt{background:#36363f}.btn-dark-alt:focus{background:#36363f}.btn-outline-orange{border-color:#f14600;color:#f14600}.btn-orange,.btn-outline-orange:hover{background:#f14600;color:#fff}.btn:active,.btn:hover{text-decoration:none}.text-orange{color:#f14600}.bg-number{position:absolute;font-size:900%;font-weight:700;color:rgba(241,70,0,.1);line-height:1;margin-top:-1rem}.headerlink{text-decoration:none;margin-left:.5rem}#content table{border:1px solid #dee2e6;width:100%;margin-bottom:1rem;overflow-x:auto}#content thead{background:#444451;color:#fff}#content td,#content th{padding:.75rem;vertical-align:top}#content td{border:1px solid #dee2e6}#content th{border:1px solid #444451}#content code{color:#000;background:#eee;padding:.125rem .25rem}#content code.syntax{padding:0}#content pre{background:#efefef;padding:1rem;line-height:1.25}@media(max-width:768px){#search-form{width:50%}#search-form .input-group{width:100%}}@media print{body{min-width:0}code,h1,h2,h3,h4,h5,h6,img,li,p,pre,td,th,thead,tr{page-break-inside:avoid}}@media(prefers-color-scheme:dark){#to-full-website,body.amp,body[data-spy]{background:#1c1c1c;color:#efefef}.invert-dark{filter:invert(100%)}#content table{border:1px solid #2a2b2c}#content thead{background:#333}#content td{border:1px solid #444451}#content code{background:#444;color:#eee;padding:.125rem .25rem}#content pre{background:#444;color:#eee}}@media(prefers-color-scheme:dark){.syntax{background:#2d2d2d;color:#f2f0ec}.syntax .c{color:#747369}.syntax .err{color:#f2777a}.syntax .k{color:#c9c}.syntax .l{color:#f99157}.syntax .n{color:#f2f0ec}.syntax .o{color:#6cc}.syntax .p{color:#f2f0ec}.syntax .cp{color:#747369}.syntax .c1{color:#747369}.syntax .kc{color:#c9c}.syntax .ld{color:#9c9}.syntax .m{color:#f99157}.syntax .s{color:#9c9}.syntax .na{color:#69c}.syntax .nb{color:#f2f0ec}.syntax .nc{color:#fc6}.syntax .no{color:#f2777a}.syntax .nd{color:#6cc}.syntax .py{color:#f2f0ec}.syntax .nt{color:#6cc}.syntax .nv{color:#f2777a}.syntax .mi{color:#f99157}.syntax .s2{color:#9c9}.syntax .s1{color:#9c9}.syntax .ss{color:#9c9}}</style><script async custom-element=amp-analytics src=https://cdn.ampproject.org/v0/amp-analytics-0.1.js></script><script async custom-element=amp-iframe src=https://cdn.ampproject.org/v0/amp-iframe-0.1.js></script></head> <body class=amp dir=ltr> <div class="container-fluid container-lg pb-5"> <div class="row pt-3 mb-3"> <div class=col> <a href=/ class=text-decoration-none> <amp-img class="d-inline-block mr-3" layout=fixed width=40 height=36 src=/images/logo.svg alt="ClickHouse logo" title="ClickHouse logo"></amp-img><amp-img class="invert-dark d-inline-block" layout=fixed width=238 height=36 src=/images/clickhouse-black.svg alt=ClickHouse title=ClickHouse></amp-img> </a> </div> </div> <div class=row> <div id=content class=col> <h1 id=formats>Форматы входных и выходных данных<a class=headerlink href=../amp/#formats title="Permanent link"> </a></h1> <p>ClickHouse может принимать (<code class=syntax>INSERT</code>) и отдавать (<code class=syntax>SELECT</code>) данные в различных форматах.</p> <p>Поддерживаемые форматы и возможность использовать их в запросах <code class=syntax>INSERT</code> и <code class=syntax>SELECT</code> перечислены в таблице ниже.</p> <table> <thead> <tr> <th>Формат</th> <th>INSERT</th> <th>SELECT</th> </tr> </thead> <tbody> <tr> <td><a href=../amp/#tabseparated>TabSeparated</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#tabseparatedraw>TabSeparatedRaw</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#tabseparatedwithnames>TabSeparatedWithNames</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#tabseparatedwithnamesandtypes>TabSeparatedWithNamesAndTypes</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#format-template>Template</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#templateignorespaces>TemplateIgnoreSpaces</a></td> <td>✔</td> <td>✗</td> </tr> <tr> <td><a href=../amp/#csv>CSV</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#csvwithnames>CSVWithNames</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#format-customseparated>CustomSeparated</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#data-format-values>Values</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#vertical>Vertical</a></td> <td>✗</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#verticalraw>VerticalRaw</a></td> <td>✗</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#json>JSON</a></td> <td>✗</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#jsonasstring>JSONAsString</a></td> <td>✔</td> <td>✗</td> </tr> <tr> <td><a href=../amp/#jsonstring>JSONString</a></td> <td>✗</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#jsoncompact>JSONCompact</a></td> <td>✗</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#jsoncompactstring>JSONCompactString</a></td> <td>✗</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#jsoneachrow>JSONEachRow</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#jsoneachrowwithprogress>JSONEachRowWithProgress</a></td> <td>✗</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#jsonstringeachrow>JSONStringEachRow</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#jsonstringeachrowwithprogress>JSONStringEachRowWithProgress</a></td> <td>✗</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#jsoncompacteachrow>JSONCompactEachRow</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#jsoncompacteachrowwithnamesandtypes>JSONCompactEachRowWithNamesAndTypes</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#jsoncompactstringeachrow>JSONCompactStringEachRow</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#jsoncompactstringeachrowwithnamesandtypes>JSONCompactStringEachRowWithNamesAndTypes</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#tskv>TSKV</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#pretty>Pretty</a></td> <td>✗</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#prettycompact>PrettyCompact</a></td> <td>✗</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#prettycompactmonoblock>PrettyCompactMonoBlock</a></td> <td>✗</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#prettynoescapes>PrettyNoEscapes</a></td> <td>✗</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#prettyspace>PrettySpace</a></td> <td>✗</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#protobuf>Protobuf</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#protobufsingle>ProtobufSingle</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#data-format-avro>Avro</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#data-format-avro-confluent>AvroConfluent</a></td> <td>✔</td> <td>✗</td> </tr> <tr> <td><a href=../amp/#data-format-parquet>Parquet</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#data-format-arrow>Arrow</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#data-format-arrow-stream>ArrowStream</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#data-format-orc>ORC</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#rowbinary>RowBinary</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#rowbinarywithnamesandtypes>RowBinaryWithNamesAndTypes</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#native>Native</a></td> <td>✔</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#null>Null</a></td> <td>✗</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#xml>XML</a></td> <td>✗</td> <td>✔</td> </tr> <tr> <td><a href=../amp/#capnproto>CapnProto</a></td> <td>✔</td> <td>✗</td> </tr> <tr> <td><a href=../amp/#lineasstring>LineAsString</a></td> <td>✔</td> <td>✗</td> </tr> <tr> <td><a href=../amp/#data-format-regexp>Regexp</a></td> <td>✔</td> <td>✗</td> </tr> <tr> <td><a href=../amp/#rawblob>RawBLOB</a></td> <td>✔</td> <td>✔</td> </tr> </tbody> </table> <p>Вы можете регулировать некоторые параметры работы с форматами с помощью настроек ClickHouse. За дополнительной информацией обращайтесь к разделу <a href=../../../operations/settings/settings/amp/ >Настройки</a>.</p> <h2 id=tabseparated>TabSeparated<a class=headerlink href=../amp/#tabseparated title="Permanent link"> </a></h2> <p>В TabSeparated формате данные пишутся по строкам. Каждая строчка содержит значения, разделённые табами. После каждого значения идёт таб, кроме последнего значения в строке, после которого идёт перевод строки. Везде подразумеваются исключительно unix-переводы строк. Последняя строка также обязана содержать перевод строки на конце. Значения пишутся в текстовом виде, без обрамляющих кавычек, с экранированием служебных символов.</p> <p>Этот формат также доступен под именем <code class=syntax>TSV</code>.</p> <p>Формат <code class=syntax>TabSeparated</code> удобен для обработки данных произвольными программами и скриптами. Он используется по умолчанию в HTTP-интерфейсе, а также в batch-режиме клиента командной строки. Также формат позволяет переносить данные между разными СУБД. Например, вы можете получить дамп из MySQL и загрузить его в ClickHouse, или наоборот.</p> <p>Формат <code class=syntax>TabSeparated</code> поддерживает вывод тотальных значений (при использовании WITH TOTALS) и экстремальных значений (при настройке extremes выставленной в 1). В этих случаях, после основных данных выводятся тотальные значения, и экстремальные значения. Основной результат, тотальные значения и экстремальные значения, отделяются друг от друга пустой строкой. Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>EventDate</span><span class=p>,</span> <span class=k>count</span><span class=p>()</span> <span class=k>AS</span> <span class=k>c</span> <span class=k>FROM</span> <span class=n>test</span><span class=p>.</span><span class=n>hits</span> <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>EventDate</span> <span class=k>WITH</span> <span class=n>TOTALS</span> <span class=k>ORDER</span> <span class=k>BY</span> <span class=n>EventDate</span> <span class=n>FORMAT</span> <span class=n>TabSeparated</span><span class=o>``</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>2014-03-17      1406958
2014-03-18      1383658
2014-03-19      1405797
2014-03-20      1353623
2014-03-21      1245779
2014-03-22      1031592
2014-03-23      1046491

1970-01-01      8873898

2014-03-17      1031592
2014-03-23      1406958
</code></pre></div> <h3 id=formatirovanie-dannykh>Форматирование данных<a class=headerlink href=../amp/#formatirovanie-dannykh title="Permanent link"> </a></h3> <p>Целые числа пишутся в десятичной форме. Числа могут содержать лишний символ «+» в начале (игнорируется при парсинге, а при форматировании не пишется). Неотрицательные числа не могут содержать знак отрицания. При чтении допустим парсинг пустой строки, как числа ноль, или (для знаковых типов) строки, состоящей из одного минуса, как числа ноль. Числа, не помещающиеся в соответствующий тип данных, могут парсится, как некоторое другое число, без сообщения об ошибке.</p> <p>Числа с плавающей запятой пишутся в десятичной форме. При этом, десятичный разделитель - точка. Поддерживается экспоненциальная запись, а также inf, +inf, -inf, nan. Запись числа с плавающей запятой может начинаться или заканчиваться на десятичную точку.<br> При форматировании возможна потеря точности чисел с плавающей запятой.<br> При парсинге, допустимо чтение не обязательно наиболее близкого к десятичной записи машинно-представимого числа.</p> <p>Даты выводятся в формате YYYY-MM-DD, парсятся в том же формате, но с любыми символами в качестве разделителей.<br> Даты-с-временем выводятся в формате YYYY-MM-DD hh:mm:ss, парсятся в том же формате, но с любыми символами в качестве разделителей.<br> Всё это происходит в системном часовом поясе на момент старта клиента (если клиент занимается форматированием данных) или сервера. Для дат-с-временем не указывается, действует ли daylight saving time. То есть, если в дампе есть времена во время перевода стрелок назад, то дамп не соответствует данным однозначно, и при парсинге будет выбрано какое-либо из двух времён.<br> При парсинге, некорректные даты и даты-с-временем могут парситься с естественным переполнением или как нулевые даты/даты-с-временем без сообщения об ошибке.</p> <p>В качестве исключения, поддерживается также парсинг даты-с-временем в формате unix timestamp, если он состоит ровно из 10 десятичных цифр. Результат не зависит от часового пояса. Различение форматов YYYY-MM-DD hh:mm:ss и NNNNNNNNNN делается автоматически.</p> <p>Строки выводятся с экранированием спецсимволов с помощью обратного слеша. При выводе, используются следующие escape-последовательности: <code class=syntax>\b</code>, <code class=syntax>\f</code>, <code class=syntax>\r</code>, <code class=syntax>\n</code>, <code class=syntax>\t</code>, <code class=syntax>\0</code>, <code class=syntax>\'</code>, <code class=syntax>\\</code>. Парсер также поддерживает последовательности <code class=syntax>\a</code>, <code class=syntax>\v</code>, и <code class=syntax>\xHH</code> (последовательности hex escape) и любые последовательности вида <code class=syntax>\c</code>, где <code class=syntax>c</code> — любой символ (такие последовательности преобразуются в <code class=syntax>c</code>). Таким образом, при чтении поддерживаются форматы, где перевод строки может быть записан как <code class=syntax>\n</code> и как <code class=syntax>\</code> и перевод строки. Например, строка <code class=syntax>Hello world</code>, где между словами вместо пробела стоит перевод строки, может быть считана в любом из следующих вариантов:</p> <div class=codehilite><pre><span></span><code class=syntax>Hello\nworld

Hello\
world
</code></pre></div> <p>Второй вариант поддерживается, так как его использует MySQL при записи tab-separated дампа.</p> <p>Минимальный набор символов, которых вам необходимо экранировать при передаче в TabSeparated формате: таб, перевод строки (LF) и обратный слеш.</p> <p>Экранируется лишь небольшой набор символов. Вы можете легко наткнуться на строковое значение, которое испортит ваш терминал при выводе в него.</p> <p>Массивы форматируются в виде списка значений через запятую в квадратных скобках. Элементы массива - числа форматируются как обычно, а даты, даты-с-временем и строки - в одинарных кавычках с такими же правилами экранирования, как указано выше.</p> <p><a href=../../../sql-reference/syntax/amp/ >NULL</a> форматируется как <code class=syntax>\N</code>.</p> <p>Каждый элемент структуры типа <a href=../../../sql-reference/data-types/nested-data-structures/nested/amp/ >Nested</a> представляется как отдельный массив.</p> <p>Например:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>nestedt</span>
<span class=p>(</span>
    <span class=o>`</span><span class=n>id</span><span class=o>`</span> <span class=n>UInt8</span><span class=p>,</span>
    <span class=o>`</span><span class=n>aux</span><span class=o>`</span> <span class=n>Nested</span><span class=p>(</span>
        <span class=n>a</span> <span class=n>UInt8</span><span class=p>,</span>
        <span class=n>b</span> <span class=n>String</span>
    <span class=p>)</span>
<span class=p>)</span>
<span class=n>ENGINE</span> <span class=o>=</span> <span class=n>TinyLog</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>nestedt</span> <span class=k>Values</span> <span class=p>(</span> <span class=mi>1</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=p>[</span><span class=s1>'a'</span><span class=p>])</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>nestedt</span> <span class=n>FORMAT</span> <span class=n>TSV</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>1 [1] ['a']
</code></pre></div> <h2 id=tabseparatedraw>TabSeparatedRaw<a class=headerlink href=../amp/#tabseparatedraw title="Permanent link"> </a></h2> <p>Отличается от формата <code class=syntax>TabSeparated</code> тем, что строки выводятся без экранирования.<br> Используя этот формат, следите, чтобы в полях не было символов табуляции или разрыва строки.</p> <p>Этот формат также доступен под именем <code class=syntax>TSVRaw</code>.</p> <h2 id=tabseparatedwithnames>TabSeparatedWithNames<a class=headerlink href=../amp/#tabseparatedwithnames title="Permanent link"> </a></h2> <p>Отличается от формата <code class=syntax>TabSeparated</code> тем, что в первой строке пишутся имена столбцов.<br> При парсинге, первая строка полностью игнорируется. Вы не можете использовать имена столбцов, чтобы указать их порядок расположения, или чтобы проверить их корректность.<br> (Поддержка обработки заголовка при парсинге может быть добавлена в будущем.)</p> <p>Этот формат также доступен под именем <code class=syntax>TSVWithNames</code>.</p> <h2 id=tabseparatedwithnamesandtypes>TabSeparatedWithNamesAndTypes<a class=headerlink href=../amp/#tabseparatedwithnamesandtypes title="Permanent link"> </a></h2> <p>Отличается от формата <code class=syntax>TabSeparated</code> тем, что в первой строке пишутся имена столбцов, а во второй - типы столбцов.<br> При парсинге, первая и вторая строка полностью игнорируется.</p> <p>Этот формат также доступен под именем <code class=syntax>TSVWithNamesAndTypes</code>.</p> <h2 id=format-template>Template<a class=headerlink href=../amp/#format-template title="Permanent link"> </a></h2> <p>Этот формат позволяет указать произвольную форматную строку, в которую подставляются значения, сериализованные выбранным способом.</p> <p>Для этого используются настройки <code class=syntax>format_template_resultset</code>, <code class=syntax>format_template_row</code>, <code class=syntax>format_template_rows_between_delimiter</code> и настройки экранирования других форматов (например, <code class=syntax>output_format_json_quote_64bit_integers</code> при экранировании как в <code class=syntax>JSON</code>, см. далее)</p> <p>Настройка <code class=syntax>format_template_row</code> задаёт путь к файлу, содержащему форматную строку для строк таблицы, которая должна иметь вид:</p> <p><code class=syntax>delimiter_1${column_1:serializeAs_1}delimiter_2${column_2:serializeAs_2} ... delimiter_N</code>,</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>где</span> <span class="n n-Quoted">`delimiter_i`</span> <span class=o>-</span> <span class=n>разделители</span> <span class=n>между</span> <span class=n>значениями</span> <span class=p>(</span><span class=n>символ</span> <span class="n n-Quoted">`$`</span> <span class=n>в</span> <span class=n>разделителе</span> <span class=n>экранируется</span> <span class=n>как</span> <span class="n n-Quoted">`$$`</span><span class=p>),</span>
<span class="n n-Quoted">`column_i`</span> <span class=o>-</span> <span class=n>имена</span> <span class=n>или</span> <span class=n>номера</span> <span class=n>столбцов</span><span class=p>,</span> <span class=n>значения</span> <span class=n>которых</span> <span class=n>должны</span> <span class=n>быть</span> <span class=n>выведены</span> <span class=n>или</span> <span class=n>считаны</span> <span class=p>(</span><span class=n>если</span> <span class=n>имя</span> <span class=n>не</span> <span class=n>указано</span> <span class=o>-</span> <span class=n>столбец</span> <span class=n>пропускается</span><span class=p>),</span>
<span class="n n-Quoted">`serializeAs_i`</span> <span class=o>-</span> <span class=n>тип</span> <span class=n>экранирования</span> <span class=n>для</span> <span class=n>значений</span> <span class=n>соответствующего</span> <span class=n>столбца</span><span class=p>.</span> <span class=n>Поддерживаются</span> <span class=n>следующие</span> <span class=n>типы</span> <span class=n>экранирования</span><span class=o>:</span>

<span class=o>-</span> <span class="n n-Quoted">`CSV`</span><span class=p>,</span> <span class="n n-Quoted">`JSON`</span><span class=p>,</span> <span class="n n-Quoted">`XML`</span> <span class=p>(</span><span class=n>как</span> <span class=n>в</span> <span class=n>одноимённых</span> <span class=n>форматах</span><span class=p>)</span>
<span class=o>-</span> <span class="n n-Quoted">`Escaped`</span> <span class=p>(</span><span class=n>как</span> <span class=n>в</span> <span class="n n-Quoted">`TSV`</span><span class=p>)</span>
<span class=o>-</span> <span class="n n-Quoted">`Quoted`</span> <span class=p>(</span><span class=n>как</span> <span class=n>в</span> <span class="n n-Quoted">`Values`</span><span class=p>)</span>
<span class=o>-</span> <span class="n n-Quoted">`Raw`</span> <span class=p>(</span><span class=n>без</span> <span class=n>экранирования</span><span class=p>,</span> <span class=n>как</span> <span class=n>в</span> <span class="n n-Quoted">`TSVRaw`</span><span class=p>)</span>
<span class=o>-</span> <span class="n n-Quoted">`None`</span> <span class=p>(</span><span class=n>тип</span> <span class=n>экранирования</span> <span class=n>отсутствует</span><span class=p>,</span> <span class=n>см</span><span class=p>.</span> <span class=n>далее</span><span class=p>)</span>

<span class=n>Если</span> <span class=n>для</span> <span class=n>столбца</span> <span class=n>не</span> <span class=n>указан</span> <span class=n>тип</span> <span class=n>экранирования</span><span class=p>,</span> <span class=n>используется</span> <span class="n n-Quoted">`None`</span><span class=p>.</span> <span class="n n-Quoted">`XML`</span> <span class=n>и</span> <span class="n n-Quoted">`Raw`</span> <span class=n>поддерживаются</span> <span class=n>только</span> <span class=n>для</span> <span class=n>вывода</span><span class=p>.</span>

<span class=n>Так</span><span class=p>,</span> <span class=n>в</span> <span class=n>форматной</span> <span class=n>строке</span>

<span class="n n-Quoted">`Search phrase: ${SearchPhrase:Quoted}, count: ${c:Escaped}, ad price: $$${price:JSON};`</span>

<span class=n>между</span> <span class=n>разделителями</span> <span class="n n-Quoted">`Search phrase: `</span><span class=p>,</span> <span class="n n-Quoted">`, count: `</span><span class=p>,</span> <span class="n n-Quoted">`, ad price: $`</span> <span class=n>и</span> <span class="n n-Quoted">`;`</span> <span class=n>при</span> <span class=n>выводе</span> <span class=n>будут</span> <span class=n>подставлены</span> <span class=p>(</span><span class=n>при</span> <span class=n>вводе</span> <span class=o>-</span> <span class=n>будут</span> <span class=n>ожидаться</span><span class=p>)</span> <span class=n>значения</span> <span class=n>столбцов</span> <span class="n n-Quoted">`SearchPhrase`</span><span class=p>,</span> <span class="n n-Quoted">`c`</span> <span class=n>и</span> <span class="n n-Quoted">`price`</span><span class=p>,</span> <span class=n>сериализованные</span> <span class=n>как</span> <span class="n n-Quoted">`Quoted`</span><span class=p>,</span> <span class="n n-Quoted">`Escaped`</span> <span class=n>и</span> <span class="n n-Quoted">`JSON`</span> <span class=n>соответственно</span><span class=p>,</span> <span class=n>например</span><span class=o>:</span>

<span class="n n-Quoted">`Search phrase: 'bathroom interior design', count: 2166, ad price: $3;`</span>
</code></pre></div> <p>Настройка <code class=syntax>format_template_rows_between_delimiter</code> задаёт разделитель между строками, который выводится (или ожмдается при вводе) после каждой строки, кроме последней. По умолчанию <code class=syntax>\n</code>.</p> <p>Настройка <code class=syntax>format_template_resultset</code> задаёт путь к файлу, содержащему форматную строку для результата. Форматная строка для результата имеет синтаксис аналогичный форматной строке для строк таблицы и позволяет указать префикс, суффикс и способ вывода дополнительной информации. Вместо имён столбцов в ней указываются следующие имена подстановок:</p> <ul> <li><code class=syntax>data</code> - строки с данными в формате <code class=syntax>format_template_row</code>, разделённые <code class=syntax>format_template_rows_between_delimiter</code>. Эта подстановка должна быть первой подстановкой в форматной строке.</li> <li><code class=syntax>totals</code> - строка с тотальными значениями в формате <code class=syntax>format_template_row</code> (при использовании WITH TOTALS)</li> <li><code class=syntax>min</code> - строка с минимальными значениями в формате <code class=syntax>format_template_row</code> (при настройке extremes, выставленной в 1)</li> <li><code class=syntax>max</code> - строка с максимальными значениями в формате <code class=syntax>format_template_row</code> (при настройке extremes, выставленной в 1)</li> <li><code class=syntax>rows</code> - общее количество выведенных стрчек</li> <li><code class=syntax>rows_before_limit</code> - не менее скольких строчек получилось бы, если бы не было LIMIT-а. Выводится только если запрос содержит LIMIT. В случае, если запрос содержит GROUP BY, <code class=syntax>rows_before_limit</code> - точное число строк, которое получилось бы, если бы не было LIMIT-а.</li> <li><code class=syntax>time</code> - время выполнения запроса в секундах</li> <li><code class=syntax>rows_read</code> - сколько строк было прочитано при выполнении запроса</li> <li><code class=syntax>bytes_read</code> - сколько байт (несжатых) было прочитано при выполнении запроса</li> </ul> <p>У подстановок <code class=syntax>data</code>, <code class=syntax>totals</code>, <code class=syntax>min</code> и <code class=syntax>max</code> не должны быть указаны типы экранирования (или должен быть указан <code class=syntax>None</code>). Остальные подстановки - это отдельные значения, для них может быть указан любой тип экранирования.<br> Если строка <code class=syntax>format_template_resultset</code> пустая, то по-умолчанию используется <code class=syntax>${data}</code>.<br> Из всех перечисленных подстановок форматная строка <code class=syntax>format_template_resultset</code> для ввода может содержать только <code class=syntax>data</code>.<br> Также при вводе формат поддерживает пропуск значений столбцов и пропуск значений в префиксе и суффиксе (см. пример).</p> <p>Пример вывода:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>SearchPhrase</span><span class=p>,</span> <span class=k>count</span><span class=p>()</span> <span class=k>AS</span> <span class=k>c</span> <span class=k>FROM</span> <span class=n>test</span><span class=p>.</span><span class=n>hits</span> <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>SearchPhrase</span> <span class=k>ORDER</span> <span class=k>BY</span> <span class=k>c</span> <span class=k>DESC</span> <span class=k>LIMIT</span> <span class=mi>5</span> <span class=n>FORMAT</span> <span class=k>Template</span> <span class=n>SETTINGS</span>
<span class=n>format_template_resultset</span> <span class=o>=</span> <span class=s1>'/some/path/resultset.format'</span><span class=p>,</span> <span class=n>format_template_row</span> <span class=o>=</span> <span class=s1>'/some/path/row.format'</span><span class=p>,</span> <span class=n>format_template_rows_between_delimiter</span> <span class=o>=</span> <span class=s1>'\n    '</span>
</code></pre></div> <p><code class=syntax>/some/path/resultset.format</code>:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=cp>&lt;!DOCTYPE HTML&gt;</span>
<span class=nt>&lt;html&gt;</span> <span class=nt>&lt;head&gt;</span> <span class=nt>&lt;title&gt;</span>Search phrases<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span> <span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
 <span class=nt>&lt;body&gt;</span>
  <span class=nt>&lt;table</span> <span class=na>border=</span><span class=s>"1"</span><span class=nt>&gt;</span> <span class=nt>&lt;caption&gt;</span>Search phrases<span class=p>&lt;/</span><span class=nt>caption</span><span class=p>&gt;</span>
    <span class=nt>&lt;tr&gt;</span> <span class=nt>&lt;th&gt;</span>Search phrase<span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span> <span class=nt>&lt;th&gt;</span>Count<span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span> <span class=p>&lt;/</span><span class=nt>tr</span><span class=p>&gt;</span>
    <span class=cp>${</span><span class=n>data</span><span class=cp>}</span>
  <span class=p>&lt;/</span><span class=nt>table</span><span class=p>&gt;</span>
  <span class=nt>&lt;table</span> <span class=na>border=</span><span class=s>"1"</span><span class=nt>&gt;</span> <span class=nt>&lt;caption&gt;</span>Max<span class=p>&lt;/</span><span class=nt>caption</span><span class=p>&gt;</span>
    <span class=cp>${</span><span class=nb>max</span><span class=cp>}</span>
  <span class=p>&lt;/</span><span class=nt>table</span><span class=p>&gt;</span>
  <span class=nt>&lt;b&gt;</span>Processed <span class=cp>${</span><span class=n>rows_read</span><span class=p>:</span><span class=n>XML</span><span class=cp>}</span> rows in <span class=cp>${</span><span class=n>time</span><span class=p>:</span><span class=n>XML</span><span class=cp>}</span> sec<span class=p>&lt;/</span><span class=nt>b</span><span class=p>&gt;</span>
 <span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</code></pre></div> <p><code class=syntax>/some/path/row.format</code>:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;tr&gt;</span> <span class=nt>&lt;td&gt;</span><span class=cp>${</span><span class=mi>0</span><span class=p>:</span><span class=n>XML</span><span class=cp>}</span><span class=nt>&lt;/td&gt;</span> <span class=nt>&lt;td&gt;</span><span class=cp>${</span><span class=mi>1</span><span class=p>:</span><span class=n>XML</span><span class=cp>}</span><span class=nt>&lt;/td&gt;</span> <span class=nt>&lt;/tr&gt;</span>
</code></pre></div> <p>Резутьтат:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=cp>&lt;!DOCTYPE HTML&gt;</span>
<span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>Search phrases<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span> <span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
 <span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>table</span> <span class=na>border</span><span class=o>=</span><span class=s>"1"</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>caption</span><span class=p>&gt;</span>Search phrases<span class=p>&lt;/</span><span class=nt>caption</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>tr</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span>Search phrase<span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span>Count<span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span> <span class=p>&lt;/</span><span class=nt>tr</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>tr</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;&lt;/</span><span class=nt>td</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;</span>8267016<span class=p>&lt;/</span><span class=nt>td</span><span class=p>&gt;</span> <span class=p>&lt;/</span><span class=nt>tr</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>tr</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;</span>bathroom interior design<span class=p>&lt;/</span><span class=nt>td</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;</span>2166<span class=p>&lt;/</span><span class=nt>td</span><span class=p>&gt;</span> <span class=p>&lt;/</span><span class=nt>tr</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>tr</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;</span>yandex<span class=p>&lt;/</span><span class=nt>td</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;</span>1655<span class=p>&lt;/</span><span class=nt>td</span><span class=p>&gt;</span> <span class=p>&lt;/</span><span class=nt>tr</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>tr</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;</span>spring 2014 fashion<span class=p>&lt;/</span><span class=nt>td</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;</span>1549<span class=p>&lt;/</span><span class=nt>td</span><span class=p>&gt;</span> <span class=p>&lt;/</span><span class=nt>tr</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>tr</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;</span>freeform photos<span class=p>&lt;/</span><span class=nt>td</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;</span>1480<span class=p>&lt;/</span><span class=nt>td</span><span class=p>&gt;</span> <span class=p>&lt;/</span><span class=nt>tr</span><span class=p>&gt;</span>
  <span class=p>&lt;/</span><span class=nt>table</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>table</span> <span class=na>border</span><span class=o>=</span><span class=s>"1"</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>caption</span><span class=p>&gt;</span>Max<span class=p>&lt;/</span><span class=nt>caption</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>tr</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;&lt;/</span><span class=nt>td</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;</span>8873898<span class=p>&lt;/</span><span class=nt>td</span><span class=p>&gt;</span> <span class=p>&lt;/</span><span class=nt>tr</span><span class=p>&gt;</span>
  <span class=p>&lt;/</span><span class=nt>table</span><span class=p>&gt;</span>
  <span class=p>&lt;</span><span class=nt>b</span><span class=p>&gt;</span>Processed 3095973 rows in 0.1569913 sec<span class=p>&lt;/</span><span class=nt>b</span><span class=p>&gt;</span>
 <span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</code></pre></div> <p>Пример ввода:</p> <div class=codehilite><pre><span></span><code class=syntax>Some header
Page views: 5, User id: 4324182021466249494, Useless field: hello, Duration: 146, Sign: -1
Page views: 6, User id: 4324182021466249494, Useless field: world, Duration: 185, Sign: 1
Total rows: 2
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>UserActivity</span> <span class=n>FORMAT</span> <span class=k>Template</span> <span class=n>SETTINGS</span>
<span class=n>format_template_resultset</span> <span class=o>=</span> <span class=s1>'/some/path/resultset.format'</span><span class=p>,</span> <span class=n>format_template_row</span> <span class=o>=</span> <span class=s1>'/some/path/row.format'</span>
</code></pre></div> <p><code class=syntax>/some/path/resultset.format</code>:</p> <div class=codehilite><pre><span></span><code class=syntax>Some header\n<span class=cp>${</span><span class=n>data</span><span class=cp>}</span>\nTotal rows: <span class=cp>${</span><span class=p>:</span><span class=n>CSV</span><span class=cp>}</span>\n
</code></pre></div> <p><code class=syntax>/some/path/row.format</code>:</p> <div class=codehilite><pre><span></span><code class=syntax>Page views: <span class=cp>${</span><span class=n>PageViews</span><span class=p>:</span><span class=n>CSV</span><span class=cp>}</span>, User id: <span class=cp>${</span><span class=n>UserID</span><span class=p>:</span><span class=n>CSV</span><span class=cp>}</span>, Useless field: <span class=cp>${</span><span class=p>:</span><span class=n>CSV</span><span class=cp>}</span>, Duration: <span class=cp>${</span><span class=n>Duration</span><span class=p>:</span><span class=n>CSV</span><span class=cp>}</span>, Sign: <span class=cp>${</span><span class=n>Sign</span><span class=p>:</span><span class=n>CSV</span><span class=cp>}</span>
</code></pre></div> <p><code class=syntax>PageViews</code>, <code class=syntax>UserID</code>, <code class=syntax>Duration</code> и <code class=syntax>Sign</code> внутри подстановок - имена столбцов в таблице, в которую вставляются данные. Значения после <code class=syntax>Useless field</code> в строках и значение после <code class=syntax>\nTotal rows:</code> в суффиксе будут проигнорированы.<br> Все разделители во входных данных должны строго соответствовать разделителям в форматных строках.</p> <h2 id=templateignorespaces>TemplateIgnoreSpaces<a class=headerlink href=../amp/#templateignorespaces title="Permanent link"> </a></h2> <p>Подходит только для ввода. Отличается от формата <code class=syntax>Template</code> тем, что пропускает пробельные символы между разделителями и значениями во входном потоке. Также в этом формате можно указать пустые подстановки с типом экранирования <code class=syntax>None</code> (<code class=syntax>${}</code> или <code class=syntax>${:None}</code>), чтобы разбить разделители на несколько частей, пробелы между которыми должны игнорироваться. Такие подстановки используются только для пропуска пробелов. С помощью этого формата можно считывать <code class=syntax>JSON</code>, если значения столбцов в нём всегда идут в одном порядке в каждой строке. Например, для вставки данных из примера вывода формата <a href=../amp/#json>JSON</a> в таблицу со столбцами <code class=syntax>phrase</code> и <code class=syntax>cnt</code> можно использовать следующий запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>INSERT</span> <span class=k>INTO</span> <span class=k>table_name</span> <span class=n>FORMAT</span> <span class=n>TemplateIgnoreSpaces</span> <span class=n>SETTINGS</span>
<span class=n>format_schema</span> <span class=o>=</span> <span class=s1>'{${}"meta"${}:${:JSON},${}"data"${}:${}[${data}]${},${}"totals"${}:${:JSON},${}"extremes"${}:${:JSON},${}"rows"${}:${:JSON},${}"rows_before_limit_at_least"${}:${:JSON}${}}'</span><span class=p>,</span>
<span class=n>format_schema_rows</span> <span class=o>=</span> <span class=s1>'{${}"SearchPhrase"${}:${}${phrase:JSON}${},${}"c"${}:${}${cnt:JSON}${}}'</span><span class=p>,</span>
<span class=n>format_schema_rows_between_delimiter</span> <span class=o>=</span> <span class=s1>','</span>
</code></pre></div> <h2 id=tskv>TSKV<a class=headerlink href=../amp/#tskv title="Permanent link"> </a></h2> <p>Похож на TabSeparated, но выводит значения в формате name=value. Имена экранируются так же, как строки в формате TabSeparated и, дополнительно, экранируется также символ =.</p> <div class=codehilite><pre><span></span><code class=syntax>SearchPhrase=   count()=8267016
SearchPhrase=интерьер ванной комнаты    count()=2166
SearchPhrase=яндекс     count()=1655
SearchPhrase=весна 2014 мода    count()=1549
SearchPhrase=фриформ фото       count()=1480
SearchPhrase=анджелина джоли    count()=1245
SearchPhrase=омск       count()=1112
SearchPhrase=фото собак разных пород    count()=1091
SearchPhrase=дизайн штор        count()=1064
SearchPhrase=баку       count()=1000
</code></pre></div> <p><a href=../../../sql-reference/syntax/amp/ >NULL</a> форматируется как <code class=syntax>\N</code>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>t_null</span> <span class=n>FORMAT</span> <span class=n>TSKV</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>x=1 y=\N
</code></pre></div> <p>При большом количестве маленьких столбцов, этот формат существенно неэффективен, и обычно нет причин его использовать. Впрочем, он не хуже формата JSONEachRow по производительности.</p> <p>Поддерживается как вывод, так и парсинг данных в этом формате. При парсинге, поддерживается расположение значений разных столбцов в произвольном порядке. Допустимо отсутствие некоторых значений - тогда они воспринимаются как равные значениям по умолчанию. В этом случае в качестве значений по умолчанию используются нули и пустые строки. Сложные значения, которые могут быть заданы в таблице не поддерживаются как значения по умолчанию.</p> <p>При парсинге, в качестве дополнительного поля, может присутствовать <code class=syntax>tskv</code> без знака равенства и без значения. Это поле игнорируется.</p> <h2 id=csv>CSV<a class=headerlink href=../amp/#csv title="Permanent link"> </a></h2> <p>Формат Comma Separated Values (<a href=https://tools.ietf.org/html/rfc4180 rel="external nofollow noreferrer" target=_blank>RFC</a>).</p> <p>При форматировании, строки выводятся в двойных кавычках. Двойная кавычка внутри строки выводится как две двойные кавычки подряд. Других правил экранирования нет. Даты и даты-с-временем выводятся в двойных кавычках. Числа выводятся без кавычек. Значения разделяются символом-разделителем, по умолчанию — <code class=syntax>,</code>. Символ-разделитель определяется настройкой <a href=../../../operations/settings/settings/amp/#settings-format_csv_delimiter>format_csv_delimiter</a>. Строки разделяются unix переводом строки (LF). Массивы сериализуются в CSV следующим образом: сначала массив сериализуется в строку, как в формате TabSeparated, а затем полученная строка выводится в CSV в двойных кавычках. Кортежи в формате CSV сериализуются, как отдельные столбцы (то есть, теряется их вложенность в кортеж).</p> <div class=codehilite><pre><span></span><code class=syntax>$ clickhouse-client --format_csv_delimiter<span class=o>=</span><span class=s2>"|"</span> --query<span class=o>=</span><span class=s2>"INSERT INTO test.csv FORMAT CSV"</span> &lt; data.csv
</code></pre></div> <p>*По умолчанию — <code class=syntax>,</code>. См. настройку <a href=../../../operations/settings/settings/amp/#settings-format_csv_delimiter>format_csv_delimiter</a> для дополнительной информации.</p> <p>При парсинге, все значения могут парситься как в кавычках, так и без кавычек. Поддерживаются как двойные, так и одинарные кавычки. Строки также могут быть без кавычек. В этом случае они парсятся до символа-разделителя или перевода строки (CR или LF). В нарушение RFC, в случае парсинга строк не в кавычках, начальные и конечные пробелы и табы игнорируются. В качестве перевода строки, поддерживаются как Unix (LF), так и Windows (CR LF) и Mac OS Classic (LF CR) варианты.</p> <p><code class=syntax>NULL</code> форматируется в виде <code class=syntax>\N</code> или <code class=syntax>NULL</code> или пустой неэкранированной строки (см. настройки <a href=../../../operations/settings/settings/amp/#settings-input_format_csv_unquoted_null_literal_as_null>input_format_csv_unquoted_null_literal_as_null</a> и <a href=../../../operations/settings/settings/amp/#session_settings-input_format_defaults_for_omitted_fields>input_format_defaults_for_omitted_fields</a>).</p> <p>Если установлена настройка <a href=../../../operations/settings/settings/amp/#session_settings-input_format_defaults_for_omitted_fields>input_format_defaults_for_omitted_fields = 1</a> и тип столбца не <code class=syntax>Nullable(T)</code>, то пустые значения без кавычек заменяются значениями по умолчанию для типа данных столбца.</p> <p>Формат CSV поддерживает вывод totals и extremes аналогично <code class=syntax>TabSeparated</code>.</p> <h2 id=csvwithnames>CSVWithNames<a class=headerlink href=../amp/#csvwithnames title="Permanent link"> </a></h2> <p>Выводит также заголовок, аналогично <code class=syntax>TabSeparatedWithNames</code>.</p> <h2 id=format-customseparated>CustomSeparated<a class=headerlink href=../amp/#format-customseparated title="Permanent link"> </a></h2> <p>Аналогичен <a href=../amp/#format-template>Template</a>, но выводит (или считывает) все столбцы, используя для них правило экранирования из настройки <code class=syntax>format_custom_escaping_rule</code> и разделители из настроек <code class=syntax>format_custom_field_delimiter</code>, <code class=syntax>format_custom_row_before_delimiter</code>, <code class=syntax>format_custom_row_after_delimiter</code>, <code class=syntax>format_custom_row_between_delimiter</code>, <code class=syntax>format_custom_result_before_delimiter</code> и <code class=syntax>format_custom_result_after_delimiter</code>, а не из форматных строк.<br> Также существует формат <code class=syntax>CustomSeparatedIgnoreSpaces</code>, аналогичный <code class=syntax>TemplateIgnoreSpaces</code>.</p> <h2 id=json>JSON<a class=headerlink href=../amp/#json title="Permanent link"> </a></h2> <p>Выводит данные в формате JSON. Кроме таблицы с данными, также выводятся имена и типы столбцов, и некоторая дополнительная информация - общее количество выведенных строк, а также количество строк, которое могло бы быть выведено, если бы не было LIMIT-а. Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>SearchPhrase</span><span class=p>,</span> <span class=k>count</span><span class=p>()</span> <span class=k>AS</span> <span class=k>c</span> <span class=k>FROM</span> <span class=n>test</span><span class=p>.</span><span class=n>hits</span> <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>SearchPhrase</span> <span class=k>WITH</span> <span class=n>TOTALS</span> <span class=k>ORDER</span> <span class=k>BY</span> <span class=k>c</span> <span class=k>DESC</span> <span class=k>LIMIT</span> <span class=mi>5</span> <span class=n>FORMAT</span> <span class=n>JSON</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=p>{</span>
        <span class=nt>"meta"</span><span class=p>:</span>
        <span class=p>[</span>
                <span class=p>{</span>
                        <span class=nt>"name"</span><span class=p>:</span> <span class=s2>"'hello'"</span><span class=p>,</span>
                        <span class=nt>"type"</span><span class=p>:</span> <span class=s2>"String"</span>
                <span class=p>},</span>
                <span class=p>{</span>
                        <span class=nt>"name"</span><span class=p>:</span> <span class=s2>"multiply(42, number)"</span><span class=p>,</span>
                        <span class=nt>"type"</span><span class=p>:</span> <span class=s2>"UInt64"</span>
                <span class=p>},</span>
                <span class=p>{</span>
                        <span class=nt>"name"</span><span class=p>:</span> <span class=s2>"range(5)"</span><span class=p>,</span>
                        <span class=nt>"type"</span><span class=p>:</span> <span class=s2>"Array(UInt8)"</span>
                <span class=p>}</span>
        <span class=p>],</span>

        <span class=nt>"data"</span><span class=p>:</span>
        <span class=p>[</span>
                <span class=p>{</span>
                        <span class=nt>"'hello'"</span><span class=p>:</span> <span class=s2>"hello"</span><span class=p>,</span>
                        <span class=nt>"multiply(42, number)"</span><span class=p>:</span> <span class=s2>"0"</span><span class=p>,</span>
                        <span class=nt>"range(5)"</span><span class=p>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>]</span>
                <span class=p>},</span>
                <span class=p>{</span>
                        <span class=nt>"'hello'"</span><span class=p>:</span> <span class=s2>"hello"</span><span class=p>,</span>
                        <span class=nt>"multiply(42, number)"</span><span class=p>:</span> <span class=s2>"42"</span><span class=p>,</span>
                        <span class=nt>"range(5)"</span><span class=p>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>]</span>
                <span class=p>},</span>
                <span class=p>{</span>
                        <span class=nt>"'hello'"</span><span class=p>:</span> <span class=s2>"hello"</span><span class=p>,</span>
                        <span class=nt>"multiply(42, number)"</span><span class=p>:</span> <span class=s2>"84"</span><span class=p>,</span>
                        <span class=nt>"range(5)"</span><span class=p>:</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>]</span>
                <span class=p>}</span>
        <span class=p>],</span>

        <span class=nt>"rows"</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span>

        <span class=nt>"rows_before_limit_at_least"</span><span class=p>:</span> <span class=mi>3</span>
<span class=p>}</span>
</code></pre></div> <p>JSON совместим с JavaScript. Для этого, дополнительно экранируются некоторые символы: символ прямого слеша <code class=syntax>/</code> экранируется в виде <code class=syntax>\/</code>; альтернативные переводы строк <code class=syntax>U+2028</code>, <code class=syntax>U+2029</code>, на которых ломаются некоторые браузеры, экранируются в виде <code class=syntax>\uXXXX</code>-последовательностей. Экранируются ASCII control characters: backspace, form feed, line feed, carriage return, horizontal tab в виде <code class=syntax>\b</code>, <code class=syntax>\f</code>, <code class=syntax>\n</code>, <code class=syntax>\r</code>, <code class=syntax>\t</code> соответственно, а также остальные байты из диапазона 00-1F с помощью <code class=syntax>\uXXXX</code>-последовательностей. Невалидные UTF-8 последовательности заменяются на replacement character � и, таким образом, выводимый текст будет состоять из валидных UTF-8 последовательностей. Числа типа UInt64 и Int64, для совместимости с JavaScript, по умолчанию выводятся в двойных кавычках. Чтобы они выводились без кавычек, можно установить конфигурационный параметр <a href=../../../operations/settings/settings/amp/#session_settings-output_format_json_quote_64bit_integers>output_format_json_quote_64bit_integers</a> равным 0.</p> <p><code class=syntax>rows</code> - общее количество выведенных строчек.</p> <p><code class=syntax>rows_before_limit_at_least</code> - не менее скольких строчек получилось бы, если бы не было LIMIT-а. Выводится только если запрос содержит LIMIT.<br> В случае, если запрос содержит GROUP BY, rows_before_limit_at_least - точное число строк, которое получилось бы, если бы не было LIMIT-а.</p> <p><code class=syntax>totals</code> - тотальные значения (при использовании WITH TOTALS).</p> <p><code class=syntax>extremes</code> - экстремальные значения (при настройке extremes, выставленной в 1).</p> <p>Этот формат подходит только для вывода результата выполнения запроса, но не для парсинга (приёма данных для вставки в таблицу).</p> <p>ClickHouse поддерживает <a href=../../../sql-reference/syntax/amp/ >NULL</a>, который при выводе JSON будет отображен как <code class=syntax>null</code>. Чтобы включить отображение в результате значений <code class=syntax>+nan</code>, <code class=syntax>-nan</code>, <code class=syntax>+inf</code>, <code class=syntax>-inf</code>, установите параметр <a href=../../../operations/settings/settings/amp/#settings-output_format_json_quote_denormals>output_format_json_quote_denormals</a> равным 1.</p> <p><strong>Смотрите также</strong></p> <ul> <li>Формат <a href=../amp/#jsoneachrow>JSONEachRow</a></li> <li>Настройка <a href=../../../operations/settings/settings/amp/#output-format-json-array-of-rows>output_format_json_array_of_rows</a></li> </ul> <h2 id=jsonstring>JSONString<a class=headerlink href=../amp/#jsonstring title="Permanent link"> </a></h2> <p>Отличается от JSON только тем, что поля данных выводятся в строках, а не в типизированных значениях JSON.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=p>{</span>
        <span class=nt>"meta"</span><span class=p>:</span>
        <span class=p>[</span>
                <span class=p>{</span>
                        <span class=nt>"name"</span><span class=p>:</span> <span class=s2>"'hello'"</span><span class=p>,</span>
                        <span class=nt>"type"</span><span class=p>:</span> <span class=s2>"String"</span>
                <span class=p>},</span>
                <span class=p>{</span>
                        <span class=nt>"name"</span><span class=p>:</span> <span class=s2>"multiply(42, number)"</span><span class=p>,</span>
                        <span class=nt>"type"</span><span class=p>:</span> <span class=s2>"UInt64"</span>
                <span class=p>},</span>
                <span class=p>{</span>
                        <span class=nt>"name"</span><span class=p>:</span> <span class=s2>"range(5)"</span><span class=p>,</span>
                        <span class=nt>"type"</span><span class=p>:</span> <span class=s2>"Array(UInt8)"</span>
                <span class=p>}</span>
        <span class=p>],</span>

        <span class=nt>"data"</span><span class=p>:</span>
        <span class=p>[</span>
                <span class=p>{</span>
                        <span class=nt>"'hello'"</span><span class=p>:</span> <span class=s2>"hello"</span><span class=p>,</span>
                        <span class=nt>"multiply(42, number)"</span><span class=p>:</span> <span class=s2>"0"</span><span class=p>,</span>
                        <span class=nt>"range(5)"</span><span class=p>:</span> <span class=s2>"[0,1,2,3,4]"</span>
                <span class=p>},</span>
                <span class=p>{</span>
                        <span class=nt>"'hello'"</span><span class=p>:</span> <span class=s2>"hello"</span><span class=p>,</span>
                        <span class=nt>"multiply(42, number)"</span><span class=p>:</span> <span class=s2>"42"</span><span class=p>,</span>
                        <span class=nt>"range(5)"</span><span class=p>:</span> <span class=s2>"[0,1,2,3,4]"</span>
                <span class=p>},</span>
                <span class=p>{</span>
                        <span class=nt>"'hello'"</span><span class=p>:</span> <span class=s2>"hello"</span><span class=p>,</span>
                        <span class=nt>"multiply(42, number)"</span><span class=p>:</span> <span class=s2>"84"</span><span class=p>,</span>
                        <span class=nt>"range(5)"</span><span class=p>:</span> <span class=s2>"[0,1,2,3,4]"</span>
                <span class=p>}</span>
        <span class=p>],</span>

        <span class=nt>"rows"</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span>

        <span class=nt>"rows_before_limit_at_least"</span><span class=p>:</span> <span class=mi>3</span>
<span class=p>}</span>
</code></pre></div> <h2 id=jsonasstring>JSONAsString<a class=headerlink href=../amp/#jsonasstring title="Permanent link"> </a></h2> <p>В этом формате один объект JSON интерпретируется как одно строковое значение. Если входные данные имеют несколько объектов JSON, разделенных запятой, то они будут интерпретироваться как отдельные строки таблицы.</p> <p>В этом формате парситься может только таблица с единственным полем типа <a href=../../../sql-reference/data-types/string/amp/ >String</a>. Остальные столбцы должны быть заданы как <code class=syntax>DEFAULT</code> или <code class=syntax>MATERIALIZED</code>(смотрите раздел <a href=../../../sql-reference/statements/create/table/amp/#create-default-values>Значения по умолчанию</a>), либо отсутствовать. Для дальнейшей обработки объекта JSON, представленного в строке, вы можете использовать <a href=../../../sql-reference/functions/json-functions/amp/ >функции для работы с JSON</a>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>DROP</span> <span class=k>TABLE</span> <span class=k>IF</span> <span class=k>EXISTS</span> <span class=n>json_as_string</span><span class=p>;</span>
<span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>json_as_string</span> <span class=p>(</span><span class=n>json</span> <span class=n>String</span><span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>Memory</span><span class=p>;</span>
<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>json_as_string</span> <span class=p>(</span><span class=n>json</span><span class=p>)</span> <span class=n>FORMAT</span> <span class=n>JSONAsString</span> <span class=err>{</span><span class=ss>"foo"</span><span class=p>:</span><span class=err>{</span><span class=ss>"bar"</span><span class=p>:</span><span class=err>{</span><span class=ss>"x"</span><span class=p>:</span><span class=ss>"y"</span><span class=err>}</span><span class=p>,</span><span class=ss>"baz"</span><span class=p>:</span><span class=mi>1</span><span class=err>}}</span><span class=p>,</span><span class=err>{}</span><span class=p>,</span><span class=err>{</span><span class=ss>"any json stucture"</span><span class=p>:</span><span class=mi>1</span><span class=err>}</span>
<span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>json_as_string</span><span class=p>;</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─json──────────────────────────────┐
│ {"foo":{"bar":{"x":"y"},"baz":1}} │
│ {}                                │
│ {"any json stucture":1}           │
└───────────────────────────────────┘
</code></pre></div> <h2 id=jsoncompact>JSONCompact<a class=headerlink href=../amp/#jsoncompact title="Permanent link"> </a></h2> <h2 id=jsoncompactstring>JSONCompactString<a class=headerlink href=../amp/#jsoncompactstring title="Permanent link"> </a></h2> <p>Отличается от JSON только тем, что строчки данных выводятся в массивах, а не в object-ах.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=err>//</span> <span class=err>JSONCompac</span><span class=kc>t</span>
<span class=p>{</span>
        <span class=nt>"meta"</span><span class=p>:</span>
        <span class=p>[</span>
                <span class=p>{</span>
                        <span class=nt>"name"</span><span class=p>:</span> <span class=s2>"'hello'"</span><span class=p>,</span>
                        <span class=nt>"type"</span><span class=p>:</span> <span class=s2>"String"</span>
                <span class=p>},</span>
                <span class=p>{</span>
                        <span class=nt>"name"</span><span class=p>:</span> <span class=s2>"multiply(42, number)"</span><span class=p>,</span>
                        <span class=nt>"type"</span><span class=p>:</span> <span class=s2>"UInt64"</span>
                <span class=p>},</span>
                <span class=p>{</span>
                        <span class=nt>"name"</span><span class=p>:</span> <span class=s2>"range(5)"</span><span class=p>,</span>
                        <span class=nt>"type"</span><span class=p>:</span> <span class=s2>"Array(UInt8)"</span>
                <span class=p>}</span>
        <span class=p>],</span>

        <span class=nt>"data"</span><span class=p>:</span>
        <span class=p>[</span>
                <span class=p>[</span><span class=s2>"hello"</span><span class=p>,</span> <span class=s2>"0"</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>]],</span>
                <span class=p>[</span><span class=s2>"hello"</span><span class=p>,</span> <span class=s2>"42"</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>]],</span>
                <span class=p>[</span><span class=s2>"hello"</span><span class=p>,</span> <span class=s2>"84"</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>]]</span>
        <span class=p>],</span>

        <span class=nt>"rows"</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span>

        <span class=nt>"rows_before_limit_at_least"</span><span class=p>:</span> <span class=mi>3</span>
<span class=p>}</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=err>//</span> <span class=err>JSONCompac</span><span class=kc>t</span><span class=err>S</span><span class=kc>tr</span><span class=err>i</span><span class=kc>n</span><span class=err>g</span>
<span class=p>{</span>
        <span class=nt>"meta"</span><span class=p>:</span>
        <span class=p>[</span>
                <span class=p>{</span>
                        <span class=nt>"name"</span><span class=p>:</span> <span class=s2>"'hello'"</span><span class=p>,</span>
                        <span class=nt>"type"</span><span class=p>:</span> <span class=s2>"String"</span>
                <span class=p>},</span>
                <span class=p>{</span>
                        <span class=nt>"name"</span><span class=p>:</span> <span class=s2>"multiply(42, number)"</span><span class=p>,</span>
                        <span class=nt>"type"</span><span class=p>:</span> <span class=s2>"UInt64"</span>
                <span class=p>},</span>
                <span class=p>{</span>
                        <span class=nt>"name"</span><span class=p>:</span> <span class=s2>"range(5)"</span><span class=p>,</span>
                        <span class=nt>"type"</span><span class=p>:</span> <span class=s2>"Array(UInt8)"</span>
                <span class=p>}</span>
        <span class=p>],</span>

        <span class=nt>"data"</span><span class=p>:</span>
        <span class=p>[</span>
                <span class=p>[</span><span class=s2>"hello"</span><span class=p>,</span> <span class=s2>"0"</span><span class=p>,</span> <span class=s2>"[0,1,2,3,4]"</span><span class=p>],</span>
                <span class=p>[</span><span class=s2>"hello"</span><span class=p>,</span> <span class=s2>"42"</span><span class=p>,</span> <span class=s2>"[0,1,2,3,4]"</span><span class=p>],</span>
                <span class=p>[</span><span class=s2>"hello"</span><span class=p>,</span> <span class=s2>"84"</span><span class=p>,</span> <span class=s2>"[0,1,2,3,4]"</span><span class=p>]</span>
        <span class=p>],</span>

        <span class=nt>"rows"</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span>

        <span class=nt>"rows_before_limit_at_least"</span><span class=p>:</span> <span class=mi>3</span>
<span class=p>}</span>
</code></pre></div> <h2 id=jsoneachrow>JSONEachRow<a class=headerlink href=../amp/#jsoneachrow title="Permanent link"> </a></h2> <h2 id=jsonstringeachrow>JSONStringEachRow<a class=headerlink href=../amp/#jsonstringeachrow title="Permanent link"> </a></h2> <h2 id=jsoncompacteachrow>JSONCompactEachRow<a class=headerlink href=../amp/#jsoncompacteachrow title="Permanent link"> </a></h2> <h2 id=jsoncompactstringeachrow>JSONCompactStringEachRow<a class=headerlink href=../amp/#jsoncompactstringeachrow title="Permanent link"> </a></h2> <p>При использовании этих форматов ClickHouse выводит каждую запись как значения JSON (каждое значение отдельной строкой), при этом данные в целом — невалидный JSON.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=p>{</span><span class=nt>"some_int"</span><span class=p>:</span><span class=mi>42</span><span class=p>,</span><span class=nt>"some_str"</span><span class=p>:</span><span class=s2>"hello"</span><span class=p>,</span><span class=nt>"some_tuple"</span><span class=p>:[</span><span class=mi>1</span><span class=p>,</span><span class=s2>"a"</span><span class=p>]}</span> <span class=err>//</span> <span class=err>JSONEachRow</span>
<span class=p>[</span><span class=mi>42</span><span class=p>,</span><span class=s2>"hello"</span><span class=p>,[</span><span class=mi>1</span><span class=p>,</span><span class=s2>"a"</span><span class=p>]]</span> <span class=err>//</span> <span class=err>JSONCompac</span><span class=kc>t</span><span class=err>EachRow</span>
<span class=p>[</span><span class=s2>"42"</span><span class=p>,</span><span class=s2>"hello"</span><span class=p>,</span><span class=s2>"(2,'a')"</span><span class=p>]</span> <span class=err>//</span> <span class=err>JSONCompac</span><span class=kc>t</span><span class=err>S</span><span class=kc>tr</span><span class=err>i</span><span class=kc>n</span><span class=err>gsEachRow</span>
</code></pre></div> <p>При вставке данных вы должны предоставить отдельное значение JSON для каждой строки.</p> <h2 id=jsoneachrowwithprogress>JSONEachRowWithProgress<a class=headerlink href=../amp/#jsoneachrowwithprogress title="Permanent link"> </a></h2> <h2 id=jsonstringeachrowwithprogress>JSONStringEachRowWithProgress<a class=headerlink href=../amp/#jsonstringeachrowwithprogress title="Permanent link"> </a></h2> <p>Отличается от <code class=syntax>JSONEachRow</code>/<code class=syntax>JSONStringEachRow</code> тем, что ClickHouse будет выдавать информацию о ходе выполнения в виде значений JSON.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=p>{</span><span class=nt>"row"</span><span class=p>:{</span><span class=nt>"'hello'"</span><span class=p>:</span><span class=s2>"hello"</span><span class=p>,</span><span class=nt>"multiply(42, number)"</span><span class=p>:</span><span class=s2>"0"</span><span class=p>,</span><span class=nt>"range(5)"</span><span class=p>:[</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>]}}</span>
<span class=p>{</span><span class=nt>"row"</span><span class=p>:{</span><span class=nt>"'hello'"</span><span class=p>:</span><span class=s2>"hello"</span><span class=p>,</span><span class=nt>"multiply(42, number)"</span><span class=p>:</span><span class=s2>"42"</span><span class=p>,</span><span class=nt>"range(5)"</span><span class=p>:[</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>]}}</span>
<span class=p>{</span><span class=nt>"row"</span><span class=p>:{</span><span class=nt>"'hello'"</span><span class=p>:</span><span class=s2>"hello"</span><span class=p>,</span><span class=nt>"multiply(42, number)"</span><span class=p>:</span><span class=s2>"84"</span><span class=p>,</span><span class=nt>"range(5)"</span><span class=p>:[</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>]}}</span>
<span class=p>{</span><span class=nt>"progress"</span><span class=p>:{</span><span class=nt>"read_rows"</span><span class=p>:</span><span class=s2>"3"</span><span class=p>,</span><span class=nt>"read_bytes"</span><span class=p>:</span><span class=s2>"24"</span><span class=p>,</span><span class=nt>"written_rows"</span><span class=p>:</span><span class=s2>"0"</span><span class=p>,</span><span class=nt>"written_bytes"</span><span class=p>:</span><span class=s2>"0"</span><span class=p>,</span><span class=nt>"total_rows_to_read"</span><span class=p>:</span><span class=s2>"3"</span><span class=p>}}</span>
</code></pre></div> <h2 id=jsoncompacteachrowwithnamesandtypes>JSONCompactEachRowWithNamesAndTypes<a class=headerlink href=../amp/#jsoncompacteachrowwithnamesandtypes title="Permanent link"> </a></h2> <h2 id=jsoncompactstringeachrowwithnamesandtypes>JSONCompactStringEachRowWithNamesAndTypes<a class=headerlink href=../amp/#jsoncompactstringeachrowwithnamesandtypes title="Permanent link"> </a></h2> <p>Отличается от <code class=syntax>JSONCompactEachRow</code>/<code class=syntax>JSONCompactStringEachRow</code> тем, что имена и типы столбцов записываются как первые две строки.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=p>[</span><span class=s2>"'hello'"</span><span class=p>,</span> <span class=s2>"multiply(42, number)"</span><span class=p>,</span> <span class=s2>"range(5)"</span><span class=p>]</span>
<span class=p>[</span><span class=s2>"String"</span><span class=p>,</span> <span class=s2>"UInt64"</span><span class=p>,</span> <span class=s2>"Array(UInt8)"</span><span class=p>]</span>
<span class=p>[</span><span class=s2>"hello"</span><span class=p>,</span> <span class=s2>"0"</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>]]</span>
<span class=p>[</span><span class=s2>"hello"</span><span class=p>,</span> <span class=s2>"42"</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>]]</span>
<span class=p>[</span><span class=s2>"hello"</span><span class=p>,</span> <span class=s2>"84"</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>]]</span>
</code></pre></div> <h3 id=vstavka-dannykh>Вставка данных<a class=headerlink href=../amp/#vstavka-dannykh title="Permanent link"> </a></h3> <div class=codehilite><pre><span></span><code class=syntax><span class=nv>INSERT</span> <span class=nv>INTO</span> <span class=nv>UserActivity</span> <span class=nv>FORMAT</span> <span class=nv>JSONEachRow</span> <span class=p>{</span><span class=s2>"PageViews"</span><span class="s s-Atom">:</span><span class=mi>5</span><span class=p>,</span> <span class=s2>"UserID"</span><span class="s s-Atom">:</span><span class=s2>"4324182021466249494"</span><span class=p>,</span> <span class=s2>"Duration"</span><span class="s s-Atom">:</span><span class=mi>146</span><span class=p>,</span><span class=s2>"Sign"</span><span class=p>:-</span><span class=mi>1</span><span class=p>}</span> <span class=p>{</span><span class=s2>"UserID"</span><span class="s s-Atom">:</span><span class=s2>"4324182021466249494"</span><span class=p>,</span><span class=s2>"PageViews"</span><span class="s s-Atom">:</span><span class=mi>6</span><span class=p>,</span><span class=s2>"Duration"</span><span class="s s-Atom">:</span><span class=mi>185</span><span class=p>,</span><span class=s2>"Sign"</span><span class="s s-Atom">:</span><span class=mi>1</span><span class=p>}</span>
</code></pre></div> <p>ClickHouse допускает:</p> <ul> <li>Любой порядок пар ключ-значение в объекте.</li> <li>Пропуск отдельных значений.</li> </ul> <p>ClickHouse игнорирует пробелы между элементами и запятые после объектов. Вы можете передать все объекты одной строкой. Вам не нужно разделять их переносами строк.</p> <p><strong>Обработка пропущенных значений</strong></p> <p>ClickHouse заменяет опущенные значения значениями по умолчанию для соответствующих <a href=../../../sql-reference/data-types/amp/ >data types</a>.</p> <p>Если указано <code class=syntax>DEFAULT expr</code>, то ClickHouse использует различные правила подстановки в зависимости от настройки <a href=../../../operations/settings/settings/amp/#session_settings-input_format_defaults_for_omitted_fields>input_format_defaults_for_omitted_fields</a>.</p> <p>Рассмотрим следующую таблицу:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=k>IF</span> <span class=k>NOT</span> <span class=k>EXISTS</span> <span class=n>example_table</span>
<span class=p>(</span>
    <span class=n>x</span> <span class=n>UInt32</span><span class=p>,</span>
    <span class=n>a</span> <span class=k>DEFAULT</span> <span class=n>x</span> <span class=o>*</span> <span class=mi>2</span>
<span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>Memory</span><span class=p>;</span>
</code></pre></div> <ul> <li>Если <code class=syntax>input_format_defaults_for_omitted_fields = 0</code>, то значение по умолчанию для <code class=syntax>x</code> и <code class=syntax>a</code> равняется <code class=syntax>0</code> (поскольку это значение по умолчанию для типа данных <code class=syntax>UInt32</code>.)</li> <li>Если <code class=syntax>input_format_defaults_for_omitted_fields = 1</code>, то значение по умолчанию для <code class=syntax>x</code> равно <code class=syntax>0</code>, а значение по умолчанию <code class=syntax>a</code> равно <code class=syntax>x * 2</code>.</li> </ul> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Предупреждение</p> <p>Если <code class=syntax>input_format_defaults_for_omitted_fields = 1</code>, то при обработке запросов ClickHouse потребляет больше вычислительных ресурсов, чем если <code class=syntax>input_format_defaults_for_omitted_fields = 0</code>.</p> </div> <h3 id=vyborka-dannykh>Выборка данных<a class=headerlink href=../amp/#vyborka-dannykh title="Permanent link"> </a></h3> <p>Рассмотрим в качестве примера таблицу <code class=syntax>UserActivity</code>:</p> <div class=codehilite><pre><span></span><code class=syntax>┌──────────────UserID─┬─PageViews─┬─Duration─┬─Sign─┐
│ 4324182021466249494 │         5 │      146 │   -1 │
│ 4324182021466249494 │         6 │      185 │    1 │
└─────────────────────┴───────────┴──────────┴──────┘
</code></pre></div> <p>Запрос <code class=syntax>SELECT * FROM UserActivity FORMAT JSONEachRow</code> возвращает:</p> <div class=codehilite><pre><span></span><code class=syntax>{"UserID":"4324182021466249494","PageViews":5,"Duration":146,"Sign":-1}
{"UserID":"4324182021466249494","PageViews":6,"Duration":185,"Sign":1}
</code></pre></div> <p>В отличие от формата <a href=../amp/#json>JSON</a>, для <code class=syntax>JSONEachRow</code> ClickHouse не заменяет невалидные UTF-8 последовательности. Значения экранируются так же, как и для формата <code class=syntax>JSON</code>.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Примечание</p> <p>В строках может выводиться произвольный набор байт. Используйте формат <code class=syntax>JSONEachRow</code>, если вы уверены, что данные в таблице могут быть представлены в формате JSON без потери информации.</p> </div> <h3 id=jsoneachrow-nested>Использование вложенных структур<a class=headerlink href=../amp/#jsoneachrow-nested title="Permanent link"> </a></h3> <p>Если у вас есть таблица со столбцами типа <a href=../../../sql-reference/data-types/nested-data-structures/nested/amp/ >Nested</a>, то в неё можно вставить данные из JSON-документа с такой же структурой. Функциональность включается настройкой <a href=../../../operations/settings/settings/amp/#settings-input_format_import_nested_json>input_format_import_nested_json</a>.</p> <p>Например, рассмотрим следующую таблицу:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>json_each_row_nested</span> <span class=p>(</span><span class=n>n</span> <span class=n>Nested</span> <span class=p>(</span><span class=n>s</span> <span class=n>String</span><span class=p>,</span> <span class=n>i</span> <span class=n>Int32</span><span class=p>)</span> <span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>Memory</span>
</code></pre></div> <p>Из описания типа данных <code class=syntax>Nested</code> видно, что ClickHouse трактует каждый компонент вложенной структуры как отдельный столбец (для нашей таблицы <code class=syntax>n.s</code> и <code class=syntax>n.i</code>). Можно вставить данные следующим образом:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>json_each_row_nested</span> <span class=n>FORMAT</span> <span class=n>JSONEachRow</span> <span class=err>{</span><span class=ss>"n.s"</span><span class=p>:</span> <span class=p>[</span><span class=ss>"abc"</span><span class=p>,</span> <span class=ss>"def"</span><span class=p>],</span> <span class=ss>"n.i"</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>23</span><span class=p>]</span><span class=err>}</span>
</code></pre></div> <p>Чтобы вставить данные как иерархический объект JSON, установите <a href=../../../operations/settings/settings/amp/#settings-input_format_import_nested_json>input_format_import_nested_json=1</a>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=p>{</span>
    <span class=nt>"n"</span><span class=p>:</span> <span class=p>{</span>
        <span class=nt>"s"</span><span class=p>:</span> <span class=p>[</span><span class=s2>"abc"</span><span class=p>,</span> <span class=s2>"def"</span><span class=p>],</span>
        <span class=nt>"i"</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>23</span><span class=p>]</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <p>Без этой настройки ClickHouse сгенерирует исключение.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>name</span><span class=p>,</span> <span class=n>value</span> <span class=k>FROM</span> <span class=k>system</span><span class=p>.</span><span class=n>settings</span> <span class=k>WHERE</span> <span class=n>name</span> <span class=o>=</span> <span class=s1>'input_format_import_nested_json'</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─name────────────────────────────┬─value─┐
│ input_format_import_nested_json │ 0     │
└─────────────────────────────────┴───────┘
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>json_each_row_nested</span> <span class=n>FORMAT</span> <span class=n>JSONEachRow</span> <span class=err>{</span><span class=ss>"n"</span><span class=p>:</span> <span class=err>{</span><span class=ss>"s"</span><span class=p>:</span> <span class=p>[</span><span class=ss>"abc"</span><span class=p>,</span> <span class=ss>"def"</span><span class=p>],</span> <span class=ss>"i"</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>23</span><span class=p>]</span><span class=err>}}</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>Code: 117. DB::Exception: Unknown field found while parsing JSONEachRow format: n: (at row 1)
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SET</span> <span class=n>input_format_import_nested_json</span><span class=o>=</span><span class=mi>1</span>
<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>json_each_row_nested</span> <span class=n>FORMAT</span> <span class=n>JSONEachRow</span> <span class=err>{</span><span class=ss>"n"</span><span class=p>:</span> <span class=err>{</span><span class=ss>"s"</span><span class=p>:</span> <span class=p>[</span><span class=ss>"abc"</span><span class=p>,</span> <span class=ss>"def"</span><span class=p>],</span> <span class=ss>"i"</span><span class=p>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>23</span><span class=p>]</span><span class=err>}}</span>
<span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>json_each_row_nested</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─n.s───────────┬─n.i────┐
│ ['abc','def'] │ [1,23] │
└───────────────┴────────┘
</code></pre></div> <h2 id=native>Native<a class=headerlink href=../amp/#native title="Permanent link"> </a></h2> <p>Самый эффективный формат. Данные пишутся и читаются блоками в бинарном виде. Для каждого блока пишется количество строк, количество столбцов, имена и типы столбцов, а затем кусочки столбцов этого блока, один за другим. То есть, этот формат является «столбцовым» - не преобразует столбцы в строки. Именно этот формат используется в родном интерфейсе - при межсерверном взаимодействии, при использовании клиента командной строки, при работе клиентов, написанных на C++.</p> <p>Вы можете использовать этот формат для быстрой генерации дампов, которые могут быть прочитаны только СУБД ClickHouse. Вряд ли имеет смысл работать с этим форматом самостоятельно.</p> <h2 id=null>Null<a class=headerlink href=../amp/#null title="Permanent link"> </a></h2> <p>Ничего не выводит. При этом, запрос обрабатывается, а при использовании клиента командной строки, данные ещё и передаются на клиент. Используется для тестов, в том числе, тестов производительности.<br> Очевидно, формат подходит только для вывода, но не для парсинга.</p> <h2 id=pretty>Pretty<a class=headerlink href=../amp/#pretty title="Permanent link"> </a></h2> <p>Выводит данные в виде Unicode-art табличек, также используя ANSI-escape последовательности для установки цветов в терминале.<br> Рисуется полная сетка таблицы и, таким образом, каждая строчка занимает две строки в терминале.<br> Каждый блок результата выводится в виде отдельной таблицы. Это нужно, чтобы можно было выводить блоки без буферизации результата (буферизация потребовалась бы, чтобы заранее вычислить видимую ширину всех значений.)</p> <p><a href=../../../sql-reference/syntax/amp/ >NULL</a> выводится как <code class=syntax>ᴺᵁᴸᴸ</code>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>t_null</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─x─┬────y─┐
│ 1 │ ᴺᵁᴸᴸ │
└───┴──────┘
</code></pre></div> <p>В форматах <code class=syntax>Pretty*</code> строки выводятся без экранирования. Ниже приведен пример для формата <a href=../amp/#prettycompact>PrettyCompact</a>:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=s1>'String with \'</span><span class=n>quotes</span><span class=err>\</span><span class=s1>' and \t character'</span> <span class=k>AS</span> <span class=n>Escaping_test</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─Escaping_test────────────────────────┐
│ String with 'quotes' and   character │
└──────────────────────────────────────┘
</code></pre></div> <p>Для защиты от вываливания слишком большого количества данных в терминал, выводится только первые 10 000 строк. Если строк больше или равно 10 000, то будет написано «Showed first 10 000.»<br> Этот формат подходит только для вывода результата выполнения запроса, но не для парсинга (приёма данных для вставки в таблицу).</p> <p>Формат <code class=syntax>Pretty</code> поддерживает вывод тотальных значений (при использовании WITH TOTALS) и экстремальных значений (при настройке extremes выставленной в 1). В этих случаях, после основных данных выводятся тотальные значения, и экстремальные значения, в отдельных табличках. Пример (показан для формата <a href=../amp/#prettycompact>PrettyCompact</a>):</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>EventDate</span><span class=p>,</span> <span class=k>count</span><span class=p>()</span> <span class=k>AS</span> <span class=k>c</span> <span class=k>FROM</span> <span class=n>test</span><span class=p>.</span><span class=n>hits</span> <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>EventDate</span> <span class=k>WITH</span> <span class=n>TOTALS</span> <span class=k>ORDER</span> <span class=k>BY</span> <span class=n>EventDate</span> <span class=n>FORMAT</span> <span class=n>PrettyCompact</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌──EventDate─┬───────c─┐
│ 2014-03-17 │ 1406958 │
│ 2014-03-18 │ 1383658 │
│ 2014-03-19 │ 1405797 │
│ 2014-03-20 │ 1353623 │
│ 2014-03-21 │ 1245779 │
│ 2014-03-22 │ 1031592 │
│ 2014-03-23 │ 1046491 │
└────────────┴─────────┘

Totals:
┌──EventDate─┬───────c─┐
│ 1970-01-01 │ 8873898 │
└────────────┴─────────┘

Extremes:
┌──EventDate─┬───────c─┐
│ 2014-03-17 │ 1031592 │
│ 2014-03-23 │ 1406958 │
└────────────┴─────────┘
</code></pre></div> <h2 id=prettycompact>PrettyCompact<a class=headerlink href=../amp/#prettycompact title="Permanent link"> </a></h2> <p>Отличается от <a href=../amp/#pretty>Pretty</a> тем, что не рисуется сетка между строками - результат более компактный.<br> Этот формат используется по умолчанию в клиенте командной строки в интерактивном режиме.</p> <h2 id=prettycompactmonoblock>PrettyCompactMonoBlock<a class=headerlink href=../amp/#prettycompactmonoblock title="Permanent link"> </a></h2> <p>Отличается от <a href=../amp/#prettycompact>PrettyCompact</a> тем, что строки (до 10 000 штук) буферизуются и затем выводятся в виде одной таблицы, а не по блокам.</p> <h2 id=prettynoescapes>PrettyNoEscapes<a class=headerlink href=../amp/#prettynoescapes title="Permanent link"> </a></h2> <p>Отличается от Pretty тем, что не используются ANSI-escape последовательности. Это нужно для отображения этого формата в браузере, а также при использовании утилиты командной строки watch.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax>$ watch -n1 <span class=s2>"clickhouse-client --query='SELECT event, value FROM system.events FORMAT PrettyCompactNoEscapes'"</span>
</code></pre></div> <p>Для отображения в браузере, вы можете использовать HTTP интерфейс.</p> <h3 id=prettycompactnoescapes>PrettyCompactNoEscapes<a class=headerlink href=../amp/#prettycompactnoescapes title="Permanent link"> </a></h3> <p>Аналогично.</p> <h3 id=prettyspacenoescapes>PrettySpaceNoEscapes<a class=headerlink href=../amp/#prettyspacenoescapes title="Permanent link"> </a></h3> <p>Аналогично.</p> <h2 id=prettyspace>PrettySpace<a class=headerlink href=../amp/#prettyspace title="Permanent link"> </a></h2> <p>Отличается от <a href=../amp/#prettycompact>PrettyCompact</a> тем, что вместо сетки используется пустое пространство (пробелы).</p> <h2 id=rowbinary>RowBinary<a class=headerlink href=../amp/#rowbinary title="Permanent link"> </a></h2> <p>Форматирует и парсит данные по строкам, в бинарном виде. Строки и значения уложены подряд, без разделителей.<br> Формат менее эффективен, чем формат Native, так как является строковым.</p> <p>Числа представлены в little endian формате фиксированной длины. Для примера, UInt64 занимает 8 байт.<br> DateTime представлены как UInt32, содержащий unix timestamp в качестве значения.<br> Date представлены как UInt16, содержащий количество дней, прошедших с 1970-01-01 в качестве значения.<br> String представлены как длина в формате varint (unsigned <a href=https://en.wikipedia.org/wiki/LEB128 rel="external nofollow noreferrer" target=_blank>LEB128</a>), а затем байты строки.<br> FixedString представлены просто как последовательность байт.</p> <p>Array представлены как длина в формате varint (unsigned <a href=https://en.wikipedia.org/wiki/LEB128 rel="external nofollow noreferrer" target=_blank>LEB128</a>), а затем элементы массива, подряд.</p> <p>Для поддержки <a href=../../../sql-reference/syntax/amp/#null-literal>NULL</a> перед каждым значением типа <a href=../../../sql-reference/data-types/nullable/amp/ >Nullable</a> следует байт содержащий 1 или 0. Если байт 1, то значение равно NULL, и этот байт интерпретируется как отдельное значение (т.е. после него следует значение следующего поля). Если байт 0, то после байта следует значение поля (не равно NULL).</p> <h2 id=rowbinarywithnamesandtypes>RowBinaryWithNamesAndTypes<a class=headerlink href=../amp/#rowbinarywithnamesandtypes title="Permanent link"> </a></h2> <p>То же самое что <a href=../amp/#rowbinary>RowBinary</a>, но добавляется заголовок:</p> <ul> <li>Количество колонок - N, закодированное <a href=https://en.wikipedia.org/wiki/LEB128 rel="external nofollow noreferrer" target=_blank>LEB128</a>,</li> <li>N строк (<code class=syntax>String</code>) с именами колонок,</li> <li>N строк (<code class=syntax>String</code>) с типами колонок.</li> </ul> <h2 id=data-format-values>Values<a class=headerlink href=../amp/#data-format-values title="Permanent link"> </a></h2> <p>Выводит каждую строку в скобках. Строки разделены запятыми. После последней строки запятой нет. Значения внутри скобок также разделены запятыми. Числа выводятся в десятичном виде без кавычек. Массивы выводятся в квадратных скобках. Строки, даты, даты-с-временем выводятся в кавычках. Правила экранирования и особенности парсинга аналогичны формату <a href=../amp/#tabseparated>TabSeparated</a>. При форматировании, лишние пробелы не ставятся, а при парсинге - допустимы и пропускаются (за исключением пробелов внутри значений типа массив, которые недопустимы). <a href=../../../sql-reference/syntax/amp/ >NULL</a> представляется как <code class=syntax>NULL</code>.</p> <p>Минимальный набор символов, которых вам необходимо экранировать при передаче в Values формате: одинарная кавычка и обратный слеш.</p> <p>Именно этот формат используется в запросе <code class=syntax>INSERT INTO t VALUES ...</code>, но вы также можете использовать его для форматирования результатов запросов.</p> <h2 id=vertical>Vertical<a class=headerlink href=../amp/#vertical title="Permanent link"> </a></h2> <p>Выводит каждое значение на отдельной строке, с указанием имени столбца. Формат удобно использовать для вывода одной-нескольких строк, если каждая строка состоит из большого количества столбцов.</p> <p><a href=../../../sql-reference/syntax/amp/ >NULL</a> выводится как <code class=syntax>ᴺᵁᴸᴸ</code>.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>t_null</span> <span class=n>FORMAT</span> <span class=n>Vertical</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>Row 1:
──────
x: 1
y: ᴺᵁᴸᴸ
</code></pre></div> <p>В формате <code class=syntax>Vertical</code> строки выводятся без экранирования. Например:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=s1>'string with \'</span><span class=n>quotes</span><span class=err>\</span><span class=s1>' and \t with some special \n characters'</span> <span class=k>AS</span> <span class=n>test</span> <span class=n>FORMAT</span> <span class=n>Vertical</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>Row 1:
──────
test: string with 'quotes' and   with some special
 characters
</code></pre></div> <p>Этот формат подходит только для вывода результата выполнения запроса, но не для парсинга (приёма данных для вставки в таблицу).</p> <h2 id=verticalraw>VerticalRaw<a class=headerlink href=../amp/#verticalraw title="Permanent link"> </a></h2> <p>Аналогичен <a href=../amp/#vertical>Vertical</a>, но с отключенным выходом. Этот формат подходит только для вывода результата выполнения запроса, но не для парсинга (приёма данных для вставки в таблицу).</p> <h2 id=xml>XML<a class=headerlink href=../amp/#xml title="Permanent link"> </a></h2> <p>Формат XML подходит только для вывода данных, не для парсинга. Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=cp>&lt;?xml version='1.0' encoding='UTF-8' ?&gt;</span>
<span class=nt>&lt;result&gt;</span>
        <span class=nt>&lt;meta&gt;</span>
                <span class=nt>&lt;columns&gt;</span>
                        <span class=nt>&lt;column&gt;</span>
                                <span class=nt>&lt;name&gt;</span>SearchPhrase<span class=nt>&lt;/name&gt;</span>
                                <span class=nt>&lt;type&gt;</span>String<span class=nt>&lt;/type&gt;</span>
                        <span class=nt>&lt;/column&gt;</span>
                        <span class=nt>&lt;column&gt;</span>
                                <span class=nt>&lt;name&gt;</span>count()<span class=nt>&lt;/name&gt;</span>
                                <span class=nt>&lt;type&gt;</span>UInt64<span class=nt>&lt;/type&gt;</span>
                        <span class=nt>&lt;/column&gt;</span>
                <span class=nt>&lt;/columns&gt;</span>
        <span class=nt>&lt;/meta&gt;</span>
        <span class=nt>&lt;data&gt;</span>
                <span class=nt>&lt;row&gt;</span>
                        <span class=nt>&lt;SearchPhrase&gt;&lt;/SearchPhrase&gt;</span>
                        <span class=nt>&lt;field&gt;</span>8267016<span class=nt>&lt;/field&gt;</span>
                <span class=nt>&lt;/row&gt;</span>
                <span class=nt>&lt;row&gt;</span>
                        <span class=nt>&lt;SearchPhrase&gt;</span>интерьер ванной комнаты<span class=nt>&lt;/SearchPhrase&gt;</span>
                        <span class=nt>&lt;field&gt;</span>2166<span class=nt>&lt;/field&gt;</span>
                <span class=nt>&lt;/row&gt;</span>
                <span class=nt>&lt;row&gt;</span>
                        <span class=nt>&lt;SearchPhrase&gt;</span>яндекс<span class=nt>&lt;/SearchPhrase&gt;</span>
                        <span class=nt>&lt;field&gt;</span>1655<span class=nt>&lt;/field&gt;</span>
                <span class=nt>&lt;/row&gt;</span>
                <span class=nt>&lt;row&gt;</span>
                        <span class=nt>&lt;SearchPhrase&gt;</span>весна 2014 мода<span class=nt>&lt;/SearchPhrase&gt;</span>
                        <span class=nt>&lt;field&gt;</span>1549<span class=nt>&lt;/field&gt;</span>
                <span class=nt>&lt;/row&gt;</span>
                <span class=nt>&lt;row&gt;</span>
                        <span class=nt>&lt;SearchPhrase&gt;</span>фриформ фото<span class=nt>&lt;/SearchPhrase&gt;</span>
                        <span class=nt>&lt;field&gt;</span>1480<span class=nt>&lt;/field&gt;</span>
                <span class=nt>&lt;/row&gt;</span>
                <span class=nt>&lt;row&gt;</span>
                        <span class=nt>&lt;SearchPhrase&gt;</span>анджелина джоли<span class=nt>&lt;/SearchPhrase&gt;</span>
                        <span class=nt>&lt;field&gt;</span>1245<span class=nt>&lt;/field&gt;</span>
                <span class=nt>&lt;/row&gt;</span>
                <span class=nt>&lt;row&gt;</span>
                        <span class=nt>&lt;SearchPhrase&gt;</span>омск<span class=nt>&lt;/SearchPhrase&gt;</span>
                        <span class=nt>&lt;field&gt;</span>1112<span class=nt>&lt;/field&gt;</span>
                <span class=nt>&lt;/row&gt;</span>
                <span class=nt>&lt;row&gt;</span>
                        <span class=nt>&lt;SearchPhrase&gt;</span>фото собак разных пород<span class=nt>&lt;/SearchPhrase&gt;</span>
                        <span class=nt>&lt;field&gt;</span>1091<span class=nt>&lt;/field&gt;</span>
                <span class=nt>&lt;/row&gt;</span>
                <span class=nt>&lt;row&gt;</span>
                        <span class=nt>&lt;SearchPhrase&gt;</span>дизайн штор<span class=nt>&lt;/SearchPhrase&gt;</span>
                        <span class=nt>&lt;field&gt;</span>1064<span class=nt>&lt;/field&gt;</span>
                <span class=nt>&lt;/row&gt;</span>
                <span class=nt>&lt;row&gt;</span>
                        <span class=nt>&lt;SearchPhrase&gt;</span>баку<span class=nt>&lt;/SearchPhrase&gt;</span>
                        <span class=nt>&lt;field&gt;</span>1000<span class=nt>&lt;/field&gt;</span>
                <span class=nt>&lt;/row&gt;</span>
        <span class=nt>&lt;/data&gt;</span>
        <span class=nt>&lt;rows&gt;</span>10<span class=nt>&lt;/rows&gt;</span>
        <span class=nt>&lt;rows_before_limit_at_least&gt;</span>141137<span class=nt>&lt;/rows_before_limit_at_least&gt;</span>
<span class=nt>&lt;/result&gt;</span>
</code></pre></div> <p>Если имя столбца не имеет некоторый допустимый вид, то в качестве имени элемента используется просто field. В остальном, структура XML повторяет структуру в формате JSON.<br> Как и для формата JSON, невалидные UTF-8 последовательности заменяются на replacement character � и, таким образом, выводимый текст будет состоять из валидных UTF-8 последовательностей.</p> <p>В строковых значениях, экранируются символы <code class=syntax>&lt;</code> и <code class=syntax>&amp;</code> как <code class=syntax>&amp;lt;</code> и <code class=syntax>&amp;amp;</code>.</p> <p>Массивы выводятся как <code class=syntax>&lt;array&gt;&lt;elem&gt;Hello&lt;/elem&gt;&lt;elem&gt;World&lt;/elem&gt;...&lt;/array&gt;</code>,<br> а кортежи как <code class=syntax>&lt;tuple&gt;&lt;elem&gt;Hello&lt;/elem&gt;&lt;elem&gt;World&lt;/elem&gt;...&lt;/tuple&gt;</code>.</p> <h2 id=capnproto>CapnProto<a class=headerlink href=../amp/#capnproto title="Permanent link"> </a></h2> <p>Cap’n Proto - формат бинарных сообщений, похож на Protocol Buffers и Thrift, но не похож на JSON или MessagePack.</p> <p>Сообщения Cap’n Proto строго типизированы и не самоописывающиеся, т.е. нуждаются во внешнем описании схемы. Схема применяется «на лету» и кешируется между запросами.</p> <div class=codehilite><pre><span></span><code class=syntax>$ cat capnproto_messages.bin <span class=p>|</span> clickhouse-client --query <span class=s2>"INSERT INTO test.hits FORMAT CapnProto SETTINGS format_schema='schema:Message'"</span>
</code></pre></div> <p>Где <code class=syntax>schema.capnp</code> выглядит следующим образом:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>struct</span> <span class=n>Message</span> {
  <span class=n>SearchPhrase</span> <span class=nd>@0</span> <span class=nc>:Text</span>;
  <span class=n>c</span> <span class=nd>@1</span> <span class=nc>:Uint64</span>;
}
</code></pre></div> <p>Десериализация эффективна и обычно не повышает нагрузку на систему.</p> <p>См. также <a href=../amp/#formatschema>схема формата</a>.</p> <h2 id=protobuf>Protobuf<a class=headerlink href=../amp/#protobuf title="Permanent link"> </a></h2> <p>Protobuf - формат <a href=https://developers.google.com/protocol-buffers/ rel="external nofollow noreferrer" target=_blank>Protocol Buffers</a>.</p> <p>Формат нуждается во внешнем описании схемы. Схема кэшируется между запросами.<br> ClickHouse поддерживает как синтаксис <code class=syntax>proto2</code>, так и <code class=syntax>proto3</code>; все типы полей (repeated/optional/required) поддерживаются.</p> <p>Пример использования формата:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>test</span><span class=p>.</span><span class=k>table</span> <span class=n>FORMAT</span> <span class=n>Protobuf</span> <span class=n>SETTINGS</span> <span class=n>format_schema</span> <span class=o>=</span> <span class=s1>'schemafile:MessageType'</span>
</code></pre></div> <p>или</p> <div class=codehilite><pre><span></span><code class=syntax>$ cat protobuf_messages.bin <span class=p>|</span> clickhouse-client --query <span class=s2>"INSERT INTO test.table FORMAT Protobuf SETTINGS format_schema='schemafile:MessageType'"</span>
</code></pre></div> <p>Где файл <code class=syntax>schemafile.proto</code> может выглядеть так:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>syntax</span> <span class=l>= "proto3"</span>;

<span class=n>message</span> <span class=n>MessageType</span> {
  <span class=n>string</span> <span class=n>name</span> <span class=l>= 1</span>;
  <span class=n>string</span> <span class=n>surname</span> <span class=l>= 2</span>;
  <span class=n>uint32</span> <span class=n>birthDate</span> <span class=l>= 3</span>;
  <span class=n>repeated</span> <span class=n>string</span> <span class=n>phoneNumbers</span> <span class=l>= 4</span>;
};
</code></pre></div> <p>Соответствие между столбцами таблицы и полями сообщения <code class=syntax>Protocol Buffers</code> устанавливается по имени,<br> при этом игнорируется регистр букв и символы <code class=syntax>_</code> (подчеркивание) и <code class=syntax>.</code> (точка) считаются одинаковыми.<br> Если типы столбцов не соответствуют точно типам полей сообщения <code class=syntax>Protocol Buffers</code>, производится необходимая конвертация.</p> <p>Вложенные сообщения поддерживаются, например, для поля <code class=syntax>z</code> в таком сообщении</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>message</span> <span class=n>MessageType</span> {
  <span class=n>message</span> <span class=n>XType</span> {
    <span class=n>message</span> <span class=n>YType</span> {
      <span class=n>int32</span> <span class=n>z</span>;
    };
    <span class=n>repeated</span> <span class=n>YType</span> <span class=n>y</span>;
  };
  <span class=n>XType</span> <span class=n>x</span>;
};
</code></pre></div> <p>ClickHouse попытается найти столбец с именем <code class=syntax>x.y.z</code> (или <code class=syntax>x_y_z</code>, или <code class=syntax>X.y_Z</code> и т.п.).<br> Вложенные сообщения удобно использовать в качестве соответствия для <a href=../../../sql-reference/data-types/nested-data-structures/nested/amp/ >вложенной структуры данных</a>.</p> <p>Значения по умолчанию, определённые в схеме <code class=syntax>proto2</code>, например,</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>syntax</span> <span class=l>= "proto2"</span>;

<span class=n>message</span> <span class=n>MessageType</span> {
  <span class=n>optional</span> <span class=n>int32</span> <span class=n>result_per_page</span> <span class=l>= 3 [default = 10]</span>;
}
</code></pre></div> <p>не применяются; вместо них используются определенные в таблице <a href=../../../sql-reference/statements/create/table/amp/#create-default-values>значения по умолчанию</a>.</p> <p>ClickHouse пишет и читает сообщения <code class=syntax>Protocol Buffers</code> в формате <code class=syntax>length-delimited</code>. Это означает, что перед каждым сообщением пишется его длина<br> в формате <a href=https://developers.google.com/protocol-buffers/docs/encoding#varints rel="external nofollow noreferrer" target=_blank>varint</a>. См. также <a href=https://cwiki.apache.org/confluence/display/GEODE/Delimiting+Protobuf+Messages rel="external nofollow noreferrer" target=_blank>как читать и записывать сообщения Protocol Buffers в формате length-delimited в различных языках программирования</a>.</p> <h2 id=protobufsingle>ProtobufSingle<a class=headerlink href=../amp/#protobufsingle title="Permanent link"> </a></h2> <p>То же, что <a href=../amp/#protobuf>Protobuf</a>, но без разделителей. Позволяет записать / прочитать не более одного сообщения за раз.</p> <h2 id=data-format-avro>Avro<a class=headerlink href=../amp/#data-format-avro title="Permanent link"> </a></h2> <p><a href=https://avro.apache.org/ rel="external nofollow noreferrer" target=_blank>Apache Avro</a> — это ориентированный на строки фреймворк для сериализации данных. Разработан в рамках проекта Apache Hadoop.</p> <p>В ClickHouse формат Avro поддерживает чтение и запись <a href=https://avro.apache.org/docs/current/spec.html#Object+Container+Files rel="external nofollow noreferrer" target=_blank>файлов данных Avro</a>.</p> <p><a href=https://avro.apache.org/docs/current/spec.html#Logical+Types rel="external nofollow noreferrer" target=_blank>Логические типы Avro</a></p> <h2 id=data-format-avro-confluent>AvroConfluent<a class=headerlink href=../amp/#data-format-avro-confluent title="Permanent link"> </a></h2> <p>Для формата <code class=syntax>AvroConfluent</code> ClickHouse поддерживает декодирование сообщений <code class=syntax>Avro</code> с одним объектом. Такие сообщения используются с [Kafka] (<a href=http://kafka.apache.org/ target=_blank>http://kafka.apache.org/</a>) и реестром схем <a href=https://docs.confluent.io/current/schema-registry/index.html rel="external nofollow noreferrer" target=_blank>Confluent</a>.</p> <p>Каждое сообщение <code class=syntax>Avro</code> содержит идентификатор схемы, который может быть разрешен для фактической схемы с помощью реестра схем.</p> <p>Схемы кэшируются после разрешения.</p> <p>URL-адрес реестра схем настраивается с помощью <a href=../../../operations/settings/settings/amp/#format_avro_schema_registry_url>format_avro_schema_registry_url</a>.</p> <h3 id=sootvetstvie-tipov-dannykh-0>Соответствие типов данных<a class=headerlink href=../amp/#sootvetstvie-tipov-dannykh-0 title="Permanent link"> </a></h3> <p>Такое же, как в <a href=../amp/#data-format-avro>Avro</a>.</p> <h3 id=ispolzovanie>Использование<a class=headerlink href=../amp/#ispolzovanie title="Permanent link"> </a></h3> <p>Чтобы быстро проверить разрешение схемы, используйте <a href=https://github.com/edenhill/kafkacat rel="external nofollow noreferrer" target=_blank>kafkacat</a> с языком запросов <a href=../../../operations/utilities/clickhouse-local/amp/ >clickhouse-local</a>:</p> <div class=codehilite><pre><span></span><code class=syntax>$ kafkacat -b kafka-broker  -C -t topic1 -o beginning -f <span class=s1>'%s'</span> -c <span class=m>3</span> <span class=p>|</span> clickhouse-local   --input-format AvroConfluent --format_avro_schema_registry_url <span class=s1>'http://schema-registry'</span> -S <span class=s2>"field1 Int64, field2 String"</span>  -q <span class=s1>'select *  from table'</span>
<span class=m>1</span> a
<span class=m>2</span> b
<span class=m>3</span> c
</code></pre></div> <p>Чтобы использовать <code class=syntax>AvroConfluent</code> с <a href=../../../engines/table-engines/integrations/kafka/amp/ >Kafka</a>:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>topic1_stream</span>
<span class=p>(</span>
    <span class=n>field1</span> <span class=n>String</span><span class=p>,</span>
    <span class=n>field2</span> <span class=n>String</span>
<span class=p>)</span>
<span class=n>ENGINE</span> <span class=o>=</span> <span class=n>Kafka</span><span class=p>()</span>
<span class=n>SETTINGS</span>
<span class=n>kafka_broker_list</span> <span class=o>=</span> <span class=s1>'kafka-broker'</span><span class=p>,</span>
<span class=n>kafka_topic_list</span> <span class=o>=</span> <span class=s1>'topic1'</span><span class=p>,</span>
<span class=n>kafka_group_name</span> <span class=o>=</span> <span class=s1>'group1'</span><span class=p>,</span>
<span class=n>kafka_format</span> <span class=o>=</span> <span class=s1>'AvroConfluent'</span><span class=p>;</span>

<span class=k>SET</span> <span class=n>format_avro_schema_registry_url</span> <span class=o>=</span> <span class=s1>'http://schema-registry'</span><span class=p>;</span>

<span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>topic1_stream</span><span class=p>;</span>
</code></pre></div> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Внимание</p> <p><code class=syntax>format_avro_schema_registry_url</code> необходимо настроить в <code class=syntax>users.xml</code>, чтобы сохранить значение после перезапуска. Также можно использовать настройку <code class=syntax>format_avro_schema_registry_url</code> табличного движка <code class=syntax>Kafka</code>.</p> </div> <h2 id=data-format-parquet>Parquet<a class=headerlink href=../amp/#data-format-parquet title="Permanent link"> </a></h2> <p><a href=https://parquet.apache.org/ rel="external nofollow noreferrer" target=_blank>Apache Parquet</a> — формат поколоночного хранения данных, который распространён в экосистеме Hadoop. Для формата <code class=syntax>Parquet</code> ClickHouse поддерживает операции чтения и записи.</p> <h3 id=sootvetstvie-tipov-dannykh>Соответствие типов данных<a class=headerlink href=../amp/#sootvetstvie-tipov-dannykh title="Permanent link"> </a></h3> <p>Таблица ниже содержит поддерживаемые типы данных и их соответствие <a href=../../../sql-reference/data-types/amp/ >типам данных</a> ClickHouse для запросов <code class=syntax>INSERT</code> и <code class=syntax>SELECT</code>.</p> <table> <thead> <tr> <th>Тип данных Parquet (<code class=syntax>INSERT</code>)</th> <th>Тип данных ClickHouse</th> <th>Тип данных Parquet (<code class=syntax>SELECT</code>)</th> </tr> </thead> <tbody> <tr> <td><code class=syntax>UINT8</code>, <code class=syntax>BOOL</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >UInt8</a></td> <td><code class=syntax>UINT8</code></td> </tr> <tr> <td><code class=syntax>INT8</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >Int8</a></td> <td><code class=syntax>INT8</code></td> </tr> <tr> <td><code class=syntax>UINT16</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >UInt16</a></td> <td><code class=syntax>UINT16</code></td> </tr> <tr> <td><code class=syntax>INT16</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >Int16</a></td> <td><code class=syntax>INT16</code></td> </tr> <tr> <td><code class=syntax>UINT32</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >UInt32</a></td> <td><code class=syntax>UINT32</code></td> </tr> <tr> <td><code class=syntax>INT32</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >Int32</a></td> <td><code class=syntax>INT32</code></td> </tr> <tr> <td><code class=syntax>UINT64</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >UInt64</a></td> <td><code class=syntax>UINT64</code></td> </tr> <tr> <td><code class=syntax>INT64</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >Int64</a></td> <td><code class=syntax>INT64</code></td> </tr> <tr> <td><code class=syntax>FLOAT</code>, <code class=syntax>HALF_FLOAT</code></td> <td><a href=../../../sql-reference/data-types/float/amp/ >Float32</a></td> <td><code class=syntax>FLOAT</code></td> </tr> <tr> <td><code class=syntax>DOUBLE</code></td> <td><a href=../../../sql-reference/data-types/float/amp/ >Float64</a></td> <td><code class=syntax>DOUBLE</code></td> </tr> <tr> <td><code class=syntax>DATE32</code></td> <td><a href=../../../sql-reference/data-types/date/amp/ >Date</a></td> <td><code class=syntax>UINT16</code></td> </tr> <tr> <td><code class=syntax>DATE64</code>, <code class=syntax>TIMESTAMP</code></td> <td><a href=../../../sql-reference/data-types/datetime/amp/ >DateTime</a></td> <td><code class=syntax>UINT32</code></td> </tr> <tr> <td><code class=syntax>STRING</code>, <code class=syntax>BINARY</code></td> <td><a href=../../../sql-reference/data-types/string/amp/ >String</a></td> <td><code class=syntax>STRING</code></td> </tr> <tr> <td>—</td> <td><a href=../../../sql-reference/data-types/fixedstring/amp/ >FixedString</a></td> <td><code class=syntax>STRING</code></td> </tr> <tr> <td><code class=syntax>DECIMAL</code></td> <td><a href=../../../sql-reference/data-types/decimal/amp/ >Decimal</a></td> <td><code class=syntax>DECIMAL</code></td> </tr> <tr> <td><code class=syntax>LIST</code></td> <td><a href=../../../sql-reference/data-types/array/amp/ >Array</a></td> <td><code class=syntax>LIST</code></td> </tr> </tbody> </table> <p>Массивы могут быть вложенными и иметь в качестве аргумента значение типа <code class=syntax>Nullable</code>.</p> <p>ClickHouse поддерживает настраиваемую точность для формата <code class=syntax>Decimal</code>. При выполнении запроса <code class=syntax>INSERT</code> ClickHouse обрабатывает тип данных Parquet <code class=syntax>DECIMAL</code> как <code class=syntax>Decimal128</code>.</p> <p>Неподдерживаемые типы данных Parquet: <code class=syntax>TIME32</code>, <code class=syntax>FIXED_SIZE_BINARY</code>, <code class=syntax>JSON</code>, <code class=syntax>UUID</code>, <code class=syntax>ENUM</code>.</p> <p>Типы данных столбцов в ClickHouse могут отличаться от типов данных соответствующих полей файла в формате Parquet. При вставке данных ClickHouse интерпретирует типы данных в соответствии с таблицей выше, а затем <a href=../../sql-reference/functions/type-conversion-functions/amp/#type_conversion_function-cast>приводит</a> данные к тому типу, который установлен для столбца таблицы.</p> <h3 id=vstavka-i-vyborka-dannykh>Вставка и выборка данных<a class=headerlink href=../amp/#vstavka-i-vyborka-dannykh title="Permanent link"> </a></h3> <p>Чтобы вставить в ClickHouse данные из файла в формате Parquet, выполните команду следующего вида:</p> <div class=codehilite><pre><span></span><code class=syntax>$ cat <span class=o>{</span>filename<span class=o>}</span> <span class=p>|</span> clickhouse-client --query<span class=o>=</span><span class=s2>"INSERT INTO {some_table} FORMAT Parquet"</span>
</code></pre></div> <p>Чтобы получить данные из таблицы ClickHouse и сохранить их в файл формата Parquet, используйте команду следующего вида:</p> <div class=codehilite><pre><span></span><code class=syntax>$ clickhouse-client --query<span class=o>=</span><span class=s2>"SELECT * FROM {some_table} FORMAT Parquet"</span> &gt; <span class=o>{</span>some_file.pq<span class=o>}</span>
</code></pre></div> <p>Для обмена данными с экосистемой Hadoop можно использовать движки таблиц <a href=../../../engines/table-engines/integrations/hdfs/amp/ >HDFS</a>.</p> <h2 id=data-format-arrow>Arrow<a class=headerlink href=../amp/#data-format-arrow title="Permanent link"> </a></h2> <p><a href=https://arrow.apache.org/ rel="external nofollow noreferrer" target=_blank>Apache Arrow</a> поставляется с двумя встроенными поколоночнами форматами хранения. ClickHouse поддерживает операции чтения и записи для этих форматов.</p> <p><code class=syntax>Arrow</code> — это Apache Arrow's "file mode" формат. Он предназначен для произвольного доступа в памяти.</p> <h3 id=data_types-matching-arrow>Соответствие типов данных<a class=headerlink href=../amp/#data_types-matching-arrow title="Permanent link"> </a></h3> <p>Таблица ниже содержит поддерживаемые типы данных и их соответствие <a href=../../../sql-reference/data-types/amp/ >типам данных</a> ClickHouse для запросов <code class=syntax>INSERT</code> и <code class=syntax>SELECT</code>.</p> <table> <thead> <tr> <th>Тип данных Arrow (<code class=syntax>INSERT</code>)</th> <th>Тип данных ClickHouse</th> <th>Тип данных Arrow (<code class=syntax>SELECT</code>)</th> </tr> </thead> <tbody> <tr> <td><code class=syntax>UINT8</code>, <code class=syntax>BOOL</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >UInt8</a></td> <td><code class=syntax>UINT8</code></td> </tr> <tr> <td><code class=syntax>INT8</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >Int8</a></td> <td><code class=syntax>INT8</code></td> </tr> <tr> <td><code class=syntax>UINT16</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >UInt16</a></td> <td><code class=syntax>UINT16</code></td> </tr> <tr> <td><code class=syntax>INT16</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >Int16</a></td> <td><code class=syntax>INT16</code></td> </tr> <tr> <td><code class=syntax>UINT32</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >UInt32</a></td> <td><code class=syntax>UINT32</code></td> </tr> <tr> <td><code class=syntax>INT32</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >Int32</a></td> <td><code class=syntax>INT32</code></td> </tr> <tr> <td><code class=syntax>UINT64</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >UInt64</a></td> <td><code class=syntax>UINT64</code></td> </tr> <tr> <td><code class=syntax>INT64</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >Int64</a></td> <td><code class=syntax>INT64</code></td> </tr> <tr> <td><code class=syntax>FLOAT</code>, <code class=syntax>HALF_FLOAT</code></td> <td><a href=../../../sql-reference/data-types/float/amp/ >Float32</a></td> <td><code class=syntax>FLOAT32</code></td> </tr> <tr> <td><code class=syntax>DOUBLE</code></td> <td><a href=../../../sql-reference/data-types/float/amp/ >Float64</a></td> <td><code class=syntax>FLOAT64</code></td> </tr> <tr> <td><code class=syntax>DATE32</code></td> <td><a href=../../../sql-reference/data-types/date/amp/ >Date</a></td> <td><code class=syntax>UINT16</code></td> </tr> <tr> <td><code class=syntax>DATE64</code>, <code class=syntax>TIMESTAMP</code></td> <td><a href=../../../sql-reference/data-types/datetime/amp/ >DateTime</a></td> <td><code class=syntax>UINT32</code></td> </tr> <tr> <td><code class=syntax>STRING</code>, <code class=syntax>BINARY</code></td> <td><a href=../../../sql-reference/data-types/string/amp/ >String</a></td> <td><code class=syntax>UTF8</code></td> </tr> <tr> <td><code class=syntax>STRING</code>, <code class=syntax>BINARY</code></td> <td><a href=../../../sql-reference/data-types/fixedstring/amp/ >FixedString</a></td> <td><code class=syntax>UTF8</code></td> </tr> <tr> <td><code class=syntax>DECIMAL</code></td> <td><a href=../../../sql-reference/data-types/decimal/amp/ >Decimal</a></td> <td><code class=syntax>DECIMAL</code></td> </tr> <tr> <td><code class=syntax>LIST</code></td> <td><a href=../../../sql-reference/data-types/array/amp/ >Array</a></td> <td><code class=syntax>LIST</code></td> </tr> </tbody> </table> <p>Массивы могут быть вложенными и иметь в качестве аргумента значение типа <code class=syntax>Nullable</code>.</p> <p>ClickHouse поддерживает настраиваемую точность для формата <code class=syntax>Decimal</code>. При выполнении запроса <code class=syntax>INSERT</code> ClickHouse обрабатывает тип данных Arrow <code class=syntax>DECIMAL</code> как <code class=syntax>Decimal128</code>.</p> <p>Неподдерживаемые типы данных Arrow: <code class=syntax>TIME32</code>, <code class=syntax>FIXED_SIZE_BINARY</code>, <code class=syntax>JSON</code>, <code class=syntax>UUID</code>, <code class=syntax>ENUM</code>.</p> <p>Типы данных столбцов в ClickHouse могут отличаться от типов данных соответствующих полей файла в формате Arrow. При вставке данных ClickHouse интерпретирует типы данных в соответствии с таблицей выше, а затем <a href=../../sql-reference/functions/type-conversion-functions/amp/#type_conversion_function-cast>приводит</a> данные к тому типу, который установлен для столбца таблицы.</p> <h3 id=inserting-data-arrow>Вставка данных<a class=headerlink href=../amp/#inserting-data-arrow title="Permanent link"> </a></h3> <p>Чтобы вставить в ClickHouse данные из файла в формате Arrow, используйте команду следующего вида:</p> <div class=codehilite><pre><span></span><code class=syntax>$ cat filename.arrow <span class=p>|</span> clickhouse-client --query<span class=o>=</span><span class=s2>"INSERT INTO some_table FORMAT Arrow"</span>
</code></pre></div> <h3 id=selecting-data-arrow>Вывод данных<a class=headerlink href=../amp/#selecting-data-arrow title="Permanent link"> </a></h3> <p>Чтобы получить данные из таблицы ClickHouse и сохранить их в файл формата Arrow, используйте команду следующего вида:</p> <div class=codehilite><pre><span></span><code class=syntax>$ clickhouse-client --query<span class=o>=</span><span class=s2>"SELECT * FROM {some_table} FORMAT Arrow"</span> &gt; <span class=o>{</span>filename.arrow<span class=o>}</span>
</code></pre></div> <h2 id=data-format-arrow-stream>ArrowStream<a class=headerlink href=../amp/#data-format-arrow-stream title="Permanent link"> </a></h2> <p><code class=syntax>ArrowStream</code> — это Apache Arrow's "stream mode" формат. Он предназначен для обработки потоков в памяти.</p> <h2 id=data-format-orc>ORC<a class=headerlink href=../amp/#data-format-orc title="Permanent link"> </a></h2> <p><a href=https://orc.apache.org/ rel="external nofollow noreferrer" target=_blank>Apache ORC</a> — это столбцовый формат данных, распространенный в экосистеме <a href=https://hadoop.apache.org/ rel="external nofollow noreferrer" target=_blank>Hadoop</a>.</p> <h3 id=sootvetstvie-tipov-dannykh-1>Соответствие типов данных<a class=headerlink href=../amp/#sootvetstvie-tipov-dannykh-1 title="Permanent link"> </a></h3> <p>Таблица ниже содержит поддерживаемые типы данных и их соответствие <a href=../../../sql-reference/data-types/amp/ >типам данных</a> ClickHouse для запросов <code class=syntax>INSERT</code> и <code class=syntax>SELECT</code>.</p> <table> <thead> <tr> <th>Тип данных ORC (<code class=syntax>INSERT</code>)</th> <th>Тип данных ClickHouse</th> <th>Тип данных ORC (<code class=syntax>SELECT</code>)</th> </tr> </thead> <tbody> <tr> <td><code class=syntax>UINT8</code>, <code class=syntax>BOOL</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >UInt8</a></td> <td><code class=syntax>UINT8</code></td> </tr> <tr> <td><code class=syntax>INT8</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >Int8</a></td> <td><code class=syntax>INT8</code></td> </tr> <tr> <td><code class=syntax>UINT16</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >UInt16</a></td> <td><code class=syntax>UINT16</code></td> </tr> <tr> <td><code class=syntax>INT16</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >Int16</a></td> <td><code class=syntax>INT16</code></td> </tr> <tr> <td><code class=syntax>UINT32</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >UInt32</a></td> <td><code class=syntax>UINT32</code></td> </tr> <tr> <td><code class=syntax>INT32</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >Int32</a></td> <td><code class=syntax>INT32</code></td> </tr> <tr> <td><code class=syntax>UINT64</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >UInt64</a></td> <td><code class=syntax>UINT64</code></td> </tr> <tr> <td><code class=syntax>INT64</code></td> <td><a href=../../../sql-reference/data-types/int-uint/amp/ >Int64</a></td> <td><code class=syntax>INT64</code></td> </tr> <tr> <td><code class=syntax>FLOAT</code>, <code class=syntax>HALF_FLOAT</code></td> <td><a href=../../../sql-reference/data-types/float/amp/ >Float32</a></td> <td><code class=syntax>FLOAT</code></td> </tr> <tr> <td><code class=syntax>DOUBLE</code></td> <td><a href=../../../sql-reference/data-types/float/amp/ >Float64</a></td> <td><code class=syntax>DOUBLE</code></td> </tr> <tr> <td><code class=syntax>DATE32</code></td> <td><a href=../../../sql-reference/data-types/date/amp/ >Date</a></td> <td><code class=syntax>DATE32</code></td> </tr> <tr> <td><code class=syntax>DATE64</code>, <code class=syntax>TIMESTAMP</code></td> <td><a href=../../../sql-reference/data-types/datetime/amp/ >DateTime</a></td> <td><code class=syntax>TIMESTAMP</code></td> </tr> <tr> <td><code class=syntax>STRING</code>, <code class=syntax>BINARY</code></td> <td><a href=../../../sql-reference/data-types/string/amp/ >String</a></td> <td><code class=syntax>BINARY</code></td> </tr> <tr> <td><code class=syntax>DECIMAL</code></td> <td><a href=../../../sql-reference/data-types/decimal/amp/ >Decimal</a></td> <td><code class=syntax>DECIMAL</code></td> </tr> <tr> <td><code class=syntax>LIST</code></td> <td><a href=../../../sql-reference/data-types/array/amp/ >Array</a></td> <td><code class=syntax>LIST</code></td> </tr> </tbody> </table> <p>Массивы могут быть вложенными и иметь в качестве аргумента значение типа <code class=syntax>Nullable</code>.</p> <p>ClickHouse поддерживает настраиваемую точность для формата <code class=syntax>Decimal</code>. При выполнении запроса <code class=syntax>INSERT</code> ClickHouse обрабатывает тип данных ORC <code class=syntax>DECIMAL</code> как <code class=syntax>Decimal128</code>.</p> <p>Неподдерживаемые типы данных ORC: <code class=syntax>TIME32</code>, <code class=syntax>FIXED_SIZE_BINARY</code>, <code class=syntax>JSON</code>, <code class=syntax>UUID</code>, <code class=syntax>ENUM</code>.</p> <p>Типы данных столбцов в таблицах ClickHouse могут отличаться от типов данных для соответствующих полей ORC. При вставке данных ClickHouse интерпретирует типы данных ORC согласно таблице соответствия, а затем <a href=../../sql-reference/functions/type-conversion-functions/amp/#type_conversion_function-cast>приводит</a> данные к типу, установленному для столбца таблицы ClickHouse.</p> <h3 id=vstavka-dannykh-1>Вставка данных<a class=headerlink href=../amp/#vstavka-dannykh-1 title="Permanent link"> </a></h3> <p>Чтобы вставить в ClickHouse данные из файла в формате ORC, используйте команду следующего вида:</p> <div class=codehilite><pre><span></span><code class=syntax>$ cat filename.orc <span class=p>|</span> clickhouse-client --query<span class=o>=</span><span class=s2>"INSERT INTO some_table FORMAT ORC"</span>
</code></pre></div> <h3 id=vyvod-dannykh-1>Вывод данных<a class=headerlink href=../amp/#vyvod-dannykh-1 title="Permanent link"> </a></h3> <p>Чтобы получить данные из таблицы ClickHouse и сохранить их в файл формата ORC, используйте команду следующего вида:</p> <div class=codehilite><pre><span></span><code class=syntax>$ clickhouse-client --query<span class=o>=</span><span class=s2>"SELECT * FROM {some_table} FORMAT ORC"</span> &gt; <span class=o>{</span>filename.orc<span class=o>}</span>
</code></pre></div> <p>Для обмена данных с экосистемой Hadoop вы можете использовать <a href=../../../engines/table-engines/integrations/hdfs/amp/ >движок таблиц HDFS</a>.</p> <h2 id=lineasstring>LineAsString<a class=headerlink href=../amp/#lineasstring title="Permanent link"> </a></h2> <p>В этом формате каждая строка импортируемых данных интерпретируется как одно строковое значение. Парситься может только таблица с единственным полем типа <a href=../../../sql-reference/data-types/string/amp/ >String</a>. Остальные столбцы должны быть заданы как <a href=../../../sql-reference/statements/create/table/amp/#create-default-values>DEFAULT</a> или <a href=../../../sql-reference/statements/create/table/amp/#create-default-values>MATERIALIZED</a>, либо отсутствовать.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>DROP</span> <span class=k>TABLE</span> <span class=k>IF</span> <span class=k>EXISTS</span> <span class=n>line_as_string</span><span class=p>;</span>
<span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>line_as_string</span> <span class=p>(</span><span class=n>field</span> <span class=n>String</span><span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>Memory</span><span class=p>;</span>
<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>line_as_string</span> <span class=n>FORMAT</span> <span class=n>LineAsString</span> <span class=ss>"I love apple"</span><span class=p>,</span> <span class=ss>"I love banana"</span><span class=p>,</span> <span class=ss>"I love orange"</span><span class=p>;</span>
<span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>line_as_string</span><span class=p>;</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─field─────────────────────────────────────────────┐
│ "I love apple", "I love banana", "I love orange"; │
└───────────────────────────────────────────────────┘
</code></pre></div> <h2 id=data-format-regexp>Regexp<a class=headerlink href=../amp/#data-format-regexp title="Permanent link"> </a></h2> <p>Каждая строка импортируемых данных разбирается в соответствии с регулярным выражением.</p> <p>При работе с форматом <code class=syntax>Regexp</code> можно использовать следующие параметры:</p> <ul> <li><code class=syntax>format_regexp</code> — <a href=../../../sql-reference/data-types/string/amp/ >String</a>. Строка с регулярным выражением в формате <a href=https://github.com/google/re2/wiki/Syntax rel="external nofollow noreferrer" target=_blank>re2</a>.</li> <li><code class=syntax>format_regexp_escaping_rule</code> — <a href=../../../sql-reference/data-types/string/amp/ >String</a>. Правило сериализации. Поддерживаются следующие правила:<ul> <li>CSV (как в <a href=../amp/#csv>CSV</a>)</li> <li>JSON (как в <a href=../amp/#jsoneachrow>JSONEachRow</a>)</li> <li>Escaped (как в <a href=../amp/#tabseparated>TSV</a>)</li> <li>Quoted (как в <a href=../amp/#data-format-values>Values</a>)</li> <li>Raw (данные импортируются как есть, без сериализации)</li> </ul> </li> <li><code class=syntax>format_regexp_skip_unmatched</code> — <a href=../../../sql-reference/data-types/int-uint/amp/ >UInt8</a>. Признак, будет ли генерироваться исключение в случае, если импортируемые данные не соответствуют регулярному выражению <code class=syntax>format_regexp</code>. Может принимать значение <code class=syntax>0</code> или <code class=syntax>1</code>.</li> </ul> <p><strong>Использование</strong></p> <p>Регулярное выражение (шаблон) из параметра <code class=syntax>format_regexp</code> применяется к каждой строке импортируемых данных. Количество частей в шаблоне (подшаблонов) должно соответствовать количеству колонок в импортируемых данных.</p> <p>Строки импортируемых данных должны разделяться символом новой строки <code class=syntax>'\n'</code> или символами <code class=syntax>"\r\n"</code> (перенос строки в формате DOS).</p> <p>Данные, выделенные по подшаблонам, интерпретируются в соответствии с типом, указанным в параметре <code class=syntax>format_regexp_escaping_rule</code>.</p> <p>Если строка импортируемых данных не соответствует регулярному выражению и параметр <code class=syntax>format_regexp_skip_unmatched</code> равен 1, строка просто игнорируется. Если же параметр <code class=syntax>format_regexp_skip_unmatched</code> равен 0, генерируется исключение.</p> <p><strong>Пример</strong></p> <p>Рассмотрим файл data.tsv:</p> <div class=codehilite><pre><span></span><code class=syntax>id: 1 array: [1,2,3] string: str1 date: 2020-01-01
id: 2 array: [1,2,3] string: str2 date: 2020-01-02
id: 3 array: [1,2,3] string: str3 date: 2020-01-03
</code></pre></div> <p>и таблицу:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>imp_regex_table</span> <span class=p>(</span><span class=n>id</span> <span class=n>UInt32</span><span class=p>,</span> <span class=nb>array</span> <span class=nb>Array</span><span class=p>(</span><span class=n>UInt32</span><span class=p>),</span> <span class=n>string</span> <span class=n>String</span><span class=p>,</span> <span class=nb>date</span> <span class=nb>Date</span><span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>Memory</span><span class=p>;</span>
</code></pre></div> <p>Команда импорта:</p> <div class=codehilite><pre><span></span><code class=syntax>$ cat data.tsv <span class=p>|</span> clickhouse-client  --query <span class=s2>"INSERT INTO imp_regex_table FORMAT Regexp SETTINGS format_regexp='id: (.+?) array: (.+?) string: (.+?) date: (.+?)', format_regexp_escaping_rule='Escaped', format_regexp_skip_unmatched=0;"</span>
</code></pre></div> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>imp_regex_table</span><span class=p>;</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─id─┬─array───┬─string─┬───────date─┐
│  1 │ [1,2,3] │ str1   │ 2020-01-01 │
│  2 │ [1,2,3] │ str2   │ 2020-01-02 │
│  3 │ [1,2,3] │ str3   │ 2020-01-03 │
└────┴─────────┴────────┴────────────┘
</code></pre></div> <h2 id=formatschema>Схема формата<a class=headerlink href=../amp/#formatschema title="Permanent link"> </a></h2> <p>Имя файла со схемой записывается в настройке <code class=syntax>format_schema</code>. При использовании форматов <code class=syntax>Cap'n Proto</code> и <code class=syntax>Protobuf</code> требуется указать схему.<br> Схема представляет собой имя файла и имя типа в этом файле, разделенные двоеточием, например <code class=syntax>schemafile.proto:MessageType</code>.<br> Если файл имеет стандартное расширение для данного формата (например <code class=syntax>.proto</code> для <code class=syntax>Protobuf</code>),<br> то можно его не указывать и записывать схему так <code class=syntax>schemafile:MessageType</code>.</p> <p>Если для ввода/вывода данных используется <a href=../../cli/amp/ >клиент</a> в <a href=../../cli/amp/#cli_usage>интерактивном режиме</a>, то при записи схемы можно использовать абсолютный путь или записывать путь<br> относительно текущей директории на клиенте. Если клиент используется в <a href=../../cli/amp/#cli_usage>batch режиме</a>, то в записи схемы допускается только относительный путь, из соображений безопасности.</p> <p>Если для ввода/вывода данных используется <a href=../../http/amp/ >HTTP-интерфейс</a>, то файл со схемой должен располагаться на сервере в каталоге,<br> указанном в параметре <a href=../../../operations/server-configuration-parameters/settings/amp/#server_configuration_parameters-format_schema_path>format_schema_path</a> конфигурации сервера.</p> <h2 id=skippingerrors>Игнорирование ошибок<a class=headerlink href=../amp/#skippingerrors title="Permanent link"> </a></h2> <p>Некоторые форматы, такие как <code class=syntax>CSV</code>, <code class=syntax>TabSeparated</code>, <code class=syntax>TSKV</code>, <code class=syntax>JSONEachRow</code>, <code class=syntax>Template</code>, <code class=syntax>CustomSeparated</code> и <code class=syntax>Protobuf</code>, могут игнорировать строки, которые не соответствуют правилам и разбор которых может вызвать ошибку. При этом обработка импортируемых данных продолжается со следующей строки. См. настройки <a href=../../../operations/settings/settings/amp/#input-format-allow-errors-num>input_format_allow_errors_num</a> и<br> <a href=../../../operations/settings/settings/amp/#input-format-allow-errors-ratio>input_format_allow_errors_ratio</a>.<br> Ограничения:<br> - В формате <code class=syntax>JSONEachRow</code> в случае ошибки игнорируются все данные до конца текущей строки (или до конца файла). Поэтому строки должны быть разделены символом <code class=syntax>\n</code>, чтобы ошибки обрабатывались корректно.<br> - Форматы <code class=syntax>Template</code> и <code class=syntax>CustomSeparated</code> используют разделитель после последней колонки и разделитель между строками. Поэтому игнорирование ошибок работает только если хотя бы одна из строк не пустая.</p> <h2 id=rawblob>RawBLOB<a class=headerlink href=../amp/#rawblob title="Permanent link"> </a></h2> <p>В этом формате все входные данные считываются в одно значение. Парсить можно только таблицу с одним полем типа <a href=../../../sql-reference/data-types/string/amp/ >String</a> или подобным ему.<br> Результат выводится в бинарном виде без разделителей и экранирования. При выводе более одного значения формат неоднозначен и будет невозможно прочитать данные снова.</p> <p>Ниже приведено сравнение форматов <code class=syntax>RawBLOB</code> и <a href=../amp/#tabseparatedraw>TabSeparatedRaw</a>.<br> <code class=syntax>RawBLOB</code>:<br> - данные выводятся в бинарном виде, без экранирования;<br> - нет разделителей между значениями;<br> - нет перевода строки в конце каждого значения.<br> <a href=../amp/#tabseparatedraw>TabSeparatedRaw</a>:<br> - данные выводятся без экранирования;<br> - строка содержит значения, разделённые табуляцией;<br> - после последнего значения в строке есть перевод строки.</p> <p>Далее рассмотрено сравнение форматов <code class=syntax>RawBLOB</code> и <a href=../amp/#rowbinary>RowBinary</a>.<br> <code class=syntax>RawBLOB</code>:<br> - строки выводятся без их длины в начале.<br> <code class=syntax>RowBinary</code>:<br> - строки представлены как длина в формате varint (unsigned <a href=https://en.wikipedia.org/wiki/LEB128 rel="external nofollow noreferrer" target=_blank>LEB128</a>), а затем байты строки.</p> <p>При передаче на вход <code class=syntax>RawBLOB</code> пустых данных, ClickHouse бросает исключение:</p> <div class=codehilite><pre><span></span><code class=syntax>Code: 108. DB::Exception: No data to insert
</code></pre></div> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax>$ clickhouse-client --query <span class=s2>"CREATE TABLE {some_table} (a String) ENGINE = Memory;"</span>
$ cat <span class=o>{</span>filename<span class=o>}</span> <span class=p>|</span> clickhouse-client --query<span class=o>=</span><span class=s2>"INSERT INTO {some_table} FORMAT RawBLOB"</span>
$ clickhouse-client --query <span class=s2>"SELECT * FROM {some_table} FORMAT RawBLOB"</span> <span class=p>|</span> md5sum
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>f9725a22f9191e064120d718e26862a9  -
</code></pre></div> </div> </div> <div class=row> <div class=col> <div class="alert alert-light my-3"> <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p> <span class="alert-heading display-6">Article Rating</span> <div id=rating-stars class="display-6 mb-0">RATING_STARS</div> </div> <div id=content-footer class="text-muted pt-3 mb-5"> <div class=float-md-right>©2016–2021 Yandex LLC</div> <div>Built from <a href=https://github.com/ClickHouse/ClickHouse/commit/878a159538935028f2d2dce3eb3074d44eb191df rel="external nofollow noreferrer" target=_blank class=text-reset>878a159538</a> </div> </div> </div> </div> <div id=to-full-website class="row fixed-bottom text-center bg-white py-3"> <div class=col> <a href=https://clickhouse.tech/docs/ru/interfaces/formats/ class="btn btn-lg btn-outline-orange">To full website</a> </div> </div> </div> <amp-analytics type=metrika> <script type=application/json>{
"vars": {
  "counterId": "18343495",
  "triggers": {
    "notBounce": {
      "on": "timer",
      "timerSpec": {
        "immediate": false,
        "interval": 15,
        "maxTimerLength": 16
      },
      "request": "notBounce"
    }
  }
}
}</script> </amp-analytics> </body> </html> 