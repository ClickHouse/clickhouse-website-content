<!doctype html><html ⚡ lang=ja> <head><meta charset=utf-8><script async src=https://cdn.ampproject.org/v0.js></script><title>C++コードの書き方 | ClickHouseドキュメント</title><link href=https://clickhouse.tech/docs/ja/development/style/ rel=canonical><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><script type=application/ld+json>[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "C++コードの書き方 | ClickHouseドキュメント",
"mainEntityOfPage": "https://clickhouse.tech/docs/ja/development/style/",




"image": "https://clickhouse.tech/images/logo-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "Yandex LLC",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.tech/images/yandex.png",
    "width": 163,
    "height": 60
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "C++コードの書き方 | ClickHouseドキュメント",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script><style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript><style amp-custom>:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--white:#fff;--gray:#6c757d;--gray-dark:#343a40;--primary:#007bff;--secondary:#6c757d;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f8f9fa;--dark:#343a40;--breakpoint-xs:0;--breakpoint-sm:576px;--breakpoint-md:768px;--breakpoint-lg:992px;--breakpoint-xl:1200px;--font-family-sans-serif:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,::after,::before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}article,footer,main{display:block}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem}p{margin-top:0;margin-bottom:1rem}ul{margin-top:0;margin-bottom:1rem}ul ul{margin-bottom:0}strong{font-weight:bolder}a{color:#007bff;text-decoration:none;background-color:transparent}a:hover{color:#0056b3;text-decoration:underline}a:not([href]){color:inherit;text-decoration:none}a:not([href]):hover{color:inherit;text-decoration:none}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}img{vertical-align:middle;border-style:none}svg{overflow:hidden;vertical-align:middle}table{border-collapse:collapse}select{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit]{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{padding:0;border-style:none}progress{vertical-align:baseline}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}template{display:none}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:.5rem;font-weight:500;line-height:1.2}.h1,h1{font-size:2rem}.h2,h2{font-size:1.5rem}.h3,h3{font-size:1.25rem}.h4,h4{font-size:1rem}.h5,h5{font-size:1rem}.h6,h6{font-size:1rem}.lead{font-size:1.25rem;font-weight:300}.display-1{font-size:6rem;font-weight:300;line-height:1.2}.display-2{font-size:5.5rem;font-weight:300;line-height:1.2}.display-3{font-size:4.5rem;font-weight:300;line-height:1.2}.display-4{font-size:3.5rem;font-weight:300;line-height:1.2}.img-fluid{max-width:100%;height:auto}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}pre{display:block;font-size:87.5%;color:#212529}pre code{font-size:inherit;color:inherit;word-break:normal}.container{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container{max-width:720px}}@media(min-width:992px){.container{max-width:960px}}@media(min-width:1200px){.container{max-width:1140px}}.container-fluid,.container-lg,.container-md{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container,.container-md{max-width:720px}}@media(min-width:992px){.container,.container-lg,.container-md{max-width:960px}}@media(min-width:1200px){.container,.container-lg,.container-md{max-width:1140px}}.row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-15px;margin-left:-15px}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-auto,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-lg-auto,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-auto{position:relative;width:100%;padding-right:15px;padding-left:15px}.col{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-auto{-ms-flex:0 0 auto;flex:0 0 auto;width:auto;max-width:100%}.col-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}@media(min-width:768px){.col-md{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-md-auto{-ms-flex:0 0 auto;flex:0 0 auto;width:auto;max-width:100%}.col-md-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-md-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-md-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-md-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-md-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-md-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-md-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-md-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-md-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-md-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-md-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-md-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}}@media(min-width:992px){.col-lg{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-lg-auto{-ms-flex:0 0 auto;flex:0 0 auto;width:auto;max-width:100%}.col-lg-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-lg-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-lg-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-lg-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-lg-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-lg-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-lg-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-lg-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-lg-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-lg-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-lg-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-lg-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}}.table{width:100%;margin-bottom:1rem;color:#212529}.table-primary{background-color:#b8daff}.table-info{background-color:#bee5eb}.table-light{background-color:#fdfdfe}.table-dark{background-color:#c6c8ca}.table-dark{color:#fff;background-color:#343a40}.btn{display:inline-block;font-weight:400;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:.375rem .75rem;font-size:1rem;line-height:1.5;border-radius:.25rem}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus{outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.btn:disabled{opacity:.65}.btn-primary{color:#fff;background-color:#007bff;border-color:#007bff}.btn-primary:hover{color:#fff;background-color:#0069d9;border-color:#0062cc}.btn-primary:focus{color:#fff;background-color:#0069d9;border-color:#0062cc;box-shadow:0 0 0 .2rem rgba(38,143,255,.5)}.btn-primary:disabled{color:#fff;background-color:#007bff;border-color:#007bff}.btn-info{color:#fff;background-color:#17a2b8;border-color:#17a2b8}.btn-info:hover{color:#fff;background-color:#138496;border-color:#117a8b}.btn-info:focus{color:#fff;background-color:#138496;border-color:#117a8b;box-shadow:0 0 0 .2rem rgba(58,176,195,.5)}.btn-info:disabled{color:#fff;background-color:#17a2b8;border-color:#17a2b8}.btn-light{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-light:hover{color:#212529;background-color:#e2e6ea;border-color:#dae0e5}.btn-light:focus{color:#212529;background-color:#e2e6ea;border-color:#dae0e5;box-shadow:0 0 0 .2rem rgba(216,217,219,.5)}.btn-light:disabled{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-dark{color:#fff;background-color:#343a40;border-color:#343a40}.btn-dark:hover{color:#fff;background-color:#23272b;border-color:#1d2124}.btn-dark:focus{color:#fff;background-color:#23272b;border-color:#1d2124;box-shadow:0 0 0 .2rem rgba(82,88,93,.5)}.btn-dark:disabled{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-primary{color:#007bff;border-color:#007bff}.btn-outline-primary:hover{color:#fff;background-color:#007bff;border-color:#007bff}.btn-outline-primary:focus{box-shadow:0 0 0 .2rem rgba(0,123,255,.5)}.btn-outline-primary:disabled{color:#007bff;background-color:transparent}.btn-outline-info{color:#17a2b8;border-color:#17a2b8}.btn-outline-info:hover{color:#fff;background-color:#17a2b8;border-color:#17a2b8}.btn-outline-info:focus{box-shadow:0 0 0 .2rem rgba(23,162,184,.5)}.btn-outline-info:disabled{color:#17a2b8;background-color:transparent}.btn-outline-light{color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:hover{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:focus{box-shadow:0 0 0 .2rem rgba(248,249,250,.5)}.btn-outline-light:disabled{color:#f8f9fa;background-color:transparent}.btn-outline-dark{color:#343a40;border-color:#343a40}.btn-outline-dark:hover{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-dark:focus{box-shadow:0 0 0 .2rem rgba(52,58,64,.5)}.btn-outline-dark:disabled{color:#343a40;background-color:transparent}.btn-link{font-weight:400;color:#007bff;text-decoration:none}.btn-link:hover{color:#0056b3;text-decoration:underline}.btn-link:focus{text-decoration:underline;box-shadow:none}.btn-link:disabled{color:#6c757d;pointer-events:none}.btn-lg{padding:.5rem 1rem;font-size:1.25rem;line-height:1.5;border-radius:.3rem}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:.5rem}.custom-select{display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;vertical-align:middle;background:#fff url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5' viewBox='0 0 4 5'%3e%3cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3e%3c/svg%3e") no-repeat right .75rem center/8px 10px;border:1px solid #ced4da;border-radius:.25rem;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.custom-select:focus::-ms-value{color:#495057;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #495057}.custom-select-lg{height:calc(1.5em+1rem+2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.25rem}.custom-file{position:relative;display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);margin-bottom:0}@media(prefers-reduced-motion:reduce){.custom-select{transition:none}}.page-link{position:relative;display:block;padding:.5rem .75rem;margin-left:-1px;line-height:1.25;color:#007bff;background-color:#fff;border:1px solid #dee2e6}.page-link:hover{z-index:2;color:#0056b3;text-decoration:none;background-color:#e9ecef;border-color:#dee2e6}.page-link:focus{z-index:3;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.alert{position:relative;padding:.75rem 1.25rem;margin-bottom:1rem;border:1px solid transparent;border-radius:.25rem}.alert-heading{color:inherit}.alert-link{font-weight:700}.alert-primary{color:#004085;background-color:#cce5ff;border-color:#b8daff}.alert-primary .alert-link{color:#002752}.alert-info{color:#0c5460;background-color:#d1ecf1;border-color:#bee5eb}.alert-info .alert-link{color:#062c33}.alert-light{color:#818182;background-color:#fefefe;border-color:#fdfdfe}.alert-light .alert-link{color:#686868}.alert-dark{color:#1b1e21;background-color:#d6d8d9;border-color:#c6c8ca}.alert-dark .alert-link{color:#040505}@-webkit-keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}.progress{display:-ms-flexbox;display:flex;height:1rem;overflow:hidden;font-size:.75rem;background-color:#e9ecef;border-radius:.25rem}.close{float:right;font-size:1.5rem;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:.5}.close:hover{color:#000;text-decoration:none}@-webkit-keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}@keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}.bg-primary{background-color:#007bff}a.bg-primary:focus,a.bg-primary:hover{background-color:#0062cc}.bg-info{background-color:#17a2b8}a.bg-info:focus,a.bg-info:hover{background-color:#117a8b}.bg-light{background-color:#f8f9fa}a.bg-light:focus,a.bg-light:hover{background-color:#dae0e5}.bg-dark{background-color:#343a40}a.bg-dark:focus,a.bg-dark:hover{background-color:#1d2124}.bg-white{background-color:#fff}.d-none{display:none}.d-inline{display:inline}.d-inline-block{display:inline-block}.d-block{display:block}.d-table{display:table}.d-table-row{display:table-row}@media(min-width:768px){.d-md-none{display:none}.d-md-inline{display:inline}.d-md-inline-block{display:inline-block}.d-md-block{display:block}.d-md-table{display:table}.d-md-table-row{display:table-row}}@media(min-width:992px){.d-lg-none{display:none}.d-lg-inline{display:inline}.d-lg-inline-block{display:inline-block}.d-lg-block{display:block}.d-lg-table{display:table}.d-lg-table-row{display:table-row}}.float-left{float:left}.float-right{float:right}.float-none{float:none}@media(min-width:768px){.float-md-left{float:left}.float-md-right{float:right}.float-md-none{float:none}}@media(min-width:992px){.float-lg-left{float:left}.float-lg-right{float:right}.float-lg-none{float:none}}.position-static{position:static}.position-fixed{position:fixed}.fixed-bottom{position:fixed;right:0;bottom:0;left:0;z-index:1030}.h-25{height:25%}.h-50{height:50%}.h-75{height:75%}.h-100{height:100%}.h-auto{height:auto}.m-0{margin:0}.my-0{margin-top:0}.mr-0{margin-right:0}.mb-0,.my-0{margin-bottom:0}.m-1{margin:.25rem}.my-1{margin-top:.25rem}.mr-1{margin-right:.25rem}.mb-1,.my-1{margin-bottom:.25rem}.m-2{margin:.5rem}.my-2{margin-top:.5rem}.mr-2{margin-right:.5rem}.mb-2,.my-2{margin-bottom:.5rem}.m-3{margin:1rem}.my-3{margin-top:1rem}.mr-3{margin-right:1rem}.mb-3,.my-3{margin-bottom:1rem}.m-4{margin:1.5rem}.my-4{margin-top:1.5rem}.mr-4{margin-right:1.5rem}.mb-4,.my-4{margin-bottom:1.5rem}.m-5{margin:3rem}.my-5{margin-top:3rem}.mr-5{margin-right:3rem}.mb-5,.my-5{margin-bottom:3rem}.p-0{padding:0}.pt-0,.py-0{padding-top:0}.pb-0,.py-0{padding-bottom:0}.p-1{padding:.25rem}.pt-1,.py-1{padding-top:.25rem}.pb-1,.py-1{padding-bottom:.25rem}.p-2{padding:.5rem}.pt-2,.py-2{padding-top:.5rem}.pb-2,.py-2{padding-bottom:.5rem}.p-3{padding:1rem}.pt-3,.py-3{padding-top:1rem}.pb-3,.py-3{padding-bottom:1rem}.p-4{padding:1.5rem}.pt-4,.py-4{padding-top:1.5rem}.pb-4,.py-4{padding-bottom:1.5rem}.p-5{padding:3rem}.pt-5,.py-5{padding-top:3rem}.pb-5,.py-5{padding-bottom:3rem}.m-n1{margin:-.25rem}.my-n1{margin-top:-.25rem}.mr-n1{margin-right:-.25rem}.mb-n1,.my-n1{margin-bottom:-.25rem}.m-n2{margin:-.5rem}.my-n2{margin-top:-.5rem}.mr-n2{margin-right:-.5rem}.mb-n2,.my-n2{margin-bottom:-.5rem}.m-n3{margin:-1rem}.my-n3{margin-top:-1rem}.mr-n3{margin-right:-1rem}.mb-n3,.my-n3{margin-bottom:-1rem}.m-n4{margin:-1.5rem}.my-n4{margin-top:-1.5rem}.mr-n4{margin-right:-1.5rem}.mb-n4,.my-n4{margin-bottom:-1.5rem}.m-n5{margin:-3rem}.my-n5{margin-top:-3rem}.mr-n5{margin-right:-3rem}.mb-n5,.my-n5{margin-bottom:-3rem}.m-auto{margin:auto}.my-auto{margin-top:auto}.mr-auto{margin-right:auto}.mb-auto,.my-auto{margin-bottom:auto}@media(min-width:768px){.m-md-0{margin:0}.my-md-0{margin-top:0}.mr-md-0{margin-right:0}.mb-md-0,.my-md-0{margin-bottom:0}.m-md-1{margin:.25rem}.my-md-1{margin-top:.25rem}.mr-md-1{margin-right:.25rem}.mb-md-1,.my-md-1{margin-bottom:.25rem}.m-md-2{margin:.5rem}.my-md-2{margin-top:.5rem}.mr-md-2{margin-right:.5rem}.mb-md-2,.my-md-2{margin-bottom:.5rem}.m-md-3{margin:1rem}.my-md-3{margin-top:1rem}.mr-md-3{margin-right:1rem}.mb-md-3,.my-md-3{margin-bottom:1rem}.m-md-4{margin:1.5rem}.my-md-4{margin-top:1.5rem}.mr-md-4{margin-right:1.5rem}.mb-md-4,.my-md-4{margin-bottom:1.5rem}.m-md-5{margin:3rem}.my-md-5{margin-top:3rem}.mr-md-5{margin-right:3rem}.mb-md-5,.my-md-5{margin-bottom:3rem}.p-md-0{padding:0}.pt-md-0,.py-md-0{padding-top:0}.pb-md-0,.py-md-0{padding-bottom:0}.p-md-1{padding:.25rem}.pt-md-1,.py-md-1{padding-top:.25rem}.pb-md-1,.py-md-1{padding-bottom:.25rem}.p-md-2{padding:.5rem}.pt-md-2,.py-md-2{padding-top:.5rem}.pb-md-2,.py-md-2{padding-bottom:.5rem}.p-md-3{padding:1rem}.pt-md-3,.py-md-3{padding-top:1rem}.pb-md-3,.py-md-3{padding-bottom:1rem}.p-md-4{padding:1.5rem}.pt-md-4,.py-md-4{padding-top:1.5rem}.pb-md-4,.py-md-4{padding-bottom:1.5rem}.p-md-5{padding:3rem}.pt-md-5,.py-md-5{padding-top:3rem}.pb-md-5,.py-md-5{padding-bottom:3rem}.m-md-n1{margin:-.25rem}.my-md-n1{margin-top:-.25rem}.mr-md-n1{margin-right:-.25rem}.mb-md-n1,.my-md-n1{margin-bottom:-.25rem}.m-md-n2{margin:-.5rem}.my-md-n2{margin-top:-.5rem}.mr-md-n2{margin-right:-.5rem}.mb-md-n2,.my-md-n2{margin-bottom:-.5rem}.m-md-n3{margin:-1rem}.my-md-n3{margin-top:-1rem}.mr-md-n3{margin-right:-1rem}.mb-md-n3,.my-md-n3{margin-bottom:-1rem}.m-md-n4{margin:-1.5rem}.my-md-n4{margin-top:-1.5rem}.mr-md-n4{margin-right:-1.5rem}.mb-md-n4,.my-md-n4{margin-bottom:-1.5rem}.m-md-n5{margin:-3rem}.my-md-n5{margin-top:-3rem}.mr-md-n5{margin-right:-3rem}.mb-md-n5,.my-md-n5{margin-bottom:-3rem}.m-md-auto{margin:auto}.my-md-auto{margin-top:auto}.mr-md-auto{margin-right:auto}.mb-md-auto,.my-md-auto{margin-bottom:auto}}@media(min-width:992px){.m-lg-0{margin:0}.my-lg-0{margin-top:0}.mr-lg-0{margin-right:0}.mb-lg-0,.my-lg-0{margin-bottom:0}.m-lg-1{margin:.25rem}.my-lg-1{margin-top:.25rem}.mr-lg-1{margin-right:.25rem}.mb-lg-1,.my-lg-1{margin-bottom:.25rem}.m-lg-2{margin:.5rem}.my-lg-2{margin-top:.5rem}.mr-lg-2{margin-right:.5rem}.mb-lg-2,.my-lg-2{margin-bottom:.5rem}.m-lg-3{margin:1rem}.my-lg-3{margin-top:1rem}.mr-lg-3{margin-right:1rem}.mb-lg-3,.my-lg-3{margin-bottom:1rem}.m-lg-4{margin:1.5rem}.my-lg-4{margin-top:1.5rem}.mr-lg-4{margin-right:1.5rem}.mb-lg-4,.my-lg-4{margin-bottom:1.5rem}.m-lg-5{margin:3rem}.my-lg-5{margin-top:3rem}.mr-lg-5{margin-right:3rem}.mb-lg-5,.my-lg-5{margin-bottom:3rem}.p-lg-0{padding:0}.pt-lg-0,.py-lg-0{padding-top:0}.pb-lg-0,.py-lg-0{padding-bottom:0}.p-lg-1{padding:.25rem}.pt-lg-1,.py-lg-1{padding-top:.25rem}.pb-lg-1,.py-lg-1{padding-bottom:.25rem}.p-lg-2{padding:.5rem}.pt-lg-2,.py-lg-2{padding-top:.5rem}.pb-lg-2,.py-lg-2{padding-bottom:.5rem}.p-lg-3{padding:1rem}.pt-lg-3,.py-lg-3{padding-top:1rem}.pb-lg-3,.py-lg-3{padding-bottom:1rem}.p-lg-4{padding:1.5rem}.pt-lg-4,.py-lg-4{padding-top:1.5rem}.pb-lg-4,.py-lg-4{padding-bottom:1.5rem}.p-lg-5{padding:3rem}.pt-lg-5,.py-lg-5{padding-top:3rem}.pb-lg-5,.py-lg-5{padding-bottom:3rem}.m-lg-n1{margin:-.25rem}.my-lg-n1{margin-top:-.25rem}.mr-lg-n1{margin-right:-.25rem}.mb-lg-n1,.my-lg-n1{margin-bottom:-.25rem}.m-lg-n2{margin:-.5rem}.my-lg-n2{margin-top:-.5rem}.mr-lg-n2{margin-right:-.5rem}.mb-lg-n2,.my-lg-n2{margin-bottom:-.5rem}.m-lg-n3{margin:-1rem}.my-lg-n3{margin-top:-1rem}.mr-lg-n3{margin-right:-1rem}.mb-lg-n3,.my-lg-n3{margin-bottom:-1rem}.m-lg-n4{margin:-1.5rem}.my-lg-n4{margin-top:-1.5rem}.mr-lg-n4{margin-right:-1.5rem}.mb-lg-n4,.my-lg-n4{margin-bottom:-1.5rem}.m-lg-n5{margin:-3rem}.my-lg-n5{margin-top:-3rem}.mr-lg-n5{margin-right:-3rem}.mb-lg-n5,.my-lg-n5{margin-bottom:-3rem}.m-lg-auto{margin:auto}.my-lg-auto{margin-top:auto}.mr-lg-auto{margin-right:auto}.mb-lg-auto,.my-lg-auto{margin-bottom:auto}}.text-left{text-align:left}.text-right{text-align:right}.text-center{text-align:center}@media(min-width:768px){.text-md-left{text-align:left}.text-md-right{text-align:right}.text-md-center{text-align:center}}@media(min-width:992px){.text-lg-left{text-align:left}.text-lg-right{text-align:right}.text-lg-center{text-align:center}}.text-white{color:#fff}.text-primary{color:#007bff}a.text-primary:focus,a.text-primary:hover{color:#0056b3}.text-info{color:#17a2b8}a.text-info:focus,a.text-info:hover{color:#0f6674}.text-light{color:#f8f9fa}a.text-light:focus,a.text-light:hover{color:#cbd3da}.text-dark{color:#343a40}a.text-dark:focus,a.text-dark:hover{color:#121416}.text-body{color:#212529}.text-muted{color:#6c757d}.text-black-50{color:rgba(0,0,0,.5)}.text-white-50{color:rgba(255,255,255,.5)}.text-hide{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;border:0}.text-decoration-none{text-decoration:none}.text-reset{color:inherit}.visible{visibility:visible}@media print{*,::after,::before{text-shadow:none;box-shadow:none}a:not(.btn){text-decoration:underline}pre{white-space:pre-wrap}pre{border:1px solid #adb5bd;page-break-inside:avoid}img{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}body{min-width:992px}.container{min-width:992px}.table{border-collapse:collapse}.table-dark{color:inherit}}@-webkit-keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}@keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"}a:link,a:visited{color:#f14600;text-decoration:none}a:active,a:hover{text-decoration:underline}.btn:disabled{cursor:default;opacity:.4}#logo-text{width:180px;margin-left:12px}.display-5{font-size:2rem;font-weight:300;line-height:1.2}.display-6{font-size:1.75rem;font-weight:300;line-height:1.2}.bg-dark-alt,.bg-dark-alt:focus{background:#36363f}.bg-orange,.bg-orange:focus{background:#f14600}.text-dark-alt{color:#36363f}.btn-dark-alt{background:#36363f}.btn-dark-alt:focus{background:#36363f}.btn-outline-orange{border-color:#f14600;color:#f14600}.btn-orange,.btn-outline-orange:hover{background:#f14600;color:#fff}.btn:active,.btn:hover{text-decoration:none}.text-orange{color:#f14600}.headerlink{text-decoration:none;margin-left:.5rem}#content table{border:1px solid #dee2e6;width:100%;margin-bottom:1rem;overflow-x:auto}#content code{color:#000;background:#eee;padding:.125rem .25rem}#content code.syntax{padding:0}#content pre{background:#efefef;padding:1rem;line-height:1.25}@media print{body{min-width:0}code,h1,h2,h3,h4,h5,h6,img,li,p,pre{page-break-inside:avoid}}@media(prefers-color-scheme:dark){#to-full-website,body.amp,body[data-spy]{background:#1c1c1c;color:#efefef}.invert-dark{filter:invert(100%)}#content table{border:1px solid #2a2b2c}#content code{background:#444;color:#eee;padding:.125rem .25rem}#content pre{background:#444;color:#eee}}@media(prefers-color-scheme:dark){.syntax{background:#2d2d2d;color:#f2f0ec}.syntax .c{color:#747369}.syntax .k{color:#c9c}.syntax .n{color:#f2f0ec}.syntax .o{color:#6cc}.syntax .p{color:#f2f0ec}.syntax .cm{color:#747369}.syntax .cp{color:#747369}.syntax .c1{color:#747369}.syntax .kr{color:#c9c}.syntax .kt{color:#fc6}.syntax .ld{color:#9c9}.syntax .m{color:#f99157}.syntax .s{color:#9c9}.syntax .nb{color:#f2f0ec}.syntax .nc{color:#fc6}.syntax .nf{color:#69c}.syntax .nl{color:#f2f0ec}.syntax .py{color:#f2f0ec}.syntax .mf{color:#f99157}.syntax .mi{color:#f99157}.syntax .sc{color:#f2f0ec}.syntax .s2{color:#9c9}.syntax .s1{color:#9c9}}</style><script async custom-element=amp-analytics src=https://cdn.ampproject.org/v0/amp-analytics-0.1.js></script><script async custom-element=amp-iframe src=https://cdn.ampproject.org/v0/amp-iframe-0.1.js></script></head> <body class=amp dir=ltr> <div class="container-fluid container-lg pb-5"> <div class="row pt-3 mb-3"> <div class=col> <a href=/ class=text-decoration-none> <amp-img class="d-inline-block mr-3" layout=fixed width=40 height=36 src=/images/logo.svg alt="ClickHouse logo" title="ClickHouse logo"></amp-img><amp-img class="invert-dark d-inline-block" layout=fixed width=238 height=36 src=/images/clickhouse-black.svg alt=ClickHouse title=ClickHouse></amp-img> </a> </div> </div> <div class=row> <div id=content class=col> <div class="alert alert-primary" role=alert> <p class="display-5 mb-2">Help wanted!</p> <p class=lead>The following content of this documentation page has been machine-translated. But unlike other websites, it is not done on the fly. This translated text lives on GitHub repository alongside main ClickHouse codebase and waits for fellow native speakers to make it more human-readable. <a href=/docs/en/development/style/ class=alert-link>You can also use the original English version as a reference.</a></p> <p class=lead> <a class="btn btn-lg btn-primary text-white" href=https://github.com/ClickHouse/ClickHouse/edit/master/docs/ja/development/style.md target=_blank rel="external nofollow noreferrer"> Help ClickHouse documentation by editing this page </a> </p> </div> <h1 id=how-to-write-c-code>C++コードの書き方<a class=headerlink href=../amp/#how-to-write-c-code title="Permanent link"> </a></h1> <h2 id=general-recommendations>一般的な推奨事項<a class=headerlink href=../amp/#general-recommendations title="Permanent link"> </a></h2> <p><strong>1.</strong> 以下は推奨事項であり、要件ではありません。</p> <p><strong>2.</strong> コードを編集する場合は、既存のコードの書式に従うことが理にかなっています。</p> <p><strong>3.</strong> 一貫性のためにコードスタイルが必要です。 一貫性により、コードを読みやすくなり、コードの検索も簡単になります。</p> <p><strong>4.</strong> ルールの多くは論理的な理由を持っていない;彼らは確立された慣行によって決定されます。</p> <h2 id=formatting>書式設定<a class=headerlink href=../amp/#formatting title="Permanent link"> </a></h2> <p><strong>1.</strong> 多くのフォーマットは自動的に実行されるのでよ <code class=syntax>clang-format</code>.</p> <p><strong>2.</strong> インデントは4スペースです。 タブにスペースが追加されるように開発環境を構成します。</p> <p><strong>3.</strong> 中括弧の開始と終了は別の行にする必要があります。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=kr>inline</span> <span class=kt>void</span> <span class=nf>readBoolText</span><span class=p>(</span><span class=kt>bool</span> <span class=o>&amp;</span> <span class=n>x</span><span class=p>,</span> <span class=n>ReadBuffer</span> <span class=o>&amp;</span> <span class=n>buf</span><span class=p>)</span>
<span class=p>{</span>
    <span class=kt>char</span> <span class=n>tmp</span> <span class=o>=</span> <span class=sc>'0'</span><span class=p>;</span>
    <span class=n>readChar</span><span class=p>(</span><span class=n>tmp</span><span class=p>,</span> <span class=n>buf</span><span class=p>);</span>
    <span class=n>x</span> <span class=o>=</span> <span class=n>tmp</span> <span class=o>!=</span> <span class=sc>'0'</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div> <p><strong>4.</strong> 関数本体全体が単一の場合 <code class=syntax>statement</code>、それは単一行に置くことができます。 中括弧の周りにスペースを配置します（行末のスペースのほかに）。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=kr>inline</span> <span class=kt>size_t</span> <span class=nf>mask</span><span class=p>()</span> <span class=k>const</span>                <span class=p>{</span> <span class=k>return</span> <span class=n>buf_size</span><span class=p>()</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=p>}</span>
<span class=kr>inline</span> <span class=kt>size_t</span> <span class=nf>place</span><span class=p>(</span><span class=n>HashValue</span> <span class=n>x</span><span class=p>)</span> <span class=k>const</span>    <span class=p>{</span> <span class=k>return</span> <span class=n>x</span> <span class=o>&amp;</span> <span class=n>mask</span><span class=p>();</span> <span class=p>}</span>
</code></pre></div> <p><strong>5.</strong> 機能のため。 をかけないスットに固定して使用します。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=kt>void</span> <span class=n>reinsert</span><span class=p>(</span><span class=k>const</span> <span class=n>Value</span> <span class=o>&amp;</span> <span class=n>x</span><span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=n>memcpy</span><span class=p>(</span><span class=o>&amp;</span><span class=n>buf</span><span class=p>[</span><span class=n>place_value</span><span class=p>],</span> <span class=o>&amp;</span><span class=n>x</span><span class=p>,</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>x</span><span class=p>));</span>
</code></pre></div> <p><strong>6.</strong> で <code class=syntax>if</code>, <code class=syntax>for</code>, <code class=syntax>while</code> 他の式では、（関数呼び出しとは対照的に）開始括弧の前にスペースが挿入されます。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>for</span> <span class=p>(</span><span class=kt>size_t</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>rows</span><span class=p>;</span> <span class=n>i</span> <span class=o>+=</span> <span class=n>storage</span><span class=p>.</span><span class=n>index_granularity</span><span class=p>)</span>
</code></pre></div> <p><strong>7.</strong> 二項演算子の周りにスペースを追加 (<code class=syntax>+</code>, <code class=syntax>-</code>, <code class=syntax>*</code>, <code class=syntax>/</code>, <code class=syntax>%</code>, …) and the ternary operator <code class=syntax>?:</code>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>UInt16</span> <span class=n>year</span> <span class=o>=</span> <span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>-</span> <span class=sc>'0'</span><span class=p>)</span> <span class=o>*</span> <span class=mi>1000</span> <span class=o>+</span> <span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>-</span> <span class=sc>'0'</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span> <span class=o>+</span> <span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>-</span> <span class=sc>'0'</span><span class=p>)</span> <span class=o>*</span> <span class=mi>10</span> <span class=o>+</span> <span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>-</span> <span class=sc>'0'</span><span class=p>);</span>
<span class=n>UInt8</span> <span class=n>month</span> <span class=o>=</span> <span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=mi>5</span><span class=p>]</span> <span class=o>-</span> <span class=sc>'0'</span><span class=p>)</span> <span class=o>*</span> <span class=mi>10</span> <span class=o>+</span> <span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>-</span> <span class=sc>'0'</span><span class=p>);</span>
<span class=n>UInt8</span> <span class=n>day</span> <span class=o>=</span> <span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=mi>8</span><span class=p>]</span> <span class=o>-</span> <span class=sc>'0'</span><span class=p>)</span> <span class=o>*</span> <span class=mi>10</span> <span class=o>+</span> <span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=mi>9</span><span class=p>]</span> <span class=o>-</span> <span class=sc>'0'</span><span class=p>);</span>
</code></pre></div> <p><strong>8.</strong> 改行が入力されている場合は、演算子を新しい行に置き、その前にインデントを増やします。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>if</span> <span class=p>(</span><span class=n>elapsed_ns</span><span class=p>)</span>
    <span class=n>message</span> <span class=o>&lt;&lt;</span> <span class=s>" ("</span>
        <span class=o>&lt;&lt;</span> <span class=n>rows_read_on_server</span> <span class=o>*</span> <span class=mi>1000000000</span> <span class=o>/</span> <span class=n>elapsed_ns</span> <span class=o>&lt;&lt;</span> <span class=s>" rows/s., "</span>
        <span class=o>&lt;&lt;</span> <span class=n>bytes_read_on_server</span> <span class=o>*</span> <span class=mf>1000.0</span> <span class=o>/</span> <span class=n>elapsed_ns</span> <span class=o>&lt;&lt;</span> <span class=s>" MB/s.) "</span><span class=p>;</span>
</code></pre></div> <p><strong>9.</strong> 必要に応じて、行内の整列にスペースを使用できます。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>dst</span><span class=p>.</span><span class=n>ClickLogID</span>         <span class=o>=</span> <span class=n>click</span><span class=p>.</span><span class=n>LogID</span><span class=p>;</span>
<span class=n>dst</span><span class=p>.</span><span class=n>ClickEventID</span>       <span class=o>=</span> <span class=n>click</span><span class=p>.</span><span class=n>EventID</span><span class=p>;</span>
<span class=n>dst</span><span class=p>.</span><span class=n>ClickGoodEvent</span>     <span class=o>=</span> <span class=n>click</span><span class=p>.</span><span class=n>GoodEvent</span><span class=p>;</span>
</code></pre></div> <p><strong>10.</strong> 演算子の周りにスペースを使用しない <code class=syntax>.</code>, <code class=syntax>-&gt;</code>.</p> <p>必要に応じて、演算子を次の行に折り返すことができます。 この場合、その前のオフセットが増加する。</p> <p><strong>11.</strong> 単項演算子の区切りにスペースを使用しないでください (<code class=syntax>--</code>, <code class=syntax>++</code>, <code class=syntax>*</code>, <code class=syntax>&amp;</code>, …) from the argument.</p> <p><strong>12.</strong> 入れの後に空白、コンマといえるものです。 同じルールは、内部のセミコロンのために行く <code class=syntax>for</code> 式。</p> <p><strong>13.</strong> 区切りにスペースを使用しないで下さい <code class=syntax>[]</code> オペレーター</p> <p><strong>14.</strong> で <code class=syntax>template &lt;...&gt;</code> 式は、間にスペースを使用します <code class=syntax>template</code> と <code class=syntax>&lt;</code>;後にスペースなし <code class=syntax>&lt;</code> または前に <code class=syntax>&gt;</code>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=nc>TKey</span><span class=p>,</span> <span class=k>typename</span> <span class=nc>TValue</span><span class=o>&gt;</span>
<span class=k>struct</span> <span class=nc>AggregatedStatElement</span>
<span class=p>{}</span>
</code></pre></div> <p><strong>15.</strong> クラスと構造体では、 <code class=syntax>public</code>, <code class=syntax>private</code>,and <code class=syntax>protected</code> と同じレベルで <code class=syntax>class/struct</code> コードの残りの部分をインデントします。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=nc>T</span><span class=o>&gt;</span>
<span class=k>class</span> <span class=nc>MultiVersion</span>
<span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=c1>/// Version of object for usage. shared_ptr manage lifetime of version.</span>
    <span class=k>using</span> <span class=n>Version</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>shared_ptr</span><span class=o>&lt;</span><span class=k>const</span> <span class=n>T</span><span class=o>&gt;</span><span class=p>;</span>
    <span class=p>...</span>
<span class=p>}</span>
</code></pre></div> <p><strong>16.</strong> 同じ場合 <code class=syntax>namespace</code> ファイル全体に使用され、他に重要なものはありません。 <code class=syntax>namespace</code>.</p> <p><strong>17.</strong> のブロックが <code class=syntax>if</code>, <code class=syntax>for</code>, <code class=syntax>while</code>、または他の式は、単一の <code class=syntax>statement</code>、中括弧は省略可能です。 を置く <code class=syntax>statement</code> 別の行で、代わりに。 この規則は、入れ子に対しても有効です <code class=syntax>if</code>, <code class=syntax>for</code>, <code class=syntax>while</code>, …</p> <p>しかし、内側の場合 <code class=syntax>statement</code> 中括弧または <code class=syntax>else</code>、外部ブロックは中括弧で記述する必要があります。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=c1>/// Finish write.</span>
<span class=k>for</span> <span class=p>(</span><span class=k>auto</span> <span class=o>&amp;</span> <span class=nl>stream</span> <span class=p>:</span> <span class=n>streams</span><span class=p>)</span>
    <span class=n>stream</span><span class=p>.</span><span class=n>second</span><span class=o>-&gt;</span><span class=n>finalize</span><span class=p>();</span>
</code></pre></div> <p><strong>18.</strong> 行の終わりにスペースがあってはなりません。</p> <p><strong>19.</strong> ソースファイルはUTF-8エンコードです。</p> <p><strong>20.</strong> ASCII以外の文字は、文字列リテラルで使用できます。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=o>&lt;&lt;</span> <span class=s>", "</span> <span class=o>&lt;&lt;</span> <span class=p>(</span><span class=n>timer</span><span class=p>.</span><span class=n>elapsed</span><span class=p>()</span> <span class=o>/</span> <span class=n>chunks_stats</span><span class=p>.</span><span class=n>hits</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=s>" μsec/hit."</span><span class=p>;</span>
</code></pre></div> <p><strong>21.</strong> 単一行に複数の式を記述しないでください。</p> <p><strong>22.</strong> 関数内のコードのセクションをグループ化し、空行を複数以下で区切ります。</p> <p><strong>23.</strong> 関数、クラスなどを空行で区切ります。</p> <p><strong>24.</strong> <code class=syntax>A const</code> (値に関連する)型名の前に記述する必要があります。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=c1>//correct</span>
<span class=k>const</span> <span class=kt>char</span> <span class=o>*</span> <span class=n>pos</span>
<span class=k>const</span> <span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=o>&amp;</span> <span class=n>s</span>
<span class=c1>//incorrect</span>
<span class=kt>char</span> <span class=k>const</span> <span class=o>*</span> <span class=n>pos</span>
</code></pre></div> <p><strong>25.</strong> ポインタまたは参照を宣言するとき、 <code class=syntax>*</code> と <code class=syntax>&amp;</code> シンボルは、両側のスペースで区切る必要があります。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=c1>//correct</span>
<span class=k>const</span> <span class=kt>char</span> <span class=o>*</span> <span class=n>pos</span>
<span class=c1>//incorrect</span>
<span class=k>const</span> <span class=kt>char</span><span class=o>*</span> <span class=n>pos</span>
<span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>pos</span>
</code></pre></div> <p><strong>26.</strong> テンプレートタイプを使用するときは、それらを <code class=syntax>using</code> キーワード(最も単純な場合を除く)。</p> <p>つまり、テンプレートパラメーターは、 <code class=syntax>using</code> コードでは繰り返されません。</p> <p><code class=syntax>using</code> 関数内など、ローカルで宣言できます。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=c1>//correct</span>
<span class=k>using</span> <span class=n>FileStreams</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>map</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=p>,</span> <span class=n>std</span><span class=o>::</span><span class=n>shared_ptr</span><span class=o>&lt;</span><span class=n>Stream</span><span class=o>&gt;&gt;</span><span class=p>;</span>
<span class=n>FileStreams</span> <span class=n>streams</span><span class=p>;</span>
<span class=c1>//incorrect</span>
<span class=n>std</span><span class=o>::</span><span class=n>map</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=p>,</span> <span class=n>std</span><span class=o>::</span><span class=n>shared_ptr</span><span class=o>&lt;</span><span class=n>Stream</span><span class=o>&gt;&gt;</span> <span class=n>streams</span><span class=p>;</span>
</code></pre></div> <p><strong>27.</strong> 一つの文で異なる型の変数を複数宣言しないでください。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=c1>//incorrect</span>
<span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=o>*</span><span class=n>y</span><span class=p>;</span>
</code></pre></div> <p><strong>28.</strong> Cスタイルのキャストは使用しないでください。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=c1>//incorrect</span>
<span class=n>std</span><span class=o>::</span><span class=n>cerr</span> <span class=o>&lt;&lt;</span> <span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=n>c</span> <span class=o>&lt;&lt;</span><span class=p>;</span> <span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
<span class=c1>//correct</span>
<span class=n>std</span><span class=o>::</span><span class=n>cerr</span> <span class=o>&lt;&lt;</span> <span class=k>static_cast</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>c</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
</code></pre></div> <p><strong>29.</strong> クラスと構造体では、各可視スコープ内でメンバーと関数を個別にグループ化します。</p> <p><strong>30.</strong> 小さなクラスと構造体の場合、メソッド宣言を実装から分離する必要はありません。</p> <p>同じことが、クラスや構造体の小さなメソッドにも当てはまります。</p> <p>テンプレート化されたクラスと構造体の場合、メソッド宣言を実装から分離しないでください（そうでない場合は、同じ翻訳単位で定義する必要があ</p> <p><strong>31.</strong> 行は140文字で、80文字ではなく折り返すことができます。</p> <p><strong>32.</strong> Postfixが必要ない場合は、常に接頭辞の増分/減分演算子を使用します。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>for</span> <span class=p>(</span><span class=n>Names</span><span class=o>::</span><span class=n>const_iterator</span> <span class=n>it</span> <span class=o>=</span> <span class=n>column_names</span><span class=p>.</span><span class=n>begin</span><span class=p>();</span> <span class=n>it</span> <span class=o>!=</span> <span class=n>column_names</span><span class=p>.</span><span class=n>end</span><span class=p>();</span> <span class=o>++</span><span class=n>it</span><span class=p>)</span>
</code></pre></div> <h2 id=comments>コメント<a class=headerlink href=../amp/#comments title="Permanent link"> </a></h2> <p><strong>1.</strong> コードのすべての非自明な部分にコメントを追加してください。</p> <p>これは非常に重要です。 書面でのコメントだけを更新したいのですが--このコードに必要な、又は間違っています。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=cm>/** Part of piece of memory, that can be used.</span>
<span class=cm>  * For example, if internal_buffer is 1MB, and there was only 10 bytes loaded to buffer from file for reading,</span>
<span class=cm>  * then working_buffer will have size of only 10 bytes</span>
<span class=cm>  * (working_buffer.end() will point to position right after those 10 bytes available for read).</span>
<span class=cm>  */</span>
</code></pre></div> <p><strong>2.</strong> コメントは必要に応じて詳細に設定できます。</p> <p><strong>3.</strong> 記述するコードの前にコメントを配置します。 まれに、コメントが同じ行のコードの後に来ることがあります。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=cm>/** Parses and executes the query.</span>
<span class=cm>*/</span>
<span class=kt>void</span> <span class=n>executeQuery</span><span class=p>(</span>
    <span class=n>ReadBuffer</span> <span class=o>&amp;</span> <span class=n>istr</span><span class=p>,</span> <span class=c1>/// Where to read the query from (and data for INSERT, if applicable)</span>
    <span class=n>WriteBuffer</span> <span class=o>&amp;</span> <span class=n>ostr</span><span class=p>,</span> <span class=c1>/// Where to write the result</span>
    <span class=n>Context</span> <span class=o>&amp;</span> <span class=n>context</span><span class=p>,</span> <span class=c1>/// DB, tables, data types, engines, functions, aggregate functions...</span>
    <span class=n>BlockInputStreamPtr</span> <span class=o>&amp;</span> <span class=n>query_plan</span><span class=p>,</span> <span class=c1>/// Here could be written the description on how query was executed</span>
    <span class=n>QueryProcessingStage</span><span class=o>::</span><span class=n>Enum</span> <span class=n>stage</span> <span class=o>=</span> <span class=n>QueryProcessingStage</span><span class=o>::</span><span class=n>Complete</span> <span class=c1>/// Up to which stage process the SELECT query</span>
    <span class=p>)</span>
</code></pre></div> <p><strong>4.</strong> コメントは英語のみで書く必要があります。</p> <p><strong>5.</strong> を書いていて図書館を含む詳細なコメントで説明を主なヘッダファイルです。</p> <p><strong>6.</strong> 追加情報を提供しないコメントは追加しないでください。 特に放置しないでください空のコメントこのような:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=cm>/*</span>
<span class=cm>* Procedure Name:</span>
<span class=cm>* Original procedure name:</span>
<span class=cm>* Author:</span>
<span class=cm>* Date of creation:</span>
<span class=cm>* Dates of modification:</span>
<span class=cm>* Modification authors:</span>
<span class=cm>* Original file name:</span>
<span class=cm>* Purpose:</span>
<span class=cm>* Intent:</span>
<span class=cm>* Designation:</span>
<span class=cm>* Classes used:</span>
<span class=cm>* Constants:</span>
<span class=cm>* Local variables:</span>
<span class=cm>* Parameters:</span>
<span class=cm>* Date of creation:</span>
<span class=cm>* Purpose:</span>
<span class=cm>*/</span>
</code></pre></div> <p>この例はリソースから借用されていますhttp://home.tamk.fi/~jaalto/course/coding-style/doc/unmainainable-code/.</p> <p><strong>7.</strong> ごみのコメントを書かないでください（作成者、作成日。.)各ファイルの先頭にある。</p> <p><strong>8.</strong> 単一行のコメントはスラッシュで始まります: <code class=syntax>///</code> 複数行のコメントは <code class=syntax>/**</code>. これらのコメントは、 “documentation”.</p> <p>注:Doxygenを使用すると、これらのコメントからドキュメントを生成できます。 しかし、Ideでコードをナビゲートする方が便利なので、Doxygenは一般的には使用されません。</p> <p><strong>9.</strong> 複数行コメントの先頭と末尾に空行を含めることはできません(複数行コメントを閉じる行を除きます)。</p> <p><strong>10.</strong> コメント行コードは、基本的なコメントは、 “documenting” コメント。</p> <p><strong>11.</strong> 削除のコメントアウトされていパーツのコード深い.</p> <p><strong>12.</strong> コメントやコードで冒涜を使用しないでください。</p> <p><strong>13.</strong> 大文字は使用しないでください。 過度の句読点を使用しないでください。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=c1>/// WHAT THE FAIL???</span>
</code></pre></div> <p><strong>14.</strong> 使用しないコメントをdelimeters.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=c1>///******************************************************</span>
</code></pre></div> <p><strong>15.</strong> コメントで議論を開始しないでください。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=c1>/// Why did you do this stuff?</span>
</code></pre></div> <p><strong>16.</strong> それが何であったかを説明するブロックの最後にコメントを書く必要はありません。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=c1>/// for</span>
</code></pre></div> <h2 id=names>名前<a class=headerlink href=../amp/#names title="Permanent link"> </a></h2> <p><strong>1.</strong> 変数とクラスメンバーの名前にアンダースコア付きの小文字を使用します。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=kt>size_t</span> <span class=n>max_block_size</span><span class=p>;</span>
</code></pre></div> <p><strong>2.</strong> 関数（メソッド）の名前には、小文字で始まるcamelCaseを使用します。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=nf>getName</span><span class=p>()</span> <span class=k>const</span> <span class=k>override</span> <span class=p>{</span> <span class=k>return</span> <span class=s>"Memory"</span><span class=p>;</span> <span class=p>}</span>
</code></pre></div> <p><strong>3.</strong> クラス(構造体)の名前には、大文字で始まるCamelCaseを使用します。 I以外の接頭辞はインターフェイスには使用されません。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>class</span> <span class=nc>StorageMemory</span> <span class=o>:</span> <span class=k>public</span> <span class=n>IStorage</span>
</code></pre></div> <p><strong>4.</strong> <code class=syntax>using</code> クラスと同じように、または <code class=syntax>_t</code> 最後に。</p> <p><strong>5.</strong> テンプレート型引数の名前:単純な場合は、次のようにします <code class=syntax>T</code>; <code class=syntax>T</code>, <code class=syntax>U</code>; <code class=syntax>T1</code>, <code class=syntax>T2</code>.</p> <p>より複雑な場合は、クラス名の規則に従うか、プレフィックスを追加します <code class=syntax>T</code>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>template</span> <span class=o>&lt;</span><span class=k>typename</span> <span class=nc>TKey</span><span class=p>,</span> <span class=k>typename</span> <span class=nc>TValue</span><span class=o>&gt;</span>
<span class=k>struct</span> <span class=nc>AggregatedStatElement</span>
</code></pre></div> <p><strong>6.</strong> テンプレート定数引数の名前:変数名の規則に従うか、または <code class=syntax>N</code> 簡単なケースでは。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>template</span> <span class=o>&lt;</span><span class=kt>bool</span> <span class=n>without_www</span><span class=o>&gt;</span>
<span class=k>struct</span> <span class=nc>ExtractDomain</span>
</code></pre></div> <p><strong>7.</strong> 抽象クラス(インターフェイス)については、 <code class=syntax>I</code> プレフィックス</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>class</span> <span class=nc>IBlockInputStream</span>
</code></pre></div> <p><strong>8.</strong> 変数をローカルで使用する場合は、短い名前を使用できます。</p> <p>それ以外の場合は、意味を説明する名前を使用します。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=kt>bool</span> <span class=n>info_successfully_loaded</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span>
</code></pre></div> <p><strong>9.</strong> の名前 <code class=syntax>define</code>sおよびグローバル定数を使用ALL_CAPSをアンダースコア(_).</p> <div class=codehilite><pre><span></span><code class=syntax><span class=cp>#define MAX_SRC_TABLE_NAMES_TO_STORE 1000</span>
</code></pre></div> <p><strong>10.</strong> ファイル名は内容と同じスタイルを使用する必要があります。</p> <p>ファイルに単一のクラスが含まれている場合は、クラス(CamelCase)と同じ方法でファイルに名前を付けます。</p> <p>ファイルに単一の関数が含まれている場合は、関数(camelCase)と同じ方法でファイルに名前を付けます。</p> <p><strong>11.</strong> 名前に略語が含まれている場合は、:</p> <ul> <li>変数名の場合、省略形は小文字を使用する必要があります <code class=syntax>mysql_connection</code> （ない <code class=syntax>mySQL_connection</code>).</li> <li>クラスおよび関数の名前については、省略形に大文字を使用します<code class=syntax>MySQLConnection</code> （ない <code class=syntax>MySqlConnection</code>).</li> </ul> <p><strong>12.</strong> クラスメンバーを初期化するためだけに使用されるコンストラクター引数には、クラスメンバーと同じ名前を付ける必要がありますが、最後にアンダースコ</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>FileQueueProcessor</span><span class=p>(</span>
    <span class=k>const</span> <span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=o>&amp;</span> <span class=n>path_</span><span class=p>,</span>
    <span class=k>const</span> <span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=o>&amp;</span> <span class=n>prefix_</span><span class=p>,</span>
    <span class=n>std</span><span class=o>::</span><span class=n>shared_ptr</span><span class=o>&lt;</span><span class=n>FileHandler</span><span class=o>&gt;</span> <span class=n>handler_</span><span class=p>)</span>
    <span class=o>:</span> <span class=n>path</span><span class=p>(</span><span class=n>path_</span><span class=p>),</span>
    <span class=n>prefix</span><span class=p>(</span><span class=n>prefix_</span><span class=p>),</span>
    <span class=n>handler</span><span class=p>(</span><span class=n>handler_</span><span class=p>),</span>
    <span class=n>log</span><span class=p>(</span><span class=o>&amp;</span><span class=n>Logger</span><span class=o>::</span><span class=n>get</span><span class=p>(</span><span class=s>"FileQueueProcessor"</span><span class=p>))</span>
<span class=p>{</span>
<span class=p>}</span>
</code></pre></div> <p>引数がコンストラクタ本体で使用されていない場合は、アンダースコアの接尾辞を省略できます。</p> <p><strong>13.</strong> ローカル変数とクラスメンバーの名前に違いはありません（接頭辞は必要ありません）。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>timer</span> <span class=p>(</span><span class=n>not</span> <span class=n>m_timer</span><span class=p>)</span>
</code></pre></div> <p><strong>14.</strong> の定数に対して <code class=syntax>enum</code>、大文字でキャメルケースを使用します。 ALL_CAPSも許容されます。 もし <code class=syntax>enum</code> は非ローカルである。 <code class=syntax>enum class</code>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>enum</span> <span class=k>class</span> <span class=nc>CompressionMethod</span>
<span class=p>{</span>
    <span class=n>QuickLZ</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
    <span class=n>LZ4</span>     <span class=o>=</span> <span class=mi>1</span><span class=p>,</span>
<span class=p>};</span>
</code></pre></div> <p><strong>15.</strong> すべての名前は英語である必要があります。 ロシア語の音訳は許可されていません。</p> <div class=codehilite><pre><span></span><code class=syntax>not Stroka
</code></pre></div> <p><strong>16.</strong> 略語は、よく知られている場合（Wikipediaや検索エンジンで略語の意味を簡単に見つけることができる場合）に許容されます。</p> <div class=codehilite><pre><span></span><code class=syntax><span class="n n-Quoted">`AST`</span><span class=p>,</span> <span class="n n-Quoted">`SQL`</span><span class=p>.</span>

<span class=k>Not</span> <span class="n n-Quoted">`NVDH`</span> <span class=p>(</span><span class=k>some</span> <span class=k>random</span> <span class=n>letters</span><span class=p>)</span>
</code></pre></div> <p>短縮版が一般的に使用されている場合、不完全な単語は許容されます。</p> <p>コメントの横にフルネームが含まれている場合は、略語を使用することもできます。</p> <p><strong>17.</strong> C++のソースコードを持つファイル名は、 <code class=syntax>.cpp</code> 延長。 ヘッダファイルには <code class=syntax>.h</code> 延長。</p> <h2 id=how-to-write-code>コードの書き方<a class=headerlink href=../amp/#how-to-write-code title="Permanent link"> </a></h2> <p><strong>1.</strong> メモリ管理。</p> <p>手動メモリ解放 (<code class=syntax>delete</code>）ライブラリコードでのみ使用できます。</p> <p>ライブラリコードでは、 <code class=syntax>delete</code> operatorはデストラクタでのみ使用できます。</p> <p>アプリケーショ</p> <p>例:</p> <ul> <li>最も簡単な方法は、スタック上にオブジェクトを配置するか、別のクラスのメンバーにすることです。</li> <li>多数の小さなオブジェクトの場合は、コンテナを使用します。</li> <li>ヒープ内に存在する少数のオブジェクトの自動割り当て解除には、以下を使用します <code class=syntax>shared_ptr/unique_ptr</code>.</li> </ul> <p><strong>2.</strong> リソース管理。</p> <p>使用 <code class=syntax>RAII</code> 上記を参照してください。</p> <p><strong>3.</strong> エラー処理。</p> <p>例外を使用します。 ほとんどの場合、例外をスローするだけで、それをキャッチする必要はありません（ <code class=syntax>RAII</code>).</p> <p>オフライ</p> <p>ユーザー要求を処理するサーバーでは、通常、接続ハンドラの最上位レベルで例外をキャッチするだけで十分です。</p> <p>スレッド機能、とくすべての例外rethrowのメインスレッド後 <code class=syntax>join</code>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=c1>/// If there weren't any calculations yet, calculate the first block synchronously</span>
<span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>started</span><span class=p>)</span>
<span class=p>{</span>
    <span class=n>calculate</span><span class=p>();</span>
    <span class=n>started</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
<span class=p>}</span>
<span class=k>else</span> <span class=c1>/// If calculations are already in progress, wait for the result</span>
    <span class=n>pool</span><span class=p>.</span><span class=n>wait</span><span class=p>();</span>

<span class=k>if</span> <span class=p>(</span><span class=n>exception</span><span class=p>)</span>
    <span class=n>exception</span><span class=o>-&gt;</span><span class=n>rethrow</span><span class=p>();</span>
</code></pre></div> <p>ない非表示の例外なります。 すべての例外を盲目的に記録するだけではありません。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=c1>//Not correct</span>
<span class=k>catch</span> <span class=p>(...)</span> <span class=p>{}</span>
</code></pre></div> <p>いくつかの例外を無視する必要がある場合は、特定の例外に対してのみ実行し、残りを再スローします。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>catch</span> <span class=p>(</span><span class=k>const</span> <span class=n>DB</span><span class=o>::</span><span class=n>Exception</span> <span class=o>&amp;</span> <span class=n>e</span><span class=p>)</span>
<span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>e</span><span class=p>.</span><span class=n>code</span><span class=p>()</span> <span class=o>==</span> <span class=n>ErrorCodes</span><span class=o>::</span><span class=n>UNKNOWN_AGGREGATE_FUNCTION</span><span class=p>)</span>
        <span class=k>return</span> <span class=k>nullptr</span><span class=p>;</span>
    <span class=k>else</span>
        <span class=k>throw</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div> <p>応答コードまたは関数を使用する場合 <code class=syntax>errno</code>、常に結果をチェックし、エラーの場合は例外をスローします。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>if</span> <span class=p>(</span><span class=mi>0</span> <span class=o>!=</span> <span class=n>close</span><span class=p>(</span><span class=n>fd</span><span class=p>))</span>
    <span class=n>throwFromErrno</span><span class=p>(</span><span class=s>"Cannot close file "</span> <span class=o>+</span> <span class=n>file_name</span><span class=p>,</span> <span class=n>ErrorCodes</span><span class=o>::</span><span class=n>CANNOT_CLOSE_FILE</span><span class=p>);</span>
</code></pre></div> <p><code class=syntax>Do not use assert</code>.</p> <p><strong>4.</strong> 例外タイプ。</p> <p>アプリケーションコードで複雑な例外階層を使用する必要はありません。 例外テキストは、システム管理者が理解できるはずです。</p> <p><strong>5.</strong> 投げから例外がスローされる場合destructors.</p> <p>これは推奨されませんが、許可されています。</p> <p>次のオプションを使用しま:</p> <ul> <li>関数の作成 (<code class=syntax>done()</code> または <code class=syntax>finalize()</code>）それは例外につながる可能性のあるすべての作業を事前に行います。 その関数が呼び出された場合、後でデストラクタに例外はないはずです。</li> <li>タスクも複雑で(メッセージを送信するなどのネットワーク)を置くことができます別の方法は、クラスのユーザーを呼び出す前に破壊.</li> <li>デストラクタに例外がある場合は、それを非表示にするよりもログに記録する方が良いでしょう（ロガーが利用可能な場合）。</li> <li>簡単な適用では、頼ることは受諾可能です <code class=syntax>std::terminate</code> （以下の場合 <code class=syntax>noexcept</code> デフォルトではc++11）例外を処理する。</li> </ul> <p><strong>6.</strong> 匿名コードブロック。</p> <p>特定の変数をローカルにするために、単一の関数内に別のコードブロックを作成して、ブロックを終了するときにデストラクターが呼び出されるようにす</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>Block</span> <span class=n>block</span> <span class=o>=</span> <span class=n>data</span><span class=p>.</span><span class=n>in</span><span class=o>-&gt;</span><span class=n>read</span><span class=p>();</span>

<span class=p>{</span>
    <span class=n>std</span><span class=o>::</span><span class=n>lock_guard</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>mutex</span><span class=o>&gt;</span> <span class=n>lock</span><span class=p>(</span><span class=n>mutex</span><span class=p>);</span>
    <span class=n>data</span><span class=p>.</span><span class=n>ready</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span>
    <span class=n>data</span><span class=p>.</span><span class=n>block</span> <span class=o>=</span> <span class=n>block</span><span class=p>;</span>
<span class=p>}</span>

<span class=n>ready_any</span><span class=p>.</span><span class=n>set</span><span class=p>();</span>
</code></pre></div> <p><strong>7.</strong> マルチスレッド</p> <p>オフライ:</p> <ul> <li>単一のCPUコアで可能な限り最高のパフォーマンスを得ようとします。 必要に応じて、コードを並列化できます。</li> </ul> <p>サーバーアプリ:</p> <ul> <li>スレッドプールを使用して要求を処理します。 この時点で、まだたタスクを必要とした管理コスイッチング時の値です。※</li> </ul> <p>Forkは並列化には使用されません。</p> <p><strong>8.</strong> 同期スレッド。</p> <p>くすることが可能で別のスレッドが別のメモリー細胞により異なるキャッシュ回線)を使用していないスレッドが同期を除く <code class=syntax>joinAll</code>).</p> <p>同期が必要な場合は、ほとんどの場合、以下の条件でmutexを使用すれば十分です <code class=syntax>lock_guard</code>.</p> <p>他の場合は、システム同期プリミティブを使用します。 Busy waitは使用しないでください。</p> <p>原子演算は、最も単純な場合にのみ使用する必要があります。</p> <p>主な専門分野でない限り、ロックフリーのデータ構造を実装しようとしないでください。</p> <p><strong>9.</strong> ポインタ対参照。</p> <p>ほとんどの場合、参照を好む。</p> <p><strong>10.</strong> const.</p> <p>定数参照、定数へのポインタを使用する, <code class=syntax>const_iterator</code>、およびconstメソッド。</p> <p>考慮する <code class=syntax>const</code> デフォルトで非を使用するには-<code class=syntax>const</code> 必要なときだけ。</p> <p>変数を値で渡すときは、 <code class=syntax>const</code> 通常は意味がありません。</p> <p><strong>11.</strong> 無署名</p> <p>使用 <code class=syntax>unsigned</code> 必要に応じて。</p> <p><strong>12.</strong> 数値型。</p> <p>タイプを使用する <code class=syntax>UInt8</code>, <code class=syntax>UInt16</code>, <code class=syntax>UInt32</code>, <code class=syntax>UInt64</code>, <code class=syntax>Int8</code>, <code class=syntax>Int16</code>, <code class=syntax>Int32</code>,and <code class=syntax>Int64</code> だけでなく、 <code class=syntax>size_t</code>, <code class=syntax>ssize_t</code>,and <code class=syntax>ptrdiff_t</code>.</p> <p>これらの型を数値に使用しないでください: <code class=syntax>signed/unsigned long</code>, <code class=syntax>long long</code>, <code class=syntax>short</code>, <code class=syntax>signed/unsigned char</code>, <code class=syntax>char</code>.</p> <p><strong>13.</strong> 引数を渡す。</p> <p>参照による複素数値の渡し(含む <code class=syntax>std::string</code>).</p> <p>関数がヒープ内に作成されたオブジェクトの所有権を取得する場合は、引数の型を作成します <code class=syntax>shared_ptr</code> または <code class=syntax>unique_ptr</code>.</p> <p><strong>14.</strong> 戻り値。</p> <p>ほとんどの場合、 <code class=syntax>return</code>. 書かない <code class=syntax>return std::move(res)</code>.</p> <p>関数がオブジェクトをヒープに割り当てて返す場合は、次のようにします <code class=syntax>shared_ptr</code> または <code class=syntax>unique_ptr</code>.</p> <p>まれに、引数を使用して値を返す必要がある場合があります。 この場合、引数は参照でなければなりません。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>using</span> <span class=n>AggregateFunctionPtr</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>shared_ptr</span><span class=o>&lt;</span><span class=n>IAggregateFunction</span><span class=o>&gt;</span><span class=p>;</span>

<span class=cm>/** Allows creating an aggregate function by its name.</span>
<span class=cm>  */</span>
<span class=k>class</span> <span class=nc>AggregateFunctionFactory</span>
<span class=p>{</span>
<span class=k>public</span><span class=o>:</span>
    <span class=n>AggregateFunctionFactory</span><span class=p>();</span>
    <span class=n>AggregateFunctionPtr</span> <span class=nf>get</span><span class=p>(</span><span class=k>const</span> <span class=n>String</span> <span class=o>&amp;</span> <span class=n>name</span><span class=p>,</span> <span class=k>const</span> <span class=n>DataTypes</span> <span class=o>&amp;</span> <span class=n>argument_types</span><span class=p>)</span> <span class=k>const</span><span class=p>;</span>
</code></pre></div> <p><strong>15.</strong> 名前空間。</p> <p>別のものを使用する必要はありません <code class=syntax>namespace</code> 適用コードのため。</p> <p>小さな図書館でもこれは必要ありません。</p> <p>中規模から大規模のライブラリの場合は、すべてを <code class=syntax>namespace</code>.</p> <p>図書館の <code class=syntax>.h</code> ファイル、使用できます <code class=syntax>namespace detail</code> アプリケーションコードに必要ない実装の詳細を非表示にする。</p> <p>で <code class=syntax>.cpp</code> を使用することができます <code class=syntax>static</code> またはシンボルを非表示にする匿名の名前空間。</p> <p>また、 <code class=syntax>namespace</code> に使用することができます <code class=syntax>enum</code> 対応する名前が外部に落ちないようにするには <code class=syntax>namespace</code> （しかし、それを使用する方が良いです <code class=syntax>enum class</code>).</p> <p><strong>16.</strong> 遅延初期化。</p> <p>初期化に引数が必要な場合は、通常は既定のコンストラクタを記述しないでください。</p> <p>後で初期化を遅らせる必要がある場合は、無効なオブジェクトを作成する既定のコンストラクターを追加できます。 または、少数のオブジェクトの場合は、以下を使用できます <code class=syntax>shared_ptr/unique_ptr</code>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>Loader</span><span class=p>(</span><span class=n>DB</span><span class=o>::</span><span class=n>Connection</span> <span class=o>*</span> <span class=n>connection_</span><span class=p>,</span> <span class=k>const</span> <span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=o>&amp;</span> <span class=n>query</span><span class=p>,</span> <span class=kt>size_t</span> <span class=n>max_block_size_</span><span class=p>);</span>

<span class=c1>/// For deferred initialization</span>
<span class=n>Loader</span><span class=p>()</span> <span class=p>{}</span>
</code></pre></div> <p><strong>17.</strong> 仮想関数。</p> <p>クラスが多態的な使用を意図していない場合、関数を仮想にする必要はありません。 これはデストラクタにも当てはまります。</p> <p><strong>18.</strong> エンコーディング</p> <p>どこでもUTF-8を使用します。 使用 <code class=syntax>std::string</code>と<code class=syntax>char *</code>. 使用しない <code class=syntax>std::wstring</code>と<code class=syntax>wchar_t</code>.</p> <p><strong>19.</strong> ロギング</p> <p>コードのどこでも例を参照してください。</p> <p>コミットする前に、無意味なログやデバッグログ、その他のデバッグ出力をすべて削除します。</p> <p>トレースレベルでも、サイクルのログインは避けるべきです。</p> <p>ログには必読でログインです。</p> <p>ログインできるアプリケーションコードにすることができます。</p> <p>ログメッセージは英語で書く必要があります。</p> <p>ログは、システム管理者が理解できるようにしてください。</p> <p>ログに冒涜を使用しないでください。</p> <p>ログでUTF-8エンコーディングを使用します。 まれに、ログに非ASCII文字を使用できます。</p> <p><strong>20.</strong> 入出力。</p> <p>使用しない <code class=syntax>iostreams</code> 内部のサイクルにおいて不可欠な存在であのためのアプリケーション性能(い利用 <code class=syntax>stringstream</code>).</p> <p>使用する <code class=syntax>DB/IO</code> 代わりに図書館。</p> <p><strong>21.</strong> 日付と時刻。</p> <p>を参照。 <code class=syntax>DateLUT</code> 図書館</p> <p><strong>22.</strong> 含める。</p> <p>常に使用 <code class=syntax>#pragma once</code> 代わりに警備員を含めます。</p> <p><strong>23.</strong> を使用して。</p> <p><code class=syntax>using namespace</code> は使用されません。 以下を使用できます <code class=syntax>using</code> 特定の何かと。 しかし、クラスや関数内でローカルにします。</p> <p><strong>24.</strong> 使用しない <code class=syntax>trailing return type</code> 必要がない限り機能のため。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>auto</span> <span class=n>f</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=kt>void</span>
</code></pre></div> <p><strong>25.</strong> 変数の宣言と初期化。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=c1>//right way</span>
<span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=n>s</span> <span class=o>=</span> <span class=s>"Hello"</span><span class=p>;</span>
<span class=n>std</span><span class=o>::</span><span class=n>string</span> <span class=n>s</span><span class=p>{</span><span class=s>"Hello"</span><span class=p>};</span>

<span class=c1>//wrong way</span>
<span class=k>auto</span> <span class=n>s</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=p>{</span><span class=s>"Hello"</span><span class=p>};</span>
</code></pre></div> <p><strong>26.</strong> のための仮想関数を書く <code class=syntax>virtual</code> 基本クラスでは、 <code class=syntax>override</code> 代わりに <code class=syntax>virtual</code> 子孫クラスで。</p> <h2 id=unused-features-of-c>C++の未使用の機能<a class=headerlink href=../amp/#unused-features-of-c title="Permanent link"> </a></h2> <p><strong>1.</strong> 仮想継承は使用されません。</p> <p><strong>2.</strong> C++03の例外指定子は使用されません。</p> <h2 id=platform>プラット<a class=headerlink href=../amp/#platform title="Permanent link"> </a></h2> <p><strong>1.</strong> を書いていますコードの特定の。</p> <p>それが同じ場合には、クロス-プラットフォームまたは携帯コードが好ましい。</p> <p><strong>2.</strong> 言語:C++20.</p> <p><strong>3.</strong> コンパイラ: <code class=syntax>gcc</code>. 2020年現在、コードはバージョン9.3を使用してコンパイルされている。 （以下を使ってコンパイルできます <code class=syntax>clang 8</code>.)</p> <p>標準ライブラリが使用されます (<code class=syntax>libc++</code>).</p> <p><strong>4.</strong>OS：LinuxのUbuntuの、正確よりも古いではありません。</p> <p><strong>5.</strong>コードはx86_64CPUアーキテクチャ用に書かれている。</p> <p>CPU命令セットは、サーバー間でサポートされる最小のセットです。 現在、SSE4.2です。</p> <p><strong>6.</strong> 使用 <code class=syntax>-Wall -Wextra -Werror</code> コンパイルフラグ。</p> <p><strong>7.</strong> 静的に接続することが困難なライブラリを除くすべてのライブラリとの静的リンクを使用します。 <code class=syntax>ldd</code> コマンド）。</p> <p><strong>8.</strong> コードはリリース設定で開発およびデバッグされます。</p> <h2 id=tools>ツール<a class=headerlink href=../amp/#tools title="Permanent link"> </a></h2> <p><strong>1.</strong> KDevelopは良いIDEです。</p> <p><strong>2.</strong> デバッグの使用 <code class=syntax>gdb</code>, <code class=syntax>valgrind</code> (<code class=syntax>memcheck</code>), <code class=syntax>strace</code>, <code class=syntax>-fsanitize=...</code>,または <code class=syntax>tcmalloc_minimal_debug</code>.</p> <p><strong>3.</strong> のためのプロファイリングを使用 <code class=syntax>Linux Perf</code>, <code class=syntax>valgrind</code> (<code class=syntax>callgrind</code>）、または <code class=syntax>strace -cf</code>.</p> <p><strong>4.</strong> ソースはGitにあります。</p> <p><strong>5.</strong> アセンブリの使用 <code class=syntax>CMake</code>.</p> <p><strong>6.</strong> プログラムは <code class=syntax>deb</code> パッケージ。</p> <p><strong>7.</strong> ることを約束し、マスターが破ってはいけないの。</p> <p>選択したリビジョンのみが実行可能とみなされます。</p> <p><strong>8.</strong> コードが部分的にしか準備できていなくても、できるだけ頻繁にコミットを行います。</p> <p>この目的のために分岐を使用します。</p> <p>あなたのコードが <code class=syntax>master</code> branchはまだビルド可能ではありません。 <code class=syntax>push</code>. あなたはそれを終了するか、数日以内にそれを削除する必要があります。</p> <p><strong>9.</strong> 些細な変更ではない場合は、ブランチを使用してサーバーに公開します。</p> <p><strong>10.</strong> 未使用のコードがリポジトリから削除されます。</p> <h2 id=libraries>図書館<a class=headerlink href=../amp/#libraries title="Permanent link"> </a></h2> <p><strong>1.</strong> C++20標準ライブラリが使用されています（実験的な拡張が許可されています）。 <code class=syntax>boost</code> と <code class=syntax>Poco</code> フレームワーク</p> <p><strong>2.</strong> 必要に応じて、OSパッケージで利用可能な既知のライブラリを使用できます。</p> <p>すでに利用可能な良い解決策がある場合は、別のライブラリをインストールする必要がある場合でも、それを使用してください。</p> <p>(が準備をしておいてくださ去の悪い図書館からのコードです。)</p> <p><strong>3.</strong> パッケージに必要なものがない場合や、古いバージョンや間違った種類のコンパイルがある場合は、パッケージにないライブラリをインストールできます。</p> <p><strong>4.</strong> ライブラリが小さく、独自の複雑なビルドシステムがない場合は、ソースファイルを <code class=syntax>contrib</code> フォルダ。</p> <p><strong>5.</strong> すでに使用されているライブラリが優先されます。</p> <h2 id=general-recommendations-1>一般的な推奨事項<a class=headerlink href=../amp/#general-recommendations-1 title="Permanent link"> </a></h2> <p><strong>1.</strong> できるだけ少ないコードを書く。</p> <p><strong>2.</strong> う最も単純な解決策です。</p> <p><strong>3.</strong> どのように動作し、内部ループがどのように機能するかを知るまで、コードを記述しないでください。</p> <p><strong>4.</strong> 最も単純なケースでは、 <code class=syntax>using</code> クラスや構造体の代わりに。</p> <p><strong>5.</strong> 可能であれば、コピーコンストラクター、代入演算子、デストラクター(クラスに少なくとも一つの仮想関数が含まれている場合は仮想関数を除く)、コンストラク つまり、コンパイラで生成された関数は正しく動作する必要があります。 以下を使用できます <code class=syntax>default</code>.</p> <p><strong>6.</strong> コードの簡素化が推奨されます。 可能であれば、コードのサイズを小さくします。</p> <h2 id=additional-recommendations>その他の推奨事項<a class=headerlink href=../amp/#additional-recommendations title="Permanent link"> </a></h2> <p><strong>1.</strong> 明示的に指定する <code class=syntax>std::</code> からのタイプのため <code class=syntax>stddef.h</code></p> <p>推奨されません。 つまり、書くことをお勧めします <code class=syntax>size_t</code> 代わりに <code class=syntax>std::size_t</code> それは短いので。</p> <p>追加することは許容されます <code class=syntax>std::</code>.</p> <p><strong>2.</strong> 明示的に指定する <code class=syntax>std::</code> 標準Cライブラリの関数の場合</p> <p>推奨されません。 言い換えれば、 <code class=syntax>memcpy</code> 代わりに <code class=syntax>std::memcpy</code>.</p> <p>その理由は、次のような非標準的な機能があるからです <code class=syntax>memmem</code>. 私たちは機会にこれらの機能を使用します。 これらの関数は、 <code class=syntax>namespace std</code>.</p> <p>あなたが書く場合 <code class=syntax>std::memcpy</code> 代わりに <code class=syntax>memcpy</code> どこでも、その後、 <code class=syntax>memmem</code> なし <code class=syntax>std::</code> 奇妙に見えます。</p> <p>それにもかかわらず、 <code class=syntax>std::</code> あなたがそれを好むなら。</p> <p><strong>3.</strong> 標準C++ライブラリで同じ関数が使用できる場合、Cからの関数を使用します。</p> <p>これは、より効率的であれば許容されます。</p> <p>たとえば、次を使用します <code class=syntax>memcpy</code> 代わりに <code class=syntax>std::copy</code> メモリの大きな塊をコピーするため。</p> <p><strong>4.</strong> 複数行の関数の引数。</p> <p>の他の包装のスタイルを許可:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>function</span><span class=p>(</span>
  <span class=n>T1</span> <span class=n>x1</span><span class=p>,</span>
  <span class=n>T2</span> <span class=n>x2</span><span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=n>function</span><span class=p>(</span>
  <span class=kt>size_t</span> <span class=n>left</span><span class=p>,</span> <span class=kt>size_t</span> <span class=n>right</span><span class=p>,</span>
  <span class=k>const</span> <span class=o>&amp;</span> <span class=n>RangesInDataParts</span> <span class=n>ranges</span><span class=p>,</span>
  <span class=kt>size_t</span> <span class=n>limit</span><span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=n>function</span><span class=p>(</span><span class=kt>size_t</span> <span class=n>left</span><span class=p>,</span> <span class=kt>size_t</span> <span class=n>right</span><span class=p>,</span>
  <span class=k>const</span> <span class=o>&amp;</span> <span class=n>RangesInDataParts</span> <span class=n>ranges</span><span class=p>,</span>
  <span class=kt>size_t</span> <span class=n>limit</span><span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=n>function</span><span class=p>(</span><span class=kt>size_t</span> <span class=n>left</span><span class=p>,</span> <span class=kt>size_t</span> <span class=n>right</span><span class=p>,</span>
      <span class=k>const</span> <span class=o>&amp;</span> <span class=n>RangesInDataParts</span> <span class=n>ranges</span><span class=p>,</span>
      <span class=kt>size_t</span> <span class=n>limit</span><span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=n>function</span><span class=p>(</span>
      <span class=kt>size_t</span> <span class=n>left</span><span class=p>,</span>
      <span class=kt>size_t</span> <span class=n>right</span><span class=p>,</span>
      <span class=k>const</span> <span class=o>&amp;</span> <span class=n>RangesInDataParts</span> <span class=n>ranges</span><span class=p>,</span>
      <span class=kt>size_t</span> <span class=n>limit</span><span class=p>)</span>
</code></pre></div> <p><a href=https://clickhouse.tech/docs/en/development/style/ target=_blank>元の記事</a> <!--hide--></p> </div> </div> <div class=row> <div class=col> <div class="alert alert-light my-3"> <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p> <span class="alert-heading display-6">Article Rating</span> <div id=rating-stars class="display-6 mb-0">RATING_STARS</div> </div> <div id=content-footer class="text-muted pt-3 mb-5"> <div class=float-md-right>©2016–2021 Yandex LLC</div> <div>Built from <a href=https://github.com/ClickHouse/ClickHouse/commit/878a159538935028f2d2dce3eb3074d44eb191df rel="external nofollow noreferrer" target=_blank class=text-reset>878a159538</a> </div> </div> </div> </div> <div id=to-full-website class="row fixed-bottom text-center bg-white py-3"> <div class=col> <a href=https://clickhouse.tech/docs/ja/development/style/ class="btn btn-lg btn-outline-orange">To full website</a> </div> </div> </div> <amp-analytics type=metrika> <script type=application/json>{
"vars": {
  "counterId": "18343495",
  "triggers": {
    "notBounce": {
      "on": "timer",
      "timerSpec": {
        "immediate": false,
        "interval": 15,
        "maxTimerLength": 16
      },
      "request": "notBounce"
    }
  }
}
}</script> </amp-analytics> </body> </html> 