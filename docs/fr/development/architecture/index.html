<!DOCTYPE html><html lang=fr data-version=master data-single-page=false> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Vue d'ensemble de L'Architecture ClickHouse | Documentation ClickHouse</title><link rel="shortcut icon" href=/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/images/logo-180x180.png><meta property=og:title content="Vue d'ensemble de L'Architecture ClickHouse | Documentation ClickHouse"><meta property=og:description content="Vue d'ensemble de L'Architecture ClickHouse ClickHouse est un véritable SGBD orienté colonne. Les données sont stockées "><meta property=og:type content=article><meta property=og:image content=https://clickhouse.tech/images/logo.png><meta content=https://clickhouse.tech/docs/fr/development/architecture/ property=og:url><link href=https://clickhouse.tech/docs/fr/development/architecture/ rel=canonical><link href=https://clickhouse.tech/docs/fr/development/architecture/amp/ rel=amphtml><link rel=search href=/opensearch.xml title=ClickHouse type=application/opensearchdescription+xml><script type=application/ld+json>[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "Vue d'ensemble de L'Architecture ClickHouse | Documentation ClickHouse",
"mainEntityOfPage": "https://clickhouse.tech/docs/fr/development/architecture/",




"image": "https://clickhouse.tech/images/logo-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "Yandex LLC",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.tech/images/yandex.png",
    "width": 163,
    "height": 60
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "Vue d'ensemble de L'Architecture ClickHouse | Documentation ClickHouse",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script><meta name=description content="Vue d'ensemble de L'Architecture ClickHouse ClickHouse est un véritable SGBD orienté colonne. Les données sont stockées "><meta name=keywords content="ClickHouse, DBMS, OLAP, SQL, open-source, relational, analytics, analytical, Big Data, web-analytics"><link rel=alternate href=https://clickhouse.tech/docs/en/development/architecture/ hreflang=en><link rel=alternate href=https://clickhouse.tech/docs/zh/development/architecture/ hreflang=zh><link rel=alternate href=https://clickhouse.tech/docs/es/development/architecture/ hreflang=es><link rel=alternate href=https://clickhouse.tech/docs/fr/development/architecture/ hreflang=fr><link rel=alternate href=https://clickhouse.tech/docs/ru/development/architecture/ hreflang=ru><link rel=alternate href=https://clickhouse.tech/docs/ja/development/architecture/ hreflang=ja><link rel=alternate href=https://clickhouse.tech/docs/en/development/architecture/ hreflang=x-default><link href=/css/base.css?e27f3458 media=all rel=stylesheet></head> <body dir=ltr data-spy=scroll data-target=#toc data-offset=80> <nav id=top-nav class="navbar navbar-dark navbar-expand-md bg-dark-alt text-white sticky-top"> <div class="container-fluid justify-content-between"> <a href=/ class="d-block navbar-brand mr-3"> <img id=docs-logo-icon src=/images/logo.svg alt="ClickHouse logo" title="ClickHouse logo"> </a> <div class="w-100 navbar-text text-left d-none d-md-block"> <h1 class="h3 m-0 p-0 d-inline"> <a href=# class="text-white text-decoration-none"> Vue d'ensemble de L'Architecture ClickHouse </a> </h1> </div> <div class="d-none d-md-block"> <ul class="navbar-nav ml-auto mt-2 mt-lg-0 justify-content-end"> <li id=edit-wrapper class=nav-item> <a id=edit-link href=https://github.com/ClickHouse/ClickHouse/edit/master/docs/fr/development/architecture.md title="Edit this article" class=nav-link rel="external nofollow noreferrer" target=_blank><img src=/images/mkdocs/edit.svg alt="Edit this article" class=mt-1 height=22></a> </li> <li class=nav-item> <a class=nav-link href=https://github.com/ClickHouse/ClickHouse rel="external nofollow noreferrer"> <img src=/images/index/github.svg alt="GitHub repository" title="Go to GitHub" height=32> </a> </li> <li id=languages-wrapper class="nav-item dropdown"> <div id=languages-dropdown> <a class="nav-link dropdown-toggle d-inline-block mt-1 text-muted" href=# id=lang-dropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false> <img src=/images/flags/fr.svg alt=Français title=Français width=32 class="d-inline-block mt-n1"> </a> <div class="dropdown-menu bg-dark" aria-labelledby=lang-dropdown> <a href=/docs/en/development/architecture/ class=dropdown-item> <img src=/images/flags/en.svg alt title width=32 class="d-inline-block mr-2">English </a> <a href=/docs/zh/development/architecture/ class=dropdown-item> <img src=/images/flags/zh.svg alt title width=32 class="d-inline-block mr-2">中文 </a> <a href=/docs/es/development/architecture/ class=dropdown-item> <img src=/images/flags/es.svg alt title width=32 class="d-inline-block mr-2">Español </a> <a href=/docs/fr/development/architecture/ class="dropdown-item disabled"> <img src=/images/flags/fr.svg alt title width=32 class="d-inline-block mr-2">Français </a> <a href=/docs/ru/development/architecture/ class=dropdown-item> <img src=/images/flags/ru.svg alt title width=32 class="d-inline-block mr-2">Русский </a> <a href=/docs/ja/development/architecture/ class=dropdown-item> <img src=/images/flags/ja.svg alt title width=32 class="d-inline-block mr-2">日本語 </a> </div> </div> </li> </ul> </div> <form id=search-form class="form-inline m-0"> <div class=input-group> <div class="input-group-prepend w-100"> <span class="input-group-text bg-secondary-alt text-muted border-0 mr-n1" id=search-icon> <img src=/images/mkdocs/search.svg> </span> <input id=docsearch-input class="form-control bg-secondary-alt text-muted border-0 pl-1" type=search placeholder=Search aria-label=Search> </div> </div> </form> <button id=navbar-toggler class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#sidebar aria-controls=sidebar aria-expanded=false aria-label="Toggle navigation"> <span class=navbar-toggler-icon></span> </button> </div> </nav> <div class=container-fluid> <div class="row justify-content-end justify-content-xl-center"> <div id=sidebar class="col-xl-2 col-md-4 bg-secondary-alt p-3 d-print-none min-vh-100 overflow-auto"> <div class=overflow-auto> <div id=single-page-switch class="btn-group mb-2 float-right" role=group aria-label="Multi-page or single-page"> <a href=../.. role=button class="btn btn-dark active" aria-pressed=true> <img src=/images/mkdocs/multi.svg alt="Multi-page version" title="Multi-page version"> </a> <a href=../../single/ role=button class="btn btn-dark-alt active" aria-pressed=true> <img src=/images/mkdocs/single.svg alt="Single-page version" title="Single-page version"> </a> </div> <nav id=sidebar-nav class="nav flex-column mb-5"> <a href=#sidebar-sidebar-1 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-1 title=Introduction class="nav-link text-light dropdown-toggle px-0">Introduction</a> <div id=sidebar-sidebar-1 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../ title=Aperçu class="nav-link text-light text-wrap d-inline-block w-100 px-0">Aperçu</a> <a href=../../introduction/distinctive-features/ title=particularité class="nav-link text-light text-wrap d-inline-block w-100 px-0">particularité</a> <a href=../../introduction/performance/ title=Performance class="nav-link text-light text-wrap d-inline-block w-100 px-0">Performance</a> <a href=../../introduction/history/ title=Histoire class="nav-link text-light text-wrap d-inline-block w-100 px-0">Histoire</a> <a href=../../introduction/adopters/ title=Adoptant class="nav-link text-light text-wrap d-inline-block w-100 px-0">Adoptant</a> </nav> </div> <a href=#sidebar-sidebar-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-2 title="Prise En Main" class="nav-link text-light dropdown-toggle px-0">Prise En Main</a> <div id=sidebar-sidebar-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../getting-started/install/ title=Installation class="nav-link text-light text-wrap d-inline-block w-100 px-0">Installation</a> <a href=#sidebar-sidebar-2-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-2-3 title="Exemple De Jeux De Données" class="nav-link text-light dropdown-toggle px-0">Exemple De Jeux De Données</a> <div id=sidebar-sidebar-2-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../getting-started/example-datasets/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../getting-started/example-datasets/metrica/ title="Yandex.Metrica De Données" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Yandex.Metrica De Données</a> <a href=../../getting-started/example-datasets/ontime/ title=OnTime class="nav-link text-light text-wrap d-inline-block w-100 px-0">OnTime</a> <a href=../../getting-started/example-datasets/nyc-taxi/ title="New York Taxi Données" class="nav-link text-light text-wrap d-inline-block w-100 px-0">New York Taxi Données</a> <a href=../../getting-started/example-datasets/amplab-benchmark/ title="AMPLab Big Data Benchmark" class="nav-link text-light text-wrap d-inline-block w-100 px-0">AMPLab Big Data Benchmark</a> <a href=../../getting-started/example-datasets/wikistat/ title=WikiStat class="nav-link text-light text-wrap d-inline-block w-100 px-0">WikiStat</a> <a href=../../getting-started/example-datasets/criteo/ title="Téraoctet click Logs de Criteo" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Téraoctet click Logs de Criteo</a> <a href=../../getting-started/example-datasets/star-schema/ title="Référence Du Schéma En Étoile" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Référence Du Schéma En Étoile</a> </nav> </div> <a href=../../getting-started/tutorial/ title=Tutoriel class="nav-link text-light text-wrap d-inline-block w-100 px-0">Tutoriel</a> <a href=../../getting-started/playground/ title=Récréation class="nav-link text-light text-wrap d-inline-block w-100 px-0">Récréation</a> </nav> </div> <a href=#sidebar-sidebar-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3 title=Interface class="nav-link text-light dropdown-toggle px-0">Interface</a> <div id=sidebar-sidebar-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../interfaces/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../interfaces/cli/ title="Client De Ligne De Commande" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Client De Ligne De Commande</a> <a href=../../interfaces/tcp/ title="Interface Native (TCP)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Interface Native (TCP)</a> <a href=../../interfaces/http/ title="Interface HTTP" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Interface HTTP</a> <a href=../../interfaces/mysql/ title="Interface MySQL" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Interface MySQL</a> <a href=../../interfaces/formats/ title="Formats d'entrée et de sortie" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Formats d'entrée et de sortie</a> <a href=../../interfaces/jdbc/ title=JDBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">JDBC</a> <a href=../../interfaces/odbc/ title="Pilote ODBC" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Pilote ODBC</a> <a href=../../interfaces/cpp/ title="Bibliothèque Client C++" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Bibliothèque Client C++</a> <a href=#sidebar-sidebar-3-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3-10 title=tiers class="nav-link text-light dropdown-toggle px-0">tiers</a> <div id=sidebar-sidebar-3-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../interfaces/third-party/client-libraries/ title="Bibliothèques Clientes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Bibliothèques Clientes</a> <a href=../../interfaces/third-party/integrations/ title=Intégration class="nav-link text-light text-wrap d-inline-block w-100 px-0">Intégration</a> <a href=../../interfaces/third-party/gui/ title="Les Interfaces Visuelles" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Les Interfaces Visuelles</a> <a href=../../interfaces/third-party/proxy/ title=Proxy class="nav-link text-light text-wrap d-inline-block w-100 px-0">Proxy</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4 title=Moteur class="nav-link text-light dropdown-toggle px-0">Moteur</a> <div id=sidebar-sidebar-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=#sidebar-sidebar-4-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-2 title="Moteurs De Table" class="nav-link text-light dropdown-toggle px-0">Moteurs De Table</a> <div id=sidebar-sidebar-4-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../engines/table-engines/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=#sidebar-sidebar-4-2-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-2-2 title="Famille MergeTree" class="nav-link text-light dropdown-toggle px-0">Famille MergeTree</a> <div id=sidebar-sidebar-4-2-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../engines/table-engines/mergetree-family/mergetree/ title=MergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">MergeTree</a> <a href=../../engines/table-engines/mergetree-family/replication/ title="Réplication Des Données" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Réplication Des Données</a> <a href=../../engines/table-engines/mergetree-family/custom-partitioning-key/ title="Clé De Partitionnement Personnalisée" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Clé De Partitionnement Personnalisée</a> <a href=../../engines/table-engines/mergetree-family/replacingmergetree/ title=ReplacingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">ReplacingMergeTree</a> <a href=../../engines/table-engines/mergetree-family/summingmergetree/ title=SummingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">SummingMergeTree</a> <a href=../../engines/table-engines/mergetree-family/aggregatingmergetree/ title=AggregatingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">AggregatingMergeTree</a> <a href=../../engines/table-engines/mergetree-family/collapsingmergetree/ title=CollapsingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">CollapsingMergeTree</a> <a href=../../engines/table-engines/mergetree-family/versionedcollapsingmergetree/ title=VersionedCollapsingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">VersionedCollapsingMergeTree</a> <a href=../../engines/table-engines/mergetree-family/graphitemergetree/ title=GraphiteMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">GraphiteMergeTree</a> </nav> </div> <a href=#sidebar-sidebar-4-2-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-2-3 title=Intégration class="nav-link text-light dropdown-toggle px-0">Intégration</a> <div id=sidebar-sidebar-4-2-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../engines/table-engines/integrations/kafka/ title=Kafka class="nav-link text-light text-wrap d-inline-block w-100 px-0">Kafka</a> <a href=../../engines/table-engines/integrations/mysql/ title=MySQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQL</a> <a href=../../engines/table-engines/integrations/jdbc/ title=JDBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">JDBC</a> <a href=../../engines/table-engines/integrations/odbc/ title=ODBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">ODBC</a> <a href=../../engines/table-engines/integrations/hdfs/ title=HDFS class="nav-link text-light text-wrap d-inline-block w-100 px-0">HDFS</a> </nav> </div> <a href=#sidebar-sidebar-4-2-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-2-4 title=Spécial class="nav-link text-light dropdown-toggle px-0">Spécial</a> <div id=sidebar-sidebar-4-2-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../engines/table-engines/special/distributed/ title=Distribué class="nav-link text-light text-wrap d-inline-block w-100 px-0">Distribué</a> <a href=../../engines/table-engines/special/external-data/ title="De données externes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">De données externes</a> <a href=../../engines/table-engines/special/dictionary/ title=Dictionnaire class="nav-link text-light text-wrap d-inline-block w-100 px-0">Dictionnaire</a> <a href=../../engines/table-engines/special/merge/ title=Fusionner class="nav-link text-light text-wrap d-inline-block w-100 px-0">Fusionner</a> <a href=../../engines/table-engines/special/file/ title=Fichier class="nav-link text-light text-wrap d-inline-block w-100 px-0">Fichier</a> <a href=../../engines/table-engines/special/null/ title=NULL class="nav-link text-light text-wrap d-inline-block w-100 px-0">NULL</a> <a href=../../engines/table-engines/special/set/ title=Définir class="nav-link text-light text-wrap d-inline-block w-100 px-0">Définir</a> <a href=../../engines/table-engines/special/join/ title=Rejoindre class="nav-link text-light text-wrap d-inline-block w-100 px-0">Rejoindre</a> <a href=../../engines/table-engines/special/url/ title=URL class="nav-link text-light text-wrap d-inline-block w-100 px-0">URL</a> <a href=../../engines/table-engines/special/view/ title=Vue class="nav-link text-light text-wrap d-inline-block w-100 px-0">Vue</a> <a href=../../engines/table-engines/special/materializedview/ title=MaterializedView class="nav-link text-light text-wrap d-inline-block w-100 px-0">MaterializedView</a> <a href=../../engines/table-engines/special/memory/ title=Mémoire class="nav-link text-light text-wrap d-inline-block w-100 px-0">Mémoire</a> <a href=../../engines/table-engines/special/buffer/ title=Tampon class="nav-link text-light text-wrap d-inline-block w-100 px-0">Tampon</a> <a href=../../engines/table-engines/special/generate/ title=GenerateRandom class="nav-link text-light text-wrap d-inline-block w-100 px-0">GenerateRandom</a> </nav> </div> <a href=#sidebar-sidebar-4-2-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-2-5 title="Journal De La Famille" class="nav-link text-light dropdown-toggle px-0">Journal De La Famille</a> <div id=sidebar-sidebar-4-2-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../engines/table-engines/log-family/stripelog/ title=StripeLog class="nav-link text-light text-wrap d-inline-block w-100 px-0">StripeLog</a> <a href=../../engines/table-engines/log-family/log/ title=Journal class="nav-link text-light text-wrap d-inline-block w-100 px-0">Journal</a> <a href=../../engines/table-engines/log-family/tinylog/ title=TinyLog class="nav-link text-light text-wrap d-inline-block w-100 px-0">TinyLog</a> <a href=../../engines/table-engines/log-family/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-4-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-3 title="Moteurs De Base De Données" class="nav-link text-light dropdown-toggle px-0">Moteurs De Base De Données</a> <div id=sidebar-sidebar-4-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../engines/database-engines/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../engines/database-engines/mysql/ title=MySQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQL</a> <a href=../../engines/database-engines/lazy/ title=Paresseux class="nav-link text-light text-wrap d-inline-block w-100 px-0">Paresseux</a> <a href=../../engines/database-engines/atomic/ title=Atomic class="nav-link text-light text-wrap d-inline-block w-100 px-0">Atomic</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5 title="Référence SQL" class="nav-link text-light dropdown-toggle px-0">Référence SQL</a> <div id=sidebar-sidebar-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=#sidebar-sidebar-5-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2 title=Déclaration class="nav-link text-light dropdown-toggle px-0">Déclaration</a> <div id=sidebar-sidebar-5-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=#sidebar-sidebar-5-2-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2-2 title=SELECT class="nav-link text-light dropdown-toggle px-0">SELECT</a> <div id=sidebar-sidebar-5-2-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/statements/select/ title=SELECT class="nav-link text-light text-wrap d-inline-block w-100 px-0">SELECT</a> <a href=../../sql-reference/statements/select/with/ title="AVEC la Clause" class="nav-link text-light text-wrap d-inline-block w-100 px-0">AVEC la Clause</a> <a href=../../sql-reference/statements/select/group-by/ title="Clause GROUP BY" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Clause GROUP BY</a> <a href=../../sql-reference/statements/select/having/ title="Clause HAVING" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Clause HAVING</a> <a href=../../sql-reference/statements/select/limit/ title="Clause LIMIT" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Clause LIMIT</a> <a href=../../sql-reference/statements/select/order-by/ title="Clause ORDER BY" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Clause ORDER BY</a> <a href=../../sql-reference/statements/select/prewhere/ title="Clause PREWHERE" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Clause PREWHERE</a> <a href=../../sql-reference/statements/select/union/ title="Clause UNION ALL" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Clause UNION ALL</a> <a href=../../sql-reference/statements/select/join/ title="Clause de JOINTURE" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Clause de JOINTURE</a> <a href=../../sql-reference/statements/select/array-join/ title="Clause de jointure de tableau" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Clause de jointure de tableau</a> <a href=../../sql-reference/statements/select/where/ title="Clause where" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Clause where</a> <a href=../../sql-reference/statements/select/into-outfile/ title="Dans OUTFILE Clause" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Dans OUTFILE Clause</a> <a href=../../sql-reference/statements/select/from/ title="De la Clause" class="nav-link text-light text-wrap d-inline-block w-100 px-0">De la Clause</a> <a href=../../sql-reference/statements/select/sample/ title="Exemple de Clause" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Exemple de Clause</a> <a href=../../sql-reference/statements/select/format/ title="FORMAT de la Clause" class="nav-link text-light text-wrap d-inline-block w-100 px-0">FORMAT de la Clause</a> <a href=../../sql-reference/statements/select/distinct/ title="La Clause DISTINCT" class="nav-link text-light text-wrap d-inline-block w-100 px-0">La Clause DISTINCT</a> <a href=../../sql-reference/statements/select/limit-by/ title="Limite par Clause" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Limite par Clause</a> </nav> </div> <a href=../../sql-reference/statements/insert-into/ title="INSERT INTO" class="nav-link text-light text-wrap d-inline-block w-100 px-0">INSERT INTO</a> <a href=../../sql-reference/statements/create/ title=CREATE class="nav-link text-light text-wrap d-inline-block w-100 px-0">CREATE</a> <a href=../../sql-reference/statements/alter/ title=ALTER class="nav-link text-light text-wrap d-inline-block w-100 px-0">ALTER</a> <a href=../../sql-reference/statements/system/ title=SYSTEM class="nav-link text-light text-wrap d-inline-block w-100 px-0">SYSTEM</a> <a href=../../sql-reference/statements/show/ title=SHOW class="nav-link text-light text-wrap d-inline-block w-100 px-0">SHOW</a> <a href=../../sql-reference/statements/grant/ title=GRANT class="nav-link text-light text-wrap d-inline-block w-100 px-0">GRANT</a> <a href=../../sql-reference/statements/revoke/ title=REVOKE class="nav-link text-light text-wrap d-inline-block w-100 px-0">REVOKE</a> <a href=../../sql-reference/statements/misc/ title=Autre class="nav-link text-light text-wrap d-inline-block w-100 px-0">Autre</a> </nav> </div> <a href=../../sql-reference/syntax/ title=Syntaxe class="nav-link text-light text-wrap d-inline-block w-100 px-0">Syntaxe</a> <a href=#sidebar-sidebar-5-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-4 title=Fonction class="nav-link text-light dropdown-toggle px-0">Fonction</a> <div id=sidebar-sidebar-5-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/functions/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../sql-reference/functions/arithmetic-functions/ title=Arithmétique class="nav-link text-light text-wrap d-inline-block w-100 px-0">Arithmétique</a> <a href=../../sql-reference/functions/comparison-functions/ title=Comparaison class="nav-link text-light text-wrap d-inline-block w-100 px-0">Comparaison</a> <a href=../../sql-reference/functions/logical-functions/ title=Logique class="nav-link text-light text-wrap d-inline-block w-100 px-0">Logique</a> <a href=../../sql-reference/functions/type-conversion-functions/ title="La Conversion De Type" class="nav-link text-light text-wrap d-inline-block w-100 px-0">La Conversion De Type</a> <a href=../../sql-reference/functions/date-time-functions/ title="Travailler avec les Dates et les heures" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec les Dates et les heures</a> <a href=../../sql-reference/functions/string-functions/ title="Travailler avec des chaînes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec des chaînes</a> <a href=../../sql-reference/functions/string-search-functions/ title="Pour Rechercher Des Chaînes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Pour Rechercher Des Chaînes</a> <a href=../../sql-reference/functions/string-replace-functions/ title="Pour remplacer dans les chaînes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Pour remplacer dans les chaînes</a> <a href=../../sql-reference/functions/conditional-functions/ title=Conditionnel class="nav-link text-light text-wrap d-inline-block w-100 px-0">Conditionnel</a> <a href=../../sql-reference/functions/math-functions/ title=Mathématique class="nav-link text-light text-wrap d-inline-block w-100 px-0">Mathématique</a> <a href=../../sql-reference/functions/rounding-functions/ title=Arrondi class="nav-link text-light text-wrap d-inline-block w-100 px-0">Arrondi</a> <a href=../../sql-reference/functions/array-functions/ title="Travailler avec des tableaux" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec des tableaux</a> <a href=../../sql-reference/functions/splitting-merging-functions/ title="Fractionnement et fusion de chaînes et de tableaux" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Fractionnement et fusion de chaînes et de tableaux</a> <a href=../../sql-reference/functions/bit-functions/ title=Bit class="nav-link text-light text-wrap d-inline-block w-100 px-0">Bit</a> <a href=../../sql-reference/functions/bitmap-functions/ title=Bitmap class="nav-link text-light text-wrap d-inline-block w-100 px-0">Bitmap</a> <a href=../../sql-reference/functions/hash-functions/ title=Hachage class="nav-link text-light text-wrap d-inline-block w-100 px-0">Hachage</a> <a href=../../sql-reference/functions/random-functions/ title="La Génération De Nombres Pseudo-Aléatoires" class="nav-link text-light text-wrap d-inline-block w-100 px-0">La Génération De Nombres Pseudo-Aléatoires</a> <a href=../../sql-reference/functions/encoding-functions/ title=Encodage class="nav-link text-light text-wrap d-inline-block w-100 px-0">Encodage</a> <a href=../../sql-reference/functions/uuid-functions/ title="Travailler avec UUID" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec UUID</a> <a href=../../sql-reference/functions/url-functions/ title="Travailler avec des URL" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec des URL</a> <a href=../../sql-reference/functions/ip-address-functions/ title="Travailler avec des adresses IP" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec des adresses IP</a> <a href=../../sql-reference/functions/json-functions/ title="Travailler avec JSON" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec JSON</a> <a href=../../sql-reference/functions/higher-order-functions/ title="D'Ordre Supérieur" class="nav-link text-light text-wrap d-inline-block w-100 px-0">D'Ordre Supérieur</a> <a href=../../sql-reference/functions/ext-dict-functions/ title="Travailler avec des dictionnaires externes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec des dictionnaires externes</a> <a href=../../sql-reference/functions/ym-dict-functions/ title="Travailler avec Yandex.Dictionnaires Metrica" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec Yandex.Dictionnaires Metrica</a> <a href=../../sql-reference/functions/in-functions/ title="Mise en œuvre de L'opérateur IN" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Mise en œuvre de L'opérateur IN</a> <a href=../../sql-reference/functions/array-join/ title=arrayJoin class="nav-link text-light text-wrap d-inline-block w-100 px-0">arrayJoin</a> <a href=../../sql-reference/functions/geo/ title="Travailler avec des coordonnées géographiques" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec des coordonnées géographiques</a> <a href=../../sql-reference/functions/functions-for-nulls/ title="Travailler avec des arguments nullables" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Travailler avec des arguments nullables</a> <a href=../../sql-reference/functions/machine-learning-functions/ title="Fonctions D'Apprentissage Automatique" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Fonctions D'Apprentissage Automatique</a> <a href=../../sql-reference/functions/introspection/ title=Introspection class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introspection</a> <a href=../../sql-reference/functions/other-functions/ title=Autre class="nav-link text-light text-wrap d-inline-block w-100 px-0">Autre</a> </nav> </div> <a href=#sidebar-sidebar-5-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-5 title="Les Fonctions D'Agrégation" class="nav-link text-light dropdown-toggle px-0">Les Fonctions D'Agrégation</a> <div id=sidebar-sidebar-5-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/aggregate-functions/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../sql-reference/aggregate-functions/reference/ title=Référence class="nav-link text-light text-wrap d-inline-block w-100 px-0">Référence</a> <a href=../../sql-reference/aggregate-functions/combinators/ title=Combinators class="nav-link text-light text-wrap d-inline-block w-100 px-0">Combinators</a> <a href=../../sql-reference/aggregate-functions/parametric-functions/ title=Paramétrique class="nav-link text-light text-wrap d-inline-block w-100 px-0">Paramétrique</a> </nav> </div> <a href=#sidebar-sidebar-5-6 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-6 title="Les Fonctions De Table" class="nav-link text-light dropdown-toggle px-0">Les Fonctions De Table</a> <div id=sidebar-sidebar-5-6 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/table-functions/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../sql-reference/table-functions/file/ title=fichier class="nav-link text-light text-wrap d-inline-block w-100 px-0">fichier</a> <a href=../../sql-reference/table-functions/merge/ title=fusionner class="nav-link text-light text-wrap d-inline-block w-100 px-0">fusionner</a> <a href=../../sql-reference/table-functions/numbers/ title=nombre class="nav-link text-light text-wrap d-inline-block w-100 px-0">nombre</a> <a href=../../sql-reference/table-functions/remote/ title=distant class="nav-link text-light text-wrap d-inline-block w-100 px-0">distant</a> <a href=../../sql-reference/table-functions/url/ title=URL class="nav-link text-light text-wrap d-inline-block w-100 px-0">URL</a> <a href=../../sql-reference/table-functions/mysql/ title=mysql class="nav-link text-light text-wrap d-inline-block w-100 px-0">mysql</a> <a href=../../sql-reference/table-functions/jdbc/ title=jdbc class="nav-link text-light text-wrap d-inline-block w-100 px-0">jdbc</a> <a href=../../sql-reference/table-functions/odbc/ title=ODBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">ODBC</a> <a href=../../sql-reference/table-functions/hdfs/ title=hdfs class="nav-link text-light text-wrap d-inline-block w-100 px-0">hdfs</a> <a href=../../sql-reference/table-functions/input/ title=entrée class="nav-link text-light text-wrap d-inline-block w-100 px-0">entrée</a> <a href=../../sql-reference/table-functions/generate/ title=generateRandom class="nav-link text-light text-wrap d-inline-block w-100 px-0">generateRandom</a> </nav> </div> <a href=#sidebar-sidebar-5-7 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-7 title=Dictionnaire class="nav-link text-light dropdown-toggle px-0">Dictionnaire</a> <div id=sidebar-sidebar-5-7 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/dictionaries/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=#sidebar-sidebar-5-7-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-7-2 title="Dictionnaires Externes" class="nav-link text-light dropdown-toggle px-0">Dictionnaires Externes</a> <div id=sidebar-sidebar-5-7-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/dictionaries/external-dictionaries/external-dicts/ title="Description Générale" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Description Générale</a> <a href=../../sql-reference/dictionaries/external-dictionaries/external-dicts-dict/ title="Configuration D'un dictionnaire externe" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Configuration D'un dictionnaire externe</a> <a href=../../sql-reference/dictionaries/external-dictionaries/external-dicts-dict-layout/ title="Stockage des dictionnaires en mémoire" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Stockage des dictionnaires en mémoire</a> <a href=../../sql-reference/dictionaries/external-dictionaries/external-dicts-dict-lifetime/ title="Mises À Jour Du Dictionnaire" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Mises À Jour Du Dictionnaire</a> <a href=../../sql-reference/dictionaries/external-dictionaries/external-dicts-dict-sources/ title="Sources de dictionnaires externes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Sources de dictionnaires externes</a> <a href=../../sql-reference/dictionaries/external-dictionaries/external-dicts-dict-structure/ title="Clé et champs du dictionnaire" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Clé et champs du dictionnaire</a> <a href=../../sql-reference/dictionaries/external-dictionaries/external-dicts-dict-hierarchical/ title="Dictionnaires hiérarchiques" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Dictionnaires hiérarchiques</a> </nav> </div> <a href=../../sql-reference/dictionaries/internal-dicts/ title="Dictionnaires Internes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Dictionnaires Internes</a> </nav> </div> <a href=#sidebar-sidebar-5-8 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-8 title=Opérateur class="nav-link text-light dropdown-toggle px-0">Opérateur</a> <div id=sidebar-sidebar-5-8 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/operators/ title=Opérateur class="nav-link text-light text-wrap d-inline-block w-100 px-0">Opérateur</a> <a href=../../sql-reference/operators/in/ title="Dans les opérateurs" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Dans les opérateurs</a> </nav> </div> <a href=#sidebar-sidebar-5-9 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-9 title="Types De Données" class="nav-link text-light dropdown-toggle px-0">Types De Données</a> <div id=sidebar-sidebar-5-9 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/data-types/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../sql-reference/data-types/int-uint/ title="UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64" class="nav-link text-light text-wrap d-inline-block w-100 px-0">UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64</a> <a href=../../sql-reference/data-types/float/ title="Float32, Float64" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Float32, Float64</a> <a href=../../sql-reference/data-types/decimal/ title=Décimal class="nav-link text-light text-wrap d-inline-block w-100 px-0">Décimal</a> <a href=../../sql-reference/data-types/boolean/ title=Booléen class="nav-link text-light text-wrap d-inline-block w-100 px-0">Booléen</a> <a href=../../sql-reference/data-types/string/ title=Chaîne class="nav-link text-light text-wrap d-inline-block w-100 px-0">Chaîne</a> <a href=../../sql-reference/data-types/fixedstring/ title="FixedString (N)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">FixedString (N)</a> <a href=../../sql-reference/data-types/uuid/ title=UUID class="nav-link text-light text-wrap d-inline-block w-100 px-0">UUID</a> <a href=../../sql-reference/data-types/date/ title=Date class="nav-link text-light text-wrap d-inline-block w-100 px-0">Date</a> <a href=../../sql-reference/data-types/datetime/ title=DateTime class="nav-link text-light text-wrap d-inline-block w-100 px-0">DateTime</a> <a href=../../sql-reference/data-types/datetime64/ title=DateTime64 class="nav-link text-light text-wrap d-inline-block w-100 px-0">DateTime64</a> <a href=../../sql-reference/data-types/enum/ title=Enum class="nav-link text-light text-wrap d-inline-block w-100 px-0">Enum</a> <a href=../../sql-reference/data-types/array/ title=Array(T) class="nav-link text-light text-wrap d-inline-block w-100 px-0">Array(T)</a> <a href=../../sql-reference/data-types/aggregatefunction/ title="AggregateFunction (nom, types_of_arguments...)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">AggregateFunction (nom, types_of_arguments...)</a> <a href=../../sql-reference/data-types/tuple/ title="Tuple (T1, T2,...)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Tuple (T1, T2,...)</a> <a href=../../sql-reference/data-types/nullable/ title=Nullable class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nullable</a> <a href=#sidebar-sidebar-5-9-17 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-9-17 title="Structures De Données Imbriquées" class="nav-link text-light dropdown-toggle px-0">Structures De Données Imbriquées</a> <div id=sidebar-sidebar-5-9-17 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/data-types/nested-data-structures/nested/ title="Imbriquée(Type1 Nom1, Nom2 Type2, ...)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Imbriquée(Type1 Nom1, Nom2 Type2, ...)</a> </nav> </div> <a href=#sidebar-sidebar-5-9-18 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-9-18 title="Types De Données Spéciaux" class="nav-link text-light dropdown-toggle px-0">Types De Données Spéciaux</a> <div id=sidebar-sidebar-5-9-18 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/data-types/special-data-types/expression/ title=Expression class="nav-link text-light text-wrap d-inline-block w-100 px-0">Expression</a> <a href=../../sql-reference/data-types/special-data-types/set/ title=Définir class="nav-link text-light text-wrap d-inline-block w-100 px-0">Définir</a> <a href=../../sql-reference/data-types/special-data-types/nothing/ title=Rien class="nav-link text-light text-wrap d-inline-block w-100 px-0">Rien</a> <a href=../../sql-reference/data-types/special-data-types/interval/ title=Intervalle class="nav-link text-light text-wrap d-inline-block w-100 px-0">Intervalle</a> </nav> </div> <a href=#sidebar-sidebar-5-9-19 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-9-19 title=Domaine class="nav-link text-light dropdown-toggle px-0">Domaine</a> <div id=sidebar-sidebar-5-9-19 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/data-types/domains/ title=Aperçu class="nav-link text-light text-wrap d-inline-block w-100 px-0">Aperçu</a> <a href=../../sql-reference/data-types/domains/ipv4/ title=IPv4 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IPv4</a> <a href=../../sql-reference/data-types/domains/ipv6/ title=IPv6 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IPv6</a> </nav> </div> <a href=../../sql-reference/data-types/simpleaggregatefunction/ title=SimpleAggregateFunction class="nav-link text-light text-wrap d-inline-block w-100 px-0">SimpleAggregateFunction</a> </nav> </div> <a href=../../sql-reference/ansi/ title="La Compatibilité ANSI" class="nav-link text-light text-wrap d-inline-block w-100 px-0">La Compatibilité ANSI</a> </nav> </div> <a href=#sidebar-sidebar-6 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6 title=Guide class="nav-link text-light dropdown-toggle px-0">Guide</a> <div id=sidebar-sidebar-6 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../guides/ title=Aperçu class="nav-link text-light text-wrap d-inline-block w-100 px-0">Aperçu</a> <a href=../../guides/apply-catboost-model/ title="Application Des Modèles CatBoost" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Application Des Modèles CatBoost</a> </nav> </div> <a href=#sidebar-sidebar-7 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7 title=Opérations class="nav-link text-light dropdown-toggle px-0">Opérations</a> <div id=sidebar-sidebar-7 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../operations/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../operations/requirements/ title=Exigence class="nav-link text-light text-wrap d-inline-block w-100 px-0">Exigence</a> <a href=../../operations/monitoring/ title=Surveiller class="nav-link text-light text-wrap d-inline-block w-100 px-0">Surveiller</a> <a href=../../operations/troubleshooting/ title=Dépannage class="nav-link text-light text-wrap d-inline-block w-100 px-0">Dépannage</a> <a href=../../operations/update/ title="Mise À Jour De ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Mise À Jour De ClickHouse</a> <a href=../../operations/access-rights/ title="Le Contrôle d'accès et de Gestion de Compte" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Le Contrôle d'accès et de Gestion de Compte</a> <a href=../../operations/backup/ title="La Sauvegarde Des Données" class="nav-link text-light text-wrap d-inline-block w-100 px-0">La Sauvegarde Des Données</a> <a href=../../operations/configuration-files/ title="Fichiers De Configuration" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Fichiers De Configuration</a> <a href=../../operations/quotas/ title=Quota class="nav-link text-light text-wrap d-inline-block w-100 px-0">Quota</a> <a href=../../operations/system-tables/ title="Les Tables Système" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Les Tables Système</a> <a href=#sidebar-sidebar-7-11 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7-11 title="Optimisation Des Performances" class="nav-link text-light dropdown-toggle px-0">Optimisation Des Performances</a> <div id=sidebar-sidebar-7-11 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../operations/optimizing-performance/sampling-query-profiler/ title="Profilage De Requête" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Profilage De Requête</a> </nav> </div> <a href=#sidebar-sidebar-7-12 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7-12 title="Paramètres De Configuration Du Serveur" class="nav-link text-light dropdown-toggle px-0">Paramètres De Configuration Du Serveur</a> <div id=sidebar-sidebar-7-12 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../operations/server-configuration-parameters/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../operations/server-configuration-parameters/settings/ title="Les Paramètres Du Serveur" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Les Paramètres Du Serveur</a> </nav> </div> <a href=../../operations/performance-test/ title="Tester Le Matériel" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Tester Le Matériel</a> <a href=#sidebar-sidebar-7-14 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7-14 title=Paramètre class="nav-link text-light dropdown-toggle px-0">Paramètre</a> <div id=sidebar-sidebar-7-14 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../operations/settings/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../operations/settings/permissions-for-queries/ title="Autorisations pour les requêtes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Autorisations pour les requêtes</a> <a href=../../operations/settings/query-complexity/ title="Restrictions sur la complexité des requêtes" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Restrictions sur la complexité des requêtes</a> <a href=../../operations/settings/settings-profiles/ title="Les Paramètres Des Profils" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Les Paramètres Des Profils</a> <a href=../../operations/settings/constraints-on-settings/ title="Contraintes sur les paramètres" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Contraintes sur les paramètres</a> <a href=../../operations/settings/settings-users/ title="Les Paramètres De L'Utilisateur" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Les Paramètres De L'Utilisateur</a> <a href=../../operations/settings/settings/ title=Paramètre class="nav-link text-light text-wrap d-inline-block w-100 px-0">Paramètre</a> </nav> </div> <a href=#sidebar-sidebar-7-15 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7-15 title=Utilitaire class="nav-link text-light dropdown-toggle px-0">Utilitaire</a> <div id=sidebar-sidebar-7-15 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../operations/utilities/ title=Aperçu class="nav-link text-light text-wrap d-inline-block w-100 px-0">Aperçu</a> <a href=../../operations/utilities/clickhouse-copier/ title=clickhouse-copieur class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-copieur</a> <a href=../../operations/utilities/clickhouse-local/ title=clickhouse-local class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-local</a> <a href=../../operations/utilities/clickhouse-benchmark/ title=clickhouse-benchmark class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-benchmark</a> </nav> </div> <a href=../../operations/tips/ title="Recommandations D'Utilisation" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Recommandations D'Utilisation</a> </nav> </div> <a href=#sidebar-sidebar-8 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8 title=Développement class="nav-link text-light dropdown-toggle px-0">Développement</a> <div id=sidebar-sidebar-8 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../development/developer-instruction/ title="Le Débutant Clickhouse Developer Instruction" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Le Débutant Clickhouse Developer Instruction</a> <a href=../../development/architecture/ title="Vue d'ensemble de L'Architecture ClickHouse" class="nav-link text-white active text-wrap d-inline-block w-100 px-0">Vue d'ensemble de L'Architecture ClickHouse</a> <a href=../../development/browse-code/ title="Parcourir Le Code Source" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Parcourir Le Code Source</a> <a href=../../development/build/ title="Comment Construire ClickHouse sur Linux" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Comment Construire ClickHouse sur Linux</a> <a href=../../development/build-osx/ title="Comment Construire ClickHouse sur Mac OS X" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Comment Construire ClickHouse sur Mac OS X</a> <a href=../../development/build-cross-osx/ title="Comment Construire ClickHouse sur Linux pour Mac OS X" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Comment Construire ClickHouse sur Linux pour Mac OS X</a> <a href=../../development/build-cross-arm/ title="Comment Construire ClickHouse sur Linux pour AARCH64 (ARM64)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Comment Construire ClickHouse sur Linux pour AARCH64 (ARM64)</a> <a href=../../development/style/ title="Comment écrire du Code C++" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Comment écrire du Code C++</a> <a href=../../development/tests/ title=Testing class="nav-link text-light text-wrap d-inline-block w-100 px-0">Testing</a> <a href=../../development/contrib/ title="Bibliothèques Tierces Utilisées" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Bibliothèques Tierces Utilisées</a> </nav> </div> <a href=#sidebar-sidebar-9 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-9 title=Commercial class="nav-link text-light dropdown-toggle px-0">Commercial</a> <div id=sidebar-sidebar-9 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../commercial/cloud/ title=Nuage class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nuage</a> <a href=../../commercial/support/ title=Soutien class="nav-link text-light text-wrap d-inline-block w-100 px-0">Soutien</a> </nav> </div> <a href=#sidebar-sidebar-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-10 title="Ce qui est Nouveau" class="nav-link text-light dropdown-toggle px-0">Ce qui est Nouveau</a> <div id=sidebar-sidebar-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=#sidebar-sidebar-10-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-10-2 title=Changelog class="nav-link text-light dropdown-toggle px-0">Changelog</a> <div id=sidebar-sidebar-10-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../whats-new/changelog/ title=2021 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2021</a> <a href=../../whats-new/changelog/2019/ title=2019 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2019</a> <a href=../../whats-new/changelog/2018/ title=2018 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2018</a> <a href=../../whats-new/changelog/2017/ title=2017 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2017</a> </nav> </div> <a href=../../whats-new/roadmap/ title="Feuille de route" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Feuille de route</a> <a href=../../whats-new/security-changelog/ title="Sécurité Changelog" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Sécurité Changelog</a> </nav> </div> <a href=#sidebar-sidebar-11 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-11 title=F.A.Q. class="nav-link text-light dropdown-toggle px-0">F.A.Q.</a> <div id=sidebar-sidebar-11 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../faq/general/ title="Questions Générales" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Questions Générales</a> </nav> </div> <a href=../../single/clickhouse_fr.pdf class="nav-link border-top border-secondary mt-3 px-0 pt-3 text-light"> <img src=/images/mkdocs/pdf.svg alt="PDF version" title="PDF version" height=24 class="d-block mr-1 float-left"><div>PDF version</div> </a> </nav> </div> </div> <div id=content-wrapper class="col-md-8 p-2 p-md-4"> <div id=content class=mt-md-n3> <nav class=text-muted aria-label=breadcrumb> <ol class="breadcrumb bg-transparent p-0"> <li class=breadcrumb-item><a href=../ class=text-reset>Développement</a> </li> </ol> </nav> <div class="alert alert-primary" role=alert> <p class="display-5 mb-2">Help wanted!</p> <p class=lead>The following content of this documentation page has been machine-translated. But unlike other websites, it is not done on the fly. This translated text lives on GitHub repository alongside main ClickHouse codebase and waits for fellow native speakers to make it more human-readable. <a href=/docs/en/development/architecture/ class=alert-link>You can also use the original English version as a reference.</a></p> <p class=lead> <a class="btn btn-lg btn-primary text-white" href=https://github.com/ClickHouse/ClickHouse/edit/master/docs/fr/development/architecture.md target=_blank rel="external nofollow noreferrer"> Help ClickHouse documentation by editing this page </a> </p> </div> <h1 id=overview-of-clickhouse-architecture>Vue d'ensemble de L'Architecture ClickHouse<a class=headerlink href=#overview-of-clickhouse-architecture title="Permanent link"> </a></h1> <p>ClickHouse est un véritable SGBD orienté colonne. Les données sont stockées par colonnes et lors de l'exécution de tableaux (vecteurs ou morceaux de colonnes). Dans la mesure du possible, les opérations sont distribuées sur des tableaux, plutôt que sur des valeurs individuelles. Il est appelé “vectorized query execution,” et cela aide à réduire le coût du traitement des données réel.</p> <blockquote> <p>Cette idée n'est pas nouvelle. Il remonte à la <code class=syntax>APL</code> langage de programmation et ses descendants: <code class=syntax>A +</code>, <code class=syntax>J</code>, <code class=syntax>K</code>, et <code class=syntax>Q</code>. La programmation de tableau est utilisée dans le traitement des données scientifiques. Cette idée n'est pas non plus nouvelle dans les bases de données relationnelles: par exemple, elle est utilisée dans le <code class=syntax>Vectorwise</code> système.</p> </blockquote> <p>Il existe deux approches différentes pour accélérer le traitement des requêtes: l'exécution vectorisée des requêtes et la génération de code d'exécution. Ce dernier supprime toute indirection et expédition dynamique. Aucune de ces approches est strictement meilleure que l'autre. La génération de code d'exécution peut être meilleure lorsqu'elle fusionne de nombreuses opérations, utilisant ainsi pleinement les unités D'exécution du processeur et le pipeline. L'exécution de requête vectorisée peut être moins pratique car elle implique des vecteurs temporaires qui doivent être écrits dans le cache et lus. Si les données temporaires ne rentre pas dans le cache L2, cela devient un problème. Mais l'exécution de requête vectorisée utilise plus facilement les capacités SIMD de la CPU. Un <a href=http://15721.courses.cs.cmu.edu/spring2016/papers/p5-sompolski.pdf rel="external nofollow noreferrer" target=_blank>document de recherche</a> écrit par nos amis montre qu'il est préférable de combiner les deux approches. ClickHouse utilise l'exécution de requête vectorisée et a un support initial limité pour la génération de code d'exécution.</p> <h2 id=columns>Colonne<a class=headerlink href=#columns title="Permanent link"> </a></h2> <p><code class=syntax>IColumn</code> l'interface est utilisée pour représenter des colonnes en mémoire (en fait, des morceaux de colonnes). Cette interface fournit des méthodes d'aide pour la mise en œuvre de divers opérateurs relationnels. Presque toutes les opérations sont immuables: elles ne modifient pas la colonne d'origine, mais en créent une nouvelle modifiée. Par exemple, l' <code class=syntax>IColumn :: filter</code> méthode accepte un masque d'octet de filtre. Il est utilisé pour le <code class=syntax>WHERE</code> et <code class=syntax>HAVING</code> opérateurs relationnels. Exemples supplémentaires: <code class=syntax>IColumn :: permute</code> méthode de soutien <code class=syntax>ORDER BY</code>, le <code class=syntax>IColumn :: cut</code> méthode de soutien <code class=syntax>LIMIT</code>.</p> <p>Divers <code class=syntax>IColumn</code> application (<code class=syntax>ColumnUInt8</code>, <code class=syntax>ColumnString</code> et ainsi de suite) sont responsables de la mémoire disposition de colonnes. La disposition de la mémoire est généralement un tableau contigu. Pour le type entier de colonnes, c'est juste un contiguë tableau, comme <code class=syntax>std :: vector</code>. Pour <code class=syntax>String</code> et <code class=syntax>Array</code> colonnes, il s'agit de deux vecteurs: Un pour tous les éléments du tableau, placé de manière contiguë, et un second pour les décalages au début de chaque tableau. Il y a aussi <code class=syntax>ColumnConst</code> cela stocke une seule valeur en mémoire, mais ressemble à une colonne.</p> <h2 id=field>Champ<a class=headerlink href=#field title="Permanent link"> </a></h2> <p>Néanmoins, il est possible de travailler avec des valeurs individuelles ainsi. Pour représenter une valeur individuelle, la <code class=syntax>Field</code> est utilisée. <code class=syntax>Field</code> est juste une union discriminée de <code class=syntax>UInt64</code>, <code class=syntax>Int64</code>, <code class=syntax>Float64</code>, <code class=syntax>String</code> et <code class=syntax>Array</code>. <code class=syntax>IColumn</code> a l' <code class=syntax>operator[]</code> méthode pour obtenir la n-ème valeur en tant que <code class=syntax>Field</code> et la <code class=syntax>insert</code> méthode pour ajouter un <code class=syntax>Field</code> à la fin d'une colonne. Ces méthodes ne sont pas très efficaces, car ils nécessitent de traiter avec temporaire <code class=syntax>Field</code> des objets représentant une valeur individuelle. Il existe des méthodes plus efficaces, telles que <code class=syntax>insertFrom</code>, <code class=syntax>insertRangeFrom</code> et ainsi de suite.</p> <p><code class=syntax>Field</code> ne pas avoir assez d'informations sur un type de données spécifique pour une table. Exemple, <code class=syntax>UInt8</code>, <code class=syntax>UInt16</code>, <code class=syntax>UInt32</code>, et <code class=syntax>UInt64</code> tous sont représentés comme <code class=syntax>UInt64</code> dans un <code class=syntax>Field</code>.</p> <h2 id=leaky-abstractions>Abstractions Qui Fuient<a class=headerlink href=#leaky-abstractions title="Permanent link"> </a></h2> <p><code class=syntax>IColumn</code> a des méthodes pour les transformations relationnelles communes des données, mais elles ne répondent pas à tous les besoins. Exemple, <code class=syntax>ColumnUInt64</code> ne pas avoir une méthode pour calculer la somme des deux colonnes, et <code class=syntax>ColumnString</code> n'a pas de méthode pour exécuter une recherche de sous-chaîne. Ces innombrables routines sont mises en œuvre en dehors de <code class=syntax>IColumn</code>.</p> <p>Diverses fonctions sur les colonnes peuvent être implémentées de manière générique et non efficace en utilisant <code class=syntax>IColumn</code> méthodes pour extraire <code class=syntax>Field</code> valeurs, ou d'une manière spécialisée en utilisant la connaissance de la disposition de la mémoire interne des données dans un <code class=syntax>IColumn</code> application. Il est implémenté en lançant des fonctions à un <code class=syntax>IColumn</code> tapez et traitez directement la représentation interne. Exemple, <code class=syntax>ColumnUInt64</code> a l' <code class=syntax>getData</code> méthode qui renvoie une référence à un tableau interne, puis une autre routine lit ou remplit ce tableau directement. Nous avons “leaky abstractions” permettent de spécialisations diverses routines.</p> <h2 id=data_types>Types De Données<a class=headerlink href=#data_types title="Permanent link"> </a></h2> <p><code class=syntax>IDataType</code> est responsable de la sérialisation et de la désérialisation: pour la lecture et l'écriture de morceaux de colonnes ou de valeurs individuelles sous forme binaire ou de texte. <code class=syntax>IDataType</code> correspond directement aux types de données dans les tables. Par exemple, il y a <code class=syntax>DataTypeUInt32</code>, <code class=syntax>DataTypeDateTime</code>, <code class=syntax>DataTypeString</code> et ainsi de suite.</p> <p><code class=syntax>IDataType</code> et <code class=syntax>IColumn</code> ne sont que faiblement liés les uns aux autres. Différents types de données peuvent être représentés en mémoire par le même <code class=syntax>IColumn</code> application. Exemple, <code class=syntax>DataTypeUInt32</code> et <code class=syntax>DataTypeDateTime</code> sont tous deux représentés par <code class=syntax>ColumnUInt32</code> ou <code class=syntax>ColumnConstUInt32</code>. En outre, le même type de données peut être représentée par différents <code class=syntax>IColumn</code> application. Exemple, <code class=syntax>DataTypeUInt8</code> peut être représenté par <code class=syntax>ColumnUInt8</code> ou <code class=syntax>ColumnConstUInt8</code>.</p> <p><code class=syntax>IDataType</code> stocke uniquement les métadonnées. Par exemple, <code class=syntax>DataTypeUInt8</code> ne stocke rien du tout (sauf vptr) et <code class=syntax>DataTypeFixedString</code> magasins juste <code class=syntax>N</code> (la taille des chaînes de taille fixe).</p> <p><code class=syntax>IDataType</code> a des méthodes d'aide pour différents formats de données. Des exemples sont des méthodes pour sérialiser une valeur avec des guillemets possibles, pour sérialiser une valeur pour JSON et pour sérialiser une valeur dans le format XML. Il n'y a pas de correspondance directe avec les formats de données. Par exemple, les différents formats de données <code class=syntax>Pretty</code> et <code class=syntax>TabSeparated</code> pouvez utiliser le même <code class=syntax>serializeTextEscaped</code> méthode d'aide à partir de la <code class=syntax>IDataType</code> interface.</p> <h2 id=block>Bloc<a class=headerlink href=#block title="Permanent link"> </a></h2> <p>A <code class=syntax>Block</code> est un conteneur qui représente un sous-ensemble (morceau) d'une table en mémoire. C'est juste un ensemble de triplets: <code class=syntax>(IColumn, IDataType, column name)</code>. Pendant l'exécution de la requête, les données sont traitées par <code class=syntax>Block</code>s. Si nous avons un <code class=syntax>Block</code>, nous disposons de données (dans le <code class=syntax>IColumn</code> objet), nous avons des informations sur son type (dans <code class=syntax>IDataType</code>) qui nous indique comment traiter cette colonne, et nous avons le nom de la colonne. Il peut s'agir du nom de colonne d'origine de la table ou d'un nom artificiel attribué pour obtenir des résultats temporaires de calculs.</p> <p>Lorsque nous calculons une fonction sur des colonnes dans un bloc, nous ajoutons une autre colonne avec son résultat au bloc, et nous ne touchons pas les colonnes pour les arguments de la fonction car les opérations sont immuables. Plus tard, les colonnes inutiles peuvent être supprimées du bloc, mais pas modifiées. Il est pratique pour l'élimination des sous-expressions communes.</p> <p>Des blocs sont créés pour chaque bloc de données traité. Notez que pour le même type de calcul, les noms et les types de colonnes restent les mêmes pour différents blocs, et seules les données de colonne changent. Il est préférable de diviser les données de bloc de l'en-tête de bloc car les petites tailles de Bloc ont une surcharge élevée de chaînes temporaires pour copier shared_ptrs et les noms de colonnes.</p> <h2 id=block-streams>Bloquer Les Flux<a class=headerlink href=#block-streams title="Permanent link"> </a></h2> <p>Les flux de blocs sont destinés au traitement des données. Nous utilisons des flux de blocs pour lire des données quelque part, effectuer des transformations de données ou écrire des données quelque part. <code class=syntax>IBlockInputStream</code> a l' <code class=syntax>read</code> méthode pour récupérer le bloc suivant, tandis que des. <code class=syntax>IBlockOutputStream</code> a l' <code class=syntax>write</code> méthode pour pousser le bloc quelque part.</p> <p>Les flux sont responsables de:</p> <ol> <li>De la lecture ou de l'écriture dans une table. La table renvoie simplement un flux pour lire ou écrire des blocs.</li> <li>Mise en œuvre des formats de données. Par exemple, si vous souhaitez envoyer des données vers un terminal <code class=syntax>Pretty</code> format, vous créez un flux de sortie de bloc où vous poussez des blocs, et il les formate.</li> <li>Effectuer des transformations de données. Disons que vous avez <code class=syntax>IBlockInputStream</code> et veulent créer un flux filtré. Vous créez <code class=syntax>FilterBlockInputStream</code> et l'initialiser avec votre flux de données. Puis quand vous tirez un bloc de <code class=syntax>FilterBlockInputStream</code>, il extrait un bloc de votre flux, le filtre et vous renvoie le bloc filtré. Les pipelines d'exécution des requêtes sont représentés de cette façon.</li> </ol> <p>Il y a des transformations plus sophistiquées. Par exemple, lorsque vous tirez de <code class=syntax>AggregatingBlockInputStream</code> il lit toutes les données à partir de sa source, agrégats, puis renvoie un flux de données agrégées pour vous. Un autre exemple: <code class=syntax>UnionBlockInputStream</code> accepte de nombreuses sources d'entrée dans le constructeur et également un certain nombre de threads. Il lance plusieurs threads et lit à partir de plusieurs sources en parallèle.</p> <blockquote> <p>Les flux de blocs utilisent le “pull” approche pour contrôler le flux: lorsque vous extrayez un bloc du premier flux, il extrait par conséquent les blocs requis des flux imbriqués, et l'ensemble du pipeline d'exécution fonctionnera. Ni “pull” ni “push” est la meilleure solution, car le flux de contrôle est implicite, ce qui limite l'implémentation de diverses fonctionnalités telles que l'exécution simultanée de plusieurs requêtes (fusion de plusieurs pipelines ensemble). Cette limitation pourrait être surmontée avec des coroutines ou simplement en exécutant des threads supplémentaires qui s'attendent les uns aux autres. Nous pouvons avoir plus de possibilités si nous rendons le flux de contrôle explicite: si nous localisons la logique pour passer des données d'une unité de calcul à une autre en dehors de ces unités de calcul. Lire ce <a href=http://journal.stuffwithstuff.com/2013/01/13/iteration-inside-and-out/ rel="external nofollow noreferrer" target=_blank>article</a> pour plus de pensées.</p> </blockquote> <p>Il convient de noter que le pipeline d'exécution de la requête crée des données temporaires à chaque étape. Nous essayons de garder la taille du bloc suffisamment petite pour que les données temporaires tiennent dans le cache du processeur. Avec cette hypothèse, l'écriture et la lecture de données temporaires sont presque libres en comparaison avec d'autres calculs. Nous pourrions envisager une alternative, qui est de fusionner de nombreuses opérations dans le pipeline ensemble. Cela pourrait rendre le pipeline aussi court que possible et supprimer une grande partie des données temporaires, ce qui pourrait être un avantage, mais cela présente également des inconvénients. Par exemple, un pipeline divisé facilite l'implémentation de la mise en cache de données intermédiaires, le vol de données intermédiaires à partir de requêtes similaires exécutées en même temps et la fusion de pipelines pour des requêtes similaires.</p> <h2 id=formats>Format<a class=headerlink href=#formats title="Permanent link"> </a></h2> <p>Les formats de données sont implémentés avec des flux de blocs. Il y a “presentational” formats appropriés uniquement pour la sortie de données vers le client, tels que <code class=syntax>Pretty</code> format, qui fournit seulement <code class=syntax>IBlockOutputStream</code>. Et il existe des formats d'entrée / sortie, tels que <code class=syntax>TabSeparated</code> ou <code class=syntax>JSONEachRow</code>.</p> <p>Il y a aussi des flux de lignes: <code class=syntax>IRowInputStream</code> et <code class=syntax>IRowOutputStream</code>. Ils vous permettent de tirer/pousser des données par des lignes individuelles, pas par des blocs. Et ils ne sont nécessaires que pour simplifier la mise en œuvre des formats orientés ligne. Wrapper <code class=syntax>BlockInputStreamFromRowInputStream</code> et <code class=syntax>BlockOutputStreamFromRowOutputStream</code> vous permet de convertir des flux orientés ligne en flux orientés blocs réguliers.</p> <h2 id=io>I/O<a class=headerlink href=#io title="Permanent link"> </a></h2> <p>Pour l'entrée/sortie orientée octet, il y a <code class=syntax>ReadBuffer</code> et <code class=syntax>WriteBuffer</code> les classes abstraites. Ils sont utilisés à la place de C++ <code class=syntax>iostream</code>s. Ne vous inquiétez pas: chaque projet c++ mature utilise autre chose que <code class=syntax>iostream</code>s pour de bonnes raisons.</p> <p><code class=syntax>ReadBuffer</code> et <code class=syntax>WriteBuffer</code> sont juste un tampon contigu et un curseur pointant vers la position dans ce tampon. Les implémentations peuvent posséder ou non la mémoire du tampon. Il existe une méthode virtuelle pour remplir le tampon avec les données suivantes (pour <code class=syntax>ReadBuffer</code>) ou pour vider le tampon quelque part (pour <code class=syntax>WriteBuffer</code>). Les méthodes virtuelles sont rarement cités.</p> <p>Les implémentations de <code class=syntax>ReadBuffer</code>/<code class=syntax>WriteBuffer</code> sont utilisés pour travailler avec des fichiers et des descripteurs de fichiers et des sockets réseau, pour implémenter la compression (<code class=syntax>CompressedWriteBuffer</code> is initialized with another WriteBuffer and performs compression before writing data to it), and for other purposes – the names <code class=syntax>ConcatReadBuffer</code>, <code class=syntax>LimitReadBuffer</code>, et <code class=syntax>HashingWriteBuffer</code> parler pour eux-mêmes.</p> <p>Read / WriteBuffers ne traite que les octets. Il y a des fonctions de <code class=syntax>ReadHelpers</code> et <code class=syntax>WriteHelpers</code> fichiers d'en-tête pour aider à formater l'entrée / sortie. Par exemple, il existe des assistants pour écrire un nombre au format décimal.</p> <p>Regardons ce qui se passe lorsque vous voulez écrire un ensemble de résultats dans <code class=syntax>JSON</code> format de sortie standard (stdout). Vous avez un jeu de résultats prêt à être récupéré <code class=syntax>IBlockInputStream</code>. Vous créez <code class=syntax>WriteBufferFromFileDescriptor(STDOUT_FILENO)</code> pour écrire des octets dans stdout. Vous créez <code class=syntax>JSONRowOutputStream</code>, initialisé avec qui <code class=syntax>WriteBuffer</code>, pour écrire des lignes dans <code class=syntax>JSON</code> à stdout. Vous créez <code class=syntax>BlockOutputStreamFromRowOutputStream</code> de plus, pour la représenter comme <code class=syntax>IBlockOutputStream</code>. Ensuite, vous appelez <code class=syntax>copyData</code> pour transférer des données de <code class=syntax>IBlockInputStream</code> de <code class=syntax>IBlockOutputStream</code> et tout fonctionne. Interne, <code class=syntax>JSONRowOutputStream</code> écrira divers délimiteurs JSON et appellera <code class=syntax>IDataType::serializeTextJSON</code> méthode avec une référence à <code class=syntax>IColumn</code> et le numéro de ligne comme arguments. Conséquent, <code class=syntax>IDataType::serializeTextJSON</code> appellera une méthode de <code class=syntax>WriteHelpers.h</code>: exemple, <code class=syntax>writeText</code> pour les types numériques et <code class=syntax>writeJSONString</code> pour <code class=syntax>DataTypeString</code>.</p> <h2 id=tables>Table<a class=headerlink href=#tables title="Permanent link"> </a></h2> <p>Le <code class=syntax>IStorage</code> l'interface représente les tables. Différentes implémentations de cette interface sont des moteurs de table différents. Les exemples sont <code class=syntax>StorageMergeTree</code>, <code class=syntax>StorageMemory</code> et ainsi de suite. Les Instances de ces classes ne sont que des tables.</p> <p>Clé <code class=syntax>IStorage</code> les méthodes sont <code class=syntax>read</code> et <code class=syntax>write</code>. Il y a aussi des <code class=syntax>alter</code>, <code class=syntax>rename</code>, <code class=syntax>drop</code> et ainsi de suite. Le <code class=syntax>read</code> méthode accepte les arguments suivants: l'ensemble de colonnes à lire à partir d'un tableau, l' <code class=syntax>AST</code> requête à considérer, et le nombre souhaité de flux de retour. Il renvoie un ou plusieurs <code class=syntax>IBlockInputStream</code> objets et informations sur l'étape de traitement des données qui a été effectuée dans un moteur de table lors de l'exécution de la requête.</p> <p>Dans la plupart des cas, la méthode read n'est responsable que de la lecture des colonnes spécifiées à partir d'une table, et non d'un traitement ultérieur des données. Tout traitement ultérieur des données est effectué par l'interpréteur de requêtes et n'est pas de la responsabilité de <code class=syntax>IStorage</code>.</p> <p>Mais il y a des exceptions notables:</p> <ul> <li>La requête AST est transmise au <code class=syntax>read</code> et le moteur de table peut l'utiliser pour dériver l'utilisation de l'index et pour lire moins de données à partir d'une table.</li> <li>Parfois, le moteur de table peut traiter les données lui-même à une étape spécifique. Exemple, <code class=syntax>StorageDistributed</code> peut envoyer une requête aux serveurs distants, leur demander de traiter les données à une étape où les données de différents serveurs distants peuvent être fusionnées, et renvoyer ces données prétraitées. L'interpréteur de requête termine ensuite le traitement des données.</li> </ul> <p>Table <code class=syntax>read</code> la méthode peut retourner plusieurs <code class=syntax>IBlockInputStream</code> objets permettant le traitement parallèle des données. Ces flux d'entrée de bloc multiples peuvent lire à partir d'une table en parallèle. Ensuite, vous pouvez envelopper ces flux avec diverses transformations (telles que l'évaluation d'expression ou le filtrage) qui peuvent être calculées indépendamment et créer un <code class=syntax>UnionBlockInputStream</code> en plus d'eux, pour lire à partir de plusieurs flux en parallèle.</p> <p>Il y a aussi des <code class=syntax>TableFunction</code>s. Ce sont des fonctions qui renvoient un <code class=syntax>IStorage</code> objet à utiliser dans le <code class=syntax>FROM</code> la clause d'une requête.</p> <p>Pour avoir une idée rapide de la façon d'implémenter votre moteur de table, regardez quelque chose de simple, comme <code class=syntax>StorageMemory</code> ou <code class=syntax>StorageTinyLog</code>.</p> <blockquote> <p>Comme le résultat de l' <code class=syntax>read</code> méthode, <code class=syntax>IStorage</code> retourner <code class=syntax>QueryProcessingStage</code> – information about what parts of the query were already calculated inside storage.</p> </blockquote> <h2 id=parsers>Analyseur<a class=headerlink href=#parsers title="Permanent link"> </a></h2> <p>Un analyseur de descente récursif écrit à la main analyse une requête. Exemple, <code class=syntax>ParserSelectQuery</code> appelle simplement récursivement les analyseurs sous-jacents pour diverses parties de la requête. Les analyseurs créent un <code class=syntax>AST</code>. Le <code class=syntax>AST</code> est représenté par des nœuds, qui sont des instances de <code class=syntax>IAST</code>.</p> <blockquote> <p>Les générateurs d'analyseurs ne sont pas utilisés pour des raisons historiques.</p> </blockquote> <h2 id=interpreters>Interprète<a class=headerlink href=#interpreters title="Permanent link"> </a></h2> <p>Les interprètes sont responsables de la création du pipeline d'exécution des requêtes à partir <code class=syntax>AST</code>. Il existe des interprètes simples, tels que <code class=syntax>InterpreterExistsQuery</code> et <code class=syntax>InterpreterDropQuery</code> ou le plus sophistiqué de <code class=syntax>InterpreterSelectQuery</code>. Le pipeline d'exécution de requête est une combinaison de flux d'entrée ou de sortie de bloc. Par exemple, le résultat de l'interprétation de la <code class=syntax>SELECT</code> la requête est la <code class=syntax>IBlockInputStream</code> pour lire le jeu de résultats; le résultat de la requête d'INSERTION est l' <code class=syntax>IBlockOutputStream</code> pour écrire des données à insérer, et le résultat de l'interprétation <code class=syntax>INSERT SELECT</code> la requête est la <code class=syntax>IBlockInputStream</code> cela renvoie un jeu de résultats vide lors de la première lecture, mais qui copie <code class=syntax>SELECT</code> de <code class=syntax>INSERT</code> dans le même temps.</p> <p><code class=syntax>InterpreterSelectQuery</code> utiliser <code class=syntax>ExpressionAnalyzer</code> et <code class=syntax>ExpressionActions</code> machines pour l'analyse des requêtes et des transformations. C'est là que la plupart des optimisations de requêtes basées sur des règles sont effectuées. <code class=syntax>ExpressionAnalyzer</code> est assez désordonné et devrait être réécrit: diverses transformations et optimisations de requête doivent être extraites dans des classes séparées pour permettre des transformations modulaires ou une requête.</p> <h2 id=functions>Fonction<a class=headerlink href=#functions title="Permanent link"> </a></h2> <p>Il y a des fonctions ordinaires et des fonctions agrégées. Pour les fonctions d'agrégation, voir la section suivante.</p> <p>Ordinary functions don't change the number of rows – they work as if they are processing each row independently. In fact, functions are not called for individual rows, but for <code class=syntax>Block</code>'s de données pour implémenter l'exécution de requête vectorisée.</p> <p>Il y a quelques fonctions diverses, comme <a href=../../sql-reference/functions/other-functions/#function-blocksize>la taille de bloc</a>, <a href=../../sql-reference/functions/other-functions/#function-rownumberinblock>rowNumberInBlock</a>, et <a href=../../sql-reference/functions/other-functions/#function-runningaccumulate>runningAccumulate</a>, qui exploitent le traitement de bloc et violent l'indépendance des lignes.</p> <p>ClickHouse a un typage fort, donc il n'y a pas de conversion de type implicite. Si une fonction ne prend pas en charge une combinaison spécifique de types, elle lève une exception. Mais les fonctions peuvent fonctionner (être surchargées) pour de nombreuses combinaisons de types différentes. Par exemple, l' <code class=syntax>plus</code> fonction (pour mettre en œuvre la <code class=syntax>+</code> opérateur) fonctionne pour toute combinaison de types numériques: <code class=syntax>UInt8</code> + <code class=syntax>Float32</code>, <code class=syntax>UInt16</code> + <code class=syntax>Int8</code> et ainsi de suite. En outre, certaines fonctions variadiques peuvent accepter n'importe quel nombre d'arguments, tels que <code class=syntax>concat</code> fonction.</p> <p>L'implémentation d'une fonction peut être légèrement gênante car une fonction distribue explicitement les types de données pris en charge et pris en charge <code class=syntax>IColumns</code>. Par exemple, l' <code class=syntax>plus</code> la fonction a du code généré par l'instanciation D'un modèle C++ pour chaque combinaison de types numériques, et des arguments gauche et droit constants ou non constants.</p> <p>C'est un excellent endroit pour implémenter la génération de code d'exécution pour éviter le gonflement du code de modèle. En outre, il permet d'ajouter des fonctions fusionnées comme Fusionné Multiplier-Ajouter ou de faire plusieurs comparaisons dans une itération de boucle.</p> <p>En raison de l'exécution de requête vectorisée, les fonctions ne sont pas court-circuitées. Par exemple, si vous écrivez <code class=syntax>WHERE f(x) AND g(y)</code> les deux faces sont calculés, même pour les lignes, quand <code class=syntax>f(x)</code> est égal à zéro (sauf quand <code class=syntax>f(x)</code> est une expression constante nulle). Mais si la sélectivité de l' <code class=syntax>f(x)</code> la condition est élevée, et le calcul de <code class=syntax>f(x)</code> est beaucoup moins cher que <code class=syntax>g(y)</code>, il est préférable d'implémenter le calcul multi-pass. Il serait d'abord calculer <code class=syntax>f(x)</code> puis filtrer les colonnes par la suite, puis de calculer <code class=syntax>g(y)</code> uniquement pour les petits morceaux de données filtrés.</p> <h2 id=aggregate-functions>Les Fonctions D'Agrégation<a class=headerlink href=#aggregate-functions title="Permanent link"> </a></h2> <p>Les fonctions d'agrégation sont des fonctions avec État. Ils accumulent les valeurs passées dans certains etats et vous permettent d'obtenir des résultats de cet état. Ils sont gérés avec le <code class=syntax>IAggregateFunction</code> interface. Les États peuvent être assez simples (l'État pour <code class=syntax>AggregateFunctionCount</code> est juste un seul <code class=syntax>UInt64</code> valeur) ou très complexes (l'état de <code class=syntax>AggregateFunctionUniqCombined</code> est une combinaison linéaire du tableau, d'une table de hachage, et un <code class=syntax>HyperLogLog</code> structure probabiliste des données).</p> <p>Les États sont répartis en <code class=syntax>Arena</code> (un pool de mémoire) pour traiter plusieurs états lors de l'exécution d'une cardinalité élevée <code class=syntax>GROUP BY</code> requête. Les États peuvent avoir un constructeur et un destructeur non triviaux: par exemple, les États d'agrégation compliqués peuvent allouer eux-mêmes de la mémoire supplémentaire. Il faut accorder une certaine attention à la création et à la destruction des États et à la transmission appropriée de leur propriété et de leur ordre de destruction.</p> <p>Les États d'agrégation peuvent être sérialisés et désérialisés pour passer sur le réseau pendant l'exécution de la requête distribuée ou pour les écrire sur le disque où il n'y a pas assez de RAM. Ils peuvent même être stockés dans une table avec le <code class=syntax>DataTypeAggregateFunction</code> pour permettre l'agrégation incrémentielle des données.</p> <blockquote> <p>Le format de données sérialisé pour les états de fonction d'agrégat n'est pas versionné pour le moment. C'est ok si les États d'agrégat ne sont stockés que temporairement. Mais nous avons l' <code class=syntax>AggregatingMergeTree</code> moteur de table pour l'agrégation incrémentielle, et les gens l'utilisent déjà en production. C'est la raison pour laquelle la rétrocompatibilité est requise lors de la modification du format sérialisé pour toute fonction d'agrégat à l'avenir.</p> </blockquote> <h2 id=server>Serveur<a class=headerlink href=#server title="Permanent link"> </a></h2> <p>Le serveur implémente plusieurs interfaces différentes:</p> <ul> <li>Une interface HTTP pour tous les clients étrangers.</li> <li>Une interface TCP pour le client clickhouse natif et pour la communication inter-serveur lors de l'exécution de la requête distribuée.</li> <li>Une interface pour transférer des données pour la réplication.</li> </ul> <p>En interne, il s'agit simplement d'un serveur multithread primitif sans coroutines ni fibres. Étant donné que le serveur n'est pas conçu pour traiter un taux élevé de requêtes simples, mais pour traiter un taux relativement faible de requêtes complexes, chacun d'eux peut traiter une grande quantité de données à des fins d'analyse.</p> <p>Le serveur initialise le <code class=syntax>Context</code> classe avec l'environnement nécessaire à l'exécution des requêtes: la liste des bases de données disponibles, des utilisateurs et des droits d'accès, des paramètres, des clusters, la liste des processus, le journal des requêtes, etc. Les interprètes utilisent cet environnement.</p> <p>Nous maintenons une compatibilité ascendante et descendante complète pour le protocole TCP du serveur: les anciens clients peuvent parler à de nouveaux serveurs, et les nouveaux clients peuvent parler à d'anciens serveurs. Mais nous ne voulons pas le maintenir éternellement, et nous supprimons le support pour les anciennes versions après environ un an.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Note</p> <p>Pour la plupart des applications externes, nous vous recommandons d'utiliser L'interface HTTP car elle est simple et facile à utiliser. Le protocole TCP est plus étroitement lié aux structures de données internes: il utilise un format interne pour passer des blocs de données, et il utilise un cadrage personnalisé pour les données compressées. Nous n'avons pas publié de bibliothèque C pour ce protocole car elle nécessite de lier la plupart de la base de code ClickHouse, ce qui n'est pas pratique.</p> </div> <h2 id=distributed-query-execution>Exécution De Requête Distribuée<a class=headerlink href=#distributed-query-execution title="Permanent link"> </a></h2> <p>Les serveurs d'une configuration de cluster sont pour la plupart indépendants. Vous pouvez créer un <code class=syntax>Distributed</code> table sur un ou tous les serveurs dans un cluster. Le <code class=syntax>Distributed</code> table does not store data itself – it only provides a “view” à toutes les tables sur plusieurs nœuds d'un cluster. Lorsque vous sélectionnez à partir d'un <code class=syntax>Distributed</code> table, il réécrit cette requête, choisit les nœuds distants en fonction des paramètres d'équilibrage de charge et leur envoie la requête. Le <code class=syntax>Distributed</code> table demande aux serveurs distants de traiter une requête jusqu'à une étape où les résultats intermédiaires de différents serveurs peuvent être fusionnés. Puis il reçoit les résultats intermédiaires et les fusionne. La table distribuée essaie de distribuer autant de travail que possible aux serveurs distants et n'envoie pas beaucoup de données intermédiaires sur le réseau.</p> <p>Les choses deviennent plus compliquées lorsque vous avez des sous-requêtes dans des clauses IN ou JOIN, et que chacune d'elles utilise un <code class=syntax>Distributed</code> table. Nous avons différentes stratégies pour l'exécution de ces requêtes.</p> <p>Il n'existe pas de plan de requête global pour l'exécution des requêtes distribuées. Chaque nœud a son plan de requête local pour sa partie du travail. Nous n'avons qu'une simple exécution de requête distribuée en une seule passe: nous envoyons des requêtes pour les nœuds distants, puis fusionnons les résultats. Mais cela n'est pas possible pour les requêtes compliquées avec des groupes de cardinalité élevés ou avec une grande quantité de données temporaires pour la jointure. Dans de tels cas, nous avons besoin de “reshuffle” données entre les serveurs, ce qui nécessite une coordination supplémentaire. ClickHouse ne supporte pas ce type d'exécution de requête, et nous devons y travailler.</p> <h2 id=merge-tree>Fusion De L'Arbre<a class=headerlink href=#merge-tree title="Permanent link"> </a></h2> <p><code class=syntax>MergeTree</code> est une famille de moteurs de stockage qui prend en charge l'indexation par clé primaire. La clé primaire peut être un tuple arbitraire de colonnes ou d'expressions. De données dans un <code class=syntax>MergeTree</code> la table est stockée dans “parts”. Chaque partie stocke les données dans l'ordre de la clé primaire, de sorte que les données sont ordonnées lexicographiquement par le tuple de clé primaire. Toutes les colonnes du tableau sont stockés dans différents <code class=syntax>column.bin</code> les fichiers dans ces régions. Les fichiers sont constitués de blocs compressés. Chaque bloc est généralement de 64 KO à 1 Mo de données non compressées, en fonction de la taille de la valeur moyenne. Les blocs sont constitués de valeurs de colonne placées de manière contiguë l'une après l'autre. Les valeurs de colonne sont dans le même ordre pour chaque colonne (la clé primaire définit l'ordre), donc lorsque vous itérez par plusieurs colonnes, vous obtenez des valeurs pour les lignes correspondantes.</p> <p>La clé primaire elle-même est “sparse”. Il ne traite pas chaque ligne, mais seulement certaines plages de données. Séparé <code class=syntax>primary.idx</code> fichier a la valeur de la clé primaire pour chaque N-ième ligne, où N est appelé <code class=syntax>index_granularity</code> (habituellement, N = 8192). Aussi, pour chaque colonne, nous avons <code class=syntax>column.mrk</code> les fichiers avec l' “marks,” qui sont des décalages à chaque N-ème ligne dans le fichier de données. Chaque marque est une paire: le décalage dans le fichier au début du bloc compressé, et le décalage dans le bloc décompressé au début des données. Habituellement, les blocs compressés sont alignés par des marques, et le décalage dans le bloc décompressé est nul. Les données pour <code class=syntax>primary.idx</code> réside toujours dans la mémoire, et les données pour <code class=syntax>column.mrk</code> les fichiers sont mis en cache.</p> <p>Quand nous allons lire quelque chose d'une partie dans <code class=syntax>MergeTree</code> nous regardons <code class=syntax>primary.idx</code> données et locate plages qui pourraient contenir des données demandées, puis regardez <code class=syntax>column.mrk</code> données et calculer des décalages pour savoir où commencer à lire ces plages. En raison de la rareté, les données excédentaires peuvent être lues. ClickHouse ne convient pas à une charge élevée de requêtes ponctuelles simples, car toute la gamme avec <code class=syntax>index_granularity</code> les lignes doivent être lues pour chaque clé, et le bloc compressé entier doit être décompressé pour chaque colonne. Nous avons rendu l'index clairsemé parce que nous devons être en mesure de maintenir des milliards de lignes par serveur unique sans consommation de mémoire notable pour l'index. De plus, comme la clé primaire est clairsemée, elle n'est pas unique: elle ne peut pas vérifier l'existence de la clé dans la table au moment de l'insertion. Vous pourriez avoir plusieurs lignes avec la même clé dans une table.</p> <p>Lorsque vous <code class=syntax>INSERT</code> un tas de données dans <code class=syntax>MergeTree</code>, ce groupe est trié par ordre de clé primaire et forme une nouvelle partie. Il existe des threads d'arrière-plan qui sélectionnent périodiquement certaines parties et les fusionnent en une seule partie triée pour maintenir le nombre de parties relativement faible. C'est pourquoi il est appelé <code class=syntax>MergeTree</code>. Bien sûr, la fusion conduit à “write amplification”. Toutes les parties sont immuables: elles sont seulement créées et supprimées, mais pas modifiées. Lorsque SELECT est exécuté, il contient un instantané de la table (un ensemble de parties). Après la Fusion, nous conservons également les anciennes pièces pendant un certain temps pour faciliter une récupération après une défaillance, donc si nous voyons qu'une partie fusionnée est probablement cassée, nous pouvons la remplacer par ses parties sources.</p> <p><code class=syntax>MergeTree</code> n'est pas un arbre LSM car il ne contient pas “memtable” et “log”: inserted data is written directly to the filesystem. This makes it suitable only to INSERT data in batches, not by individual row and not very frequently – about once per second is ok, but a thousand times a second is not. We did it this way for simplicity's sake, and because we are already inserting data in batches in our applications.</p> <blockquote> <p>Les tables MergeTree ne peuvent avoir qu'un seul index (primaire): il n'y a pas d'index secondaires. Il serait bon d'autoriser plusieurs représentations physiques sous une table logique, par exemple, pour stocker des données dans plus d'un ordre physique ou même pour autoriser des représentations avec des données pré-agrégées avec des données originales.</p> </blockquote> <p>Il existe des moteurs MergeTree qui effectuent un travail supplémentaire lors des fusions en arrière-plan. Les exemples sont <code class=syntax>CollapsingMergeTree</code> et <code class=syntax>AggregatingMergeTree</code>. Cela pourrait être traité comme un support spécial pour les mises à jour. Gardez à l'esprit que ce ne sont pas de vraies mises à jour car les utilisateurs n'ont généralement aucun contrôle sur le moment où les fusions en arrière-plan sont exécutées et les données dans un <code class=syntax>MergeTree</code> la table est presque toujours stockée dans plus d'une partie, pas sous une forme complètement fusionnée.</p> <h2 id=replication>Réplication<a class=headerlink href=#replication title="Permanent link"> </a></h2> <p>La réplication dans ClickHouse peut être configurée sur une base par table. Vous pouvez avoir des tables répliquées et des tables non répliquées sur le même serveur. Vous pouvez également avoir des tables répliquées de différentes manières, comme une table avec une réplication à deux facteurs et une autre avec trois facteurs.</p> <p>La réplication est implémentée dans le <code class=syntax>ReplicatedMergeTree</code> moteur de stockage. Le chemin d'accès dans <code class=syntax>ZooKeeper</code> est spécifié comme paramètre pour le moteur de stockage. Toutes les tables avec le même chemin dans <code class=syntax>ZooKeeper</code> devenez des répliques les unes des autres: elles synchronisent leurs données et maintiennent la cohérence. Les répliques peuvent être ajoutées et supprimées dynamiquement simplement en créant ou en supprimant une table.</p> <p>La réplication utilise un schéma multi-maître asynchrone. Vous pouvez insérer des données dans n'importe quel réplica qui a une session avec <code class=syntax>ZooKeeper</code>, et les données sont répliquées à toutes les autres répliques de manière asynchrone. Parce que ClickHouse ne prend pas en charge les mises à jour, la réplication est sans conflit. Comme il n'y a pas d'accusé de réception de quorum des insertions, les données juste insérées peuvent être perdues si un nœud échoue.</p> <p>Les métadonnées pour la réplication sont stockées dans ZooKeeper. Il existe un journal de réplication qui répertorie les actions à effectuer. Les Actions sont: obtenir une partie; fusionner des parties; déposer une partition, et ainsi de suite. Chaque réplica copie le journal de réplication dans sa file d'attente, puis exécute les actions de la file d'attente. Par exemple, sur l'insertion, l' “get the part” l'action est créée dans le journal, et chaque réplique téléchargements de la partie. Les fusions sont coordonnées entre les répliques pour obtenir des résultats identiques aux octets. Toutes les parties sont fusionnées de la même manière sur toutes les répliques. Il est réalisé en élisant une réplique en tant que leader, et cette réplique initie fusionne et écrit “merge parts” actions dans le journal.</p> <p>La réplication est physique: seules les parties compressées sont transférées entre les nœuds, pas les requêtes. Les fusions sont traitées sur chaque réplique indépendamment dans la plupart des cas pour réduire les coûts du réseau en évitant l'amplification du réseau. Grand fusionné les pièces sont envoyées sur le réseau uniquement en cas de retard de réplication.</p> <p>En outre, chaque réplique stocke son état dans ZooKeeper comme l'ensemble des pièces et ses sommes de contrôle. Lorsque l'état sur le système de fichiers local diverge de l'état de référence dans ZooKeeper, le réplica restaure sa cohérence en téléchargeant les parties manquantes et brisées à partir d'autres réplicas. Lorsqu'il y a des données inattendues ou brisées dans le système de fichiers local, ClickHouse ne les supprime pas, mais les déplace dans un répertoire séparé et les oublie.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Note</p> <p>Le cluster ClickHouse est constitué de fragments indépendants, et chaque fragment est constitué de répliques. Le cluster est <strong>pas élastique</strong>, donc, après avoir ajouté un nouveau fragment, les données ne sont pas rééquilibrées automatiquement entre les fragments. Au lieu de cela, la charge du cluster est censée être ajustée pour être inégale. Cette implémentation vous donne plus de contrôle, et c'est ok pour des clusters relativement petits, tels que des dizaines de nœuds. Mais pour les clusters avec des centaines de nœuds que nous utilisons en production, cette approche devient un inconvénient important. Nous devrions implémenter un moteur de table qui s'étend sur le cluster avec des régions répliquées dynamiquement qui pourraient être divisées et équilibrées automatiquement entre les clusters.</p> </div> </div> <div class="alert alert-light my-3"> <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p> <span class="alert-heading display-6">Was this content helpful?</span> <div id=rating-stars class="display-6 mb-0" data-titles="['Unusable', 'Poor', 'OK', 'Good', 'Excellent']" data-documentation=documentation>RATING_STARS</div> </div> <div id=content-footer class="text-muted pt-3 mb-5"> <div class=float-md-right>©2016–2020 Yandex LLC</div> <div>Built from <a href=https://github.com/ClickHouse/ClickHouse/commit/b030bfedd7db4603034643fd183cf7784a820193 rel="external nofollow noreferrer" target=_blank class=text-reset>b030bfedd7</a> </div> </div> </div> <div id=toc class="col-xl-2 d-none d-xl-block d-print-none p-3 overflow-auto toc-right mb-5"> <nav class="nav flex-column text-wrap"> <label for=toc>Table of Contents</label> <a href=#columns title=Colonne class="nav-link text-wrap d-inline-block w-100"> Colonne </a> <a href=#field title=Champ class="nav-link text-wrap d-inline-block w-100"> Champ </a> <a href=#leaky-abstractions title="Abstractions Qui Fuient" class="nav-link text-wrap d-inline-block w-100"> Abstractions Qui Fuient </a> <a href=#data_types title="Types De Données" class="nav-link text-wrap d-inline-block w-100"> Types De Données </a> <a href=#block title=Bloc class="nav-link text-wrap d-inline-block w-100"> Bloc </a> <a href=#block-streams title="Bloquer Les Flux" class="nav-link text-wrap d-inline-block w-100"> Bloquer Les Flux </a> <a href=#formats title=Format class="nav-link text-wrap d-inline-block w-100"> Format </a> <a href=#io title=I/O class="nav-link text-wrap d-inline-block w-100"> I/O </a> <a href=#tables title=Table class="nav-link text-wrap d-inline-block w-100"> Table </a> <a href=#parsers title=Analyseur class="nav-link text-wrap d-inline-block w-100"> Analyseur </a> <a href=#interpreters title=Interprète class="nav-link text-wrap d-inline-block w-100"> Interprète </a> <a href=#functions title=Fonction class="nav-link text-wrap d-inline-block w-100"> Fonction </a> <a href=#aggregate-functions title="Les Fonctions D'Agrégation" class="nav-link text-wrap d-inline-block w-100"> Les Fonctions D'Agrégation </a> <a href=#server title=Serveur class="nav-link text-wrap d-inline-block w-100"> Serveur </a> <a href=#distributed-query-execution title="Exécution De Requête Distribuée" class="nav-link text-wrap d-inline-block w-100"> Exécution De Requête Distribuée </a> <a href=#merge-tree title="Fusion De L'Arbre" class="nav-link text-wrap d-inline-block w-100"> Fusion De L'Arbre </a> <a href=#replication title=Réplication class="nav-link text-wrap d-inline-block w-100"> Réplication </a> </nav> </div> </div> </div> <script async type=text/javascript src=/js/base.js?00223b07></script> <noscript> <div><img src=https://mc.yandex.ru/watch/18343495 alt=Yandex></div> </noscript> </body> </html>