<!doctype html><html ⚡ lang=ru> <head><meta charset=utf-8><script async src=https://cdn.ampproject.org/v0.js></script><title>Массивы | Документация ClickHouse</title><link href=https://clickhouse.tech/docs/ru/sql-reference/functions/array-functions/ rel=canonical><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><script type=application/ld+json>[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "Массивы | Документация ClickHouse",
"mainEntityOfPage": "https://clickhouse.tech/docs/ru/sql-reference/functions/array-functions/",




"image": "https://clickhouse.tech/images/logo-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "Yandex LLC",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.tech/images/yandex.png",
    "width": 163,
    "height": 60
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "Массивы | Документация ClickHouse",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script><style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript><style amp-custom>:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--white:#fff;--gray:#6c757d;--gray-dark:#343a40;--primary:#007bff;--secondary:#6c757d;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f8f9fa;--dark:#343a40;--breakpoint-xs:0;--breakpoint-sm:576px;--breakpoint-md:768px;--breakpoint-lg:992px;--breakpoint-xl:1200px;--font-family-sans-serif:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,::after,::before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}article,footer{display:block}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem}p{margin-top:0;margin-bottom:1rem}ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}b,strong{font-weight:bolder}a{color:#007bff;text-decoration:none;background-color:transparent}a:hover{color:#0056b3;text-decoration:underline}a:not([href]){color:inherit;text-decoration:none}a:not([href]):hover{color:inherit;text-decoration:none}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}img{vertical-align:middle;border-style:none}svg{overflow:hidden;vertical-align:middle}select{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit]{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{padding:0;border-style:none}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:.5rem;font-weight:500;line-height:1.2}.h1,h1{font-size:2rem}.h2,h2{font-size:1.5rem}.h3,h3{font-size:1.25rem}.h4,h4{font-size:1rem}.h5,h5{font-size:1rem}.h6,h6{font-size:1rem}.display-1{font-size:6rem;font-weight:300;line-height:1.2}.display-2{font-size:5.5rem;font-weight:300;line-height:1.2}.display-3{font-size:4.5rem;font-weight:300;line-height:1.2}.display-4{font-size:3.5rem;font-weight:300;line-height:1.2}.img-fluid{max-width:100%;height:auto}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}pre{display:block;font-size:87.5%;color:#212529}pre code{font-size:inherit;color:inherit;word-break:normal}.container{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container{max-width:720px}}@media(min-width:992px){.container{max-width:960px}}@media(min-width:1200px){.container{max-width:1140px}}.container-fluid,.container-lg,.container-md{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container,.container-md{max-width:720px}}@media(min-width:992px){.container,.container-lg,.container-md{max-width:960px}}@media(min-width:1200px){.container,.container-lg,.container-md{max-width:1140px}}.row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-15px;margin-left:-15px}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9{position:relative;width:100%;padding-right:15px;padding-left:15px}.col{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-first{-ms-flex-order:-1;order:-1}.order-0{-ms-flex-order:0;order:0}.order-1{-ms-flex-order:1;order:1}.order-2{-ms-flex-order:2;order:2}.order-3{-ms-flex-order:3;order:3}.order-4{-ms-flex-order:4;order:4}.order-5{-ms-flex-order:5;order:5}.order-6{-ms-flex-order:6;order:6}.order-7{-ms-flex-order:7;order:7}.order-8{-ms-flex-order:8;order:8}.order-9{-ms-flex-order:9;order:9}.order-10{-ms-flex-order:10;order:10}.order-11{-ms-flex-order:11;order:11}.order-12{-ms-flex-order:12;order:12}.offset-1{margin-left:8.333333%}.offset-2{margin-left:16.666667%}.offset-3{margin-left:25%}.offset-4{margin-left:33.333333%}.offset-5{margin-left:41.666667%}.offset-6{margin-left:50%}.offset-7{margin-left:58.333333%}.offset-8{margin-left:66.666667%}.offset-9{margin-left:75%}.offset-10{margin-left:83.333333%}.offset-11{margin-left:91.666667%}@media(min-width:768px){.col-md{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-md-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-md-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-md-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-md-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-md-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-md-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-md-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-md-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-md-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-md-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-md-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-md-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-md-first{-ms-flex-order:-1;order:-1}.order-md-0{-ms-flex-order:0;order:0}.order-md-1{-ms-flex-order:1;order:1}.order-md-2{-ms-flex-order:2;order:2}.order-md-3{-ms-flex-order:3;order:3}.order-md-4{-ms-flex-order:4;order:4}.order-md-5{-ms-flex-order:5;order:5}.order-md-6{-ms-flex-order:6;order:6}.order-md-7{-ms-flex-order:7;order:7}.order-md-8{-ms-flex-order:8;order:8}.order-md-9{-ms-flex-order:9;order:9}.order-md-10{-ms-flex-order:10;order:10}.order-md-11{-ms-flex-order:11;order:11}.order-md-12{-ms-flex-order:12;order:12}.offset-md-0{margin-left:0}.offset-md-1{margin-left:8.333333%}.offset-md-2{margin-left:16.666667%}.offset-md-3{margin-left:25%}.offset-md-4{margin-left:33.333333%}.offset-md-5{margin-left:41.666667%}.offset-md-6{margin-left:50%}.offset-md-7{margin-left:58.333333%}.offset-md-8{margin-left:66.666667%}.offset-md-9{margin-left:75%}.offset-md-10{margin-left:83.333333%}.offset-md-11{margin-left:91.666667%}}@media(min-width:992px){.col-lg{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-lg-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-lg-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-lg-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-lg-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-lg-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-lg-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-lg-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-lg-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-lg-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-lg-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-lg-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-lg-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-lg-first{-ms-flex-order:-1;order:-1}.order-lg-0{-ms-flex-order:0;order:0}.order-lg-1{-ms-flex-order:1;order:1}.order-lg-2{-ms-flex-order:2;order:2}.order-lg-3{-ms-flex-order:3;order:3}.order-lg-4{-ms-flex-order:4;order:4}.order-lg-5{-ms-flex-order:5;order:5}.order-lg-6{-ms-flex-order:6;order:6}.order-lg-7{-ms-flex-order:7;order:7}.order-lg-8{-ms-flex-order:8;order:8}.order-lg-9{-ms-flex-order:9;order:9}.order-lg-10{-ms-flex-order:10;order:10}.order-lg-11{-ms-flex-order:11;order:11}.order-lg-12{-ms-flex-order:12;order:12}.offset-lg-0{margin-left:0}.offset-lg-1{margin-left:8.333333%}.offset-lg-2{margin-left:16.666667%}.offset-lg-3{margin-left:25%}.offset-lg-4{margin-left:33.333333%}.offset-lg-5{margin-left:41.666667%}.offset-lg-6{margin-left:50%}.offset-lg-7{margin-left:58.333333%}.offset-lg-8{margin-left:66.666667%}.offset-lg-9{margin-left:75%}.offset-lg-10{margin-left:83.333333%}.offset-lg-11{margin-left:91.666667%}}.btn{display:inline-block;font-weight:400;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:.375rem .75rem;font-size:1rem;line-height:1.5;border-radius:.25rem}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus{outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.btn:disabled{opacity:.65}.btn-primary{color:#fff;background-color:#007bff;border-color:#007bff}.btn-primary:hover{color:#fff;background-color:#0069d9;border-color:#0062cc}.btn-primary:focus{color:#fff;background-color:#0069d9;border-color:#0062cc;box-shadow:0 0 0 .2rem rgba(38,143,255,.5)}.btn-primary:disabled{color:#fff;background-color:#007bff;border-color:#007bff}.btn-light{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-light:hover{color:#212529;background-color:#e2e6ea;border-color:#dae0e5}.btn-light:focus{color:#212529;background-color:#e2e6ea;border-color:#dae0e5;box-shadow:0 0 0 .2rem rgba(216,217,219,.5)}.btn-light:disabled{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-dark{color:#fff;background-color:#343a40;border-color:#343a40}.btn-dark:hover{color:#fff;background-color:#23272b;border-color:#1d2124}.btn-dark:focus{color:#fff;background-color:#23272b;border-color:#1d2124;box-shadow:0 0 0 .2rem rgba(82,88,93,.5)}.btn-dark:disabled{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-primary{color:#007bff;border-color:#007bff}.btn-outline-primary:hover{color:#fff;background-color:#007bff;border-color:#007bff}.btn-outline-primary:focus{box-shadow:0 0 0 .2rem rgba(0,123,255,.5)}.btn-outline-primary:disabled{color:#007bff;background-color:transparent}.btn-outline-light{color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:hover{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:focus{box-shadow:0 0 0 .2rem rgba(248,249,250,.5)}.btn-outline-light:disabled{color:#f8f9fa;background-color:transparent}.btn-outline-dark{color:#343a40;border-color:#343a40}.btn-outline-dark:hover{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-dark:focus{box-shadow:0 0 0 .2rem rgba(52,58,64,.5)}.btn-outline-dark:disabled{color:#343a40;background-color:transparent}.btn-link{font-weight:400;color:#007bff;text-decoration:none}.btn-link:hover{color:#0056b3;text-decoration:underline}.btn-link:focus{text-decoration:underline;box-shadow:none}.btn-link:disabled{color:#6c757d;pointer-events:none}.btn-group-lg>.btn,.btn-lg{padding:.5rem 1rem;font-size:1.25rem;line-height:1.5;border-radius:.3rem}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:.5rem}.btn-group{position:relative;display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle}.btn-group>.btn{position:relative;-ms-flex:1 1 auto;flex:1 1 auto}.btn-group>.btn:hover{z-index:1}.btn-group>.btn:active,.btn-group>.btn:focus{z-index:1}.btn-group>.btn-group:not(:first-child),.btn-group>.btn:not(:first-child){margin-left:-1px}.btn-group>.btn-group:not(:last-child)>.btn{border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn-group:not(:first-child)>.btn,.btn-group>.btn:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.custom-select{display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;vertical-align:middle;background:#fff url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5' viewBox='0 0 4 5'%3e%3cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3e%3c/svg%3e") no-repeat right .75rem center/8px 10px;border:1px solid #ced4da;border-radius:.25rem;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.custom-select:focus::-ms-value{color:#495057;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #495057}.custom-select-lg{height:calc(1.5em+1rem+2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.25rem}.custom-range{width:100%;height:1.4rem;padding:0;background-color:transparent;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-range:focus{outline:0}.custom-range:focus::-webkit-slider-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .2rem rgba(0,123,255,.25)}.custom-range:focus::-moz-range-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .2rem rgba(0,123,255,.25)}.custom-range:focus::-ms-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .2rem rgba(0,123,255,.25)}.custom-range::-moz-focus-outer{border:0}.custom-range::-webkit-slider-thumb{width:1rem;height:1rem;margin-top:-.25rem;background-color:#007bff;border:0;border-radius:1rem;-webkit-appearance:none;appearance:none}@media(prefers-reduced-motion:reduce){.custom-range::-webkit-slider-thumb{-webkit-transition:none;transition:none}}.custom-range::-webkit-slider-thumb:active{background-color:#b3d7ff}.custom-range::-webkit-slider-runnable-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:#dee2e6;border-color:transparent;border-radius:1rem}.custom-range::-moz-range-thumb{width:1rem;height:1rem;background-color:#007bff;border:0;border-radius:1rem;-moz-appearance:none;appearance:none}@media(prefers-reduced-motion:reduce){.custom-range::-moz-range-thumb{-moz-transition:none;transition:none}}.custom-range::-moz-range-thumb:active{background-color:#b3d7ff}.custom-range::-moz-range-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:#dee2e6;border-color:transparent;border-radius:1rem}.custom-range::-ms-thumb{width:1rem;height:1rem;margin-top:0;margin-right:.2rem;margin-left:.2rem;background-color:#007bff;border:0;border-radius:1rem;appearance:none}@media(prefers-reduced-motion:reduce){.custom-range::-ms-thumb{-ms-transition:none;transition:none}}.custom-range::-ms-thumb:active{background-color:#b3d7ff}.custom-range::-ms-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:transparent;border-color:transparent;border-width:.5rem}.custom-range::-ms-fill-lower{background-color:#dee2e6;border-radius:1rem}.custom-range::-ms-fill-upper{margin-right:15px;background-color:#dee2e6;border-radius:1rem}.custom-range:disabled::-webkit-slider-thumb{background-color:#adb5bd}.custom-range:disabled::-webkit-slider-runnable-track{cursor:default}.custom-range:disabled::-moz-range-thumb{background-color:#adb5bd}.custom-range:disabled::-moz-range-track{cursor:default}.custom-range:disabled::-ms-thumb{background-color:#adb5bd}@media(prefers-reduced-motion:reduce){.custom-select{transition:none}}.alert{position:relative;padding:.75rem 1.25rem;margin-bottom:1rem;border:1px solid transparent;border-radius:.25rem}.alert-heading{color:inherit}.alert-link{font-weight:700}.alert-primary{color:#004085;background-color:#cce5ff;border-color:#b8daff}.alert-primary .alert-link{color:#002752}.alert-light{color:#818182;background-color:#fefefe;border-color:#fdfdfe}.alert-light .alert-link{color:#686868}.alert-dark{color:#1b1e21;background-color:#d6d8d9;border-color:#c6c8ca}.alert-dark .alert-link{color:#040505}@-webkit-keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@-webkit-keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}@keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}.bg-primary{background-color:#007bff}a.bg-primary:focus,a.bg-primary:hover{background-color:#0062cc}.bg-light{background-color:#f8f9fa}a.bg-light:focus,a.bg-light:hover{background-color:#dae0e5}.bg-dark{background-color:#343a40}a.bg-dark:focus,a.bg-dark:hover{background-color:#1d2124}.bg-white{background-color:#fff}.d-none{display:none}.d-inline{display:inline}.d-inline-block{display:inline-block}.d-block{display:block}@media(min-width:768px){.d-md-none{display:none}.d-md-inline{display:inline}.d-md-inline-block{display:inline-block}.d-md-block{display:block}}@media(min-width:992px){.d-lg-none{display:none}.d-lg-inline{display:inline}.d-lg-inline-block{display:inline-block}.d-lg-block{display:block}}.float-right{float:right}.float-none{float:none}@media(min-width:768px){.float-md-right{float:right}.float-md-none{float:none}}@media(min-width:992px){.float-lg-right{float:right}.float-lg-none{float:none}}.fixed-bottom{position:fixed;right:0;bottom:0;left:0;z-index:1030}.h-25{height:25%}.h-50{height:50%}.h-75{height:75%}.h-100{height:100%}.my-0{margin-top:0}.mr-0{margin-right:0}.mb-0,.my-0{margin-bottom:0}.my-1{margin-top:.25rem}.mr-1{margin-right:.25rem}.mb-1,.my-1{margin-bottom:.25rem}.my-2{margin-top:.5rem}.mr-2{margin-right:.5rem}.mb-2,.my-2{margin-bottom:.5rem}.my-3{margin-top:1rem}.mr-3{margin-right:1rem}.mb-3,.my-3{margin-bottom:1rem}.my-4{margin-top:1.5rem}.mr-4{margin-right:1.5rem}.mb-4,.my-4{margin-bottom:1.5rem}.my-5{margin-top:3rem}.mr-5{margin-right:3rem}.mb-5,.my-5{margin-bottom:3rem}.p-0{padding:0}.pt-0,.py-0{padding-top:0}.pb-0,.py-0{padding-bottom:0}.p-1{padding:.25rem}.pt-1,.py-1{padding-top:.25rem}.pb-1,.py-1{padding-bottom:.25rem}.p-2{padding:.5rem}.pt-2,.py-2{padding-top:.5rem}.pb-2,.py-2{padding-bottom:.5rem}.p-3{padding:1rem}.pt-3,.py-3{padding-top:1rem}.pb-3,.py-3{padding-bottom:1rem}.p-4{padding:1.5rem}.pt-4,.py-4{padding-top:1.5rem}.pb-4,.py-4{padding-bottom:1.5rem}.p-5{padding:3rem}.pt-5,.py-5{padding-top:3rem}.pb-5,.py-5{padding-bottom:3rem}.my-n1{margin-top:-.25rem}.mr-n1{margin-right:-.25rem}.mb-n1,.my-n1{margin-bottom:-.25rem}.my-n2{margin-top:-.5rem}.mr-n2{margin-right:-.5rem}.mb-n2,.my-n2{margin-bottom:-.5rem}.my-n3{margin-top:-1rem}.mr-n3{margin-right:-1rem}.mb-n3,.my-n3{margin-bottom:-1rem}.my-n4{margin-top:-1.5rem}.mr-n4{margin-right:-1.5rem}.mb-n4,.my-n4{margin-bottom:-1.5rem}.my-n5{margin-top:-3rem}.mr-n5{margin-right:-3rem}.mb-n5,.my-n5{margin-bottom:-3rem}@media(min-width:768px){.my-md-0{margin-top:0}.mr-md-0{margin-right:0}.mb-md-0,.my-md-0{margin-bottom:0}.my-md-1{margin-top:.25rem}.mr-md-1{margin-right:.25rem}.mb-md-1,.my-md-1{margin-bottom:.25rem}.my-md-2{margin-top:.5rem}.mr-md-2{margin-right:.5rem}.mb-md-2,.my-md-2{margin-bottom:.5rem}.my-md-3{margin-top:1rem}.mr-md-3{margin-right:1rem}.mb-md-3,.my-md-3{margin-bottom:1rem}.my-md-4{margin-top:1.5rem}.mr-md-4{margin-right:1.5rem}.mb-md-4,.my-md-4{margin-bottom:1.5rem}.my-md-5{margin-top:3rem}.mr-md-5{margin-right:3rem}.mb-md-5,.my-md-5{margin-bottom:3rem}.p-md-0{padding:0}.pt-md-0,.py-md-0{padding-top:0}.pb-md-0,.py-md-0{padding-bottom:0}.p-md-1{padding:.25rem}.pt-md-1,.py-md-1{padding-top:.25rem}.pb-md-1,.py-md-1{padding-bottom:.25rem}.p-md-2{padding:.5rem}.pt-md-2,.py-md-2{padding-top:.5rem}.pb-md-2,.py-md-2{padding-bottom:.5rem}.p-md-3{padding:1rem}.pt-md-3,.py-md-3{padding-top:1rem}.pb-md-3,.py-md-3{padding-bottom:1rem}.p-md-4{padding:1.5rem}.pt-md-4,.py-md-4{padding-top:1.5rem}.pb-md-4,.py-md-4{padding-bottom:1.5rem}.p-md-5{padding:3rem}.pt-md-5,.py-md-5{padding-top:3rem}.pb-md-5,.py-md-5{padding-bottom:3rem}.my-md-n1{margin-top:-.25rem}.mr-md-n1{margin-right:-.25rem}.mb-md-n1,.my-md-n1{margin-bottom:-.25rem}.my-md-n2{margin-top:-.5rem}.mr-md-n2{margin-right:-.5rem}.mb-md-n2,.my-md-n2{margin-bottom:-.5rem}.my-md-n3{margin-top:-1rem}.mr-md-n3{margin-right:-1rem}.mb-md-n3,.my-md-n3{margin-bottom:-1rem}.my-md-n4{margin-top:-1.5rem}.mr-md-n4{margin-right:-1.5rem}.mb-md-n4,.my-md-n4{margin-bottom:-1.5rem}.my-md-n5{margin-top:-3rem}.mr-md-n5{margin-right:-3rem}.mb-md-n5,.my-md-n5{margin-bottom:-3rem}}@media(min-width:992px){.my-lg-0{margin-top:0}.mr-lg-0{margin-right:0}.mb-lg-0,.my-lg-0{margin-bottom:0}.my-lg-1{margin-top:.25rem}.mr-lg-1{margin-right:.25rem}.mb-lg-1,.my-lg-1{margin-bottom:.25rem}.my-lg-2{margin-top:.5rem}.mr-lg-2{margin-right:.5rem}.mb-lg-2,.my-lg-2{margin-bottom:.5rem}.my-lg-3{margin-top:1rem}.mr-lg-3{margin-right:1rem}.mb-lg-3,.my-lg-3{margin-bottom:1rem}.my-lg-4{margin-top:1.5rem}.mr-lg-4{margin-right:1.5rem}.mb-lg-4,.my-lg-4{margin-bottom:1.5rem}.my-lg-5{margin-top:3rem}.mr-lg-5{margin-right:3rem}.mb-lg-5,.my-lg-5{margin-bottom:3rem}.p-lg-0{padding:0}.pt-lg-0,.py-lg-0{padding-top:0}.pb-lg-0,.py-lg-0{padding-bottom:0}.p-lg-1{padding:.25rem}.pt-lg-1,.py-lg-1{padding-top:.25rem}.pb-lg-1,.py-lg-1{padding-bottom:.25rem}.p-lg-2{padding:.5rem}.pt-lg-2,.py-lg-2{padding-top:.5rem}.pb-lg-2,.py-lg-2{padding-bottom:.5rem}.p-lg-3{padding:1rem}.pt-lg-3,.py-lg-3{padding-top:1rem}.pb-lg-3,.py-lg-3{padding-bottom:1rem}.p-lg-4{padding:1.5rem}.pt-lg-4,.py-lg-4{padding-top:1.5rem}.pb-lg-4,.py-lg-4{padding-bottom:1.5rem}.p-lg-5{padding:3rem}.pt-lg-5,.py-lg-5{padding-top:3rem}.pb-lg-5,.py-lg-5{padding-bottom:3rem}.my-lg-n1{margin-top:-.25rem}.mr-lg-n1{margin-right:-.25rem}.mb-lg-n1,.my-lg-n1{margin-bottom:-.25rem}.my-lg-n2{margin-top:-.5rem}.mr-lg-n2{margin-right:-.5rem}.mb-lg-n2,.my-lg-n2{margin-bottom:-.5rem}.my-lg-n3{margin-top:-1rem}.mr-lg-n3{margin-right:-1rem}.mb-lg-n3,.my-lg-n3{margin-bottom:-1rem}.my-lg-n4{margin-top:-1.5rem}.mr-lg-n4{margin-right:-1.5rem}.mb-lg-n4,.my-lg-n4{margin-bottom:-1.5rem}.my-lg-n5{margin-top:-3rem}.mr-lg-n5{margin-right:-3rem}.mb-lg-n5,.my-lg-n5{margin-bottom:-3rem}}.text-right{text-align:right}.text-center{text-align:center}@media(min-width:768px){.text-md-right{text-align:right}.text-md-center{text-align:center}}@media(min-width:992px){.text-lg-right{text-align:right}.text-lg-center{text-align:center}}.text-white{color:#fff}.text-primary{color:#007bff}a.text-primary:focus,a.text-primary:hover{color:#0056b3}.text-light{color:#f8f9fa}a.text-light:focus,a.text-light:hover{color:#cbd3da}.text-dark{color:#343a40}a.text-dark:focus,a.text-dark:hover{color:#121416}.text-body{color:#212529}.text-muted{color:#6c757d}.text-black-50{color:rgba(0,0,0,.5)}.text-white-50{color:rgba(255,255,255,.5)}.text-decoration-none{text-decoration:none}.text-reset{color:inherit}.visible{visibility:visible}@media print{*,::after,::before{text-shadow:none;box-shadow:none}a:not(.btn){text-decoration:underline}pre{white-space:pre-wrap}pre{border:1px solid #adb5bd;page-break-inside:avoid}img{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}body{min-width:992px}.container{min-width:992px}}@-webkit-keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}@keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"}a:link,a:visited{color:#f14600;text-decoration:none}a:active,a:hover{text-decoration:underline}.btn:disabled{cursor:default;opacity:.4}#logo-text{width:180px;margin-left:12px}.display-5{font-size:2rem;font-weight:300;line-height:1.2}.display-6{font-size:1.75rem;font-weight:300;line-height:1.2}.bg-dark-alt,.bg-dark-alt:focus{background:#36363f}.bg-orange,.bg-orange:focus{background:#f14600}.text-dark-alt{color:#36363f}.btn-dark-alt{background:#36363f}.btn-dark-alt:focus{background:#36363f}.btn-outline-orange{border-color:#f14600;color:#f14600}.btn-orange,.btn-outline-orange:hover{background:#f14600;color:#fff}.btn:active,.btn:hover{text-decoration:none}.text-orange{color:#f14600}.headerlink{text-decoration:none;margin-left:.5rem}#content code{color:#000;background:#eee;padding:.125rem .25rem}#content code.syntax{padding:0}#content pre{background:#efefef;padding:1rem;line-height:1.25}@media print{body{min-width:0}code,h1,h2,h3,h4,h5,h6,img,li,p,pre{page-break-inside:avoid}}@media(prefers-color-scheme:dark){#to-full-website,body.amp,body[data-spy]{background:#1c1c1c;color:#efefef}.invert-dark{filter:invert(100%)}#content code{background:#444;color:#eee;padding:.125rem .25rem}#content pre{background:#444;color:#eee}}@media(prefers-color-scheme:dark){.syntax{background:#2d2d2d;color:#f2f0ec}.syntax .c{color:#747369}.syntax .k{color:#c9c}.syntax .n{color:#f2f0ec}.syntax .o{color:#6cc}.syntax .p{color:#f2f0ec}.syntax .c1{color:#747369}.syntax .ld{color:#9c9}.syntax .s{color:#9c9}.syntax .nb{color:#f2f0ec}.syntax .no{color:#f2777a}.syntax .py{color:#f2f0ec}.syntax .mi{color:#f99157}.syntax .s2{color:#9c9}.syntax .s1{color:#9c9}}</style><script async custom-element=amp-analytics src=https://cdn.ampproject.org/v0/amp-analytics-0.1.js></script><script async custom-element=amp-iframe src=https://cdn.ampproject.org/v0/amp-iframe-0.1.js></script></head> <body class=amp dir=ltr> <div class="container-fluid container-lg pb-5"> <div class="row pt-3 mb-3"> <div class=col> <a href=/ class=text-decoration-none> <amp-img class="d-inline-block mr-3" layout=fixed width=40 height=36 src=/images/logo.svg alt="ClickHouse logo" title="ClickHouse logo"></amp-img><amp-img class="invert-dark d-inline-block" layout=fixed width=238 height=36 src=/images/clickhouse-black.svg alt=ClickHouse title=ClickHouse></amp-img> </a> </div> </div> <div class=row> <div id=content class=col> <h1 id=functions-for-working-with-arrays>Массивы<a class=headerlink href=../amp/#functions-for-working-with-arrays title="Permanent link"> </a></h1> <h2 id=function-empty>empty<a class=headerlink href=../amp/#function-empty title="Permanent link"> </a></h2> <p>Возвращает 1 для пустого массива, и 0 для непустого массива.<br> Тип результата - UInt8.<br> Функция также работает для строк.</p> <h2 id=function-notempty>notEmpty<a class=headerlink href=../amp/#function-notempty title="Permanent link"> </a></h2> <p>Возвращает 0 для пустого массива, и 1 для непустого массива.<br> Тип результата - UInt8.<br> Функция также работает для строк.</p> <h2 id=array_functions-length>length<a class=headerlink href=../amp/#array_functions-length title="Permanent link"> </a></h2> <p>Возвращает количество элементов в массиве.<br> Тип результата - UInt64.<br> Функция также работает для строк.</p> <h2 id=emptyarrayuint8-emptyarrayuint16-emptyarrayuint32-emptyarrayuint64>emptyArrayUInt8, emptyArrayUInt16, emptyArrayUInt32, emptyArrayUInt64<a class=headerlink href=../amp/#emptyarrayuint8-emptyarrayuint16-emptyarrayuint32-emptyarrayuint64 title="Permanent link"> </a></h2> <h2 id=emptyarrayint8-emptyarrayint16-emptyarrayint32-emptyarrayint64>emptyArrayInt8, emptyArrayInt16, emptyArrayInt32, emptyArrayInt64<a class=headerlink href=../amp/#emptyarrayint8-emptyarrayint16-emptyarrayint32-emptyarrayint64 title="Permanent link"> </a></h2> <h2 id=emptyarrayfloat32-emptyarrayfloat64>emptyArrayFloat32, emptyArrayFloat64<a class=headerlink href=../amp/#emptyarrayfloat32-emptyarrayfloat64 title="Permanent link"> </a></h2> <h2 id=emptyarraydate-emptyarraydatetime>emptyArrayDate, emptyArrayDateTime<a class=headerlink href=../amp/#emptyarraydate-emptyarraydatetime title="Permanent link"> </a></h2> <h2 id=emptyarraystring>emptyArrayString<a class=headerlink href=../amp/#emptyarraystring title="Permanent link"> </a></h2> <p>Принимает ноль аргументов и возвращает пустой массив соответствующего типа.</p> <h2 id=emptyarraytosingle>emptyArrayToSingle<a class=headerlink href=../amp/#emptyarraytosingle title="Permanent link"> </a></h2> <p>Принимает пустой массив и возвращает массив из одного элемента, равного значению по умолчанию.</p> <h2 id=range>range(end), range([start, ] end [, step])<a class=headerlink href=../amp/#range title="Permanent link"> </a></h2> <p>Возвращает массив чисел от <code class=syntax>start</code> до <code class=syntax>end - 1</code> с шагом <code class=syntax>step</code>.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>range</span><span class=p>([</span><span class=k>start</span><span class=p>,</span> <span class=p>]</span> <span class=k>end</span> <span class=p>[,</span> <span class=n>step</span><span class=p>])</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>start</code> — начало диапазона. Обязательно, когда указан <code class=syntax>step</code>. По умолчанию равно <code class=syntax>0</code>. Тип: <a href=../../../data-types/int-uint/amp/ >UInt</a></li> <li><code class=syntax>end</code> — конец диапазона. Обязательный аргумент. Должен быть больше, чем <code class=syntax>start</code>. Тип: <a href=../../../data-types/int-uint/amp/ >UInt</a></li> <li><code class=syntax>step</code> — шаг обхода. Необязательный аргумент. По умолчанию равен <code class=syntax>1</code>. Тип: <a href=../../../data-types/int-uint/amp/ >UInt</a></li> </ul> <p><strong>Возвращаемые значения</strong></p> <ul> <li>массив <code class=syntax>UInt</code> чисел от <code class=syntax>start</code> до <code class=syntax>end - 1</code> с шагом <code class=syntax>step</code></li> </ul> <p><strong>Особенности реализации</strong></p> <ul> <li> <p>Не поддерживаются отрицательные значения аргументов: <code class=syntax>start</code>, <code class=syntax>end</code>, <code class=syntax>step</code> имеют тип <code class=syntax>UInt</code>.</p> </li> <li> <p>Если в результате запроса создаются массивы суммарной длиной больше 100 000 000 элементов, то генерируется исключение.</p> </li> </ul> <p><strong>Примеры</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>range</span><span class=p>(</span><span class=mi>5</span><span class=p>),</span> <span class=n>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>),</span> <span class=n>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>2</span><span class=p>);</span>
</code></pre></div> <p>Ответ:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─range(5)────┬─range(1, 5)─┬─range(1, 5, 2)─┐
│ [0,1,2,3,4] │ [1,2,3,4]   │ [1,3]          │
└─────────────┴─────────────┴────────────────┘
</code></pre></div> <h2 id=arrayx1-operator-x1>array(x1, …), оператор [x1, …]<a class=headerlink href=../amp/#arrayx1-operator-x1 title="Permanent link"> </a></h2> <p>Создаёт массив из аргументов функции.<br> Аргументы должны быть константами и иметь типы, для которых есть наименьший общий тип. Должен быть передан хотя бы один аргумент, так как иначе непонятно, какого типа создавать массив. То есть, с помощью этой функции невозможно создать пустой массив (для этого используйте функции emptyArray*, описанные выше).<br> Возвращает результат типа Array(T), где T - наименьший общий тип от переданных аргументов.</p> <h2 id=arrayconcat>arrayConcat<a class=headerlink href=../amp/#arrayconcat title="Permanent link"> </a></h2> <p>Объединяет массивы, переданные в качестве аргументов.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arrayConcat</span><span class=p>(</span><span class=n>arrays</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>arrays</code> – произвольное количество элементов типа <a href=.././amp/ >Array</a><br> <strong>Пример</strong></li> </ul> <!-- --> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayConcat</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res───────────┐
│ [1,2,3,4,5,6] │
└───────────────┘
</code></pre></div> <h2 id=arrayelementarr-n-operator-arrn>arrayElement(arr, n), operator arr[n]<a class=headerlink href=../amp/#arrayelementarr-n-operator-arrn title="Permanent link"> </a></h2> <p>Достаёт элемент с индексом n из массива arr. n должен быть любым целочисленным типом.<br> Индексы в массиве начинаются с единицы.<br> Поддерживаются отрицательные индексы. В этом случае, будет выбран соответствующий по номеру элемент с конца. Например, arr[-1] - последний элемент массива.</p> <p>Если индекс выходит за границы массива, то возвращается некоторое значение по умолчанию (0 для чисел, пустая строка для строк и т. п.), кроме случая с неконстантным массивом и константным индексом 0 (в этом случае будет ошибка <code class=syntax>Array indices are 1-based</code>).</p> <h2 id=hasarr-elem>has(arr, elem)<a class=headerlink href=../amp/#hasarr-elem title="Permanent link"> </a></h2> <p>Проверяет наличие элемента elem в массиве arr.<br> Возвращает 0, если элемента в массиве нет, или 1, если есть.</p> <p><code class=syntax>NULL</code> обрабатывается как значение.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>has</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=k>NULL</span><span class=p>],</span> <span class=k>NULL</span><span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─has([1, 2, NULL], NULL)─┐
│                       1 │
└─────────────────────────┘
</code></pre></div> <h2 id=hasall>hasAll<a class=headerlink href=../amp/#hasall title="Permanent link"> </a></h2> <p>Проверяет, является ли один массив подмножеством другого.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>hasAll</span><span class=p>(</span><span class=k>set</span><span class=p>,</span> <span class=n>subset</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>set</code> – массив любого типа с набором элементов.</li> <li><code class=syntax>subset</code> – массив любого типа со значениями, которые проверяются на вхождение в <code class=syntax>set</code>.</li> </ul> <p><strong>Возвращаемые значения</strong></p> <ul> <li><code class=syntax>1</code>, если <code class=syntax>set</code> содержит все элементы из <code class=syntax>subset</code>.</li> <li><code class=syntax>0</code>, в противном случае.</li> </ul> <p><strong>Особенности</strong></p> <ul> <li>Пустой массив является подмножеством любого массива.</li> <li><code class=syntax>NULL</code> обрабатывается как значение.</li> <li>Порядок значений в обоих массивах не имеет значения.</li> </ul> <p><strong>Примеры</strong></p> <p><code class=syntax>SELECT hasAll([], [])</code> возвращает 1.</p> <p><code class=syntax>SELECT hasAll([1, Null], [Null])</code> возвращает 1.</p> <p><code class=syntax>SELECT hasAll([1.0, 2, 3, 4], [1, 3])</code> возвращает 1.</p> <p><code class=syntax>SELECT hasAll(['a', 'b'], ['a'])</code> возвращает 1.</p> <p><code class=syntax>SELECT hasAll([1], ['a'])</code> возвращает 0.</p> <p><code class=syntax>SELECT hasAll([[1, 2], [3, 4]], [[1, 2], [3, 5]])</code> возвращает 0.</p> <h2 id=hasany>hasAny<a class=headerlink href=../amp/#hasany title="Permanent link"> </a></h2> <p>Проверяет, имеют ли два массива хотя бы один общий элемент.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>hasAny</span><span class=p>(</span><span class=n>array1</span><span class=p>,</span> <span class=n>array2</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>array1</code> – массив любого типа с набором элементов.</li> <li><code class=syntax>array2</code> – массив любого типа с набором элементов.</li> </ul> <p><strong>Возвращаемые значения</strong></p> <ul> <li><code class=syntax>1</code>, если <code class=syntax>array1</code> и <code class=syntax>array2</code> имеют хотя бы один одинаковый элемент.</li> <li><code class=syntax>0</code>, в противном случае.</li> </ul> <p><strong>Особенности</strong></p> <ul> <li><code class=syntax>NULL</code> обрабатывается как значение.</li> <li>Порядок значений в обоих массивах не имеет значения.</li> </ul> <p><strong>Примеры</strong></p> <p><code class=syntax>SELECT hasAny([1], [])</code> возвращает <code class=syntax>0</code>.</p> <p><code class=syntax>SELECT hasAny([Null], [Null, 1])</code> возвращает <code class=syntax>1</code>.</p> <p><code class=syntax>SELECT hasAny([-128, 1., 512], [1])</code> возвращает <code class=syntax>1</code>.</p> <p><code class=syntax>SELECT hasAny([[1, 2], [3, 4]], ['a', 'c'])</code> возвращает <code class=syntax>0</code>.</p> <p><code class=syntax>SELECT hasAll([[1, 2], [3, 4]], [[1, 2], [1, 2]])</code> возвращает <code class=syntax>1</code>.</p> <h2 id=indexofarr-x>indexOf(arr, x)<a class=headerlink href=../amp/#indexofarr-x title="Permanent link"> </a></h2> <p>Возвращает индекс первого элемента x (начиная с 1), если он есть в массиве, или 0, если его нет.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>indexOf</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=k>NULL</span><span class=p>,</span> <span class=k>NULL</span><span class=p>],</span> <span class=k>NULL</span><span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─indexOf([1, 3, NULL, NULL], NULL)─┐
│                                 3 │
└───────────────────────────────────┘
</code></pre></div> <p>Элементы, равные <code class=syntax>NULL</code>, обрабатываются как обычные значения.</p> <h2 id=array-count>arrayCount([func,] arr1, …)<a class=headerlink href=../amp/#array-count title="Permanent link"> </a></h2> <p>Возвращает количество элементов массива <code class=syntax>arr</code>, для которых функция <code class=syntax>func</code> возвращает не 0. Если <code class=syntax>func</code> не указана - возвращает количество ненулевых элементов массива.</p> <p>Функция <code class=syntax>arrayCount</code> является <a href=../../amp/#higher-order-functions>функцией высшего порядка</a> — в качестве первого аргумента ей можно передать лямбда-функцию.</p> <h2 id=countequalarr-x>countEqual(arr, x)<a class=headerlink href=../amp/#countequalarr-x title="Permanent link"> </a></h2> <p>Возвращает количество элементов массива, равных x. Эквивалентно arrayCount(elem -&gt; elem = x, arr).</p> <p><code class=syntax>NULL</code> обрабатывается как значение.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>countEqual</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=k>NULL</span><span class=p>,</span> <span class=k>NULL</span><span class=p>],</span> <span class=k>NULL</span><span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─countEqual([1, 2, NULL, NULL], NULL)─┐
│                                    2 │
└──────────────────────────────────────┘
</code></pre></div> <h2 id=array_functions-arrayenumerate>arrayEnumerate(arr)<a class=headerlink href=../amp/#array_functions-arrayenumerate title="Permanent link"> </a></h2> <p>Возвращает массив [1, 2, 3, …, length(arr)]</p> <p>Эта функция обычно используется совместно с ARRAY JOIN. Она позволяет, после применения ARRAY JOIN, посчитать что-либо только один раз для каждого массива. Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=k>count</span><span class=p>()</span> <span class=k>AS</span> <span class=n>Reaches</span><span class=p>,</span>
    <span class=n>countIf</span><span class=p>(</span><span class=n>num</span> <span class=o>=</span> <span class=mi>1</span><span class=p>)</span> <span class=k>AS</span> <span class=n>Hits</span>
<span class=k>FROM</span> <span class=n>test</span><span class=p>.</span><span class=n>hits</span>
<span class=nb>ARRAY</span> <span class=k>JOIN</span>
    <span class=n>GoalsReached</span><span class=p>,</span>
    <span class=n>arrayEnumerate</span><span class=p>(</span><span class=n>GoalsReached</span><span class=p>)</span> <span class=k>AS</span> <span class=n>num</span>
<span class=k>WHERE</span> <span class=n>CounterID</span> <span class=o>=</span> <span class=mi>160656</span>
<span class=k>LIMIT</span> <span class=mi>10</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─Reaches─┬──Hits─┐
│   95606 │ 31406 │
└─────────┴───────┘
</code></pre></div> <p>В этом примере, Reaches - число достижений целей (строк, получившихся после применения ARRAY JOIN), а Hits - число хитов (строк, которые были до ARRAY JOIN). В данном случае, тот же результат можно получить проще:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=k>sum</span><span class=p>(</span><span class=k>length</span><span class=p>(</span><span class=n>GoalsReached</span><span class=p>))</span> <span class=k>AS</span> <span class=n>Reaches</span><span class=p>,</span>
    <span class=k>count</span><span class=p>()</span> <span class=k>AS</span> <span class=n>Hits</span>
<span class=k>FROM</span> <span class=n>test</span><span class=p>.</span><span class=n>hits</span>
<span class=k>WHERE</span> <span class=p>(</span><span class=n>CounterID</span> <span class=o>=</span> <span class=mi>160656</span><span class=p>)</span> <span class=k>AND</span> <span class=n>notEmpty</span><span class=p>(</span><span class=n>GoalsReached</span><span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─Reaches─┬──Hits─┐
│   95606 │ 31406 │
└─────────┴───────┘
</code></pre></div> <p>Также эта функция может быть использована в функциях высшего порядка. Например, с её помощью можно достать индексы массива для элементов, удовлетворяющих некоторому условию.</p> <h2 id=arrayenumerateuniqarr>arrayEnumerateUniq(arr, …)<a class=headerlink href=../amp/#arrayenumerateuniqarr title="Permanent link"> </a></h2> <p>Возвращает массив, такого же размера, как исходный, где для каждого элемента указано, какой он по счету среди элементов с таким же значением.<br> Например: arrayEnumerateUniq([10, 20, 10, 30]) = [1, 1, 2, 1].</p> <p>Эта функция полезна при использовании ARRAY JOIN и агрегации по элементам массива.<br> Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=n>Goals</span><span class=p>.</span><span class=n>ID</span> <span class=k>AS</span> <span class=n>GoalID</span><span class=p>,</span>
    <span class=k>sum</span><span class=p>(</span><span class=n>Sign</span><span class=p>)</span> <span class=k>AS</span> <span class=n>Reaches</span><span class=p>,</span>
    <span class=n>sumIf</span><span class=p>(</span><span class=n>Sign</span><span class=p>,</span> <span class=n>num</span> <span class=o>=</span> <span class=mi>1</span><span class=p>)</span> <span class=k>AS</span> <span class=n>Visits</span>
<span class=k>FROM</span> <span class=n>test</span><span class=p>.</span><span class=n>visits</span>
<span class=nb>ARRAY</span> <span class=k>JOIN</span>
    <span class=n>Goals</span><span class=p>,</span>
    <span class=n>arrayEnumerateUniq</span><span class=p>(</span><span class=n>Goals</span><span class=p>.</span><span class=n>ID</span><span class=p>)</span> <span class=k>AS</span> <span class=n>num</span>
<span class=k>WHERE</span> <span class=n>CounterID</span> <span class=o>=</span> <span class=mi>160656</span>
<span class=k>GROUP</span> <span class=k>BY</span> <span class=n>GoalID</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=n>Reaches</span> <span class=k>DESC</span>
<span class=k>LIMIT</span> <span class=mi>10</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌──GoalID─┬─Reaches─┬─Visits─┐
│   53225 │    3214 │   1097 │
│ 2825062 │    3188 │   1097 │
│   56600 │    2803 │    488 │
│ 1989037 │    2401 │    365 │
│ 2830064 │    2396 │    910 │
│ 1113562 │    2372 │    373 │
│ 3270895 │    2262 │    812 │
│ 1084657 │    2262 │    345 │
│   56599 │    2260 │    799 │
│ 3271094 │    2256 │    812 │
└─────────┴─────────┴────────┘
</code></pre></div> <p>В этом примере, для каждого идентификатора цели, посчитано количество достижений целей (каждый элемент вложенной структуры данных Goals является достижением целей) и количество визитов. Если бы не было ARRAY JOIN, мы бы считали количество визитов как sum(Sign). Но в данном случае, строчки были размножены по вложенной структуре Goals, и чтобы после этого учесть каждый визит один раз, мы поставили условие на значение функции arrayEnumerateUniq(Goals.ID).</p> <p>Функция arrayEnumerateUniq может принимать несколько аргументов - массивов одинаковых размеров. В этом случае, уникальность считается для кортежей элементов на одинаковых позициях всех массивов.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayEnumerateUniq</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res───────────┐
│ [1,2,1,1,2,1] │
└───────────────┘
</code></pre></div> <p>Это нужно при использовании ARRAY JOIN с вложенной структурой данных и затем агрегации по нескольким элементам этой структуры.</p> <h2 id=arraypopback>arrayPopBack<a class=headerlink href=../amp/#arraypopback title="Permanent link"> </a></h2> <p>Удаляет последний элемент из массива.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arrayPopBack</span><span class=p>(</span><span class=nb>array</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>array</code> – массив.</li> </ul> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayPopBack</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res───┐
│ [1,2] │
└───────┘
</code></pre></div> <h2 id=arraypopfront>arrayPopFront<a class=headerlink href=../amp/#arraypopfront title="Permanent link"> </a></h2> <p>Удаляет первый элемент из массива.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arrayPopFront</span><span class=p>(</span><span class=nb>array</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>array</code> – массив.</li> </ul> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayPopFront</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res───┐
│ [2,3] │
└───────┘
</code></pre></div> <h2 id=arraypushback>arrayPushBack<a class=headerlink href=../amp/#arraypushback title="Permanent link"> </a></h2> <p>Добавляет один элемент в конец массива.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arrayPushBack</span><span class=p>(</span><span class=nb>array</span><span class=p>,</span> <span class=n>single_value</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>array</code> – массив.</li> <li><code class=syntax>single_value</code> – значение добавляемого элемента. В массив с числам можно добавить только числа, в массив со строками только строки. При добавлении чисел ClickHouse автоматически приводит тип <code class=syntax>single_value</code> к типу данных массива. Подробнее о типах данных в ClickHouse читайте в разделе «<a href=.././amp/#data_types>Типы данных</a>». Может быть равно <code class=syntax>NULL</code>, в этом случае функция добавит элемент <code class=syntax>NULL</code> в массив, а тип элементов массива преобразует в <code class=syntax>Nullable</code>.</li> </ul> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayPushBack</span><span class=p>([</span><span class=s1>'a'</span><span class=p>],</span> <span class=s1>'b'</span><span class=p>)</span> <span class=k>AS</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res───────┐
│ ['a','b'] │
└───────────┘
</code></pre></div> <h2 id=arraypushfront>arrayPushFront<a class=headerlink href=../amp/#arraypushfront title="Permanent link"> </a></h2> <p>Добавляет один элемент в начало массива.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arrayPushFront</span><span class=p>(</span><span class=nb>array</span><span class=p>,</span> <span class=n>single_value</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>array</code> – массив.</li> <li><code class=syntax>single_value</code> – значение добавляемого элемента. В массив с числам можно добавить только числа, в массив со строками только строки. При добавлении чисел ClickHouse автоматически приводит тип <code class=syntax>single_value</code> к типу данных массива. Подробнее о типах данных в ClickHouse читайте в разделе «<a href=.././amp/#data_types>Типы данных</a>». Может быть равно <code class=syntax>NULL</code>, в этом случае функция добавит элемент <code class=syntax>NULL</code> в массив, а тип элементов массива преобразует в <code class=syntax>Nullable</code>.</li> </ul> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayPushFront</span><span class=p>([</span><span class=s1>'b'</span><span class=p>],</span> <span class=s1>'a'</span><span class=p>)</span> <span class=k>AS</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res───────┐
│ ['a','b'] │
└───────────┘
</code></pre></div> <h2 id=arrayresize>arrayResize<a class=headerlink href=../amp/#arrayresize title="Permanent link"> </a></h2> <p>Изменяет длину массива.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arrayResize</span><span class=p>(</span><span class=nb>array</span><span class=p>,</span> <span class=k>size</span><span class=p>[,</span> <span class=n>extender</span><span class=p>])</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>array</code> — массив.</li> <li><code class=syntax>size</code> — необходимая длина массива.<ul> <li>Если <code class=syntax>size</code> меньше изначального размера массива, то массив обрезается справа.</li> <li>Если <code class=syntax>size</code> больше изначального размера массива, массив дополняется справа значениями <code class=syntax>extender</code> или значениями по умолчанию для типа данных элементов массива.</li> </ul> </li> <li><code class=syntax>extender</code> — значение для дополнения массива. Может быть <code class=syntax>NULL</code>.</li> </ul> <p><strong>Возвращаемое значение:</strong></p> <p>Массив длины <code class=syntax>size</code>.</p> <p><strong>Примеры вызовов</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayResize</span><span class=p>([</span><span class=mi>1</span><span class=p>],</span> <span class=mi>3</span><span class=p>);</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─arrayResize([1], 3)─┐
│ [1,0,0]             │
└─────────────────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayResize</span><span class=p>([</span><span class=mi>1</span><span class=p>],</span> <span class=mi>3</span><span class=p>,</span> <span class=k>NULL</span><span class=p>);</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─arrayResize([1], 3, NULL)─┐
│ [1,NULL,NULL]             │
└───────────────────────────┘
</code></pre></div> <h2 id=arrayslice>arraySlice<a class=headerlink href=../amp/#arrayslice title="Permanent link"> </a></h2> <p>Возвращает срез массива.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arraySlice</span><span class=p>(</span><span class=nb>array</span><span class=p>,</span> <span class=k>offset</span><span class=p>[,</span> <span class=k>length</span><span class=p>])</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>array</code> – массив данных.</li> <li><code class=syntax>offset</code> – отступ от края массива. Положительное значение - отступ слева, отрицательное значение - отступ справа. Отсчет элементов массива начинается с 1.</li> <li><code class=syntax>length</code> – длина необходимого среза. Если указать отрицательное значение, то функция вернёт открытый срез <code class=syntax>[offset, array_length - length)</code>. Если не указать значение, то функция вернёт срез <code class=syntax>[offset, the_end_of_array]</code>.</li> </ul> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arraySlice</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=k>NULL</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>],</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span> <span class=k>AS</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res────────┐
│ [2,NULL,4] │
└────────────┘
</code></pre></div> <p>Элементы массива равные <code class=syntax>NULL</code> обрабатываются как обычные значения.</p> <h2 id=array_functions-sort>arraySort([func,] arr, …)<a class=headerlink href=../amp/#array_functions-sort title="Permanent link"> </a></h2> <p>Возвращает массив <code class=syntax>arr</code>, отсортированный в восходящем порядке. Если задана функция <code class=syntax>func</code>, то порядок сортировки определяется результатом применения этой функции на элементы массива <code class=syntax>arr</code>. Если <code class=syntax>func</code> принимает несколько аргументов, то в функцию <code class=syntax>arraySort</code> нужно передавать несколько массивов, которые будут соответствовать аргументам функции <code class=syntax>func</code>. Подробные примеры рассмотрены в конце описания <code class=syntax>arraySort</code>.</p> <p>Пример сортировки целочисленных значений:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arraySort</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=p>])</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─arraySort([1, 3, 3, 0])─┐
│ [0,1,3,3]               │
└─────────────────────────┘
</code></pre></div> <p>Пример сортировки строковых значений:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arraySort</span><span class=p>([</span><span class=s1>'hello'</span><span class=p>,</span> <span class=s1>'world'</span><span class=p>,</span> <span class=s1>'!'</span><span class=p>])</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─arraySort(['hello', 'world', '!'])─┐
│ ['!','hello','world']              │
└────────────────────────────────────┘
</code></pre></div> <p>Значения <code class=syntax>NULL</code>, <code class=syntax>NaN</code> и <code class=syntax>Inf</code> сортируются по следующему принципу:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arraySort</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=n>nan</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=k>NULL</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>nan</span><span class=p>,</span> <span class=o>-</span><span class=mi>4</span><span class=p>,</span> <span class=k>NULL</span><span class=p>,</span> <span class=n>inf</span><span class=p>,</span> <span class=o>-</span><span class=n>inf</span><span class=p>]);</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─arraySort([1, nan, 2, NULL, 3, nan, -4, NULL, inf, -inf])─┐
│ [-inf,-4,1,2,3,inf,nan,nan,NULL,NULL]                     │
└───────────────────────────────────────────────────────────┘
</code></pre></div> <ul> <li>Значения <code class=syntax>-Inf</code> идут в начале массива.</li> <li>Значения <code class=syntax>NULL</code> идут в конце массива.</li> <li>Значения <code class=syntax>NaN</code> идут перед <code class=syntax>NULL</code>.</li> <li>Значения <code class=syntax>Inf</code> идут перед <code class=syntax>NaN</code>.</li> </ul> <p>Функция <code class=syntax>arraySort</code> является <a href=../../amp/#higher-order-functions>функцией высшего порядка</a> — в качестве первого аргумента ей можно передать лямбда-функцию. В этом случае порядок сортировки определяется результатом применения лямбда-функции на элементы массива.</p> <p>Рассмотрим пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arraySort</span><span class=p>((</span><span class=n>x</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=o>-</span><span class=n>x</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span> <span class=k>as</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res─────┐
│ [3,2,1] │
└─────────┘
</code></pre></div> <p>Для каждого элемента исходного массива лямбда-функция возвращает ключ сортировки, то есть [1 –&gt; -1, 2 –&gt; -2, 3 –&gt; -3]. Так как <code class=syntax>arraySort</code> сортирует элементы в порядке возрастания ключей, результат будет [3, 2, 1]. Как можно заметить, функция <code class=syntax>x –&gt; -x</code> устанавливает <a href=../amp/#array_functions-reverse-sort>обратный порядок сортировки</a>.</p> <p>Лямбда-функция может принимать несколько аргументов. В этом случае, в функцию <code class=syntax>arraySort</code> нужно передавать несколько массивов, которые будут соответствовать аргументам лямбда-функции (массивы должны быть одинаковой длины). Следует иметь в виду, что результат будет содержать элементы только из первого массива; элементы из всех последующих массивов будут задавать ключи сортировки. Например:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arraySort</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>y</span><span class=p>,</span> <span class=p>[</span><span class=s1>'hello'</span><span class=p>,</span> <span class=s1>'world'</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span> <span class=k>as</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res────────────────┐
│ ['world', 'hello'] │
└────────────────────┘
</code></pre></div> <p>Элементы, указанные во втором массиве ([2,1]), определяют ключ сортировки для элементов из исходного массива ([‘hello’, ‘world’]), то есть [‘hello’ –&gt; 2, ‘world’ –&gt; 1]. Так как лямбда-функция не использует <code class=syntax>x</code>, элементы исходного массива не влияют на порядок сортировки. Таким образом, ‘hello’ будет вторым элементом в отсортированном массиве, а ‘world’ — первым.</p> <p>Ниже приведены другие примеры.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arraySort</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>y</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=s1>'c'</span><span class=p>,</span> <span class=s1>'b'</span><span class=p>,</span> <span class=s1>'a'</span><span class=p>])</span> <span class=k>as</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res─────┐
│ [2,1,0] │
└─────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arraySort</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=o>-</span><span class=n>y</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span> <span class=k>as</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res─────┐
│ [2,1,0] │
└─────────┘
</code></pre></div> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Примечание</p> <p>Для улучшения эффективности сортировки применяется <a class=alert-link href=https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%B5%D0%BE%D0%B1%D1%80%D0%B0%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%A8%D0%B2%D0%B0%D1%80%D1%86%D0%B0 rel="external nofollow noreferrer" target=_blank>преобразование Шварца</a>.</p> </div> <h2 id=array_functions-reverse-sort>arrayReverseSort([func,] arr, …)<a class=headerlink href=../amp/#array_functions-reverse-sort title="Permanent link"> </a></h2> <p>Возвращает массив <code class=syntax>arr</code>, отсортированный в нисходящем порядке. Если указана функция <code class=syntax>func</code>, то массив <code class=syntax>arr</code> сначала сортируется в порядке, который определяется функцией <code class=syntax>func</code>, а затем отсортированный массив переворачивается. Если функция <code class=syntax>func</code> принимает несколько аргументов, то в функцию <code class=syntax>arrayReverseSort</code> необходимо передавать несколько массивов, которые будут соответствовать аргументам функции <code class=syntax>func</code>. Подробные примеры рассмотрены в конце описания функции <code class=syntax>arrayReverseSort</code>.</p> <p>Пример сортировки целочисленных значений:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayReverseSort</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>0</span><span class=p>]);</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─arrayReverseSort([1, 3, 3, 0])─┐
│ [3,3,1,0]                      │
└────────────────────────────────┘
</code></pre></div> <p>Пример сортировки строковых значений:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayReverseSort</span><span class=p>([</span><span class=s1>'hello'</span><span class=p>,</span> <span class=s1>'world'</span><span class=p>,</span> <span class=s1>'!'</span><span class=p>]);</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─arrayReverseSort(['hello', 'world', '!'])─┐
│ ['world','hello','!']                     │
└───────────────────────────────────────────┘
</code></pre></div> <p>Значения <code class=syntax>NULL</code>, <code class=syntax>NaN</code> и <code class=syntax>Inf</code> сортируются в следующем порядке:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayReverseSort</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=n>nan</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=k>NULL</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>nan</span><span class=p>,</span> <span class=o>-</span><span class=mi>4</span><span class=p>,</span> <span class=k>NULL</span><span class=p>,</span> <span class=n>inf</span><span class=p>,</span> <span class=o>-</span><span class=n>inf</span><span class=p>])</span> <span class=k>as</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res───────────────────────────────────┐
│ [inf,3,2,1,-4,-inf,nan,nan,NULL,NULL] │
└───────────────────────────────────────┘
</code></pre></div> <ul> <li>Значения <code class=syntax>Inf</code> идут в начале массива.</li> <li>Значения <code class=syntax>NULL</code> идут в конце массива.</li> <li>Значения <code class=syntax>NaN</code> идут перед <code class=syntax>NULL</code>.</li> <li>Значения <code class=syntax>-Inf</code> идут перед <code class=syntax>NaN</code>.</li> </ul> <p>Функция <code class=syntax>arrayReverseSort</code> является <a href=../../amp/#higher-order-functions>функцией высшего порядка</a> — в качестве первого аргумента ей можно передать лямбда-функцию. Например:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayReverseSort</span><span class=p>((</span><span class=n>x</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=o>-</span><span class=n>x</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span> <span class=k>as</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res─────┐
│ [1,2,3] │
└─────────┘
</code></pre></div> <p>В этом примере, порядок сортировки устанавливается следующим образом:</p> <ol> <li>Сначала исходный массив ([1, 2, 3]) сортируется в том порядке, который определяется лямбда-функцией. Результатом будет массив [3, 2, 1].</li> <li>Массив, который был получен на предыдущем шаге, переворачивается. То есть, получается массив [1, 2, 3].</li> </ol> <p>Лямбда-функция может принимать на вход несколько аргументов. В этом случае, в функцию <code class=syntax>arrayReverseSort</code> нужно передавать несколько массивов, которые будут соответствовать аргументам лямбда-функции (массивы должны быть одинаковой длины). Следует иметь в виду, что результат будет содержать элементы только из первого массива; элементы из всех последующих массивов будут определять ключи сортировки. Например:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayReverseSort</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>y</span><span class=p>,</span> <span class=p>[</span><span class=s1>'hello'</span><span class=p>,</span> <span class=s1>'world'</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span> <span class=k>as</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res───────────────┐
│ ['hello','world'] │
└───────────────────┘
</code></pre></div> <p>В этом примере, массив сортируется следующим образом:</p> <ol> <li>Сначала массив сортируется в том порядке, который определяется лямбда-функцией. Элементы, указанные во втором массиве ([2,1]), определяют ключи сортировки соответствующих элементов из исходного массива ([‘hello’, ‘world’]). То есть, будет массив [‘world’, ‘hello’].</li> <li>Массив, который был отсортирован на предыдущем шаге, переворачивается. Получается массив [‘hello’, ‘world’].</li> </ol> <p>Ниже приведены ещё примеры.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayReverseSort</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>y</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=s1>'c'</span><span class=p>,</span> <span class=s1>'b'</span><span class=p>,</span> <span class=s1>'a'</span><span class=p>])</span> <span class=k>as</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res─────┐
│ [0,1,2] │
└─────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayReverseSort</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=o>-</span><span class=n>y</span><span class=p>,</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res─────┐
│ [4,3,5] │
└─────────┘
</code></pre></div> <h2 id=array-functions-arrayuniq>arrayUniq(arr, …)<a class=headerlink href=../amp/#array-functions-arrayuniq title="Permanent link"> </a></h2> <p>Если передан один аргумент, считает количество разных элементов в массиве.<br> Если передано несколько аргументов, считает количество разных кортежей из элементов на соответствующих позициях в нескольких массивах.</p> <p>Если необходимо получить список уникальных элементов массива, можно воспользоваться arrayReduce(‘groupUniqArray’, arr).</p> <h2 id=array-functions-arrayjoin>arrayJoin(arr)<a class=headerlink href=../amp/#array-functions-arrayjoin title="Permanent link"> </a></h2> <p>Особенная функция. Смотрите раздел <a href=../../array-join/amp/#functions_arrayjoin>«Функция arrayJoin»</a>.</p> <h2 id=arraydifference>arrayDifference<a class=headerlink href=../amp/#arraydifference title="Permanent link"> </a></h2> <p>Вычисляет разность между соседними элементами массива. Возвращает массив, где первым элементом будет 0, вторым – разность <code class=syntax>a[1] - a[0]</code> и т. д. Тип элементов результирующего массива определяется правилами вывода типов при вычитании (напр. <code class=syntax>UInt8</code> - <code class=syntax>UInt8</code> = <code class=syntax>Int16</code>).</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arrayDifference</span><span class=p>(</span><span class=nb>array</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>array</code> – <a href=https://clickhouse.tech/docs/ru/data_types/array/ target=_blank>массив</a>.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <p>Возвращает массив разностей между соседними элементами.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayDifference</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>]);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─arrayDifference([1, 2, 3, 4])─┐
│ [0,1,1,1]                     │
└───────────────────────────────┘
</code></pre></div> <p>Пример переполнения из-за результирующего типа <code class=syntax>Int64</code>:</p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayDifference</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>10000000000000000000</span><span class=p>]);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─arrayDifference([0, 10000000000000000000])─┐
│ [0,-8446744073709551616]                   │
└────────────────────────────────────────────┘
</code></pre></div> <h2 id=arraydistinct>arrayDistinct<a class=headerlink href=../amp/#arraydistinct title="Permanent link"> </a></h2> <p>Принимает массив, возвращает массив, содержащий уникальные элементы.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arrayDistinct</span><span class=p>(</span><span class=nb>array</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>array</code> – <a href=https://clickhouse.tech/docs/ru/data_types/array/ target=_blank>массив</a>.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <p>Возвращает массив, содержащий только уникальные элементы исходного массива.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayDistinct</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>]);</span>
</code></pre></div> <p>Ответ:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─arrayDistinct([1, 2, 2, 3, 1])─┐
│ [1,2,3]                        │
└────────────────────────────────┘
</code></pre></div> <h2 id=array_functions-arrayenumeratedense>arrayEnumerateDense(arr)<a class=headerlink href=../amp/#array_functions-arrayenumeratedense title="Permanent link"> </a></h2> <p>Возвращает массив того же размера, что и исходный массив, с индексами исходного массива, указывающими, где каждый элемент впервые появляется в исходном массиве.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayEnumerateDense</span><span class=p>([</span><span class=mi>10</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>30</span><span class=p>])</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─arrayEnumerateDense([10, 20, 10, 30])─┐
│ [1,2,1,3]                             │
└───────────────────────────────────────┘
</code></pre></div> <h2 id=array-functions-arrayintersect>arrayIntersect(arr)<a class=headerlink href=../amp/#array-functions-arrayintersect title="Permanent link"> </a></h2> <p>Принимает несколько массивов, возвращает массив с элементами, присутствующими во всех исходных массивах. Элементы на выходе следуют в порядке следования в первом массиве.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=n>arrayIntersect</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span> <span class=k>AS</span> <span class=n>no_intersect</span><span class=p>,</span>
    <span class=n>arrayIntersect</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>])</span> <span class=k>AS</span> <span class=k>intersect</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─no_intersect─┬─intersect─┐
│ []           │ [1]       │
└──────────────┴───────────┘
</code></pre></div> <h2 id=arrayreduce>arrayReduce<a class=headerlink href=../amp/#arrayreduce title="Permanent link"> </a></h2> <p>Применяет агрегатную функцию к элементам массива и возвращает ее результат. Имя агрегирующей функции передается как строка в одинарных кавычках <code class=syntax>'max'</code>, <code class=syntax>'sum'</code>. При использовании параметрических агрегатных функций, параметр указывается после имени функции в круглых скобках <code class=syntax>'uniqUpTo(6)'</code>.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arrayReduce</span><span class=p>(</span><span class=n>agg_func</span><span class=p>,</span> <span class=n>arr1</span><span class=p>,</span> <span class=n>arr2</span><span class=p>,</span> <span class=p>...,</span> <span class=n>arrN</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>agg_func</code> — Имя агрегатной функции, которая должна быть константой <a href=../../../data-types/string/amp/ >string</a>.</li> <li><code class=syntax>arr</code> — Любое количество столбцов типа <a href=../../../data-types/array/amp/ >array</a> в качестве параметров агрегатной функции.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayReduce</span><span class=p>(</span><span class=s1>'max'</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─arrayReduce('max', [1, 2, 3])─┐
│                             3 │
└───────────────────────────────┘
</code></pre></div> <p>Если агрегатная функция имеет несколько аргументов, то эту функцию можно применять к нескольким массивам одинакового размера.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayReduce</span><span class=p>(</span><span class=s1>'maxIf'</span><span class=p>,</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>5</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>]);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─arrayReduce('maxIf', [3, 5], [1, 0])─┐
│                                    3 │
└──────────────────────────────────────┘
</code></pre></div> <p>Пример с параметрической агрегатной функцией:</p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayReduce</span><span class=p>(</span><span class=s1>'uniqUpTo(3)'</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>10</span><span class=p>]);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─arrayReduce('uniqUpTo(3)', [1, 2, 3, 4, 5, 6, 7, 8, 9, 10])─┐
│                                                           4 │
└─────────────────────────────────────────────────────────────┘
</code></pre></div> <h2 id=arrayreduceinranges>arrayReduceInRanges<a class=headerlink href=../amp/#arrayreduceinranges title="Permanent link"> </a></h2> <p>Применяет агрегатную функцию к элементам массива в заданных диапазонах и возвращает массив, содержащий результат, соответствующий каждому диапазону. Функция вернет тот же результат, что и несколько <code class=syntax>arrayReduce(agg_func, arraySlice(arr1, index, length), ...)</code>.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arrayReduceInRanges</span><span class=p>(</span><span class=n>agg_func</span><span class=p>,</span> <span class=n>ranges</span><span class=p>,</span> <span class=n>arr1</span><span class=p>,</span> <span class=n>arr2</span><span class=p>,</span> <span class=p>...,</span> <span class=n>arrN</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>agg_func</code> — имя агрегатной функции, которая должна быть <a href=../../../data-types/string/amp/ >строковой</a> константой.</li> <li><code class=syntax>ranges</code> — диапазоны для агрегирования, которые должны быть <a href=../../../data-types/array/amp/ >массивом</a> of <a href=../../../data-types/tuple/amp/ >кортежей</a> содержащих индекс и длину каждого диапазона.</li> <li><code class=syntax>arr</code> — любое количество столбцов типа <a href=../../../data-types/array/amp/ >Array</a> в качестве параметров агрегатной функции.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Массив, содержащий результаты агрегатной функции для указанных диапазонов.</li> </ul> <p>Тип: <a href=../../../data-types/array/amp/ >Array</a>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayReduceInRanges</span><span class=p>(</span>
    <span class=s1>'sum'</span><span class=p>,</span>
    <span class=p>[(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>5</span><span class=p>),</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>),</span> <span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>),</span> <span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>)],</span>
    <span class=p>[</span><span class=mi>1000000</span><span class=p>,</span> <span class=mi>200000</span><span class=p>,</span> <span class=mi>30000</span><span class=p>,</span> <span class=mi>4000</span><span class=p>,</span> <span class=mi>500</span><span class=p>,</span> <span class=mi>60</span><span class=p>,</span> <span class=mi>7</span><span class=p>]</span>
<span class=p>)</span> <span class=k>AS</span> <span class=n>res</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─res─────────────────────────┐
│ [1234500,234000,34560,4567] │
└─────────────────────────────┘
</code></pre></div> <h2 id=arrayreverse>arrayReverse(arr)<a class=headerlink href=../amp/#arrayreverse title="Permanent link"> </a></h2> <p>Возвращает массив того же размера, что и исходный массив, содержащий элементы в обратном порядке.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayReverse</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─arrayReverse([1, 2, 3])─┐
│ [3,2,1]                 │
└─────────────────────────┘
</code></pre></div> <h2 id=array-functions-reverse>reverse(arr)<a class=headerlink href=../amp/#array-functions-reverse title="Permanent link"> </a></h2> <p>Синоним для <a href=../amp/#arrayreverse>«arrayReverse»</a></p> <h2 id=arrayflatten>arrayFlatten<a class=headerlink href=../amp/#arrayflatten title="Permanent link"> </a></h2> <p>Преобразует массив массивов в плоский массив.</p> <p>Функция:</p> <ul> <li>Оперирует с массивами любой вложенности.</li> <li>Не изменяет массив, если он уже плоский.</li> </ul> <p>Результирующий массив содержит все элементы исходных массивов.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>flatten</span><span class=p>(</span><span class=n>array_of_arrays</span><span class=p>)</span>
</code></pre></div> <p>Синоним: <code class=syntax>flatten</code>.</p> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>array_of_arrays</code> — <a href=.././amp/ >массив</a> массивов. Например, <code class=syntax>[[1,2,3], [4,5]]</code>.</li> </ul> <p><strong>Примеры</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>flatten</span><span class=p>([[[</span><span class=mi>1</span><span class=p>]],</span> <span class=p>[[</span><span class=mi>2</span><span class=p>],</span> <span class=p>[</span><span class=mi>3</span><span class=p>]]]);</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─flatten(array(array([1]), array([2], [3])))─┐
│ [1,2,3]                                     │
└─────────────────────────────────────────────┘
</code></pre></div> <h2 id=arraycompact>arrayCompact<a class=headerlink href=../amp/#arraycompact title="Permanent link"> </a></h2> <p>Удаляет последовательно повторяющиеся элементы из массива. Порядок результирующих значений определяется порядком в исходном массиве.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arrayCompact</span><span class=p>(</span><span class=n>arr</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <p><code class=syntax>arr</code> — <a href=.././amp/ >массив</a> для обхода.</p> <p><strong>Возвращаемое значение</strong></p> <p>Массив без последовательных дубликатов.</p> <p>Тип: <code class=syntax>Array</code>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayCompact</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=n>nan</span><span class=p>,</span> <span class=n>nan</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>]);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─arrayCompact([1, 1, nan, nan, 2, 3, 3, 3])─┐
│ [1,nan,nan,2,3]                            │
└────────────────────────────────────────────┘
</code></pre></div> <h2 id=arrayzip>arrayZip<a class=headerlink href=../amp/#arrayzip title="Permanent link"> </a></h2> <p>Объединяет несколько массивов в один. Результирующий массив содержит соответственные элементы исходных массивов, сгруппированные в кортежи в указанном порядке аргументов.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arrayZip</span><span class=p>(</span><span class=n>arr1</span><span class=p>,</span> <span class=n>arr2</span><span class=p>,</span> <span class=p>...,</span> <span class=n>arrN</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>arrN</code> — <a href=../../../data-types/array/amp/ >массив</a>.</li> </ul> <p>Функция принимает любое количество массивов, которые могут быть различных типов. Все массивы должны иметь одинаковую длину.</p> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Массив с элементами исходных массивов, сгруппированными в <a href=../../../data-types/tuple/amp/ >кортежи</a>. Типы данных в кортежах соответствуют типам данных входных массивов и следуют в том же порядке, в котором переданы массивы.</li> </ul> <p>Тип: <a href=../../../data-types/array/amp/ >Массив</a>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayZip</span><span class=p>([</span><span class=s1>'a'</span><span class=p>,</span> <span class=s1>'b'</span><span class=p>,</span> <span class=s1>'c'</span><span class=p>],</span> <span class=p>[</span><span class=mi>5</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>]);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─arrayZip(['a', 'b', 'c'], [5, 2, 1])─┐
│ [('a',5),('b',2),('c',1)]            │
└──────────────────────────────────────┘
</code></pre></div> <h2 id=array-map>arrayMap(func, arr1, …)<a class=headerlink href=../amp/#array-map title="Permanent link"> </a></h2> <p>Возвращает массив, полученный на основе результатов применения функции <code class=syntax>func</code> к каждому элементу массива <code class=syntax>arr</code>.</p> <p>Примеры:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayMap</span><span class=p>(</span><span class=n>x</span> <span class=o>-&gt;</span> <span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=mi>2</span><span class=p>),</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span> <span class=k>as</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res─────┐
│ [3,4,5] │
└─────────┘
</code></pre></div> <p>Следующий пример показывает, как создать кортежи из элементов разных массивов:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayMap</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res─────────────────┐
│ [(1,4),(2,5),(3,6)] │
└─────────────────────┘
</code></pre></div> <p>Функция <code class=syntax>arrayMap</code> является <a href=../../amp/#higher-order-functions>функцией высшего порядка</a> — в качестве первого аргумента ей нужно передать лямбда-функцию, и этот аргумент не может быть опущен.</p> <h2 id=array-filter>arrayFilter(func, arr1, …)<a class=headerlink href=../amp/#array-filter title="Permanent link"> </a></h2> <p>Возвращает массив, содержащий только те элементы массива <code class=syntax>arr1</code>, для которых функция <code class=syntax>func</code> возвращает не 0.</p> <p>Примеры:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayFilter</span><span class=p>(</span><span class=n>x</span> <span class=o>-&gt;</span> <span class=n>x</span> <span class=k>LIKE</span> <span class=s1>'%World%'</span><span class=p>,</span> <span class=p>[</span><span class=s1>'Hello'</span><span class=p>,</span> <span class=s1>'abc World'</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res───────────┐
│ ['abc World'] │
└───────────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=n>arrayFilter</span><span class=p>(</span>
        <span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>x</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>x</span> <span class=k>LIKE</span> <span class=s1>'%World%'</span><span class=p>,</span>
        <span class=n>arrayEnumerate</span><span class=p>(</span><span class=n>arr</span><span class=p>),</span>
        <span class=p>[</span><span class=s1>'Hello'</span><span class=p>,</span> <span class=s1>'abc World'</span><span class=p>]</span> <span class=k>AS</span> <span class=n>arr</span><span class=p>)</span>
    <span class=k>AS</span> <span class=n>res</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res─┐
│ [2] │
└─────┘
</code></pre></div> <p>Функция <code class=syntax>arrayFilter</code> является <a href=../../amp/#higher-order-functions>функцией высшего порядка</a> — в качестве первого аргумента ей нужно передать лямбда-функцию, и этот аргумент не может быть опущен.</p> <h2 id=array-fill>arrayFill(func, arr1, …)<a class=headerlink href=../amp/#array-fill title="Permanent link"> </a></h2> <p>Перебирает <code class=syntax>arr1</code> от первого элемента к последнему и заменяет <code class=syntax>arr1[i]</code> на <code class=syntax>arr1[i - 1]</code>, если <code class=syntax>func</code> вернула 0. Первый элемент <code class=syntax>arr1</code> остаётся неизменным.</p> <p>Примеры:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayFill</span><span class=p>(</span><span class=n>x</span> <span class=o>-&gt;</span> <span class=k>not</span> <span class=k>isNull</span><span class=p>(</span><span class=n>x</span><span class=p>),</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=k>null</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=k>null</span><span class=p>,</span> <span class=k>null</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=k>null</span><span class=p>,</span> <span class=k>null</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res──────────────────────────────┐
│ [1,1,3,11,12,12,12,5,6,14,14,14] │
└──────────────────────────────────┘
</code></pre></div> <p>Функция <code class=syntax>arrayFill</code> является <a href=../../amp/#higher-order-functions>функцией высшего порядка</a> — в качестве первого аргумента ей нужно передать лямбда-функцию, и этот аргумент не может быть опущен.</p> <h2 id=array-reverse-fill>arrayReverseFill(func, arr1, …)<a class=headerlink href=../amp/#array-reverse-fill title="Permanent link"> </a></h2> <p>Перебирает <code class=syntax>arr1</code> от последнего элемента к первому и заменяет <code class=syntax>arr1[i]</code> на <code class=syntax>arr1[i + 1]</code>, если <code class=syntax>func</code> вернула 0. Последний элемент <code class=syntax>arr1</code> остаётся неизменным.</p> <p>Примеры:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayReverseFill</span><span class=p>(</span><span class=n>x</span> <span class=o>-&gt;</span> <span class=k>not</span> <span class=k>isNull</span><span class=p>(</span><span class=n>x</span><span class=p>),</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=k>null</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>11</span><span class=p>,</span> <span class=mi>12</span><span class=p>,</span> <span class=k>null</span><span class=p>,</span> <span class=k>null</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>14</span><span class=p>,</span> <span class=k>null</span><span class=p>,</span> <span class=k>null</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res────────────────────────────────┐
│ [1,3,3,11,12,5,5,5,6,14,NULL,NULL] │
└────────────────────────────────────┘
</code></pre></div> <p>Функция <code class=syntax>arrayReverseFill</code> является <a href=../../amp/#higher-order-functions>функцией высшего порядка</a> — в качестве первого аргумента ей нужно передать лямбда-функцию, и этот аргумент не может быть опущен.</p> <h2 id=array-split>arraySplit(func, arr1, …)<a class=headerlink href=../amp/#array-split title="Permanent link"> </a></h2> <p>Разделяет массив <code class=syntax>arr1</code> на несколько. Если <code class=syntax>func</code> возвращает не 0, то массив разделяется, а элемент помещается в левую часть. Массив не разбивается по первому элементу.</p> <p>Примеры:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arraySplit</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>y</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res─────────────┐
│ [[1,2,3],[4,5]] │
└─────────────────┘
</code></pre></div> <p>Функция <code class=syntax>arraySplit</code> является <a href=../../amp/#higher-order-functions>функцией высшего порядка</a> — в качестве первого аргумента ей нужно передать лямбда-функцию, и этот аргумент не может быть опущен.</p> <h2 id=array-reverse-split>arrayReverseSplit(func, arr1, …)<a class=headerlink href=../amp/#array-reverse-split title="Permanent link"> </a></h2> <p>Разделяет массив <code class=syntax>arr1</code> на несколько. Если <code class=syntax>func</code> возвращает не 0, то массив разделяется, а элемент помещается в правую часть. Массив не разбивается по последнему элементу.</p> <p>Примеры:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayReverseSplit</span><span class=p>((</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>y</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>],</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res───────────────┐
│ [[1],[2,3,4],[5]] │
└───────────────────┘
</code></pre></div> <p>Функция <code class=syntax>arrayReverseSplit</code> является <a href=../../amp/#higher-order-functions>функцией высшего порядка</a> — в качестве первого аргумента ей нужно передать лямбда-функцию, и этот аргумент не может быть опущен.</p> <h2 id=arrayexistsfunc-arr1>arrayExists([func,] arr1, …)<a class=headerlink href=../amp/#arrayexistsfunc-arr1 title="Permanent link"> </a></h2> <p>Возвращает 1, если существует хотя бы один элемент массива <code class=syntax>arr</code>, для которого функция func возвращает не 0. Иначе возвращает 0.</p> <p>Функция <code class=syntax>arrayExists</code> является <a href=../../amp/#higher-order-functions>функцией высшего порядка</a> - в качестве первого аргумента ей можно передать лямбда-функцию.</p> <h2 id=arrayallfunc-arr1>arrayAll([func,] arr1, …)<a class=headerlink href=../amp/#arrayallfunc-arr1 title="Permanent link"> </a></h2> <p>Возвращает 1, если для всех элементов массива <code class=syntax>arr</code>, функция <code class=syntax>func</code> возвращает не 0. Иначе возвращает 0.</p> <p>Функция <code class=syntax>arrayAll</code> является <a href=../../amp/#higher-order-functions>функцией высшего порядка</a> - в качестве первого аргумента ей можно передать лямбда-функцию.</p> <h2 id=array-first>arrayFirst(func, arr1, …)<a class=headerlink href=../amp/#array-first title="Permanent link"> </a></h2> <p>Возвращает первый элемент массива <code class=syntax>arr1</code>, для которого функция func возвращает не 0.</p> <p>Функция <code class=syntax>arrayFirst</code> является <a href=../../amp/#higher-order-functions>функцией высшего порядка</a> — в качестве первого аргумента ей нужно передать лямбда-функцию, и этот аргумент не может быть опущен.</p> <h2 id=array-first-index>arrayFirstIndex(func, arr1, …)<a class=headerlink href=../amp/#array-first-index title="Permanent link"> </a></h2> <p>Возвращает индекс первого элемента массива <code class=syntax>arr1</code>, для которого функция func возвращает не 0.</p> <p>Функция <code class=syntax>arrayFirstIndex</code> является <a href=../../amp/#higher-order-functions>функцией высшего порядка</a> — в качестве первого аргумента ей нужно передать лямбда-функцию, и этот аргумент не может быть опущен.</p> <h2 id=array-min>arrayMin<a class=headerlink href=../amp/#array-min title="Permanent link"> </a></h2> <p>Возвращает значение минимального элемента в исходном массиве.</p> <p>Если передана функция <code class=syntax>func</code>, возвращается минимум из элементов массива, преобразованных этой функцией.</p> <p>Функция <code class=syntax>arrayMin</code> является <a href=../../amp/#higher-order-functions>функцией высшего порядка</a> — в качестве первого аргумента ей можно передать лямбда-функцию.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arrayMin</span><span class=p>([</span><span class=n>func</span><span class=p>,]</span> <span class=n>arr</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>func</code> — функция. <a href=../../../data-types/special-data-types/expression/amp/ >Expression</a>.</li> <li><code class=syntax>arr</code> — массив. <a href=../../../data-types/array/amp/ >Array</a>.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Минимальное значение функции (или минимальный элемент массива).</li> </ul> <p>Тип: если передана <code class=syntax>func</code>, соответствует типу ее возвращаемого значения, иначе соответствует типу элементов массива.</p> <p><strong>Примеры</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayMin</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─res─┐
│   1 │
└─────┘
</code></pre></div> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayMin</span><span class=p>(</span><span class=n>x</span> <span class=o>-&gt;</span> <span class=p>(</span><span class=o>-</span><span class=n>x</span><span class=p>),</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─res─┐
│  -4 │
└─────┘
</code></pre></div> <h2 id=array-max>arrayMax<a class=headerlink href=../amp/#array-max title="Permanent link"> </a></h2> <p>Возвращает значение максимального элемента в исходном массиве.</p> <p>Если передана функция <code class=syntax>func</code>, возвращается максимум из элементов массива, преобразованных этой функцией.</p> <p>Функция <code class=syntax>arrayMax</code> является <a href=../../amp/#higher-order-functions>функцией высшего порядка</a> — в качестве первого аргумента ей можно передать лямбда-функцию.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arrayMax</span><span class=p>([</span><span class=n>func</span><span class=p>,]</span> <span class=n>arr</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>func</code> — функция. <a href=../../../data-types/special-data-types/expression/amp/ >Expression</a>.</li> <li><code class=syntax>arr</code> — массив. <a href=../../../data-types/array/amp/ >Array</a>.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Максимальное значение функции (или максимальный элемент массива).</li> </ul> <p>Тип: если передана <code class=syntax>func</code>, соответствует типу ее возвращаемого значения, иначе соответствует типу элементов массива.</p> <p><strong>Примеры</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayMax</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─res─┐
│   4 │
└─────┘
</code></pre></div> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayMax</span><span class=p>(</span><span class=n>x</span> <span class=o>-&gt;</span> <span class=p>(</span><span class=o>-</span><span class=n>x</span><span class=p>),</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─res─┐
│  -1 │
└─────┘
</code></pre></div> <h2 id=array-sum>arraySum<a class=headerlink href=../amp/#array-sum title="Permanent link"> </a></h2> <p>Возвращает сумму элементов в исходном массиве.</p> <p>Если передана функция <code class=syntax>func</code>, возвращается сумма элементов массива, преобразованных этой функцией.</p> <p>Функция <code class=syntax>arraySum</code> является <a href=../../amp/#higher-order-functions>функцией высшего порядка</a> — в качестве первого аргумента ей можно передать лямбда-функцию.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arraySum</span><span class=p>([</span><span class=n>func</span><span class=p>,]</span> <span class=n>arr</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>func</code> — функция. <a href=../../../data-types/special-data-types/expression/amp/ >Expression</a>.</li> <li><code class=syntax>arr</code> — массив. <a href=../../../data-types/array/amp/ >Array</a>.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Сумма значений функции (или сумма элементов массива).</li> </ul> <p>Тип: для Decimal чисел в исходном массиве (если функция <code class=syntax>func</code> была передана, то для чисел, преобразованных ею) — <a href=../../../data-types/decimal/amp/ >Decimal128</a>, для чисел с плавающей точкой — <a href=../../../data-types/float/amp/ >Float64</a>, для беззнаковых целых чисел — <a href=../../../data-types/int-uint/amp/ >UInt64</a>, для целых чисел со знаком — <a href=../../../data-types/int-uint/amp/ >Int64</a>.</p> <p><strong>Примеры</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arraySum</span><span class=p>([</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─res─┐
│   5 │
└─────┘
</code></pre></div> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arraySum</span><span class=p>(</span><span class=n>x</span> <span class=o>-&gt;</span> <span class=n>x</span><span class=o>*</span><span class=n>x</span><span class=p>,</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─res─┐
│  13 │
└─────┘
</code></pre></div> <h2 id=array-avg>arrayAvg<a class=headerlink href=../amp/#array-avg title="Permanent link"> </a></h2> <p>Возвращает среднее значение элементов в исходном массиве.</p> <p>Если передана функция <code class=syntax>func</code>, возвращается среднее значение элементов массива, преобразованных этой функцией.</p> <p>Функция <code class=syntax>arrayAvg</code> является <a href=../../amp/#higher-order-functions>функцией высшего порядка</a> — в качестве первого аргумента ей можно передать лямбда-функцию.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arrayAvg</span><span class=p>([</span><span class=n>func</span><span class=p>,]</span> <span class=n>arr</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>func</code> — функция. <a href=../../../data-types/special-data-types/expression/amp/ >Expression</a>.</li> <li><code class=syntax>arr</code> — массив. <a href=../../../data-types/array/amp/ >Array</a>.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Среднее значение функции (или среднее значение элементов массива).</li> </ul> <p>Тип: <a href=../../../data-types/float/amp/ >Float64</a>.</p> <p><strong>Примеры</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayAvg</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌────────────────res─┐
│ 2.3333333333333335 │
└────────────────────┘
</code></pre></div> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayAvg</span><span class=p>(</span><span class=n>x</span> <span class=o>-&gt;</span> <span class=p>(</span><span class=n>x</span> <span class=o>*</span> <span class=n>x</span><span class=p>),</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─res─┐
│  10 │
└─────┘
</code></pre></div> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arraySum</span><span class=p>(</span><span class=n>arr</span><span class=p>)</span>
</code></pre></div> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Число.</li> </ul> <p>Тип: <a href=../../../data-types/int-uint/amp/ >Int</a> или <a href=../../../data-types/float/amp/ >Float</a>.</p> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>arr</code> — <a href=../../../data-types/array/amp/ >массив</a>.</li> </ul> <p><strong>Примеры</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arraySum</span><span class=p>([</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─res─┐
│   5 │
└─────┘
</code></pre></div> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arraySum</span><span class=p>(</span><span class=n>x</span> <span class=o>-&gt;</span> <span class=n>x</span><span class=o>*</span><span class=n>x</span><span class=p>,</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─res─┐
│  13 │
└─────┘
</code></pre></div> <h2 id=arraycumsumfunc-arr1>arrayCumSum([func,] arr1, …)<a class=headerlink href=../amp/#arraycumsumfunc-arr1 title="Permanent link"> </a></h2> <p>Возвращает массив из частичных сумм элементов исходного массива (сумма с накоплением). Если указана функция <code class=syntax>func</code>, то значения элементов массива преобразуются этой функцией перед суммированием.</p> <p>Функция <code class=syntax>arrayCumSum</code> является <a href=../../amp/#higher-order-functions>функцией высшего порядка</a> - в качестве первого аргумента ей можно передать лямбда-функцию.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayCumSum</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>])</span> <span class=k>AS</span> <span class=n>res</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res──────────┐
│ [1, 2, 3, 4] │
└──────────────┘
</code></pre></div> <h2 id=arrayauc>arrayAUC<a class=headerlink href=../amp/#arrayauc title="Permanent link"> </a></h2> <p>Вычисляет площадь под кривой.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arrayAUC</span><span class=p>(</span><span class=n>arr_scores</span><span class=p>,</span> <span class=n>arr_labels</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>arr_scores</code> — оценка, которую дает модель предсказания.</li> <li><code class=syntax>arr_labels</code> — ярлыки выборок, обычно 1 для содержательных выборок и 0 для бессодержательных выборок.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <p>Значение площади под кривой.</p> <p>Тип данных: <code class=syntax>Float64</code>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayAUC</span><span class=p>([</span><span class=mi>0</span><span class=p>.</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>.</span><span class=mi>4</span><span class=p>,</span> <span class=mi>0</span><span class=p>.</span><span class=mi>35</span><span class=p>,</span> <span class=mi>0</span><span class=p>.</span><span class=mi>8</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>]);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─arrayAUC([0.1, 0.4, 0.35, 0.8], [0, 0, 1, 1])─┐
│                                          0.75 │
└────────────────────────────────────────---──┘
</code></pre></div> <h2 id=arrayproduct>arrayProduct<a class=headerlink href=../amp/#arrayproduct title="Permanent link"> </a></h2> <p>Возвращает произведение элементов <a href=../../../data-types/array/amp/ >массива</a>.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>arrayProduct</span><span class=p>(</span><span class=n>arr</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>arr</code> — <a href=../../../data-types/array/amp/ >массив</a> числовых значений.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Произведение элементов массива.</li> </ul> <p>Тип: <a href=../../../data-types/float/amp/ >Float64</a>.</p> <p><strong>Примеры</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayProduct</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>6</span><span class=p>])</span> <span class=k>as</span> <span class=n>res</span><span class=p>;</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─res───┐
│ 720   │
└───────┘
</code></pre></div> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayProduct</span><span class=p>([</span><span class=n>toDecimal64</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>8</span><span class=p>),</span> <span class=n>toDecimal64</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span><span class=mi>8</span><span class=p>),</span> <span class=n>toDecimal64</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=mi>8</span><span class=p>)])</span> <span class=k>as</span> <span class=n>res</span><span class=p>,</span> <span class=n>toTypeName</span><span class=p>(</span><span class=n>res</span><span class=p>);</span>
</code></pre></div> <p>Возвращаемое значение всегда имеет тип <a href=../../../data-types/float/amp/ >Float64</a>. Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─res─┬─toTypeName(arrayProduct(array(toDecimal64(1, 8), toDecimal64(2, 8), toDecimal64(3, 8))))─┐
│ 6   │ Float64                                                                                  │
└─────┴──────────────────────────────────────────────────────────────────────────────────────────┘
</code></pre></div> </div> </div> <div class=row> <div class=col> <div class="alert alert-light my-3"> <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p> <span class="alert-heading display-6">Article Rating</span> <div id=rating-stars class="display-6 mb-0">RATING_STARS</div> </div> <div id=content-footer class="text-muted pt-3 mb-5"> <div class=float-md-right>©2016–2021 Yandex LLC</div> <div>Built from <a href=https://github.com/ClickHouse/ClickHouse/commit/878a159538935028f2d2dce3eb3074d44eb191df rel="external nofollow noreferrer" target=_blank class=text-reset>878a159538</a> </div> </div> </div> </div> <div id=to-full-website class="row fixed-bottom text-center bg-white py-3"> <div class=col> <a href=https://clickhouse.tech/docs/ru/sql-reference/functions/array-functions/ class="btn btn-lg btn-outline-orange">To full website</a> </div> </div> </div> <amp-analytics type=metrika> <script type=application/json>{
"vars": {
  "counterId": "18343495",
  "triggers": {
    "notBounce": {
      "on": "timer",
      "timerSpec": {
        "immediate": false,
        "interval": 15,
        "maxTimerLength": 16
      },
      "request": "notBounce"
    }
  }
}
}</script> </amp-analytics> </body> </html> 