<!doctype html><html ⚡ lang=en> <head><meta charset=utf-8><script async src=https://cdn.ampproject.org/v0.js></script><title>For Searching in Strings | ClickHouse Documentation</title><link href=https://clickhouse.tech/docs/en/sql-reference/functions/string-search-functions/ rel=canonical><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><script type=application/ld+json>[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "For Searching in Strings | ClickHouse Documentation",
"mainEntityOfPage": "https://clickhouse.tech/docs/en/sql-reference/functions/string-search-functions/",




"image": "https://clickhouse.tech/images/logo-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "Yandex LLC",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.tech/images/yandex.png",
    "width": 163,
    "height": 60
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "For Searching in Strings | ClickHouse Documentation",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script><style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript><style amp-custom>:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--white:#fff;--gray:#6c757d;--gray-dark:#343a40;--primary:#007bff;--secondary:#6c757d;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f8f9fa;--dark:#343a40;--breakpoint-xs:0;--breakpoint-sm:576px;--breakpoint-md:768px;--breakpoint-lg:992px;--breakpoint-xl:1200px;--font-family-sans-serif:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,::after,::before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}article,footer{display:block}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem}p{margin-top:0;margin-bottom:1rem}ul{margin-top:0;margin-bottom:1rem}ul ul{margin-bottom:0}b,strong{font-weight:bolder}sub,sup{position:relative;font-size:75%;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#007bff;text-decoration:none;background-color:transparent}a:hover{color:#0056b3;text-decoration:underline}a:not([href]){color:inherit;text-decoration:none}a:not([href]):hover{color:inherit;text-decoration:none}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}img{vertical-align:middle;border-style:none}svg{overflow:hidden;vertical-align:middle}table{border-collapse:collapse}th{text-align:inherit}input,select{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}input{overflow:visible}select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit]{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{padding:0;border-style:none}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=date],input[type=datetime-local],input[type=month],input[type=time]{-webkit-appearance:listbox}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:.5rem;font-weight:500;line-height:1.2}.h1,h1{font-size:2rem}.h2,h2{font-size:1.5rem}.h3,h3{font-size:1.25rem}.h4,h4{font-size:1rem}.h5,h5{font-size:1rem}.h6,h6{font-size:1rem}.display-1{font-size:6rem;font-weight:300;line-height:1.2}.display-2{font-size:5.5rem;font-weight:300;line-height:1.2}.display-3{font-size:4.5rem;font-weight:300;line-height:1.2}.display-4{font-size:3.5rem;font-weight:300;line-height:1.2}.img-fluid{max-width:100%;height:auto}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}pre{display:block;font-size:87.5%;color:#212529}pre code{font-size:inherit;color:inherit;word-break:normal}.container{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container{max-width:720px}}@media(min-width:992px){.container{max-width:960px}}@media(min-width:1200px){.container{max-width:1140px}}.container-fluid,.container-lg,.container-md{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container,.container-md{max-width:720px}}@media(min-width:992px){.container,.container-lg,.container-md{max-width:960px}}@media(min-width:1200px){.container,.container-lg,.container-md{max-width:1140px}}.row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-15px;margin-left:-15px}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9{position:relative;width:100%;padding-right:15px;padding-left:15px}.col{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-first{-ms-flex-order:-1;order:-1}.order-0{-ms-flex-order:0;order:0}.order-1{-ms-flex-order:1;order:1}.order-2{-ms-flex-order:2;order:2}.order-3{-ms-flex-order:3;order:3}.order-4{-ms-flex-order:4;order:4}.order-5{-ms-flex-order:5;order:5}.order-6{-ms-flex-order:6;order:6}.order-7{-ms-flex-order:7;order:7}.order-8{-ms-flex-order:8;order:8}.order-9{-ms-flex-order:9;order:9}.order-10{-ms-flex-order:10;order:10}.order-11{-ms-flex-order:11;order:11}.order-12{-ms-flex-order:12;order:12}.offset-1{margin-left:8.333333%}.offset-2{margin-left:16.666667%}.offset-3{margin-left:25%}.offset-4{margin-left:33.333333%}.offset-5{margin-left:41.666667%}.offset-6{margin-left:50%}.offset-7{margin-left:58.333333%}.offset-8{margin-left:66.666667%}.offset-9{margin-left:75%}.offset-10{margin-left:83.333333%}.offset-11{margin-left:91.666667%}@media(min-width:768px){.col-md{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-md-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-md-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-md-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-md-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-md-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-md-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-md-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-md-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-md-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-md-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-md-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-md-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-md-first{-ms-flex-order:-1;order:-1}.order-md-0{-ms-flex-order:0;order:0}.order-md-1{-ms-flex-order:1;order:1}.order-md-2{-ms-flex-order:2;order:2}.order-md-3{-ms-flex-order:3;order:3}.order-md-4{-ms-flex-order:4;order:4}.order-md-5{-ms-flex-order:5;order:5}.order-md-6{-ms-flex-order:6;order:6}.order-md-7{-ms-flex-order:7;order:7}.order-md-8{-ms-flex-order:8;order:8}.order-md-9{-ms-flex-order:9;order:9}.order-md-10{-ms-flex-order:10;order:10}.order-md-11{-ms-flex-order:11;order:11}.order-md-12{-ms-flex-order:12;order:12}.offset-md-0{margin-left:0}.offset-md-1{margin-left:8.333333%}.offset-md-2{margin-left:16.666667%}.offset-md-3{margin-left:25%}.offset-md-4{margin-left:33.333333%}.offset-md-5{margin-left:41.666667%}.offset-md-6{margin-left:50%}.offset-md-7{margin-left:58.333333%}.offset-md-8{margin-left:66.666667%}.offset-md-9{margin-left:75%}.offset-md-10{margin-left:83.333333%}.offset-md-11{margin-left:91.666667%}}@media(min-width:992px){.col-lg{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-lg-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-lg-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-lg-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-lg-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-lg-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-lg-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-lg-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-lg-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-lg-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-lg-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-lg-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-lg-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-lg-first{-ms-flex-order:-1;order:-1}.order-lg-0{-ms-flex-order:0;order:0}.order-lg-1{-ms-flex-order:1;order:1}.order-lg-2{-ms-flex-order:2;order:2}.order-lg-3{-ms-flex-order:3;order:3}.order-lg-4{-ms-flex-order:4;order:4}.order-lg-5{-ms-flex-order:5;order:5}.order-lg-6{-ms-flex-order:6;order:6}.order-lg-7{-ms-flex-order:7;order:7}.order-lg-8{-ms-flex-order:8;order:8}.order-lg-9{-ms-flex-order:9;order:9}.order-lg-10{-ms-flex-order:10;order:10}.order-lg-11{-ms-flex-order:11;order:11}.order-lg-12{-ms-flex-order:12;order:12}.offset-lg-0{margin-left:0}.offset-lg-1{margin-left:8.333333%}.offset-lg-2{margin-left:16.666667%}.offset-lg-3{margin-left:25%}.offset-lg-4{margin-left:33.333333%}.offset-lg-5{margin-left:41.666667%}.offset-lg-6{margin-left:50%}.offset-lg-7{margin-left:58.333333%}.offset-lg-8{margin-left:66.666667%}.offset-lg-9{margin-left:75%}.offset-lg-10{margin-left:83.333333%}.offset-lg-11{margin-left:91.666667%}}.table{width:100%;margin-bottom:1rem;color:#212529}.table th{padding:.75rem;vertical-align:top;border-top:1px solid #dee2e6}.table-primary,.table-primary>th{background-color:#b8daff}.table-primary th{border-color:#7abaff}.table-light,.table-light>th{background-color:#fdfdfe}.table-light th{border-color:#fbfcfc}.table-dark,.table-dark>th{background-color:#c6c8ca}.table-dark th{border-color:#95999c}.table-dark{color:#fff;background-color:#343a40}.table-dark th{border-color:#454d55}.btn{display:inline-block;font-weight:400;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:.375rem .75rem;font-size:1rem;line-height:1.5;border-radius:.25rem}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus{outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.btn:disabled{opacity:.65}.btn-primary{color:#fff;background-color:#007bff;border-color:#007bff}.btn-primary:hover{color:#fff;background-color:#0069d9;border-color:#0062cc}.btn-primary:focus{color:#fff;background-color:#0069d9;border-color:#0062cc;box-shadow:0 0 0 .2rem rgba(38,143,255,.5)}.btn-primary:disabled{color:#fff;background-color:#007bff;border-color:#007bff}.btn-light{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-light:hover{color:#212529;background-color:#e2e6ea;border-color:#dae0e5}.btn-light:focus{color:#212529;background-color:#e2e6ea;border-color:#dae0e5;box-shadow:0 0 0 .2rem rgba(216,217,219,.5)}.btn-light:disabled{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-dark{color:#fff;background-color:#343a40;border-color:#343a40}.btn-dark:hover{color:#fff;background-color:#23272b;border-color:#1d2124}.btn-dark:focus{color:#fff;background-color:#23272b;border-color:#1d2124;box-shadow:0 0 0 .2rem rgba(82,88,93,.5)}.btn-dark:disabled{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-primary{color:#007bff;border-color:#007bff}.btn-outline-primary:hover{color:#fff;background-color:#007bff;border-color:#007bff}.btn-outline-primary:focus{box-shadow:0 0 0 .2rem rgba(0,123,255,.5)}.btn-outline-primary:disabled{color:#007bff;background-color:transparent}.btn-outline-light{color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:hover{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:focus{box-shadow:0 0 0 .2rem rgba(248,249,250,.5)}.btn-outline-light:disabled{color:#f8f9fa;background-color:transparent}.btn-outline-dark{color:#343a40;border-color:#343a40}.btn-outline-dark:hover{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-dark:focus{box-shadow:0 0 0 .2rem rgba(52,58,64,.5)}.btn-outline-dark:disabled{color:#343a40;background-color:transparent}.btn-link{font-weight:400;color:#007bff;text-decoration:none}.btn-link:hover{color:#0056b3;text-decoration:underline}.btn-link:focus{text-decoration:underline;box-shadow:none}.btn-link:disabled{color:#6c757d;pointer-events:none}.btn-group-lg>.btn,.btn-lg{padding:.5rem 1rem;font-size:1.25rem;line-height:1.5;border-radius:.3rem}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:.5rem}input[type=button].btn-block,input[type=reset].btn-block,input[type=submit].btn-block{width:100%}.btn-group,.btn-group-vertical{position:relative;display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle}.btn-group-vertical>.btn,.btn-group>.btn{position:relative;-ms-flex:1 1 auto;flex:1 1 auto}.btn-group-vertical>.btn:hover,.btn-group>.btn:hover{z-index:1}.btn-group-vertical>.btn:active,.btn-group-vertical>.btn:focus,.btn-group>.btn:active,.btn-group>.btn:focus{z-index:1}.btn-group>.btn-group:not(:first-child),.btn-group>.btn:not(:first-child){margin-left:-1px}.btn-group>.btn-group:not(:last-child)>.btn{border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn-group:not(:first-child)>.btn,.btn-group>.btn:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.btn-group-vertical{-ms-flex-direction:column;flex-direction:column;-ms-flex-align:start;align-items:flex-start;-ms-flex-pack:center;justify-content:center}.btn-group-vertical>.btn,.btn-group-vertical>.btn-group{width:100%}.btn-group-vertical>.btn-group:not(:first-child),.btn-group-vertical>.btn:not(:first-child){margin-top:-1px}.btn-group-vertical>.btn-group:not(:last-child)>.btn{border-bottom-right-radius:0;border-bottom-left-radius:0}.btn-group-vertical>.btn-group:not(:first-child)>.btn,.btn-group-vertical>.btn:not(:first-child){border-top-left-radius:0;border-top-right-radius:0}.input-group{position:relative;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-align:stretch;align-items:stretch;width:100%}.input-group>.custom-select{position:relative;-ms-flex:1 1 0;flex:1 1 0;min-width:0;margin-bottom:0}.input-group>.custom-select+.custom-select{margin-left:-1px}.input-group>.custom-select:focus{z-index:3}.input-group>.custom-select:not(:last-child){border-top-right-radius:0;border-bottom-right-radius:0}.input-group>.custom-select:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.input-group-text{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;padding:.375rem .75rem;margin-bottom:0;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;text-align:center;white-space:nowrap;background-color:#e9ecef;border:1px solid #ced4da;border-radius:.25rem}.input-group-text input[type=checkbox],.input-group-text input[type=radio]{margin-top:0}.input-group-lg>.custom-select{height:calc(1.5em+1rem+2px)}.input-group-lg>.custom-select{padding:.5rem 1rem;font-size:1.25rem;line-height:1.5;border-radius:.3rem}.input-group-lg>.custom-select{padding-right:1.75rem}.custom-select{display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;vertical-align:middle;background:#fff url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5' viewBox='0 0 4 5'%3e%3cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3e%3c/svg%3e") no-repeat right .75rem center/8px 10px;border:1px solid #ced4da;border-radius:.25rem;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.custom-select:focus::-ms-value{color:#495057;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #495057}.custom-select-lg{height:calc(1.5em+1rem+2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.25rem}@media(prefers-reduced-motion:reduce){.custom-select{transition:none}}.alert{position:relative;padding:.75rem 1.25rem;margin-bottom:1rem;border:1px solid transparent;border-radius:.25rem}.alert-heading{color:inherit}.alert-link{font-weight:700}.alert-primary{color:#004085;background-color:#cce5ff;border-color:#b8daff}.alert-primary .alert-link{color:#002752}.alert-light{color:#818182;background-color:#fefefe;border-color:#fdfdfe}.alert-light .alert-link{color:#686868}.alert-dark{color:#1b1e21;background-color:#d6d8d9;border-color:#c6c8ca}.alert-dark .alert-link{color:#040505}@-webkit-keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@-webkit-keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}@keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}.bg-primary{background-color:#007bff}a.bg-primary:focus,a.bg-primary:hover{background-color:#0062cc}.bg-light{background-color:#f8f9fa}a.bg-light:focus,a.bg-light:hover{background-color:#dae0e5}.bg-dark{background-color:#343a40}a.bg-dark:focus,a.bg-dark:hover{background-color:#1d2124}.bg-white{background-color:#fff}.d-none{display:none}.d-inline{display:inline}.d-inline-block{display:inline-block}.d-block{display:block}.d-table{display:table}.d-table-row{display:table-row}@media(min-width:768px){.d-md-none{display:none}.d-md-inline{display:inline}.d-md-inline-block{display:inline-block}.d-md-block{display:block}.d-md-table{display:table}.d-md-table-row{display:table-row}}@media(min-width:992px){.d-lg-none{display:none}.d-lg-inline{display:inline}.d-lg-inline-block{display:inline-block}.d-lg-block{display:block}.d-lg-table{display:table}.d-lg-table-row{display:table-row}}.float-right{float:right}.float-none{float:none}@media(min-width:768px){.float-md-right{float:right}.float-md-none{float:none}}@media(min-width:992px){.float-lg-right{float:right}.float-lg-none{float:none}}.position-fixed{position:fixed}.fixed-bottom{position:fixed;right:0;bottom:0;left:0;z-index:1030}.w-25{width:25%}.w-50{width:50%}.w-75{width:75%}.w-100{width:100%}.h-25{height:25%}.h-50{height:50%}.h-75{height:75%}.h-100{height:100%}.my-0{margin-top:0}.mr-0{margin-right:0}.mb-0,.my-0{margin-bottom:0}.my-1{margin-top:.25rem}.mr-1{margin-right:.25rem}.mb-1,.my-1{margin-bottom:.25rem}.my-2{margin-top:.5rem}.mr-2{margin-right:.5rem}.mb-2,.my-2{margin-bottom:.5rem}.my-3{margin-top:1rem}.mr-3{margin-right:1rem}.mb-3,.my-3{margin-bottom:1rem}.my-4{margin-top:1.5rem}.mr-4{margin-right:1.5rem}.mb-4,.my-4{margin-bottom:1.5rem}.my-5{margin-top:3rem}.mr-5{margin-right:3rem}.mb-5,.my-5{margin-bottom:3rem}.p-0{padding:0}.pt-0,.py-0{padding-top:0}.pb-0,.py-0{padding-bottom:0}.p-1{padding:.25rem}.pt-1,.py-1{padding-top:.25rem}.pb-1,.py-1{padding-bottom:.25rem}.p-2{padding:.5rem}.pt-2,.py-2{padding-top:.5rem}.pb-2,.py-2{padding-bottom:.5rem}.p-3{padding:1rem}.pt-3,.py-3{padding-top:1rem}.pb-3,.py-3{padding-bottom:1rem}.p-4{padding:1.5rem}.pt-4,.py-4{padding-top:1.5rem}.pb-4,.py-4{padding-bottom:1.5rem}.p-5{padding:3rem}.pt-5,.py-5{padding-top:3rem}.pb-5,.py-5{padding-bottom:3rem}.my-n1{margin-top:-.25rem}.mr-n1{margin-right:-.25rem}.mb-n1,.my-n1{margin-bottom:-.25rem}.my-n2{margin-top:-.5rem}.mr-n2{margin-right:-.5rem}.mb-n2,.my-n2{margin-bottom:-.5rem}.my-n3{margin-top:-1rem}.mr-n3{margin-right:-1rem}.mb-n3,.my-n3{margin-bottom:-1rem}.my-n4{margin-top:-1.5rem}.mr-n4{margin-right:-1.5rem}.mb-n4,.my-n4{margin-bottom:-1.5rem}.my-n5{margin-top:-3rem}.mr-n5{margin-right:-3rem}.mb-n5,.my-n5{margin-bottom:-3rem}@media(min-width:768px){.my-md-0{margin-top:0}.mr-md-0{margin-right:0}.mb-md-0,.my-md-0{margin-bottom:0}.my-md-1{margin-top:.25rem}.mr-md-1{margin-right:.25rem}.mb-md-1,.my-md-1{margin-bottom:.25rem}.my-md-2{margin-top:.5rem}.mr-md-2{margin-right:.5rem}.mb-md-2,.my-md-2{margin-bottom:.5rem}.my-md-3{margin-top:1rem}.mr-md-3{margin-right:1rem}.mb-md-3,.my-md-3{margin-bottom:1rem}.my-md-4{margin-top:1.5rem}.mr-md-4{margin-right:1.5rem}.mb-md-4,.my-md-4{margin-bottom:1.5rem}.my-md-5{margin-top:3rem}.mr-md-5{margin-right:3rem}.mb-md-5,.my-md-5{margin-bottom:3rem}.p-md-0{padding:0}.pt-md-0,.py-md-0{padding-top:0}.pb-md-0,.py-md-0{padding-bottom:0}.p-md-1{padding:.25rem}.pt-md-1,.py-md-1{padding-top:.25rem}.pb-md-1,.py-md-1{padding-bottom:.25rem}.p-md-2{padding:.5rem}.pt-md-2,.py-md-2{padding-top:.5rem}.pb-md-2,.py-md-2{padding-bottom:.5rem}.p-md-3{padding:1rem}.pt-md-3,.py-md-3{padding-top:1rem}.pb-md-3,.py-md-3{padding-bottom:1rem}.p-md-4{padding:1.5rem}.pt-md-4,.py-md-4{padding-top:1.5rem}.pb-md-4,.py-md-4{padding-bottom:1.5rem}.p-md-5{padding:3rem}.pt-md-5,.py-md-5{padding-top:3rem}.pb-md-5,.py-md-5{padding-bottom:3rem}.my-md-n1{margin-top:-.25rem}.mr-md-n1{margin-right:-.25rem}.mb-md-n1,.my-md-n1{margin-bottom:-.25rem}.my-md-n2{margin-top:-.5rem}.mr-md-n2{margin-right:-.5rem}.mb-md-n2,.my-md-n2{margin-bottom:-.5rem}.my-md-n3{margin-top:-1rem}.mr-md-n3{margin-right:-1rem}.mb-md-n3,.my-md-n3{margin-bottom:-1rem}.my-md-n4{margin-top:-1.5rem}.mr-md-n4{margin-right:-1.5rem}.mb-md-n4,.my-md-n4{margin-bottom:-1.5rem}.my-md-n5{margin-top:-3rem}.mr-md-n5{margin-right:-3rem}.mb-md-n5,.my-md-n5{margin-bottom:-3rem}}@media(min-width:992px){.my-lg-0{margin-top:0}.mr-lg-0{margin-right:0}.mb-lg-0,.my-lg-0{margin-bottom:0}.my-lg-1{margin-top:.25rem}.mr-lg-1{margin-right:.25rem}.mb-lg-1,.my-lg-1{margin-bottom:.25rem}.my-lg-2{margin-top:.5rem}.mr-lg-2{margin-right:.5rem}.mb-lg-2,.my-lg-2{margin-bottom:.5rem}.my-lg-3{margin-top:1rem}.mr-lg-3{margin-right:1rem}.mb-lg-3,.my-lg-3{margin-bottom:1rem}.my-lg-4{margin-top:1.5rem}.mr-lg-4{margin-right:1.5rem}.mb-lg-4,.my-lg-4{margin-bottom:1.5rem}.my-lg-5{margin-top:3rem}.mr-lg-5{margin-right:3rem}.mb-lg-5,.my-lg-5{margin-bottom:3rem}.p-lg-0{padding:0}.pt-lg-0,.py-lg-0{padding-top:0}.pb-lg-0,.py-lg-0{padding-bottom:0}.p-lg-1{padding:.25rem}.pt-lg-1,.py-lg-1{padding-top:.25rem}.pb-lg-1,.py-lg-1{padding-bottom:.25rem}.p-lg-2{padding:.5rem}.pt-lg-2,.py-lg-2{padding-top:.5rem}.pb-lg-2,.py-lg-2{padding-bottom:.5rem}.p-lg-3{padding:1rem}.pt-lg-3,.py-lg-3{padding-top:1rem}.pb-lg-3,.py-lg-3{padding-bottom:1rem}.p-lg-4{padding:1.5rem}.pt-lg-4,.py-lg-4{padding-top:1.5rem}.pb-lg-4,.py-lg-4{padding-bottom:1.5rem}.p-lg-5{padding:3rem}.pt-lg-5,.py-lg-5{padding-top:3rem}.pb-lg-5,.py-lg-5{padding-bottom:3rem}.my-lg-n1{margin-top:-.25rem}.mr-lg-n1{margin-right:-.25rem}.mb-lg-n1,.my-lg-n1{margin-bottom:-.25rem}.my-lg-n2{margin-top:-.5rem}.mr-lg-n2{margin-right:-.5rem}.mb-lg-n2,.my-lg-n2{margin-bottom:-.5rem}.my-lg-n3{margin-top:-1rem}.mr-lg-n3{margin-right:-1rem}.mb-lg-n3,.my-lg-n3{margin-bottom:-1rem}.my-lg-n4{margin-top:-1.5rem}.mr-lg-n4{margin-right:-1.5rem}.mb-lg-n4,.my-lg-n4{margin-bottom:-1.5rem}.my-lg-n5{margin-top:-3rem}.mr-lg-n5{margin-right:-3rem}.mb-lg-n5,.my-lg-n5{margin-bottom:-3rem}}.text-right{text-align:right}.text-center{text-align:center}@media(min-width:768px){.text-md-right{text-align:right}.text-md-center{text-align:center}}@media(min-width:992px){.text-lg-right{text-align:right}.text-lg-center{text-align:center}}.text-white{color:#fff}.text-primary{color:#007bff}a.text-primary:focus,a.text-primary:hover{color:#0056b3}.text-light{color:#f8f9fa}a.text-light:focus,a.text-light:hover{color:#cbd3da}.text-dark{color:#343a40}a.text-dark:focus,a.text-dark:hover{color:#121416}.text-body{color:#212529}.text-muted{color:#6c757d}.text-black-50{color:rgba(0,0,0,.5)}.text-white-50{color:rgba(255,255,255,.5)}.text-hide{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;border:0}.text-decoration-none{text-decoration:none}.text-reset{color:inherit}.visible{visibility:visible}@media print{*,::after,::before{text-shadow:none;box-shadow:none}a:not(.btn){text-decoration:underline}pre{white-space:pre-wrap}pre{border:1px solid #adb5bd;page-break-inside:avoid}img{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}body{min-width:992px}.container{min-width:992px}.table{border-collapse:collapse}.table th{background-color:#fff}.table-dark{color:inherit}.table-dark th{border-color:#dee2e6}}@-webkit-keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}@keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"}a:link,a:visited{color:#f14600;text-decoration:none}a:active,a:hover{text-decoration:underline}.btn:disabled{cursor:default;opacity:.4}#logo-text{width:180px;margin-left:12px}.display-5{font-size:2rem;font-weight:300;line-height:1.2}.display-6{font-size:1.75rem;font-weight:300;line-height:1.2}.bg-dark-alt,.bg-dark-alt:focus{background:#36363f}.bg-orange,.bg-orange:focus{background:#f14600}.text-dark-alt{color:#36363f}.btn-dark-alt{background:#36363f}.btn-dark-alt:focus{background:#36363f}.btn-outline-orange{border-color:#f14600;color:#f14600}.btn-orange,.btn-outline-orange:hover{background:#f14600;color:#fff}.btn:active,.btn:hover{text-decoration:none}.text-orange{color:#f14600}.bg-number{position:absolute;font-size:900%;font-weight:700;color:rgba(241,70,0,.1);line-height:1;margin-top:-1rem}.w-15{width:15%}.headerlink{text-decoration:none;margin-left:.5rem}#content table{border:1px solid #dee2e6;width:100%;margin-bottom:1rem;overflow-x:auto}#content th{padding:.75rem;vertical-align:top}#content th{border:1px solid #444451}#content code{color:#000;background:#eee;padding:.125rem .25rem}#content code.syntax{padding:0}#content pre{background:#efefef;padding:1rem;line-height:1.25}@media print{body{min-width:0}code,h1,h2,h3,h4,h5,h6,img,li,p,pre,th{page-break-inside:avoid}}@media(prefers-color-scheme:dark){#to-full-website,body.amp,body[data-spy]{background:#1c1c1c;color:#efefef}.invert-dark{filter:invert(100%)}#content table{border:1px solid #2a2b2c}#content code{background:#444;color:#eee;padding:.125rem .25rem}#content pre{background:#444;color:#eee}}.syntax{background:#f8f9fa;color:#2f1e2e}.syntax .c{color:#8d8687}.syntax .k{color:#000;font-weight:700}.syntax .n{color:#2f1e2e}.syntax .o{color:#800}.syntax .p{color:#2f1e2e}.syntax .c1{color:#8d8687}.syntax .ld{color:#48b685}.syntax .s{color:#48b685}.syntax .no{color:#ef6155}.syntax .py{color:#2f1e2e}.syntax .w{color:#2f1e2e}.syntax .mi{color:#08f}.syntax .s2{color:#48b685}.syntax .s1{color:#080}@media(prefers-color-scheme:dark){.syntax .k{color:#c78cff}.syntax .ld{color:#64ffbb}.syntax .s{color:#64ffbb}.syntax .s2{color:#64ffbb}.syntax .s1{color:#64ffbb}.syntax .c{color:#64ffbb}.syntax .n{color:#f8f9fa}.syntax .p{color:#f8f9fa}.syntax .py{color:#f8f9fa}.syntax .w{color:#f8f9fa}}</style><script async custom-element=amp-analytics src=https://cdn.ampproject.org/v0/amp-analytics-0.1.js></script><script async custom-element=amp-iframe src=https://cdn.ampproject.org/v0/amp-iframe-0.1.js></script></head> <body class=amp dir=ltr> <div class="container-fluid container-lg pb-5"> <div class="row pt-3 mb-3"> <div class=col> <a href=/ class=text-decoration-none> <amp-img class="d-inline-block mr-3" layout=fixed width=40 height=36 src=/images/logo.svg alt="ClickHouse logo" title="ClickHouse logo"></amp-img><amp-img class="invert-dark d-inline-block" layout=fixed width=238 height=36 src=/images/clickhouse-black.svg alt=ClickHouse title=ClickHouse></amp-img> </a> </div> </div> <div class=row> <div id=content class=col> <h1 id=functions-for-searching-strings>Functions for Searching in Strings<a class=headerlink href=../amp/#functions-for-searching-strings title="Permanent link"> </a></h1> <p>The search is case-sensitive by default in all these functions. There are separate variants for case insensitive search.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Note</p> <p>Functions for <a href=../../string-replace-functions/amp/ class=alert-link>replacing</a> and <a href=../../string-functions/amp/ class=alert-link>other manipulations with strings</a> are described separately.</p> </div> <h2 id=position>position(haystack, needle), locate(haystack, needle)<a class=headerlink href=../amp/#position title="Permanent link"> </a></h2> <p>Returns the position (in bytes) of the found substring in the string, starting from 1.</p> <p>For a case-insensitive search, use the function <a href=../amp/#positioncaseinsensitive>positionCaseInsensitive</a>.</p> <p><strong>Syntax</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>position</span><span class=p>(</span><span class=n>haystack</span><span class=p>,</span> <span class=n>needle</span><span class=p>[,</span> <span class=n>start_pos</span><span class=p>])</span>
</code></pre></div> <p>Alias: <code class=syntax>locate(haystack, needle[, start_pos])</code>.</p> <p><strong>Arguments</strong></p> <ul> <li><code class=syntax>haystack</code> — string, in which substring will to be searched. <a href=../../../syntax/amp/#syntax-string-literal>String</a>.</li> <li><code class=syntax>needle</code> — substring to be searched. <a href=../../../syntax/amp/#syntax-string-literal>String</a>.</li> <li><code class=syntax>start_pos</code> – Optional parameter, position of the first character in the string to start search. <a href=../../../data-types/int-uint/amp/ >UInt</a></li> </ul> <p><strong>Returned values</strong></p> <ul> <li>Starting position in bytes (counting from 1), if substring was found.</li> <li>0, if the substring was not found.</li> </ul> <p>Type: <code class=syntax>Integer</code>.</p> <p><strong>Examples</strong></p> <p>The phrase “Hello, world!” contains a set of bytes representing a single-byte encoded text. The function returns some expected result:</p> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=k>position</span><span class=p>(</span><span class=s1>'Hello, world!'</span><span class=p>,</span> <span class=s1>'!'</span><span class=p>)</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─position('Hello, world!', '!')─┐
│                             13 │
└────────────────────────────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=k>position</span><span class=p>(</span><span class=s1>'Hello, world!'</span><span class=p>,</span> <span class=s1>'o'</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span>
    <span class=k>position</span><span class=p>(</span><span class=s1>'Hello, world!'</span><span class=p>,</span> <span class=s1>'o'</span><span class=p>,</span> <span class=mi>7</span><span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─position('Hello, world!', 'o', 1)─┬─position('Hello, world!', 'o', 7)─┐
│                                 5 │                                 9 │
└───────────────────────────────────┴───────────────────────────────────┘
</code></pre></div> <p>The same phrase in Russian contains characters which can’t be represented using a single byte. The function returns some unexpected result (use <a href=../amp/#positionutf8>positionUTF8</a> function for multi-byte encoded text):</p> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=k>position</span><span class=p>(</span><span class=s1>'Привет, мир!'</span><span class=p>,</span> <span class=s1>'!'</span><span class=p>)</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─position('Привет, мир!', '!')─┐
│                            21 │
└───────────────────────────────┘
</code></pre></div> <h2 id=positioncaseinsensitive>positionCaseInsensitive<a class=headerlink href=../amp/#positioncaseinsensitive title="Permanent link"> </a></h2> <p>The same as <a href=../amp/#position>position</a> returns the position (in bytes) of the found substring in the string, starting from 1. Use the function for a case-insensitive search.</p> <p>Works under the assumption that the string contains a set of bytes representing a single-byte encoded text. If this assumption is not met and a character can’t be represented using a single byte, the function doesn’t throw an exception and returns some unexpected result. If character can be represented using two bytes, it will use two bytes and so on.</p> <p><strong>Syntax</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>positionCaseInsensitive</span><span class=p>(</span><span class=n>haystack</span><span class=p>,</span> <span class=n>needle</span><span class=p>[,</span> <span class=n>start_pos</span><span class=p>])</span>
</code></pre></div> <p><strong>Arguments</strong></p> <ul> <li><code class=syntax>haystack</code> — string, in which substring will to be searched. <a href=../../../syntax/amp/#syntax-string-literal>String</a>.</li> <li><code class=syntax>needle</code> — substring to be searched. <a href=../../../syntax/amp/#syntax-string-literal>String</a>.</li> <li><code class=syntax>start_pos</code> – Optional parameter, position of the first character in the string to start search. <a href=../../../data-types/int-uint/amp/ >UInt</a></li> </ul> <p><strong>Returned values</strong></p> <ul> <li>Starting position in bytes (counting from 1), if substring was found.</li> <li>0, if the substring was not found.</li> </ul> <p>Type: <code class=syntax>Integer</code>.</p> <p><strong>Example</strong></p> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>positionCaseInsensitive</span><span class=p>(</span><span class=s1>'Hello, world!'</span><span class=p>,</span> <span class=s1>'hello'</span><span class=p>)</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─positionCaseInsensitive('Hello, world!', 'hello')─┐
│                                                 1 │
└───────────────────────────────────────────────────┘
</code></pre></div> <h2 id=positionutf8>positionUTF8<a class=headerlink href=../amp/#positionutf8 title="Permanent link"> </a></h2> <p>Returns the position (in Unicode points) of the found substring in the string, starting from 1.</p> <p>Works under the assumption that the string contains a set of bytes representing a UTF-8 encoded text. If this assumption is not met, the function doesn’t throw an exception and returns some unexpected result. If character can be represented using two Unicode points, it will use two and so on.</p> <p>For a case-insensitive search, use the function <a href=../amp/#positioncaseinsensitiveutf8>positionCaseInsensitiveUTF8</a>.</p> <p><strong>Syntax</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>positionUTF8</span><span class=p>(</span><span class=n>haystack</span><span class=p>,</span> <span class=n>needle</span><span class=p>[,</span> <span class=n>start_pos</span><span class=p>])</span>
</code></pre></div> <p><strong>Arguments</strong></p> <ul> <li><code class=syntax>haystack</code> — string, in which substring will to be searched. <a href=../../../syntax/amp/#syntax-string-literal>String</a>.</li> <li><code class=syntax>needle</code> — substring to be searched. <a href=../../../syntax/amp/#syntax-string-literal>String</a>.</li> <li><code class=syntax>start_pos</code> – Optional parameter, position of the first character in the string to start search. <a href=../../../data-types/int-uint/amp/ >UInt</a></li> </ul> <p><strong>Returned values</strong></p> <ul> <li>Starting position in Unicode points (counting from 1), if substring was found.</li> <li>0, if the substring was not found.</li> </ul> <p>Type: <code class=syntax>Integer</code>.</p> <p><strong>Examples</strong></p> <p>The phrase “Hello, world!” in Russian contains a set of Unicode points representing a single-point encoded text. The function returns some expected result:</p> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>positionUTF8</span><span class=p>(</span><span class=s1>'Привет, мир!'</span><span class=p>,</span> <span class=s1>'!'</span><span class=p>)</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─positionUTF8('Привет, мир!', '!')─┐
│                                12 │
└───────────────────────────────────┘
</code></pre></div> <p>The phrase “Salut, étudiante!”, where character <code class=syntax>é</code> can be represented using a one point (<code class=syntax>U+00E9</code>) or two points (<code class=syntax>U+0065U+0301</code>) the function can be returned some unexpected result:</p> <p>Query for the letter <code class=syntax>é</code>, which is represented one Unicode point <code class=syntax>U+00E9</code>:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>positionUTF8</span><span class=p>(</span><span class=s1>'Salut, étudiante!'</span><span class=p>,</span> <span class=s1>'!'</span><span class=p>)</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─positionUTF8('Salut, étudiante!', '!')─┐
│                                     17 │
└────────────────────────────────────────┘
</code></pre></div> <p>Query for the letter <code class=syntax>é</code>, which is represented two Unicode points <code class=syntax>U+0065U+0301</code>:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>positionUTF8</span><span class=p>(</span><span class=s1>'Salut, étudiante!'</span><span class=p>,</span> <span class=s1>'!'</span><span class=p>)</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─positionUTF8('Salut, étudiante!', '!')─┐
│                                     18 │
└────────────────────────────────────────┘
</code></pre></div> <h2 id=positioncaseinsensitiveutf8>positionCaseInsensitiveUTF8<a class=headerlink href=../amp/#positioncaseinsensitiveutf8 title="Permanent link"> </a></h2> <p>The same as <a href=../amp/#positionutf8>positionUTF8</a>, but is case-insensitive. Returns the position (in Unicode points) of the found substring in the string, starting from 1.</p> <p>Works under the assumption that the string contains a set of bytes representing a UTF-8 encoded text. If this assumption is not met, the function doesn’t throw an exception and returns some unexpected result. If character can be represented using two Unicode points, it will use two and so on.</p> <p><strong>Syntax</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>positionCaseInsensitiveUTF8</span><span class=p>(</span><span class=n>haystack</span><span class=p>,</span> <span class=n>needle</span><span class=p>[,</span> <span class=n>start_pos</span><span class=p>])</span>
</code></pre></div> <p><strong>Arguments</strong></p> <ul> <li><code class=syntax>haystack</code> — string, in which substring will to be searched. <a href=../../../syntax/amp/#syntax-string-literal>String</a>.</li> <li><code class=syntax>needle</code> — substring to be searched. <a href=../../../syntax/amp/#syntax-string-literal>String</a>.</li> <li><code class=syntax>start_pos</code> – Optional parameter, position of the first character in the string to start search. <a href=../../../data-types/int-uint/amp/ >UInt</a></li> </ul> <p><strong>Returned value</strong></p> <ul> <li>Starting position in Unicode points (counting from 1), if substring was found.</li> <li>0, if the substring was not found.</li> </ul> <p>Type: <code class=syntax>Integer</code>.</p> <p><strong>Example</strong></p> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>positionCaseInsensitiveUTF8</span><span class=p>(</span><span class=s1>'Привет, мир!'</span><span class=p>,</span> <span class=s1>'Мир'</span><span class=p>)</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─positionCaseInsensitiveUTF8('Привет, мир!', 'Мир')─┐
│                                                  9 │
└────────────────────────────────────────────────────┘
</code></pre></div> <h2 id=multisearchallpositions>multiSearchAllPositions<a class=headerlink href=../amp/#multisearchallpositions title="Permanent link"> </a></h2> <p>The same as <a href=.././amp/#position>position</a> but returns <code class=syntax>Array</code> of positions (in bytes) of the found corresponding substrings in the string. Positions are indexed starting from 1.</p> <p>The search is performed on sequences of bytes without respect to string encoding and collation.</p> <ul> <li>For case-insensitive ASCII search, use the function <code class=syntax>multiSearchAllPositionsCaseInsensitive</code>.</li> <li>For search in UTF-8, use the function <a href=../amp/#multiSearchAllPositionsUTF8>multiSearchAllPositionsUTF8</a>.</li> <li>For case-insensitive UTF-8 search, use the function multiSearchAllPositionsCaseInsensitiveUTF8.</li> </ul> <p><strong>Syntax</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>multiSearchAllPositions</span><span class=p>(</span><span class=n>haystack</span><span class=p>,</span> <span class=p>[</span><span class=n>needle1</span><span class=p>,</span> <span class=n>needle2</span><span class=p>,</span> <span class=p>...,</span> <span class=n>needlen</span><span class=p>])</span>
</code></pre></div> <p><strong>Arguments</strong></p> <ul> <li><code class=syntax>haystack</code> — string, in which substring will to be searched. <a href=../../../syntax/amp/#syntax-string-literal>String</a>.</li> <li><code class=syntax>needle</code> — substring to be searched. <a href=../../../syntax/amp/#syntax-string-literal>String</a>.</li> </ul> <p><strong>Returned values</strong></p> <ul> <li>Array of starting positions in bytes (counting from 1), if the corresponding substring was found and 0 if not found.</li> </ul> <p><strong>Example</strong></p> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>multiSearchAllPositions</span><span class=p>(</span><span class=s1>'Hello, World!'</span><span class=p>,</span> <span class=p>[</span><span class=s1>'hello'</span><span class=p>,</span> <span class=s1>'!'</span><span class=p>,</span> <span class=s1>'world'</span><span class=p>])</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─multiSearchAllPositions('Hello, World!', ['hello', '!', 'world'])─┐
│ [0,13,0]                                                          │
└───────────────────────────────────────────────────────────────────┘
</code></pre></div> <h2 id=multiSearchAllPositionsUTF8>multiSearchAllPositionsUTF8<a class=headerlink href=../amp/#multiSearchAllPositionsUTF8 title="Permanent link"> </a></h2> <p>See <code class=syntax>multiSearchAllPositions</code>.</p> <h2 id=multisearchfirstposition>multiSearchFirstPosition(haystack, [needle<sub>1</sub>, needle<sub>2</sub>, …, needle<sub>n</sub>])<a class=headerlink href=../amp/#multisearchfirstposition title="Permanent link"> </a></h2> <p>The same as <code class=syntax>position</code> but returns the leftmost offset of the string <code class=syntax>haystack</code> that is matched to some of the needles.</p> <p>For a case-insensitive search or/and in UTF-8 format use functions <code class=syntax>multiSearchFirstPositionCaseInsensitive, multiSearchFirstPositionUTF8, multiSearchFirstPositionCaseInsensitiveUTF8</code>.</p> <h2 id=multisearchfirstindexhaystack-needle1-needle2-needlen>multiSearchFirstIndex(haystack, [needle<sub>1</sub>, needle<sub>2</sub>, …, needle<sub>n</sub>])<a class=headerlink href=../amp/#multisearchfirstindexhaystack-needle1-needle2-needlen title="Permanent link"> </a></h2> <p>Returns the index <code class=syntax>i</code> (starting from 1) of the leftmost found needle<sub>i</sub> in the string <code class=syntax>haystack</code> and 0 otherwise.</p> <p>For a case-insensitive search or/and in UTF-8 format use functions <code class=syntax>multiSearchFirstIndexCaseInsensitive, multiSearchFirstIndexUTF8, multiSearchFirstIndexCaseInsensitiveUTF8</code>.</p> <h2 id=function-multisearchany>multiSearchAny(haystack, [needle<sub>1</sub>, needle<sub>2</sub>, …, needle<sub>n</sub>])<a class=headerlink href=../amp/#function-multisearchany title="Permanent link"> </a></h2> <p>Returns 1, if at least one string needle<sub>i</sub> matches the string <code class=syntax>haystack</code> and 0 otherwise.</p> <p>For a case-insensitive search or/and in UTF-8 format use functions <code class=syntax>multiSearchAnyCaseInsensitive, multiSearchAnyUTF8, multiSearchAnyCaseInsensitiveUTF8</code>.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Note</p> <p>In all <code class=syntax>multiSearch*</code> functions the number of needles should be less than 2<sup>8</sup> because of implementation specification.</p> </div> <h2 id=matchhaystack-pattern>match(haystack, pattern)<a class=headerlink href=../amp/#matchhaystack-pattern title="Permanent link"> </a></h2> <p>Checks whether the string matches the <code class=syntax>pattern</code> regular expression. A <code class=syntax>re2</code> regular expression. The <a href=https://github.com/google/re2/wiki/Syntax rel="external nofollow noreferrer" target=_blank>syntax</a> of the <code class=syntax>re2</code> regular expressions is more limited than the syntax of the Perl regular expressions.</p> <p>Returns 0 if it doesn’t match, or 1 if it matches.</p> <p>Note that the backslash symbol (<code class=syntax>\</code>) is used for escaping in the regular expression. The same symbol is used for escaping in string literals. So in order to escape the symbol in a regular expression, you must write two backslashes (\) in a string literal.</p> <p>The regular expression works with the string as if it is a set of bytes. The regular expression can’t contain null bytes.<br> For patterns to search for substrings in a string, it is better to use LIKE or ‘position’, since they work much faster.</p> <h2 id=multimatchanyhaystack-pattern1-pattern2-patternn>multiMatchAny(haystack, [pattern<sub>1</sub>, pattern<sub>2</sub>, …, pattern<sub>n</sub>])<a class=headerlink href=../amp/#multimatchanyhaystack-pattern1-pattern2-patternn title="Permanent link"> </a></h2> <p>The same as <code class=syntax>match</code>, but returns 0 if none of the regular expressions are matched and 1 if any of the patterns matches. It uses <a href=https://github.com/intel/hyperscan rel="external nofollow noreferrer" target=_blank>hyperscan</a> library. For patterns to search substrings in a string, it is better to use <code class=syntax>multiSearchAny</code> since it works much faster.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Note</p> <p>The length of any of the <code class=syntax>haystack</code> string must be less than 2<sup>32</sup> bytes otherwise the exception is thrown. This restriction takes place because of hyperscan API.</p> </div> <h2 id=multimatchanyindexhaystack-pattern1-pattern2-patternn>multiMatchAnyIndex(haystack, [pattern<sub>1</sub>, pattern<sub>2</sub>, …, pattern<sub>n</sub>])<a class=headerlink href=../amp/#multimatchanyindexhaystack-pattern1-pattern2-patternn title="Permanent link"> </a></h2> <p>The same as <code class=syntax>multiMatchAny</code>, but returns any index that matches the haystack.</p> <h2 id=multimatchallindiceshaystack-pattern1-pattern2-patternn>multiMatchAllIndices(haystack, [pattern<sub>1</sub>, pattern<sub>2</sub>, …, pattern<sub>n</sub>])<a class=headerlink href=../amp/#multimatchallindiceshaystack-pattern1-pattern2-patternn title="Permanent link"> </a></h2> <p>The same as <code class=syntax>multiMatchAny</code>, but returns the array of all indicies that match the haystack in any order.</p> <h2 id=multifuzzymatchanyhaystack-distance-pattern1-pattern2-patternn>multiFuzzyMatchAny(haystack, distance, [pattern<sub>1</sub>, pattern<sub>2</sub>, …, pattern<sub>n</sub>])<a class=headerlink href=../amp/#multifuzzymatchanyhaystack-distance-pattern1-pattern2-patternn title="Permanent link"> </a></h2> <p>The same as <code class=syntax>multiMatchAny</code>, but returns 1 if any pattern matches the haystack within a constant <a href=https://en.wikipedia.org/wiki/Edit_distance rel="external nofollow noreferrer" target=_blank>edit distance</a>. This function is also in an experimental mode and can be extremely slow. For more information see <a href=https://intel.github.io/hyperscan/dev-reference/compilation.html#approximate-matching rel="external nofollow noreferrer" target=_blank>hyperscan documentation</a>.</p> <h2 id=multifuzzymatchanyindexhaystack-distance-pattern1-pattern2-patternn>multiFuzzyMatchAnyIndex(haystack, distance, [pattern<sub>1</sub>, pattern<sub>2</sub>, …, pattern<sub>n</sub>])<a class=headerlink href=../amp/#multifuzzymatchanyindexhaystack-distance-pattern1-pattern2-patternn title="Permanent link"> </a></h2> <p>The same as <code class=syntax>multiFuzzyMatchAny</code>, but returns any index that matches the haystack within a constant edit distance.</p> <h2 id=multifuzzymatchallindiceshaystack-distance-pattern1-pattern2-patternn>multiFuzzyMatchAllIndices(haystack, distance, [pattern<sub>1</sub>, pattern<sub>2</sub>, …, pattern<sub>n</sub>])<a class=headerlink href=../amp/#multifuzzymatchallindiceshaystack-distance-pattern1-pattern2-patternn title="Permanent link"> </a></h2> <p>The same as <code class=syntax>multiFuzzyMatchAny</code>, but returns the array of all indices in any order that match the haystack within a constant edit distance.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Note</p> <p><code class=syntax>multiFuzzyMatch*</code> functions do not support UTF-8 regular expressions, and such expressions are treated as bytes because of hyperscan restriction.</p> </div> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Note</p> <p>To turn off all functions that use hyperscan, use setting <code class=syntax>SET allow_hyperscan = 0;</code>.</p> </div> <h2 id=extracthaystack-pattern>extract(haystack, pattern)<a class=headerlink href=../amp/#extracthaystack-pattern title="Permanent link"> </a></h2> <p>Extracts a fragment of a string using a regular expression. If ‘haystack’ doesn’t match the ‘pattern’ regex, an empty string is returned. If the regex doesn’t contain subpatterns, it takes the fragment that matches the entire regex. Otherwise, it takes the fragment that matches the first subpattern.</p> <h2 id=extractallhaystack-pattern>extractAll(haystack, pattern)<a class=headerlink href=../amp/#extractallhaystack-pattern title="Permanent link"> </a></h2> <p>Extracts all the fragments of a string using a regular expression. If ‘haystack’ doesn’t match the ‘pattern’ regex, an empty string is returned. Returns an array of strings consisting of all matches to the regex. In general, the behavior is the same as the ‘extract’ function (it takes the first subpattern, or the entire expression if there isn’t a subpattern).</p> <h2 id=extractallgroups-horizontal>extractAllGroupsHorizontal<a class=headerlink href=../amp/#extractallgroups-horizontal title="Permanent link"> </a></h2> <p>Matches all groups of the <code class=syntax>haystack</code> string using the <code class=syntax>pattern</code> regular expression. Returns an array of arrays, where the first array includes all fragments matching the first group, the second array - matching the second group, etc. </p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Note</p> <p><code class=syntax>extractAllGroupsHorizontal</code> function is slower than <a class=alert-link href=../amp/#extractallgroups-vertical>extractAllGroupsVertical</a>.</p> </div> <p><strong>Syntax</strong> </p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>extractAllGroupsHorizontal</span><span class=p>(</span><span class=n>haystack</span><span class=p>,</span> <span class=n>pattern</span><span class=p>)</span>
</code></pre></div> <p><strong>Arguments</strong> </p> <ul> <li><code class=syntax>haystack</code> — Input string. Type: <a href=../../../data-types/string/amp/ >String</a>.</li> <li><code class=syntax>pattern</code> — Regular expression with <a href=https://github.com/google/re2/wiki/Syntax rel="external nofollow noreferrer" target=_blank>re2 syntax</a>. Must contain groups, each group enclosed in parentheses. If <code class=syntax>pattern</code> contains no groups, an exception is thrown. Type: <a href=../../../data-types/string/amp/ >String</a>. </li> </ul> <p><strong>Returned value</strong></p> <ul> <li>Type: <a href=../../../data-types/array/amp/ >Array</a>.</li> </ul> <p>If <code class=syntax>haystack</code> doesn’t match the <code class=syntax>pattern</code> regex, an array of empty arrays is returned. </p> <p><strong>Example</strong></p> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>extractAllGroupsHorizontal</span><span class=p>(</span><span class=s1>'abc=111, def=222, ghi=333'</span><span class=p>,</span> <span class=s1>'("[^"]+"|\\w+)=("[^"]+"|\\w+)'</span><span class=p>)</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─extractAllGroupsHorizontal('abc=111, def=222, ghi=333', '("[^"]+"|\\w+)=("[^"]+"|\\w+)')─┐
│ [['abc','def','ghi'],['111','222','333']]                                                │
└──────────────────────────────────────────────────────────────────────────────────────────┘
</code></pre></div> <p><strong>See Also</strong></p> <ul> <li><a href=../amp/#extractallgroups-vertical>extractAllGroupsVertical</a></li> </ul> <h2 id=extractallgroups-vertical>extractAllGroupsVertical<a class=headerlink href=../amp/#extractallgroups-vertical title="Permanent link"> </a></h2> <p>Matches all groups of the <code class=syntax>haystack</code> string using the <code class=syntax>pattern</code> regular expression. Returns an array of arrays, where each array includes matching fragments from every group. Fragments are grouped in order of appearance in the <code class=syntax>haystack</code>.</p> <p><strong>Syntax</strong> </p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>extractAllGroupsVertical</span><span class=p>(</span><span class=n>haystack</span><span class=p>,</span> <span class=n>pattern</span><span class=p>)</span>
</code></pre></div> <p><strong>Arguments</strong> </p> <ul> <li><code class=syntax>haystack</code> — Input string. Type: <a href=../../../data-types/string/amp/ >String</a>.</li> <li><code class=syntax>pattern</code> — Regular expression with <a href=https://github.com/google/re2/wiki/Syntax rel="external nofollow noreferrer" target=_blank>re2 syntax</a>. Must contain groups, each group enclosed in parentheses. If <code class=syntax>pattern</code> contains no groups, an exception is thrown. Type: <a href=../../../data-types/string/amp/ >String</a>.</li> </ul> <p><strong>Returned value</strong></p> <ul> <li>Type: <a href=../../../data-types/array/amp/ >Array</a>.</li> </ul> <p>If <code class=syntax>haystack</code> doesn’t match the <code class=syntax>pattern</code> regex, an empty array is returned. </p> <p><strong>Example</strong></p> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>extractAllGroupsVertical</span><span class=p>(</span><span class=s1>'abc=111, def=222, ghi=333'</span><span class=p>,</span> <span class=s1>'("[^"]+"|\\w+)=("[^"]+"|\\w+)'</span><span class=p>)</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─extractAllGroupsVertical('abc=111, def=222, ghi=333', '("[^"]+"|\\w+)=("[^"]+"|\\w+)')─┐
│ [['abc','111'],['def','222'],['ghi','333']]                                            │
└────────────────────────────────────────────────────────────────────────────────────────┘
</code></pre></div> <p><strong>See Also</strong></p> <ul> <li><a href=../amp/#extractallgroups-horizontal>extractAllGroupsHorizontal</a></li> </ul> <h2 id=function-like>like(haystack, pattern), haystack LIKE pattern operator<a class=headerlink href=../amp/#function-like title="Permanent link"> </a></h2> <p>Checks whether a string matches a simple regular expression.<br> The regular expression can contain the metasymbols <code class=syntax>%</code> and <code class=syntax>_</code>.</p> <p><code class=syntax>%</code> indicates any quantity of any bytes (including zero characters).</p> <p><code class=syntax>_</code> indicates any one byte.</p> <p>Use the backslash (<code class=syntax>\</code>) for escaping metasymbols. See the note on escaping in the description of the ‘match’ function.</p> <p>For regular expressions like <code class=syntax>%needle%</code>, the code is more optimal and works as fast as the <code class=syntax>position</code> function.<br> For other regular expressions, the code is the same as for the ‘match’ function.</p> <h2 id=function-notlike>notLike(haystack, pattern), haystack NOT LIKE pattern operator<a class=headerlink href=../amp/#function-notlike title="Permanent link"> </a></h2> <p>The same thing as ‘like’, but negative.</p> <h2 id=ilike>ilike<a class=headerlink href=../amp/#ilike title="Permanent link"> </a></h2> <p>Case insensitive variant of <a href=https://clickhouse.tech/docs/en/sql-reference/functions/string-search-functions/#function-like target=_blank>like</a> function. You can use <code class=syntax>ILIKE</code> operator instead of the <code class=syntax>ilike</code> function.</p> <p><strong>Syntax</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ilike</span><span class=p>(</span><span class=n>haystack</span><span class=p>,</span> <span class=n>pattern</span><span class=p>)</span>
</code></pre></div> <p><strong>Arguments</strong></p> <ul> <li><code class=syntax>haystack</code> — Input string. <a href=../../../syntax/amp/#syntax-string-literal>String</a>.</li> <li><code class=syntax>pattern</code> — If <code class=syntax>pattern</code> doesn't contain percent signs or underscores, then the <code class=syntax>pattern</code> only represents the string itself. An underscore (<code class=syntax>_</code>) in <code class=syntax>pattern</code> stands for (matches) any single character. A percent sign (<code class=syntax>%</code>) matches any sequence of zero or more characters.</li> </ul> <p>Some <code class=syntax>pattern</code> examples:</p> <div class=codehilite><pre><span></span><code class=syntax>'abc' ILIKE 'abc'    true
'abc' ILIKE 'a%'     true
'abc' ILIKE '_b_'    true
'abc' ILIKE 'c'      false
</code></pre></div> <p><strong>Returned values</strong></p> <ul> <li>True, if the string matches <code class=syntax>pattern</code>.</li> <li>False, if the string doesn't match <code class=syntax>pattern</code>.</li> </ul> <p><strong>Example</strong></p> <p>Input table:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─id─┬─name─────┬─days─┐
│  1 │ January  │   31 │
│  2 │ February │   29 │
│  3 │ March    │   31 │
│  4 │ April    │   30 │
└────┴──────────┴──────┘
</code></pre></div> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>Months</span> <span class=k>WHERE</span> <span class=k>ilike</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=s1>'%j%'</span><span class=p>)</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─id─┬─name────┬─days─┐
│  1 │ January │   31 │
└────┴─────────┴──────┘
</code></pre></div> <p><strong>See Also</strong></p> <ul> <li><a href=https://clickhouse.tech/docs/en/sql-reference/functions/string-search-functions/#function-like target=_blank>like</a> <!--hide--></li> </ul> <h2 id=ngramdistancehaystack-needle>ngramDistance(haystack, needle)<a class=headerlink href=../amp/#ngramdistancehaystack-needle title="Permanent link"> </a></h2> <p>Calculates the 4-gram distance between <code class=syntax>haystack</code> and <code class=syntax>needle</code>: counts the symmetric difference between two multisets of 4-grams and normalizes it by the sum of their cardinalities. Returns float number from 0 to 1 – the closer to zero, the more strings are similar to each other. If the constant <code class=syntax>needle</code> or <code class=syntax>haystack</code> is more than 32Kb, throws an exception. If some of the non-constant <code class=syntax>haystack</code> or <code class=syntax>needle</code> strings are more than 32Kb, the distance is always one.</p> <p>For case-insensitive search or/and in UTF-8 format use functions <code class=syntax>ngramDistanceCaseInsensitive, ngramDistanceUTF8, ngramDistanceCaseInsensitiveUTF8</code>.</p> <h2 id=ngramsearchhaystack-needle>ngramSearch(haystack, needle)<a class=headerlink href=../amp/#ngramsearchhaystack-needle title="Permanent link"> </a></h2> <p>Same as <code class=syntax>ngramDistance</code> but calculates the non-symmetric difference between <code class=syntax>needle</code> and <code class=syntax>haystack</code> – the number of n-grams from needle minus the common number of n-grams normalized by the number of <code class=syntax>needle</code> n-grams. The closer to one, the more likely <code class=syntax>needle</code> is in the <code class=syntax>haystack</code>. Can be useful for fuzzy string search.</p> <p>For case-insensitive search or/and in UTF-8 format use functions <code class=syntax>ngramSearchCaseInsensitive, ngramSearchUTF8, ngramSearchCaseInsensitiveUTF8</code>.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Note</p> <p>For UTF-8 case we use 3-gram distance. All these are not perfectly fair n-gram distances. We use 2-byte hashes to hash n-grams and then calculate the (non-)symmetric difference between these hash tables – collisions may occur. With UTF-8 case-insensitive format we do not use fair <code class=syntax>tolower</code> function – we zero the 5-th bit (starting from zero) of each codepoint byte and first bit of zeroth byte if bytes more than one – this works for Latin and mostly for all Cyrillic letters.</p> </div> <h2 id=countSubstrings>countSubstrings<a class=headerlink href=../amp/#countSubstrings title="Permanent link"> </a></h2> <p>Returns the number of substring occurrences.</p> <p>For a case-insensitive search, use <a href=.././amp/#countSubstringsCaseInsensitive>countSubstringsCaseInsensitive</a> or <a href=.././amp/#countSubstringsCaseInsensitiveUTF8>countSubstringsCaseInsensitiveUTF8</a> functions.</p> <p><strong>Syntax</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>countSubstrings</span><span class=p>(</span><span class=n>haystack</span><span class=p>,</span> <span class=n>needle</span><span class=p>[,</span> <span class=n>start_pos</span><span class=p>])</span>
</code></pre></div> <p><strong>Arguments</strong></p> <ul> <li><code class=syntax>haystack</code> — The string to search in. <a href=../../../syntax/amp/#syntax-string-literal>String</a>.</li> <li><code class=syntax>needle</code> — The substring to search for. <a href=../../../syntax/amp/#syntax-string-literal>String</a>.</li> <li><code class=syntax>start_pos</code> – Position of the first character in the string to start search. Optional. <a href=../../../data-types/int-uint/amp/ >UInt</a>.</li> </ul> <p><strong>Returned values</strong></p> <ul> <li>Number of occurrences.</li> </ul> <p>Type: <a href=../../../data-types/int-uint/amp/ >UInt64</a>.</p> <p><strong>Examples</strong></p> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>countSubstrings</span><span class=p>(</span><span class=s1>'foobar.com'</span><span class=p>,</span> <span class=s1>'.'</span><span class=p>);</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─countSubstrings('foobar.com', '.')─┐
│                                  1 │
└────────────────────────────────────┘
</code></pre></div> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>countSubstrings</span><span class=p>(</span><span class=s1>'aaaa'</span><span class=p>,</span> <span class=s1>'aa'</span><span class=p>);</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─countSubstrings('aaaa', 'aa')─┐
│                             2 │
└───────────────────────────────┘
</code></pre></div> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>countSubstrings</span><span class=p>(</span><span class=s1>'abc___abc'</span><span class=p>,</span> <span class=s1>'abc'</span><span class=p>,</span> <span class=mi>4</span><span class=p>);</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─countSubstrings('abc___abc', 'abc', 4)─┐
│                                      1 │
└────────────────────────────────────────┘
</code></pre></div> <h2 id=countSubstringsCaseInsensitive>countSubstringsCaseInsensitive<a class=headerlink href=../amp/#countSubstringsCaseInsensitive title="Permanent link"> </a></h2> <p>Returns the number of substring occurrences case-insensitive.</p> <p><strong>Syntax</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>countSubstringsCaseInsensitive</span><span class=p>(</span><span class=n>haystack</span><span class=p>,</span> <span class=n>needle</span><span class=p>[,</span> <span class=n>start_pos</span><span class=p>])</span>
</code></pre></div> <p><strong>Arguments</strong></p> <ul> <li><code class=syntax>haystack</code> — The string to search in. <a href=../../../syntax/amp/#syntax-string-literal>String</a>.</li> <li><code class=syntax>needle</code> — The substring to search for. <a href=../../../syntax/amp/#syntax-string-literal>String</a>.</li> <li><code class=syntax>start_pos</code> – Position of the first character in the string to start search. Optional. <a href=../../../data-types/int-uint/amp/ >UInt</a>.</li> </ul> <p><strong>Returned values</strong></p> <ul> <li>Number of occurrences.</li> </ul> <p>Type: <a href=../../../data-types/int-uint/amp/ >UInt64</a>.</p> <p><strong>Examples</strong></p> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>select</span> <span class=n>countSubstringsCaseInsensitive</span><span class=p>(</span><span class=s1>'aba'</span><span class=p>,</span> <span class=s1>'B'</span><span class=p>);</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─countSubstringsCaseInsensitive('aba', 'B')─┐
│                                          1 │
└────────────────────────────────────────────┘
</code></pre></div> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>countSubstringsCaseInsensitive</span><span class=p>(</span><span class=s1>'foobar.com'</span><span class=p>,</span> <span class=s1>'CoM'</span><span class=p>);</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─countSubstringsCaseInsensitive('foobar.com', 'CoM')─┐
│                                                   1 │
└─────────────────────────────────────────────────────┘
</code></pre></div> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>countSubstringsCaseInsensitive</span><span class=p>(</span><span class=s1>'abC___abC'</span><span class=p>,</span> <span class=s1>'aBc'</span><span class=p>,</span> <span class=mi>2</span><span class=p>);</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─countSubstringsCaseInsensitive('abC___abC', 'aBc', 2)─┐
│                                                     1 │
└───────────────────────────────────────────────────────┘
</code></pre></div> <h2 id=countSubstringsCaseInsensitiveUTF8>countSubstringsCaseInsensitiveUTF8<a class=headerlink href=../amp/#countSubstringsCaseInsensitiveUTF8 title="Permanent link"> </a></h2> <p>Returns the number of substring occurrences in <code class=syntax>UTF-8</code> case-insensitive.</p> <p><strong>Syntax</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>countSubstringsCaseInsensitiveUTF8</span><span class=p>(</span><span class=n>haystack</span><span class=p>,</span> <span class=n>needle</span><span class=p>[,</span> <span class=n>start_pos</span><span class=p>])</span>
</code></pre></div> <p><strong>Arguments</strong></p> <ul> <li><code class=syntax>haystack</code> — The string to search in. <a href=../../../syntax/amp/#syntax-string-literal>String</a>.</li> <li><code class=syntax>needle</code> — The substring to search for. <a href=../../../syntax/amp/#syntax-string-literal>String</a>.</li> <li><code class=syntax>start_pos</code> – Position of the first character in the string to start search. Optional. <a href=../../../data-types/int-uint/amp/ >UInt</a>.</li> </ul> <p><strong>Returned values</strong></p> <ul> <li>Number of occurrences.</li> </ul> <p>Type: <a href=../../../data-types/int-uint/amp/ >UInt64</a>.</p> <p><strong>Examples</strong> </p> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>countSubstringsCaseInsensitiveUTF8</span><span class=p>(</span><span class=s1>'абв'</span><span class=p>,</span> <span class=s1>'A'</span><span class=p>);</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─countSubstringsCaseInsensitiveUTF8('абв', 'A')─┐
│                                              1 │
└────────────────────────────────────────────────┘
</code></pre></div> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>countSubstringsCaseInsensitiveUTF8</span><span class=p>(</span><span class=s1>'аБв__АбВ__абв'</span><span class=p>,</span> <span class=s1>'Абв'</span><span class=p>);</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─countSubstringsCaseInsensitiveUTF8('аБв__АбВ__абв', 'Абв')─┐
│                                                          3 │
└────────────────────────────────────────────────────────────┘
</code></pre></div> <h2 id=countmatcheshaystack-pattern>countMatches(haystack, pattern)<a class=headerlink href=../amp/#countmatcheshaystack-pattern title="Permanent link"> </a></h2> <p>Returns the number of regular expression matches for a <code class=syntax>pattern</code> in a <code class=syntax>haystack</code>.</p> <p><strong>Syntax</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>countMatches</span><span class=p>(</span><span class=n>haystack</span><span class=p>,</span> <span class=n>pattern</span><span class=p>)</span>
</code></pre></div> <p><strong>Arguments</strong></p> <ul> <li><code class=syntax>haystack</code> — The string to search in. <a href=../../../syntax/amp/#syntax-string-literal>String</a>.</li> <li><code class=syntax>pattern</code> — The regular expression with <a href=https://github.com/google/re2/wiki/Syntax rel="external nofollow noreferrer" target=_blank>re2 syntax</a>. <a href=../../../data-types/string/amp/ >String</a>.</li> </ul> <p><strong>Returned value</strong></p> <ul> <li>The number of matches.</li> </ul> <p>Type: <a href=../../../data-types/int-uint/amp/ >UInt64</a>.</p> <p><strong>Examples</strong></p> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>countMatches</span><span class=p>(</span><span class=s1>'foobar.com'</span><span class=p>,</span> <span class=s1>'o+'</span><span class=p>);</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─countMatches('foobar.com', 'o+')─┐
│                                2 │
└──────────────────────────────────┘
</code></pre></div> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>countMatches</span><span class=p>(</span><span class=s1>'aaaa'</span><span class=p>,</span> <span class=s1>'aa'</span><span class=p>);</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─countMatches('aaaa', 'aa')────┐
│                             2 │
└───────────────────────────────┘
</code></pre></div> <p><a href=https://clickhouse.tech/docs/en/query_language/functions/string_search_functions/ target=_blank>Original article</a> <!--hide--></p> </div> </div> <div class=row> <div class=col> <div class="alert alert-light my-3"> <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p> <span class="alert-heading display-6">Article Rating</span> <div id=rating-stars class="display-6 mb-0">RATING_STARS</div> </div> <div id=content-footer class="text-muted pt-3 mb-5"> <div class=float-md-right>©2016–2020 Yandex LLC</div> <div>Built from <a href=https://github.com/ClickHouse/ClickHouse/commit/b030bfedd7db4603034643fd183cf7784a820193 rel="external nofollow noreferrer" target=_blank class=text-reset>b030bfedd7</a> </div> </div> </div> </div> <div id=to-full-website class="row fixed-bottom text-center bg-white py-3"> <div class=col> <a href=https://clickhouse.tech/docs/en/sql-reference/functions/string-search-functions/ class="btn btn-lg btn-outline-orange">To full website</a> </div> </div> </div> <amp-analytics type=metrika> <script type=application/json>{
"vars": {
  "counterId": "18343495",
  "triggers": {
    "notBounce": {
      "on": "timer",
      "timerSpec": {
        "immediate": false,
        "interval": 15,
        "maxTimerLength": 16
      },
      "request": "notBounce"
    }
  }
}
}</script> </amp-analytics> </body> </html> 