<!DOCTYPE html><html lang=zh data-version=master data-single-page=false> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>ClickHouse 架构概述 | ClickHouse文档</title><link rel="shortcut icon" href=/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/images/logo-180x180.png><meta property=og:title content="ClickHouse 架构概述 | ClickHouse文档"><meta property=og:description content="ClickHouse 架构概述 ClickHouse 是一个真正的列式数据库管理系统（DBMS)。在 ClickHouse 中，数据始终是按列存储的，包括矢量（向量或列块）执行的过程。只要有可能，操作都是基于矢量进行分派的，而不是单个的值，"><meta property=og:type content=article><meta property=og:image content=https://clickhouse.tech/images/logo.png><meta content=https://clickhouse.tech/docs/zh/development/architecture/ property=og:url><link href=https://clickhouse.tech/docs/zh/development/architecture/ rel=canonical><link href=https://clickhouse.tech/docs/zh/development/architecture/amp/ rel=amphtml><link rel=search href=/opensearch.xml title=ClickHouse type=application/opensearchdescription+xml><meta name=description content="ClickHouse 架构概述 ClickHouse 是一个真正的列式数据库管理系统（DBMS)。在 ClickHouse 中，数据始终是按列存储的，包括矢量（向量或列块）执行的过程。只要有可能，操作都是基于矢量进行分派的，而不是单个的值，"><meta name=keywords content="ClickHouse, DBMS, OLAP, SQL, open-source, relational, analytics, analytical, Big Data, web-analytics"><link rel=alternate href=https://clickhouse.tech/docs/en/development/architecture/ hreflang=en><link rel=alternate href=https://clickhouse.tech/docs/zh/development/architecture/ hreflang=zh><link rel=alternate href=https://clickhouse.tech/docs/es/development/architecture/ hreflang=es><link rel=alternate href=https://clickhouse.tech/docs/fr/development/architecture/ hreflang=fr><link rel=alternate href=https://clickhouse.tech/docs/ru/development/architecture/ hreflang=ru><link rel=alternate href=https://clickhouse.tech/docs/ja/development/architecture/ hreflang=ja><link rel=alternate href=https://clickhouse.tech/docs/en/development/architecture/ hreflang=x-default><link href=/css/base.css?e27f3458 media=all rel=stylesheet></head> <body dir=ltr data-spy=scroll data-target=#toc data-offset=80> <nav id=top-nav class="navbar navbar-dark navbar-expand-md bg-dark-alt text-white sticky-top"> <div class="container-fluid justify-content-between"> <a href=/ class="d-block navbar-brand mr-3"> <img id=docs-logo-icon src=/images/logo.svg alt="ClickHouse logo" title="ClickHouse logo"> </a> <div class="w-100 navbar-text text-left d-none d-md-block"> <h1 class="h3 m-0 p-0 d-inline"> <a href=# class="text-white text-decoration-none"> ClickHouse 架构概述 </a> </h1> </div> <div class="d-none d-md-block"> <ul class="navbar-nav ml-auto mt-2 mt-lg-0 justify-content-end"> <li id=edit-wrapper class=nav-item> <a id=edit-link href=https://github.com/ClickHouse/ClickHouse/edit/master/docs/zh/development/architecture.md title="Edit this article" class=nav-link rel="external nofollow noreferrer" target=_blank><img src=/images/mkdocs/edit.svg alt="Edit this article" class=mt-1 height=22></a> </li> <li class=nav-item> <a class=nav-link href=https://github.com/ClickHouse/ClickHouse rel="external nofollow noreferrer"> <img src=/images/index/github.svg alt="GitHub repository" title="Go to GitHub" height=32> </a> </li> <li id=languages-wrapper class="nav-item dropdown"> <div id=languages-dropdown> <a class="nav-link dropdown-toggle d-inline-block mt-1 text-muted" href=# id=lang-dropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false> <img src=/images/flags/zh.svg alt=中文 title=中文 width=32 class="d-inline-block mt-n1"> </a> <div class="dropdown-menu bg-dark" aria-labelledby=lang-dropdown> <a href=/docs/en/development/architecture/ class=dropdown-item> <img src=/images/flags/en.svg alt title width=32 class="d-inline-block mr-2">English </a> <a href=/docs/zh/development/architecture/ class="dropdown-item disabled"> <img src=/images/flags/zh.svg alt title width=32 class="d-inline-block mr-2">中文 </a> <a href=/docs/es/development/architecture/ class=dropdown-item> <img src=/images/flags/es.svg alt title width=32 class="d-inline-block mr-2">Español </a> <a href=/docs/fr/development/architecture/ class=dropdown-item> <img src=/images/flags/fr.svg alt title width=32 class="d-inline-block mr-2">Français </a> <a href=/docs/ru/development/architecture/ class=dropdown-item> <img src=/images/flags/ru.svg alt title width=32 class="d-inline-block mr-2">Русский </a> <a href=/docs/ja/development/architecture/ class=dropdown-item> <img src=/images/flags/ja.svg alt title width=32 class="d-inline-block mr-2">日本語 </a> </div> </div> </li> </ul> </div> <form id=search-form class="form-inline m-0"> <div class=input-group> <div class="input-group-prepend w-100"> <span class="input-group-text bg-secondary-alt text-muted border-0 mr-n1" id=search-icon> <img src=/images/mkdocs/search.svg> </span> <input id=docsearch-input class="form-control bg-secondary-alt text-muted border-0 pl-1" type=search placeholder=Search aria-label=Search> </div> </div> </form> <button id=navbar-toggler class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#sidebar aria-controls=sidebar aria-expanded=false aria-label="Toggle navigation"> <span class=navbar-toggler-icon></span> </button> </div> </nav> <div class=container-fluid> <div class="row justify-content-end justify-content-xl-center"> <div id=sidebar class="col-xl-2 col-md-4 bg-secondary-alt p-3 d-print-none min-vh-100 overflow-auto"> <div class=overflow-auto> <div id=single-page-switch class="btn-group mb-2 float-right" role=group aria-label="Multi-page or single-page"> <a href=../.. role=button class="btn btn-dark active" aria-pressed=true> <img src=/images/mkdocs/multi.svg alt="Multi-page version" title="Multi-page version"> </a> <a href=../../single/ role=button class="btn btn-dark-alt active" aria-pressed=true> <img src=/images/mkdocs/single.svg alt="Single-page version" title="Single-page version"> </a> </div> <nav id=sidebar-nav class="nav flex-column mb-5"> <a href=#sidebar-sidebar-1 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-1 title=导言 class="nav-link text-light dropdown-toggle px-0">导言</a> <div id=sidebar-sidebar-1 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../ title=什么是ClickHouse？ class="nav-link text-light text-wrap d-inline-block w-100 px-0">什么是ClickHouse？</a> <a href=../../getting-started/ title=入门 class="nav-link text-light text-wrap d-inline-block w-100 px-0">入门</a> <a href=../../getting-started/install/ title=安装部署 class="nav-link text-light text-wrap d-inline-block w-100 px-0">安装部署</a> <a href=../../getting-started/tutorial/ title=使用教程 class="nav-link text-light text-wrap d-inline-block w-100 px-0">使用教程</a> <a href=#sidebar-sidebar-1-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-1-5 title=示例数据集 class="nav-link text-light dropdown-toggle px-0">示例数据集</a> <div id=sidebar-sidebar-1-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../getting-started/example-datasets/ title=导言 class="nav-link text-light text-wrap d-inline-block w-100 px-0">导言</a> <a href=../../getting-started/example-datasets/metrica/ title="Yandex.Metrica Data" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Yandex.Metrica Data</a> <a href=../../getting-started/example-datasets/star-schema/ title="Star Schema Benchmark" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Star Schema Benchmark</a> <a href=../../getting-started/example-datasets/wikistat/ title=WikiStat class="nav-link text-light text-wrap d-inline-block w-100 px-0">WikiStat</a> <a href=../../getting-started/example-datasets/criteo/ title="Terabyte Click Logs from Criteo" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Terabyte Click Logs from Criteo</a> <a href=../../getting-started/example-datasets/amplab-benchmark/ title="AMPLab Big Data Benchmark" class="nav-link text-light text-wrap d-inline-block w-100 px-0">AMPLab Big Data Benchmark</a> <a href=../../getting-started/example-datasets/nyc-taxi/ title="New York Taxi Data" class="nav-link text-light text-wrap d-inline-block w-100 px-0">New York Taxi Data</a> <a href=../../getting-started/example-datasets/ontime/ title=OnTime class="nav-link text-light text-wrap d-inline-block w-100 px-0">OnTime</a> </nav> </div> <a href=../../getting-started/playground/ title=体验平台 class="nav-link text-light text-wrap d-inline-block w-100 px-0">体验平台</a> </nav> </div> <a href=#sidebar-sidebar-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-2 title=Interfaces class="nav-link text-light dropdown-toggle px-0">Interfaces</a> <div id=sidebar-sidebar-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../interfaces/ title=客户端 class="nav-link text-light text-wrap d-inline-block w-100 px-0">客户端</a> <a href=../../interfaces/cli/ title=命令行客户端 class="nav-link text-light text-wrap d-inline-block w-100 px-0">命令行客户端</a> <a href=../../interfaces/tcp/ title=原生接口(TCP) class="nav-link text-light text-wrap d-inline-block w-100 px-0">原生接口(TCP)</a> <a href=../../interfaces/http/ title=HTTP客户端 class="nav-link text-light text-wrap d-inline-block w-100 px-0">HTTP客户端</a> <a href=../../interfaces/mysql/ title=MySQL接口 class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQL接口</a> <a href=../../interfaces/formats/ title=输入/输出格式 class="nav-link text-light text-wrap d-inline-block w-100 px-0">输入/输出格式</a> <a href=../../interfaces/jdbc/ title=JDBC驱动 class="nav-link text-light text-wrap d-inline-block w-100 px-0">JDBC驱动</a> <a href=../../interfaces/odbc/ title=ODBC驱动 class="nav-link text-light text-wrap d-inline-block w-100 px-0">ODBC驱动</a> <a href=../../interfaces/cpp/ title=C++客户端库 class="nav-link text-light text-wrap d-inline-block w-100 px-0">C++客户端库</a> <a href=#sidebar-sidebar-2-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-2-10 title=第三方工具 class="nav-link text-light dropdown-toggle px-0">第三方工具</a> <div id=sidebar-sidebar-2-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../interfaces/third-party/ title=第三方工具 class="nav-link text-light text-wrap d-inline-block w-100 px-0">第三方工具</a> <a href=../../interfaces/third-party/client-libraries/ title=客户端开发库 class="nav-link text-light text-wrap d-inline-block w-100 px-0">客户端开发库</a> <a href=../../interfaces/third-party/integrations/ title=第三方集成库 class="nav-link text-light text-wrap d-inline-block w-100 px-0">第三方集成库</a> <a href=../../interfaces/third-party/proxy/ title=第三方代理 class="nav-link text-light text-wrap d-inline-block w-100 px-0">第三方代理</a> <a href=../../interfaces/third-party/gui/ title=第三方开发的可视化界面 class="nav-link text-light text-wrap d-inline-block w-100 px-0">第三方开发的可视化界面</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3 title=引擎 class="nav-link text-light dropdown-toggle px-0">引擎</a> <div id=sidebar-sidebar-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=#sidebar-sidebar-3-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3-2 title=数据库引擎 class="nav-link text-light dropdown-toggle px-0">数据库引擎</a> <div id=sidebar-sidebar-3-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../engines/database-engines/lazy/ title=延时引擎 class="nav-link text-light text-wrap d-inline-block w-100 px-0">延时引擎</a> <a href=../../engines/database-engines/atomic/ title=Atomic class="nav-link text-light text-wrap d-inline-block w-100 px-0">Atomic</a> <a href=../../engines/database-engines/mysql/ title=MySQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQL</a> <a href=../../engines/database-engines/ title=数据库引擎 class="nav-link text-light text-wrap d-inline-block w-100 px-0">数据库引擎</a> </nav> </div> <a href=#sidebar-sidebar-3-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3-3 title=表引擎 class="nav-link text-light dropdown-toggle px-0">表引擎</a> <div id=sidebar-sidebar-3-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=#sidebar-sidebar-3-3-1 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3-3-1 title=合并树家族 class="nav-link text-light dropdown-toggle px-0">合并树家族</a> <div id=sidebar-sidebar-3-3-1 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../engines/table-engines/mergetree-family/versionedcollapsingmergetree/ title=版本折叠MergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">版本折叠MergeTree</a> <a href=../../engines/table-engines/mergetree-family/graphitemergetree/ title=GraphiteMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">GraphiteMergeTree</a> <a href=../../engines/table-engines/mergetree-family/aggregatingmergetree/ title=AggregatingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">AggregatingMergeTree</a> <a href=../../engines/table-engines/mergetree-family/mergetree/ title=MergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">MergeTree</a> <a href=../../engines/table-engines/mergetree-family/replacingmergetree/ title=ReplacingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">ReplacingMergeTree</a> <a href=../../engines/table-engines/mergetree-family/summingmergetree/ title=SummingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">SummingMergeTree</a> <a href=../../engines/table-engines/mergetree-family/collapsingmergetree/ title=折叠树 class="nav-link text-light text-wrap d-inline-block w-100 px-0">折叠树</a> <a href=../../engines/table-engines/mergetree-family/replication/ title=数据副本 class="nav-link text-light text-wrap d-inline-block w-100 px-0">数据副本</a> <a href=../../engines/table-engines/mergetree-family/custom-partitioning-key/ title=自定义分区键 class="nav-link text-light text-wrap d-inline-block w-100 px-0">自定义分区键</a> </nav> </div> <a href=#sidebar-sidebar-3-3-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3-3-2 title=日志系列 class="nav-link text-light dropdown-toggle px-0">日志系列</a> <div id=sidebar-sidebar-3-3-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../engines/table-engines/log-family/ title=日志引擎系列 class="nav-link text-light text-wrap d-inline-block w-100 px-0">日志引擎系列</a> <a href=../../engines/table-engines/log-family/log/ title=Log class="nav-link text-light text-wrap d-inline-block w-100 px-0">Log</a> <a href=../../engines/table-engines/log-family/stripelog/ title=StripeLog class="nav-link text-light text-wrap d-inline-block w-100 px-0">StripeLog</a> <a href=../../engines/table-engines/log-family/tinylog/ title=TinyLog class="nav-link text-light text-wrap d-inline-block w-100 px-0">TinyLog</a> </nav> </div> <a href=#sidebar-sidebar-3-3-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3-3-3 title=集成 class="nav-link text-light dropdown-toggle px-0">集成</a> <div id=sidebar-sidebar-3-3-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../engines/table-engines/integrations/jdbc/ title=JDBC表引擎 class="nav-link text-light text-wrap d-inline-block w-100 px-0">JDBC表引擎</a> <a href=../../engines/table-engines/integrations/odbc/ title=ODBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">ODBC</a> <a href=../../engines/table-engines/integrations/hdfs/ title=HDFS class="nav-link text-light text-wrap d-inline-block w-100 px-0">HDFS</a> <a href=../../engines/table-engines/integrations/kafka/ title=Kafka class="nav-link text-light text-wrap d-inline-block w-100 px-0">Kafka</a> <a href=../../engines/table-engines/integrations/mysql/ title=MySQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQL</a> </nav> </div> <a href=#sidebar-sidebar-3-3-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3-3-4 title=特别 class="nav-link text-light dropdown-toggle px-0">特别</a> <div id=sidebar-sidebar-3-3-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../engines/table-engines/special/join/ title=关联表引擎 class="nav-link text-light text-wrap d-inline-block w-100 px-0">关联表引擎</a> <a href=../../engines/table-engines/special/generate/ title=随机数生成 class="nav-link text-light text-wrap d-inline-block w-100 px-0">随机数生成</a> <a href=../../engines/table-engines/special/materializedview/ title=MaterializedView class="nav-link text-light text-wrap d-inline-block w-100 px-0">MaterializedView</a> <a href=../../engines/table-engines/special/null/ title=Null class="nav-link text-light text-wrap d-inline-block w-100 px-0">Null</a> <a href=../../engines/table-engines/special/url/ title=URL(URL,格式) class="nav-link text-light text-wrap d-inline-block w-100 px-0">URL(URL,格式)</a> <a href=../../engines/table-engines/special/memory/ title=内存表 class="nav-link text-light text-wrap d-inline-block w-100 px-0">内存表</a> <a href=../../engines/table-engines/special/distributed/ title=分布 class="nav-link text-light text-wrap d-inline-block w-100 px-0">分布</a> <a href=../../engines/table-engines/special/merge/ title=合并 class="nav-link text-light text-wrap d-inline-block w-100 px-0">合并</a> <a href=../../engines/table-engines/special/dictionary/ title=字典 class="nav-link text-light text-wrap d-inline-block w-100 px-0">字典</a> <a href=../../engines/table-engines/special/file/ title=文件(输入格式) class="nav-link text-light text-wrap d-inline-block w-100 px-0">文件(输入格式)</a> <a href=../../engines/table-engines/special/external-data/ title=用于查询处理的外部数据 class="nav-link text-light text-wrap d-inline-block w-100 px-0">用于查询处理的外部数据</a> <a href=../../engines/table-engines/special/buffer/ title=缓冲区 class="nav-link text-light text-wrap d-inline-block w-100 px-0">缓冲区</a> <a href=../../engines/table-engines/special/view/ title=视图 class="nav-link text-light text-wrap d-inline-block w-100 px-0">视图</a> <a href=../../engines/table-engines/special/set/ title=设置 class="nav-link text-light text-wrap d-inline-block w-100 px-0">设置</a> </nav> </div> <a href=../../engines/table-engines/ title=表引擎 class="nav-link text-light text-wrap d-inline-block w-100 px-0">表引擎</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4 title=SQL参考 class="nav-link text-light dropdown-toggle px-0">SQL参考</a> <div id=sidebar-sidebar-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/syntax/ title=SQL语法 class="nav-link text-light text-wrap d-inline-block w-100 px-0">SQL语法</a> <a href=#sidebar-sidebar-4-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-3 title=发言 class="nav-link text-light dropdown-toggle px-0">发言</a> <div id=sidebar-sidebar-4-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=#sidebar-sidebar-4-3-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-3-2 title=SELECT class="nav-link text-light dropdown-toggle px-0">SELECT</a> <div id=sidebar-sidebar-4-3-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/statements/select/ title=综述 class="nav-link text-light text-wrap d-inline-block w-100 px-0">综述</a> <a href=../../sql-reference/statements/select/all/ title="ALL 子句" class="nav-link text-light text-wrap d-inline-block w-100 px-0">ALL 子句</a> <a href=../../sql-reference/statements/select/array-join/ title="ARRAY JOIN" class="nav-link text-light text-wrap d-inline-block w-100 px-0">ARRAY JOIN</a> <a href=../../sql-reference/statements/select/distinct/ title=DISTINCT class="nav-link text-light text-wrap d-inline-block w-100 px-0">DISTINCT</a> <a href=../../sql-reference/statements/select/format/ title=FORMAT class="nav-link text-light text-wrap d-inline-block w-100 px-0">FORMAT</a> <a href=../../sql-reference/statements/select/from/ title=FROM class="nav-link text-light text-wrap d-inline-block w-100 px-0">FROM</a> <a href=../../sql-reference/statements/select/group-by/ title="GROUP BY" class="nav-link text-light text-wrap d-inline-block w-100 px-0">GROUP BY</a> <a href=../../sql-reference/statements/select/having/ title=HAVING class="nav-link text-light text-wrap d-inline-block w-100 px-0">HAVING</a> <a href=../../sql-reference/statements/select/into-outfile/ title="INTO OUTFILE" class="nav-link text-light text-wrap d-inline-block w-100 px-0">INTO OUTFILE</a> <a href=../../sql-reference/statements/select/join/ title=JOIN class="nav-link text-light text-wrap d-inline-block w-100 px-0">JOIN</a> <a href=../../sql-reference/statements/select/limit/ title=LIMIT class="nav-link text-light text-wrap d-inline-block w-100 px-0">LIMIT</a> <a href=../../sql-reference/statements/select/limit-by/ title="LIMIT BY" class="nav-link text-light text-wrap d-inline-block w-100 px-0">LIMIT BY</a> <a href=../../sql-reference/statements/select/order-by/ title="ORDER BY" class="nav-link text-light text-wrap d-inline-block w-100 px-0">ORDER BY</a> <a href=../../sql-reference/statements/select/prewhere/ title=PREWHERE class="nav-link text-light text-wrap d-inline-block w-100 px-0">PREWHERE</a> <a href=../../sql-reference/statements/select/sample/ title=SAMPLE class="nav-link text-light text-wrap d-inline-block w-100 px-0">SAMPLE</a> <a href=../../sql-reference/statements/select/union/ title="UNION ALL" class="nav-link text-light text-wrap d-inline-block w-100 px-0">UNION ALL</a> <a href=../../sql-reference/statements/select/where/ title=WHERE class="nav-link text-light text-wrap d-inline-block w-100 px-0">WHERE</a> <a href=../../sql-reference/statements/select/with/ title=WITH class="nav-link text-light text-wrap d-inline-block w-100 px-0">WITH</a> </nav> </div> <a href=../../sql-reference/statements/alter/ title=ALTER class="nav-link text-light text-wrap d-inline-block w-100 px-0">ALTER</a> <a href=../../sql-reference/statements/system/ title=SYSTEM class="nav-link text-light text-wrap d-inline-block w-100 px-0">SYSTEM</a> <a href=../../sql-reference/statements/show/ title=SHOW class="nav-link text-light text-wrap d-inline-block w-100 px-0">SHOW</a> <a href=../../sql-reference/statements/grant/ title=授权操作 class="nav-link text-light text-wrap d-inline-block w-100 px-0">授权操作</a> <a href=../../sql-reference/statements/revoke/ title=REVOKE class="nav-link text-light text-wrap d-inline-block w-100 px-0">REVOKE</a> <a href=../../sql-reference/statements/misc/ title=其他 class="nav-link text-light text-wrap d-inline-block w-100 px-0">其他</a> <a href=../../sql-reference/statements/create/ title="CREATE DATABASE" class="nav-link text-light text-wrap d-inline-block w-100 px-0">CREATE DATABASE</a> <a href=../../sql-reference/statements/insert-into/ title="INSERT INTO 语句" class="nav-link text-light text-wrap d-inline-block w-100 px-0">INSERT INTO 语句</a> </nav> </div> <a href=#sidebar-sidebar-4-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-4 title=函数 class="nav-link text-light dropdown-toggle px-0">函数</a> <div id=sidebar-sidebar-4-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/functions/ title=简介 class="nav-link text-light text-wrap d-inline-block w-100 px-0">简介</a> <a href=../../sql-reference/functions/arithmetic-functions/ title=算术函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">算术函数</a> <a href=../../sql-reference/functions/comparison-functions/ title=比较函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">比较函数</a> <a href=../../sql-reference/functions/logical-functions/ title=逻辑函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">逻辑函数</a> <a href=../../sql-reference/functions/type-conversion-functions/ title=类型转换函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">类型转换函数</a> <a href=../../sql-reference/functions/in-functions/ title="IN 运算符" class="nav-link text-light text-wrap d-inline-block w-100 px-0">IN 运算符</a> <a href=../../sql-reference/functions/introspection/ title=自省 class="nav-link text-light text-wrap d-inline-block w-100 px-0">自省</a> <a href=../../sql-reference/functions/geo/ title=GEO函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">GEO函数</a> <a href=../../sql-reference/functions/hash-functions/ title=Hash函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">Hash函数</a> <a href=../../sql-reference/functions/ip-address-functions/ title=IP函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IP函数</a> <a href=../../sql-reference/functions/json-functions/ title=JSON函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">JSON函数</a> <a href=../../sql-reference/functions/functions-for-nulls/ title=Nullable处理函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nullable处理函数</a> <a href=../../sql-reference/functions/url-functions/ title=URL函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">URL函数</a> <a href=../../sql-reference/functions/uuid-functions/ title=UUID函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">UUID函数</a> <a href=../../sql-reference/functions/array-join/ title=arrayJoin函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">arrayJoin函数</a> <a href=../../sql-reference/functions/bitmap-functions/ title=位图函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">位图函数</a> <a href=../../sql-reference/functions/bit-functions/ title=位操作函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">位操作函数</a> <a href=../../sql-reference/functions/other-functions/ title=其他函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">其他函数</a> <a href=../../sql-reference/functions/ym-dict-functions/ title=功能与Yandex的工作。梅特里卡词典 class="nav-link text-light text-wrap d-inline-block w-100 px-0">功能与Yandex的工作。梅特里卡词典</a> <a href=../../sql-reference/functions/rounding-functions/ title=取整函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">取整函数</a> <a href=../../sql-reference/functions/ext-dict-functions/ title=字典函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">字典函数</a> <a href=../../sql-reference/functions/string-functions/ title=字符串函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">字符串函数</a> <a href=../../sql-reference/functions/splitting-merging-functions/ title=字符串拆分合并函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">字符串拆分合并函数</a> <a href=../../sql-reference/functions/string-search-functions/ title=字符串搜索函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">字符串搜索函数</a> <a href=../../sql-reference/functions/string-replace-functions/ title=字符串替换函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">字符串替换函数</a> <a href=../../sql-reference/functions/math-functions/ title=数学函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">数学函数</a> <a href=../../sql-reference/functions/array-functions/ title=数组函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">数组函数</a> <a href=../../sql-reference/functions/date-time-functions/ title=时间日期函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">时间日期函数</a> <a href=../../sql-reference/functions/machine-learning-functions/ title=机器学习函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">机器学习函数</a> <a href=../../sql-reference/functions/conditional-functions/ title=条件函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">条件函数</a> <a href=../../sql-reference/functions/encoding-functions/ title=编码函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">编码函数</a> <a href=../../sql-reference/functions/random-functions/ title=随机函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">随机函数</a> <a href=../../sql-reference/functions/higher-order-functions/ title=高阶函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">高阶函数</a> </nav> </div> <a href=#sidebar-sidebar-4-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-5 title=聚合函数 class="nav-link text-light dropdown-toggle px-0">聚合函数</a> <div id=sidebar-sidebar-4-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/aggregate-functions/ title=简介 class="nav-link text-light text-wrap d-inline-block w-100 px-0">简介</a> <a href=../../sql-reference/aggregate-functions/reference/ title=参考手册 class="nav-link text-light text-wrap d-inline-block w-100 px-0">参考手册</a> <a href=../../sql-reference/aggregate-functions/combinators/ title=聚合函数组合器 class="nav-link text-light text-wrap d-inline-block w-100 px-0">聚合函数组合器</a> <a href=../../sql-reference/aggregate-functions/parametric-functions/ title=参数聚合函数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">参数聚合函数</a> </nav> </div> <a href=#sidebar-sidebar-4-6 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-6 title=表函数 class="nav-link text-light dropdown-toggle px-0">表函数</a> <div id=sidebar-sidebar-4-6 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/table-functions/ title=导言 class="nav-link text-light text-wrap d-inline-block w-100 px-0">导言</a> <a href=../../sql-reference/table-functions/file/ title=文件 class="nav-link text-light text-wrap d-inline-block w-100 px-0">文件</a> <a href=../../sql-reference/table-functions/merge/ title=合并 class="nav-link text-light text-wrap d-inline-block w-100 px-0">合并</a> <a href=../../sql-reference/table-functions/numbers/ title=数字 class="nav-link text-light text-wrap d-inline-block w-100 px-0">数字</a> <a href=../../sql-reference/table-functions/url/ title=url class="nav-link text-light text-wrap d-inline-block w-100 px-0">url</a> <a href=../../sql-reference/table-functions/mysql/ title=mysql class="nav-link text-light text-wrap d-inline-block w-100 px-0">mysql</a> <a href=../../sql-reference/table-functions/jdbc/ title=jdbc class="nav-link text-light text-wrap d-inline-block w-100 px-0">jdbc</a> <a href=../../sql-reference/table-functions/odbc/ title=odbc class="nav-link text-light text-wrap d-inline-block w-100 px-0">odbc</a> <a href=../../sql-reference/table-functions/hdfs/ title=hdfs class="nav-link text-light text-wrap d-inline-block w-100 px-0">hdfs</a> <a href=../../sql-reference/table-functions/input/ title=输入 class="nav-link text-light text-wrap d-inline-block w-100 px-0">输入</a> <a href=../../sql-reference/table-functions/generate/ title=generateRandom class="nav-link text-light text-wrap d-inline-block w-100 px-0">generateRandom</a> <a href=../../sql-reference/table-functions/remote/ title=远程，远程安全 class="nav-link text-light text-wrap d-inline-block w-100 px-0">远程，远程安全</a> </nav> </div> <a href=#sidebar-sidebar-4-7 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-7 title=字典 class="nav-link text-light dropdown-toggle px-0">字典</a> <div id=sidebar-sidebar-4-7 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/dictionaries/ title=导言 class="nav-link text-light text-wrap d-inline-block w-100 px-0">导言</a> <a href=#sidebar-sidebar-4-7-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-7-2 title=外部字典 class="nav-link text-light dropdown-toggle px-0">外部字典</a> <div id=sidebar-sidebar-4-7-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/dictionaries/external-dictionaries/external-dicts/ title=概述 class="nav-link text-light text-wrap d-inline-block w-100 px-0">概述</a> <a href=../../sql-reference/dictionaries/external-dictionaries/external-dicts-dict/ title=配置外部字典 class="nav-link text-light text-wrap d-inline-block w-100 px-0">配置外部字典</a> <a href=../../sql-reference/dictionaries/external-dictionaries/external-dicts-dict-layout/ title=在内存中存储字典 class="nav-link text-light text-wrap d-inline-block w-100 px-0">在内存中存储字典</a> <a href=../../sql-reference/dictionaries/external-dictionaries/external-dicts-dict-lifetime/ title=字典更新 class="nav-link text-light text-wrap d-inline-block w-100 px-0">字典更新</a> <a href=../../sql-reference/dictionaries/external-dictionaries/external-dicts-dict-sources/ title=外部字典的来源 class="nav-link text-light text-wrap d-inline-block w-100 px-0">外部字典的来源</a> <a href=../../sql-reference/dictionaries/external-dictionaries/external-dicts-dict-structure/ title=字典键和字段 class="nav-link text-light text-wrap d-inline-block w-100 px-0">字典键和字段</a> <a href=../../sql-reference/dictionaries/external-dictionaries/external-dicts-dict-hierarchical/ title=分层字典 class="nav-link text-light text-wrap d-inline-block w-100 px-0">分层字典</a> </nav> </div> <a href=../../sql-reference/dictionaries/internal-dicts/ title=内部字典 class="nav-link text-light text-wrap d-inline-block w-100 px-0">内部字典</a> </nav> </div> <a href=../../sql-reference/ansi/ title=ANSI兼容性 class="nav-link text-light text-wrap d-inline-block w-100 px-0">ANSI兼容性</a> <a href=#sidebar-sidebar-4-9 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-9 title=操作符 class="nav-link text-light dropdown-toggle px-0">操作符</a> <div id=sidebar-sidebar-4-9 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/operators/in/ title="IN 操作符" class="nav-link text-light text-wrap d-inline-block w-100 px-0">IN 操作符</a> <a href=../../sql-reference/operators/ title=操作符 class="nav-link text-light text-wrap d-inline-block w-100 px-0">操作符</a> </nav> </div> <a href=#sidebar-sidebar-4-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-10 title=数据类型 class="nav-link text-light dropdown-toggle px-0">数据类型</a> <div id=sidebar-sidebar-4-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/data-types/uuid/ title=UUID class="nav-link text-light text-wrap d-inline-block w-100 px-0">UUID</a> <a href=../../sql-reference/data-types/datetime64/ title=DateTime64 class="nav-link text-light text-wrap d-inline-block w-100 px-0">DateTime64</a> <a href=../../sql-reference/data-types/lowcardinality/ title=低基数类型 class="nav-link text-light text-wrap d-inline-block w-100 px-0">低基数类型</a> <a href=#sidebar-sidebar-4-10-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-10-4 title=域 class="nav-link text-light dropdown-toggle px-0">域</a> <div id=sidebar-sidebar-4-10-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/data-types/domains/ title=域 class="nav-link text-light text-wrap d-inline-block w-100 px-0">域</a> <a href=../../sql-reference/data-types/domains/ipv4/ title=IPv4 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IPv4</a> <a href=../../sql-reference/data-types/domains/ipv6/ title=IPv6 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IPv6</a> </nav> </div> <a href=../../sql-reference/data-types/aggregatefunction/ title="AggregateFunction(name, types_of_arguments…)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">AggregateFunction(name, types_of_arguments…)</a> <a href=../../sql-reference/data-types/decimal/ title=Decimal(P,S),Decimal32(S),Decimal64(S),Decimal128(S) class="nav-link text-light text-wrap d-inline-block w-100 px-0">Decimal(P,S),Decimal32(S),Decimal64(S),Decimal128(S)</a> <a href=../../sql-reference/data-types/enum/ title=Enum8,Enum16 class="nav-link text-light text-wrap d-inline-block w-100 px-0">Enum8,Enum16</a> <a href=../../sql-reference/data-types/float/ title=Float32,Float64 class="nav-link text-light text-wrap d-inline-block w-100 px-0">Float32,Float64</a> <a href=../../sql-reference/data-types/simpleaggregatefunction/ title=SimpleAggregateFunction class="nav-link text-light text-wrap d-inline-block w-100 px-0">SimpleAggregateFunction</a> <a href=../../sql-reference/data-types/tuple/ title="Tuple(T1, T2, …)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Tuple(T1, T2, …)</a> <a href=../../sql-reference/data-types/int-uint/ title=UInt8,UInt16,UInt32,UInt64,Int8,Int16,Int32,Int64 class="nav-link text-light text-wrap d-inline-block w-100 px-0">UInt8,UInt16,UInt32,UInt64,Int8,Int16,Int32,Int64</a> <a href=../../sql-reference/data-types/nullable/ title=可为空（类型名称) class="nav-link text-light text-wrap d-inline-block w-100 px-0">可为空（类型名称)</a> <a href=../../sql-reference/data-types/fixedstring/ title=固定字符串 class="nav-link text-light text-wrap d-inline-block w-100 px-0">固定字符串</a> <a href=../../sql-reference/data-types/string/ title=字符串 class="nav-link text-light text-wrap d-inline-block w-100 px-0">字符串</a> <a href=../../sql-reference/data-types/boolean/ title=布尔值 class="nav-link text-light text-wrap d-inline-block w-100 px-0">布尔值</a> <a href=../../sql-reference/data-types/ title=数据类型 class="nav-link text-light text-wrap d-inline-block w-100 px-0">数据类型</a> <a href=../../sql-reference/data-types/date/ title=日期 class="nav-link text-light text-wrap d-inline-block w-100 px-0">日期</a> <a href=../../sql-reference/data-types/datetime/ title=日期时间 class="nav-link text-light text-wrap d-inline-block w-100 px-0">日期时间</a> <a href=../../sql-reference/data-types/array/ title=阵列(T) class="nav-link text-light text-wrap d-inline-block w-100 px-0">阵列(T)</a> <a href=#sidebar-sidebar-4-10-20 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-10-20 title=嵌套数据结构 class="nav-link text-light dropdown-toggle px-0">嵌套数据结构</a> <div id=sidebar-sidebar-4-10-20 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/data-types/nested-data-structures/nested/ title="Nested(Name1 Type1, Name2 Type2, …)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nested(Name1 Type1, Name2 Type2, …)</a> <a href=../../sql-reference/data-types/nested-data-structures/ title=嵌套数据结构 class="nav-link text-light text-wrap d-inline-block w-100 px-0">嵌套数据结构</a> </nav> </div> <a href=#sidebar-sidebar-4-10-21 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-10-21 title=特殊数据类型 class="nav-link text-light dropdown-toggle px-0">特殊数据类型</a> <div id=sidebar-sidebar-4-10-21 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../sql-reference/data-types/special-data-types/interval/ title=间隔 class="nav-link text-light text-wrap d-inline-block w-100 px-0">间隔</a> <a href=../../sql-reference/data-types/special-data-types/nothing/ title=没什么 class="nav-link text-light text-wrap d-inline-block w-100 px-0">没什么</a> <a href=../../sql-reference/data-types/special-data-types/ title=特殊数据类型 class="nav-link text-light text-wrap d-inline-block w-100 px-0">特殊数据类型</a> <a href=../../sql-reference/data-types/special-data-types/expression/ title=表达式 class="nav-link text-light text-wrap d-inline-block w-100 px-0">表达式</a> <a href=../../sql-reference/data-types/special-data-types/set/ title=设置 class="nav-link text-light text-wrap d-inline-block w-100 px-0">设置</a> </nav> </div> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5 title=指南 class="nav-link text-light dropdown-toggle px-0">指南</a> <div id=sidebar-sidebar-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../guides/ title=概述 class="nav-link text-light text-wrap d-inline-block w-100 px-0">概述</a> <a href=../../guides/apply-catboost-model/ title=应用CatBoost模型 class="nav-link text-light text-wrap d-inline-block w-100 px-0">应用CatBoost模型</a> </nav> </div> <a href=#sidebar-sidebar-6 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6 title=操作 class="nav-link text-light dropdown-toggle px-0">操作</a> <div id=sidebar-sidebar-6 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../operations/ title=操作 class="nav-link text-light text-wrap d-inline-block w-100 px-0">操作</a> <a href=../../operations/requirements/ title=要求 class="nav-link text-light text-wrap d-inline-block w-100 px-0">要求</a> <a href=../../operations/monitoring/ title=监控 class="nav-link text-light text-wrap d-inline-block w-100 px-0">监控</a> <a href=../../operations/troubleshooting/ title=常见问题 class="nav-link text-light text-wrap d-inline-block w-100 px-0">常见问题</a> <a href=../../operations/update/ title=更新 class="nav-link text-light text-wrap d-inline-block w-100 px-0">更新</a> <a href=../../operations/access-rights/ title=访问权限和账户管理 class="nav-link text-light text-wrap d-inline-block w-100 px-0">访问权限和账户管理</a> <a href=../../operations/backup/ title=数据备份 class="nav-link text-light text-wrap d-inline-block w-100 px-0">数据备份</a> <a href=#sidebar-sidebar-6-8 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-8 title=优化性能 class="nav-link text-light dropdown-toggle px-0">优化性能</a> <div id=sidebar-sidebar-6-8 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../operations/optimizing-performance/sampling-query-profiler/ title=查询分析 class="nav-link text-light text-wrap d-inline-block w-100 px-0">查询分析</a> </nav> </div> <a href=#sidebar-sidebar-6-9 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-9 title=系统表 class="nav-link text-light dropdown-toggle px-0">系统表</a> <div id=sidebar-sidebar-6-9 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../operations/system-tables/ title=系统表 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统表</a> <a href=../../operations/system-tables/query_log/ title=system.query_log class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.query_log</a> <a href=../../operations/system-tables/asynchronous_metric_log/ title=系统。asynchronous_metric_log class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。asynchronous_metric_log</a> <a href=../../operations/system-tables/asynchronous_metrics/ title=系统。asynchronous_metrics class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。asynchronous_metrics</a> <a href=../../operations/system-tables/data_type_families/ title=系统。data_type_families class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。data_type_families</a> <a href=../../operations/system-tables/detached_parts/ title=系统。detached_parts class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。detached_parts</a> <a href=../../operations/system-tables/graphite_retentions/ title=系统。graphite_retentions class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。graphite_retentions</a> <a href=../../operations/system-tables/merge_tree_settings/ title=系统。merge_tree_settings class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。merge_tree_settings</a> <a href=../../operations/system-tables/metric_log/ title=系统。metric_log class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。metric_log</a> <a href=../../operations/system-tables/numbers_mt/ title=系统。numbers_mt class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。numbers_mt</a> <a href=../../operations/system-tables/part_log/ title=系统。part_log class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。part_log</a> <a href=../../operations/system-tables/query_thread_log/ title=系统。query_thread_log class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。query_thread_log</a> <a href=../../operations/system-tables/storage_policies/ title=系统。storage_policies class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。storage_policies</a> <a href=../../operations/system-tables/text_log/ title=系统。text_log class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。text_log</a> <a href=../../operations/system-tables/trace_log/ title=系统。trace_log class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。trace_log</a> <a href=../../operations/system-tables/one/ title=系统。一 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。一</a> <a href=../../operations/system-tables/columns/ title=系统。列 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。列</a> <a href=../../operations/system-tables/replicas/ title=系统。副本 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。副本</a> <a href=../../operations/system-tables/functions/ title=系统。功能 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。功能</a> <a href=../../operations/system-tables/zookeeper/ title=系统。动物园管理员 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。动物园管理员</a> <a href=../../operations/system-tables/merges/ title=系统。合并 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。合并</a> <a href=../../operations/system-tables/dictionaries/ title=系统。字典 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。字典</a> <a href=../../operations/system-tables/metrics/ title=系统。指标 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。指标</a> <a href=../../operations/system-tables/numbers/ title=系统。数字 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。数字</a> <a href=../../operations/system-tables/databases/ title=系统。数据库 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。数据库</a> <a href=../../operations/system-tables/events/ title=系统。活动 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。活动</a> <a href=../../operations/system-tables/processes/ title=系统。流程 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。流程</a> <a href=../../operations/system-tables/disks/ title=系统。磁盘 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。磁盘</a> <a href=../../operations/system-tables/mutations/ title=系统。突变 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。突变</a> <a href=../../operations/system-tables/tables/ title=系统。表 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。表</a> <a href=../../operations/system-tables/table_engines/ title=系统。表_engines class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。表_engines</a> <a href=../../operations/system-tables/settings/ title=系统。设置 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。设置</a> <a href=../../operations/system-tables/contributors/ title=系统。贡献者 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。贡献者</a> <a href=../../operations/system-tables/clusters/ title=系统。集群 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。集群</a> <a href=../../operations/system-tables/parts/ title=系统。零件 class="nav-link text-light text-wrap d-inline-block w-100 px-0">系统。零件</a> </nav> </div> <a href=../../operations/performance-test/ title=测试硬件 class="nav-link text-light text-wrap d-inline-block w-100 px-0">测试硬件</a> <a href=../../operations/tips/ title=使用建议 class="nav-link text-light text-wrap d-inline-block w-100 px-0">使用建议</a> <a href=../../operations/configuration-files/ title=配置文件 class="nav-link text-light text-wrap d-inline-block w-100 px-0">配置文件</a> <a href=../../operations/quotas/ title=配额 class="nav-link text-light text-wrap d-inline-block w-100 px-0">配额</a> <a href=#sidebar-sidebar-6-14 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-14 title=实用工具 class="nav-link text-light dropdown-toggle px-0">实用工具</a> <div id=sidebar-sidebar-6-14 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../operations/utilities/clickhouse-local/ title=clickhouse-local class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-local</a> <a href=../../operations/utilities/clickhouse-benchmark/ title=性能测试 class="nav-link text-light text-wrap d-inline-block w-100 px-0">性能测试</a> <a href=../../operations/utilities/clickhouse-copier/ title=clickhouse-copier class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-copier</a> <a href=../../operations/utilities/ title=实用工具 class="nav-link text-light text-wrap d-inline-block w-100 px-0">实用工具</a> </nav> </div> <a href=#sidebar-sidebar-6-15 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-15 title=服务器配置参数 class="nav-link text-light dropdown-toggle px-0">服务器配置参数</a> <div id=sidebar-sidebar-6-15 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../operations/server-configuration-parameters/settings/ title=服务器设置 class="nav-link text-light text-wrap d-inline-block w-100 px-0">服务器设置</a> <a href=../../operations/server-configuration-parameters/ title=服务器配置参数 class="nav-link text-light text-wrap d-inline-block w-100 px-0">服务器配置参数</a> </nav> </div> <a href=#sidebar-sidebar-6-16 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6-16 title=设置 class="nav-link text-light dropdown-toggle px-0">设置</a> <div id=sidebar-sidebar-6-16 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../operations/settings/permissions-for-queries/ title=查询权限 class="nav-link text-light text-wrap d-inline-block w-100 px-0">查询权限</a> <a href=../../operations/settings/settings-profiles/ title=设置配置文件 class="nav-link text-light text-wrap d-inline-block w-100 px-0">设置配置文件</a> <a href=../../operations/settings/constraints-on-settings/ title=对设置的限制 class="nav-link text-light text-wrap d-inline-block w-100 px-0">对设置的限制</a> <a href=../../operations/settings/settings-users/ title=用户设置 class="nav-link text-light text-wrap d-inline-block w-100 px-0">用户设置</a> <a href=../../operations/settings/query-complexity/ title=查询复杂性的限制 class="nav-link text-light text-wrap d-inline-block w-100 px-0">查询复杂性的限制</a> <a href=../../operations/settings/settings/ title=设置 class="nav-link text-light text-wrap d-inline-block w-100 px-0">设置</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-7 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7 title=商业支持 class="nav-link text-light dropdown-toggle px-0">商业支持</a> <div id=sidebar-sidebar-7 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../commercial/cloud/ title=云 class="nav-link text-light text-wrap d-inline-block w-100 px-0">云</a> <a href=../../commercial/support/ title=支持 class="nav-link text-light text-wrap d-inline-block w-100 px-0">支持</a> <a href=../../commercial/ title=简介 class="nav-link text-light text-wrap d-inline-block w-100 px-0">简介</a> </nav> </div> <a href=#sidebar-sidebar-8 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8 title=F.A.Q. class="nav-link text-light dropdown-toggle px-0">F.A.Q.</a> <div id=sidebar-sidebar-8 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../faq/general/ title=常见问题 class="nav-link text-light text-wrap d-inline-block w-100 px-0">常见问题</a> </nav> </div> <a href=#sidebar-sidebar-9 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-9 title=ClickHouse事迹 class="nav-link text-light dropdown-toggle px-0">ClickHouse事迹</a> <div id=sidebar-sidebar-9 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=#sidebar-sidebar-9-1 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-9-1 title=Changelog class="nav-link text-light dropdown-toggle px-0">Changelog</a> <div id=sidebar-sidebar-9-1 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../whats-new/changelog/ title=2021 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2021</a> <a href=../../whats-new/changelog/2019/ title=2019 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2019</a> <a href=../../whats-new/changelog/2018/ title=2018 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2018</a> <a href=../../whats-new/changelog/2017/ title=2017 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2017</a> </nav> </div> <a href=../../whats-new/roadmap/ title=Roadmap class="nav-link text-light text-wrap d-inline-block w-100 px-0">Roadmap</a> <a href=../../whats-new/security-changelog/ title=安全更新日志 class="nav-link text-light text-wrap d-inline-block w-100 px-0">安全更新日志</a> <a href=../../whats-new/ title=ClickHouse变更及改动? class="nav-link text-light text-wrap d-inline-block w-100 px-0">ClickHouse变更及改动?</a> </nav> </div> <a href=#sidebar-sidebar-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-10 title="ClickHouse 开发" class="nav-link text-light dropdown-toggle px-0">ClickHouse 开发</a> <div id=sidebar-sidebar-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../development/browse-code/ title=浏览源代码 class="nav-link text-light text-wrap d-inline-block w-100 px-0">浏览源代码</a> <a href=../../development/build-cross-arm/ title="如何在Linux上构建ClickHouse for AARCH64（ARM64)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">如何在Linux上构建ClickHouse for AARCH64（ARM64)</a> <a href=../../development/ title="ClickHouse 开发" class="nav-link text-light text-wrap d-inline-block w-100 px-0">ClickHouse 开发</a> <a href=../../development/architecture/ title="ClickHouse 架构概述" class="nav-link text-white active text-wrap d-inline-block w-100 px-0">ClickHouse 架构概述</a> <a href=../../development/developer-instruction/ title=Windows使用指引 class="nav-link text-light text-wrap d-inline-block w-100 px-0">Windows使用指引</a> <a href=../../development/contrib/ title=使用的三方库 class="nav-link text-light text-wrap d-inline-block w-100 px-0">使用的三方库</a> <a href=../../development/build-osx/ title="在 Mac OS X 中编译 ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">在 Mac OS X 中编译 ClickHouse</a> <a href=../../development/build-cross-osx/ title="如何在Linux中编译Mac OS X ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">如何在Linux中编译Mac OS X ClickHouse</a> <a href=../../development/build/ title="如何构建 ClickHouse 发布包" class="nav-link text-light text-wrap d-inline-block w-100 px-0">如何构建 ClickHouse 发布包</a> <a href=../../development/style/ title="如何编写 C++ 代码" class="nav-link text-light text-wrap d-inline-block w-100 px-0">如何编写 C++ 代码</a> </nav> </div> <a href=#sidebar-sidebar-11 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-11 title=变更日志 class="nav-link text-light dropdown-toggle px-0">变更日志</a> <div id=sidebar-sidebar-11 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../changelog/ title=变更日志 class="nav-link text-light text-wrap d-inline-block w-100 px-0">变更日志</a> </nav> </div> <a href=../../single/clickhouse_zh.pdf class="nav-link border-top border-secondary mt-3 px-0 pt-3 text-light"> <img src=/images/mkdocs/pdf.svg alt="PDF version" title="PDF version" height=24 class="d-block mr-1 float-left"><div>PDF version</div> </a> </nav> </div> </div> <div id=content-wrapper class="col-md-8 p-2 p-md-4"> <div id=content class=mt-md-n3> <nav class=text-muted aria-label=breadcrumb> <ol class="breadcrumb bg-transparent p-0"> <li class=breadcrumb-item><a href=../ class=text-reset>ClickHouse 开发</a> </li> </ol> </nav> <h1 id=clickhouse-jia-gou-gai-shu>ClickHouse 架构概述<a class=headerlink href=#clickhouse-jia-gou-gai-shu title="Permanent link"> </a></h1> <p>ClickHouse 是一个真正的列式数据库管理系统（DBMS)。在 ClickHouse 中，数据始终是按列存储的，包括矢量（向量或列块）执行的过程。只要有可能，操作都是基于矢量进行分派的，而不是单个的值，这被称为«矢量化查询执行»，它有利于降低实际的数据处理开销。</p> <blockquote> <p>这个想法并不新鲜，其可以追溯到 <code class=syntax>APL</code> 编程语言及其后代：<code class=syntax>A +</code>、<code class=syntax>J</code>、<code class=syntax>K</code> 和 <code class=syntax>Q</code>。矢量编程被大量用于科学数据处理中。即使在关系型数据库中，这个想法也不是什么新的东西：比如，矢量编程也被大量用于 <code class=syntax>Vectorwise</code> 系统中。</p> </blockquote> <p>通常有两种不同的加速查询处理的方法：矢量化查询执行和运行时代码生成。在后者中，动态地为每一类查询生成代码，消除了间接分派和动态分派。这两种方法中，并没有哪一种严格地比另一种好。运行时代码生成可以更好地将多个操作融合在一起，从而充分利用 CPU 执行单元和流水线。矢量化查询执行不是特别实用，因为它涉及必须写到缓存并读回的临时向量。如果 L2 缓存容纳不下临时数据，那么这将成为一个问题。但矢量化查询执行更容易利用 CPU 的 SIMD 功能。朋友写的一篇<a href=http://15721.courses.cs.cmu.edu/spring2016/papers/p5-sompolski.pdf rel="external nofollow noreferrer" target=_blank>研究论文</a>表明，将两种方法结合起来是更好的选择。ClickHouse 使用了矢量化查询执行，同时初步提供了有限的运行时动态代码生成。</p> <h2 id=lie-columns>列（Columns）<a class=headerlink href=#lie-columns title="Permanent link"> </a></h2> <p>要表示内存中的列（实际上是列块），需使用 <code class=syntax>IColumn</code> 接口。该接口提供了用于实现各种关系操作符的辅助方法。几乎所有的操作都是不可变的：这些操作不会更改原始列，但是会创建一个新的修改后的列。比如，<code class=syntax>IColumn::filter</code> 方法接受过滤字节掩码，用于 <code class=syntax>WHERE</code> 和 <code class=syntax>HAVING</code> 关系操作符中。另外的例子：<code class=syntax>IColumn::permute</code> 方法支持 <code class=syntax>ORDER BY</code> 实现，<code class=syntax>IColumn::cut</code> 方法支持 <code class=syntax>LIMIT</code> 实现等等。</p> <p>不同的 <code class=syntax>IColumn</code> 实现（<code class=syntax>ColumnUInt8</code>、<code class=syntax>ColumnString</code> 等）负责不同的列内存布局。内存布局通常是一个连续的数组。对于数据类型为整型的列，只是一个连续的数组，比如 <code class=syntax>std::vector</code>。对于 <code class=syntax>String</code> 列和 <code class=syntax>Array</code> 列，则由两个向量组成：其中一个向量连续存储所有的 <code class=syntax>String</code> 或数组元素，另一个存储每一个 <code class=syntax>String</code> 或 <code class=syntax>Array</code> 的起始元素在第一个向量中的偏移。而 <code class=syntax>ColumnConst</code> 则仅在内存中存储一个值，但是看起来像一个列。</p> <h2 id=field>字段<a class=headerlink href=#field title="Permanent link"> </a></h2> <p>尽管如此，有时候也可能需要处理单个值。表示单个值，可以使用 <code class=syntax>Field</code>。<code class=syntax>Field</code> 是 <code class=syntax>UInt64</code>、<code class=syntax>Int64</code>、<code class=syntax>Float64</code>、<code class=syntax>String</code> 和 <code class=syntax>Array</code> 组成的联合。<code class=syntax>IColumn</code> 拥有 <code class=syntax>operator[]</code> 方法来获取第 <code class=syntax>n</code> 个值成为一个 <code class=syntax>Field</code>，同时也拥有 <code class=syntax>insert</code> 方法将一个 <code class=syntax>Field</code> 追加到一个列的末尾。这些方法并不高效，因为它们需要处理表示单一值的临时 <code class=syntax>Field</code> 对象，但是有更高效的方法比如 <code class=syntax>insertFrom</code> 和 <code class=syntax>insertRangeFrom</code> 等。</p> <p><code class=syntax>Field</code> 中并没有足够的关于一个表（table）的特定数据类型的信息。比如，<code class=syntax>UInt8</code>、<code class=syntax>UInt16</code>、<code class=syntax>UInt32</code> 和 <code class=syntax>UInt64</code> 在 <code class=syntax>Field</code> 中均表示为 <code class=syntax>UInt64</code>。</p> <h2 id=chou-xiang-lou-dong>抽象漏洞<a class=headerlink href=#chou-xiang-lou-dong title="Permanent link"> </a></h2> <p><code class=syntax>IColumn</code> 具有用于数据的常见关系转换的方法，但这些方法并不能够满足所有需求。比如，<code class=syntax>ColumnUInt64</code> 没有用于计算两列和的方法，<code class=syntax>ColumnString</code> 没有用于进行子串搜索的方法。这些无法计算的例程在 <code class=syntax>Icolumn</code> 之外实现。</p> <p>列（Columns)上的各种函数可以通过使用 <code class=syntax>Icolumn</code> 的方法来提取 <code class=syntax>Field</code> 值，或根据特定的 <code class=syntax>Icolumn</code> 实现的数据内存布局的知识，以一种通用但不高效的方式实现。为此，函数将会转换为特定的 <code class=syntax>IColumn</code> 类型并直接处理内部表示。比如，<code class=syntax>ColumnUInt64</code> 具有 <code class=syntax>getData</code> 方法，该方法返回一个指向列的内部数组的引用，然后一个单独的例程可以直接读写或填充该数组。实际上，«抽象漏洞（leaky abstractions）»允许我们以更高效的方式来实现各种特定的例程。</p> <h2 id=shu-ju-lei-xing>数据类型<a class=headerlink href=#shu-ju-lei-xing title="Permanent link"> </a></h2> <p><code class=syntax>IDataType</code> 负责序列化和反序列化：读写二进制或文本形式的列或单个值构成的块。<code class=syntax>IDataType</code> 直接与表的数据类型相对应。比如，有 <code class=syntax>DataTypeUInt32</code>、<code class=syntax>DataTypeDateTime</code>、<code class=syntax>DataTypeString</code> 等数据类型。</p> <p><code class=syntax>IDataType</code> 与 <code class=syntax>IColumn</code> 之间的关联并不大。不同的数据类型在内存中能够用相同的 <code class=syntax>IColumn</code> 实现来表示。比如，<code class=syntax>DataTypeUInt32</code> 和 <code class=syntax>DataTypeDateTime</code> 都是用 <code class=syntax>ColumnUInt32</code> 或 <code class=syntax>ColumnConstUInt32</code> 来表示的。另外，相同的数据类型也可以用不同的 <code class=syntax>IColumn</code> 实现来表示。比如，<code class=syntax>DataTypeUInt8</code> 既可以使用 <code class=syntax>ColumnUInt8</code> 来表示，也可以使用过 <code class=syntax>ColumnConstUInt8</code> 来表示。</p> <p><code class=syntax>IDataType</code> 仅存储元数据。比如，<code class=syntax>DataTypeUInt8</code> 不存储任何东西（除了 vptr）；<code class=syntax>DataTypeFixedString</code> 仅存储 <code class=syntax>N</code>（固定长度字符串的串长度）。</p> <p><code class=syntax>IDataType</code> 具有针对各种数据格式的辅助函数。比如如下一些辅助函数：序列化一个值并加上可能的引号；序列化一个值用于 JSON 格式；序列化一个值作为 XML 格式的一部分。辅助函数与数据格式并没有直接的对应。比如，两种不同的数据格式 <code class=syntax>Pretty</code> 和 <code class=syntax>TabSeparated</code> 均可以使用 <code class=syntax>IDataType</code> 接口提供的 <code class=syntax>serializeTextEscaped</code> 这一辅助函数。</p> <h2 id=kuai-block>块（Block）<a class=headerlink href=#kuai-block title="Permanent link"> </a></h2> <p><code class=syntax>Block</code> 是表示内存中表的子集（chunk）的容器，是由三元组：<code class=syntax>(IColumn, IDataType, 列名)</code> 构成的集合。在查询执行期间，数据是按 <code class=syntax>Block</code> 进行处理的。如果我们有一个 <code class=syntax>Block</code>，那么就有了数据（在 <code class=syntax>IColumn</code> 对象中），有了数据的类型信息告诉我们如何处理该列，同时也有了列名（来自表的原始列名，或人为指定的用于临时计算结果的名字）。</p> <p>当我们遍历一个块中的列进行某些函数计算时，会把结果列加入到块中，但不会更改函数参数中的列，因为操作是不可变的。之后，不需要的列可以从块中删除，但不是修改。这对于消除公共子表达式非常方便。</p> <p><code class=syntax>Block</code> 用于处理数据块。注意，对于相同类型的计算，列名和类型对不同的块保持相同，仅列数据不同。最好把块数据（block data）和块头（block header）分离开来，因为小块大小会因复制共享指针和列名而带来很高的临时字符串开销。</p> <h2 id=kuai-liu-block-streams>块流（Block Streams）<a class=headerlink href=#kuai-liu-block-streams title="Permanent link"> </a></h2> <p>块流用于处理数据。我们可以使用块流从某个地方读取数据，执行数据转换，或将数据写到某个地方。<code class=syntax>IBlockInputStream</code> 具有 <code class=syntax>read</code> 方法，其能够在数据可用时获取下一个块。<code class=syntax>IBlockOutputStream</code> 具有 <code class=syntax>write</code> 方法，其能够将块写到某处。</p> <p>块流负责：</p> <ol> <li>读或写一个表。表仅返回一个流用于读写块。</li> <li>完成数据格式化。比如，如果你打算将数据以 <code class=syntax>Pretty</code> 格式输出到终端，你可以创建一个块输出流，将块写入该流中，然后进行格式化。</li> <li>执行数据转换。假设你现在有 <code class=syntax>IBlockInputStream</code> 并且打算创建一个过滤流，那么你可以创建一个 <code class=syntax>FilterBlockInputStream</code> 并用 <code class=syntax>IBlockInputStream</code> 进行初始化。之后，当你从 <code class=syntax>FilterBlockInputStream</code> 中拉取块时，会从你的流中提取一个块，对其进行过滤，然后将过滤后的块返回给你。查询执行流水线就是以这种方式表示的。</li> </ol> <p>还有一些更复杂的转换。比如，当你从 <code class=syntax>AggregatingBlockInputStream</code> 拉取数据时，会从数据源读取全部数据进行聚集，然后将聚集后的数据流返回给你。另一个例子：<code class=syntax>UnionBlockInputStream</code> 的构造函数接受多个输入源和多个线程，其能够启动多线程从多个输入源并行读取数据。</p> <blockquote> <p>块流使用«pull»方法来控制流：当你从第一个流中拉取块时，它会接着从嵌套的流中拉取所需的块，然后整个执行流水线开始工作。»pull«和«push»都不是最好的方案，因为控制流不是明确的，这限制了各种功能的实现，比如多个查询同步执行（多个流水线合并到一起）。这个限制可以通过协程或直接运行互相等待的线程来解决。如果控制流明确，那么我们会有更多的可能性：如果我们定位了数据从一个计算单元传递到那些外部的计算单元中其中一个计算单元的逻辑。阅读这篇<a href=http://journal.stuffwithstuff.com/2013/01/13/iteration-inside-and-out/ rel="external nofollow noreferrer" target=_blank>文章</a>来获取更多的想法。</p> </blockquote> <p>我们需要注意，查询执行流水线在每一步都会创建临时数据。我们要尽量使块的大小足够小，从而 CPU 缓存能够容纳下临时数据。在这个假设下，与其他计算相比，读写临时数据几乎是没有任何开销的。我们也可以考虑一种替代方案：将流水线中的多个操作融合在一起，使流水线尽可能短，并删除大量临时数据。这可能是一个优点，但同时也有缺点。比如，拆分流水线使得中间数据缓存、获取同时运行的类似查询的中间数据以及相似查询的流水线合并等功能很容易实现。</p> <h2 id=ge-shi-formats>格式（Formats）<a class=headerlink href=#ge-shi-formats title="Permanent link"> </a></h2> <p>数据格式同块流一起实现。既有仅用于向客户端输出数据的»展示«格式，如 <code class=syntax>IBlockOutputStream</code> 提供的 <code class=syntax>Pretty</code> 格式，也有其它输入输出格式，比如 <code class=syntax>TabSeparated</code> 或 <code class=syntax>JSONEachRow</code>。</p> <p>此外还有行流：<code class=syntax>IRowInputStream</code> 和 <code class=syntax>IRowOutputStream</code>。它们允许你按行 pull/push 数据，而不是按块。行流只需要简单地面向行格式实现。包装器 <code class=syntax>BlockInputStreamFromRowInputStream</code> 和 <code class=syntax>BlockOutputStreamFromRowOutputStream</code> 允许你将面向行的流转换为正常的面向块的流。</p> <h2 id=io>I/O<a class=headerlink href=#io title="Permanent link"> </a></h2> <p>对于面向字节的输入输出，有 <code class=syntax>ReadBuffer</code> 和 <code class=syntax>WriteBuffer</code> 这两个抽象类。它们用来替代 C++ 的 <code class=syntax>iostream</code>。不用担心：每个成熟的 C++ 项目都会有充分的理由使用某些东西来代替 <code class=syntax>iostream</code>。</p> <p><code class=syntax>ReadBuffer</code> 和 <code class=syntax>WriteBuffer</code> 由一个连续的缓冲区和指向缓冲区中某个位置的一个指针组成。实现中，缓冲区可能拥有内存，也可能不拥有内存。有一个虚方法会使用随后的数据来填充缓冲区（针对 <code class=syntax>ReadBuffer</code>）或刷新缓冲区（针对 <code class=syntax>WriteBuffer</code>），该虚方法很少被调用。</p> <p><code class=syntax>ReadBuffer</code> 和 <code class=syntax>WriteBuffer</code> 的实现用于处理文件、文件描述符和网络套接字（socket），也用于实现压缩（<code class=syntax>CompressedWriteBuffer</code> 在写入数据前需要先用一个 <code class=syntax>WriteBuffer</code> 进行初始化并进行压缩）和其它用途。<code class=syntax>ConcatReadBuffer</code>、<code class=syntax>LimitReadBuffer</code> 和 <code class=syntax>HashingWriteBuffer</code> 的用途正如其名字所描述的一样。</p> <p><code class=syntax>ReadBuffer</code> 和 <code class=syntax>WriteBuffer</code> 仅处理字节。为了实现格式化输入和输出（比如以十进制格式写一个数字），<code class=syntax>ReadHelpers</code> 和 <code class=syntax>WriteHelpers</code> 头文件中有一些辅助函数可用。</p> <p>让我们来看一下，当你把一个结果集以 <code class=syntax>JSON</code> 格式写到标准输出（stdout）时会发生什么。你已经准备好从 <code class=syntax>IBlockInputStream</code> 获取结果集，然后创建 <code class=syntax>WriteBufferFromFileDescriptor(STDOUT_FILENO)</code> 用于写字节到标准输出，创建 <code class=syntax>JSONRowOutputStream</code> 并用 <code class=syntax>WriteBuffer</code> 初始化，用于将行以 <code class=syntax>JSON</code> 格式写到标准输出，你还可以在其上创建 <code class=syntax>BlockOutputStreamFromRowOutputStream</code>，将其表示为 <code class=syntax>IBlockOutputStream</code>。然后调用 <code class=syntax>copyData</code> 将数据从 <code class=syntax>IBlockInputStream</code> 传输到 <code class=syntax>IBlockOutputStream</code>，一切工作正常。在内部，<code class=syntax>JSONRowOutputStream</code> 会写入 JSON 分隔符，并以指向 <code class=syntax>IColumn</code> 的引用和行数作为参数调用 <code class=syntax>IDataType::serializeTextJSON</code> 函数。随后，<code class=syntax>IDataType::serializeTextJSON</code> 将会调用 <code class=syntax>WriteHelpers.h</code> 中的一个方法：比如，<code class=syntax>writeText</code> 用于数值类型，<code class=syntax>writeJSONString</code> 用于 <code class=syntax>DataTypeString</code> 。</p> <h2 id=biao-tables>表（Tables）<a class=headerlink href=#biao-tables title="Permanent link"> </a></h2> <p>表由 <code class=syntax>IStorage</code> 接口表示。该接口的不同实现对应不同的表引擎。比如 <code class=syntax>StorageMergeTree</code>、<code class=syntax>StorageMemory</code> 等。这些类的实例就是表。</p> <p><code class=syntax>IStorage</code> 中最重要的方法是 <code class=syntax>read</code> 和 <code class=syntax>write</code>，除此之外还有 <code class=syntax>alter</code>、<code class=syntax>rename</code> 和 <code class=syntax>drop</code> 等方法。<code class=syntax>read</code> 方法接受如下参数：需要从表中读取的列集，需要执行的 <code class=syntax>AST</code> 查询，以及所需返回的流的数量。<code class=syntax>read</code> 方法的返回值是一个或多个 <code class=syntax>IBlockInputStream</code> 对象，以及在查询执行期间在一个表引擎内完成的关于数据处理阶段的信息。</p> <p>在大多数情况下，<code class=syntax>read</code> 方法仅负责从表中读取指定的列，而不会进行进一步的数据处理。进一步的数据处理均由查询解释器完成，不由 <code class=syntax>IStorage</code> 负责。</p> <p>但是也有值得注意的例外：</p> <ul> <li>AST 查询被传递给 <code class=syntax>read</code> 方法，表引擎可以使用它来判断是否能够使用索引，从而从表中读取更少的数据。</li> <li>有时候，表引擎能够将数据处理到一个特定阶段。比如，<code class=syntax>StorageDistributed</code> 可以向远程服务器发送查询，要求它们将来自不同的远程服务器能够合并的数据处理到某个阶段，并返回预处理后的数据，然后查询解释器完成后续的数据处理。</li> </ul> <p>表的 <code class=syntax>read</code> 方法能够返回多个 <code class=syntax>IBlockInputStream</code> 对象以允许并行处理数据。多个块输入流能够从一个表中并行读取。然后你可以通过不同的转换对这些流进行装饰（比如表达式求值或过滤），转换过程能够独立计算，并在其上创建一个 <code class=syntax>UnionBlockInputStream</code>，以并行读取多个流。</p> <p>另外也有 <code class=syntax>TableFunction</code>。<code class=syntax>TableFunction</code> 能够在查询的 <code class=syntax>FROM</code> 字句中返回一个临时的 <code class=syntax>IStorage</code> 以供使用。</p> <p>要快速了解如何实现自己的表引擎，可以查看一些简单的表引擎，比如 <code class=syntax>StorageMemory</code> 或 <code class=syntax>StorageTinyLog</code>。</p> <blockquote> <p>作为 <code class=syntax>read</code> 方法的结果，<code class=syntax>IStorage</code> 返回 <code class=syntax>QueryProcessingStage</code> - 关于 storage 里哪部分查询已经被计算的信息。当前我们仅有非常粗粒度的信息。Storage 无法告诉我们«对于这个范围的数据，我已经处理完了 WHERE 字句里的这部分表达式»。我们需要在这个地方继续努力。</p> </blockquote> <h2 id=jie-xi-qi-parsers>解析器（Parsers）<a class=headerlink href=#jie-xi-qi-parsers title="Permanent link"> </a></h2> <p>查询由一个手写递归下降解析器解析。比如， <code class=syntax>ParserSelectQuery</code> 只是针对查询的不同部分递归地调用下层解析器。解析器创建 <code class=syntax>AST</code>。<code class=syntax>AST</code> 由节点表示，节点是 <code class=syntax>IAST</code> 的实例。</p> <blockquote> <p>由于历史原因，未使用解析器生成器。</p> </blockquote> <h2 id=jie-shi-qi-interpreters>解释器（Interpreters）<a class=headerlink href=#jie-shi-qi-interpreters title="Permanent link"> </a></h2> <p>解释器负责从 <code class=syntax>AST</code> 创建查询执行流水线。既有一些简单的解释器，如 <code class=syntax>InterpreterExistsQuery</code> 和 <code class=syntax>InterpreterDropQuery</code>，也有更复杂的解释器，如 <code class=syntax>InterpreterSelectQuery</code>。查询执行流水线由块输入或输出流组成。比如，<code class=syntax>SELECT</code> 查询的解释结果是从 <code class=syntax>FROM</code> 字句的结果集中读取数据的 <code class=syntax>IBlockInputStream</code>；<code class=syntax>INSERT</code> 查询的结果是写入需要插入的数据的 <code class=syntax>IBlockOutputStream</code>；<code class=syntax>SELECT INSERT</code> 查询的解释结果是 <code class=syntax>IBlockInputStream</code>，它在第一次读取时返回一个空结果集，同时将数据从 <code class=syntax>SELECT</code> 复制到 <code class=syntax>INSERT</code>。</p> <p><code class=syntax>InterpreterSelectQuery</code> 使用 <code class=syntax>ExpressionAnalyzer</code> 和 <code class=syntax>ExpressionActions</code> 机制来进行查询分析和转换。这是大多数基于规则的查询优化完成的地方。<code class=syntax>ExpressionAnalyzer</code> 非常混乱，应该进行重写：不同的查询转换和优化应该被提取出来并划分成不同的类，从而允许模块化转换或查询。</p> <h2 id=han-shu-functions>函数（Functions）<a class=headerlink href=#han-shu-functions title="Permanent link"> </a></h2> <p>函数既有普通函数，也有聚合函数。对于聚合函数，请看下一节。</p> <p>普通函数不会改变行数 - 它们的执行看起来就像是独立地处理每一行数据。实际上，函数不会作用于一个单独的行上，而是作用在以 <code class=syntax>Block</code> 为单位的数据上，以实现向量查询执行。</p> <p>还有一些杂项函数，比如 <a href=../../sql-reference/functions/other-functions/#function-blocksize>块大小</a>、<a href=../../sql-reference/functions/other-functions/#function-rownumberinblock>rowNumberInBlock</a>，以及 <a href=../../sql-reference/functions/other-functions/#function-runningaccumulate>跑累积</a>，它们对块进行处理，并且不遵从行的独立性。</p> <p>ClickHouse 具有强类型，因此隐式类型转换不会发生。如果函数不支持某个特定的类型组合，则会抛出异常。但函数可以通过重载以支持许多不同的类型组合。比如，<code class=syntax>plus</code> 函数（用于实现 <code class=syntax>+</code> 运算符）支持任意数字类型的组合：<code class=syntax>UInt8</code> + <code class=syntax>Float32</code>，<code class=syntax>UInt16</code> + <code class=syntax>Int8</code> 等。同时，一些可变参数的函数能够级接收任意数目的参数，比如 <code class=syntax>concat</code> 函数。</p> <p>实现函数可能有些不方便，因为函数的实现需要包含所有支持该操作的数据类型和 <code class=syntax>IColumn</code> 类型。比如，<code class=syntax>plus</code> 函数能够利用 C++ 模板针对不同的数字类型组合、常量以及非常量的左值和右值进行代码生成。</p> <blockquote> <p>这是一个实现动态代码生成的好地方，从而能够避免模板代码膨胀。同样，运行时代码生成也使得实现融合函数成为可能，比如融合«乘-加»，或者在单层循环迭代中进行多重比较。</p> </blockquote> <p>由于向量查询执行，函数不会«短路»。比如，如果你写 <code class=syntax>WHERE f(x) AND g(y)</code>，两边都会进行计算，即使是对于 <code class=syntax>f(x)</code> 为 0 的行（除非 <code class=syntax>f(x)</code> 是零常量表达式）。但是如果 <code class=syntax>f(x)</code> 的选择条件很高，并且计算 <code class=syntax>f(x)</code> 比计算 <code class=syntax>g(y)</code> 要划算得多，那么最好进行多遍计算：首先计算 <code class=syntax>f(x)</code>，根据计算结果对列数据进行过滤，然后计算 <code class=syntax>g(y)</code>，之后只需对较小数量的数据进行过滤。</p> <h2 id=ju-he-han-shu>聚合函数<a class=headerlink href=#ju-he-han-shu title="Permanent link"> </a></h2> <p>聚合函数是状态函数。它们将传入的值激活到某个状态，并允许你从该状态获取结果。聚合函数使用 <code class=syntax>IAggregateFunction</code> 接口进行管理。状态可以非常简单（<code class=syntax>AggregateFunctionCount</code> 的状态只是一个单一的<code class=syntax>UInt64</code> 值），也可以非常复杂（<code class=syntax>AggregateFunctionUniqCombined</code> 的状态是由一个线性数组、一个散列表和一个 <code class=syntax>HyperLogLog</code> 概率数据结构组合而成的）。</p> <p>为了能够在执行一个基数很大的 <code class=syntax>GROUP BY</code> 查询时处理多个聚合状态，需要在 <code class=syntax>Arena</code>（一个内存池）或任何合适的内存块中分配状态。状态可以有一个非平凡的构造器和析构器：比如，复杂的聚合状态能够自己分配额外的内存。这需要注意状态的创建和销毁并恰当地传递状态的所有权，以跟踪谁将何时销毁状态。</p> <p>聚合状态可以被序列化和反序列化，以在分布式查询执行期间通过网络传递或者在内存不够的时候将其写到硬盘。聚合状态甚至可以通过 <code class=syntax>DataTypeAggregateFunction</code> 存储到一个表中，以允许数据的增量聚合。</p> <blockquote> <p>聚合函数状态的序列化数据格式目前尚未版本化。如果只是临时存储聚合状态，这样是可以的。但是我们有 <code class=syntax>AggregatingMergeTree</code> 表引擎用于增量聚合，并且人们已经在生产中使用它。这就是为什么在未来当我们更改任何聚合函数的序列化格式时需要增加向后兼容的支持。</p> </blockquote> <h2 id=fu-wu-qi-server>服务器（Server）<a class=headerlink href=#fu-wu-qi-server title="Permanent link"> </a></h2> <p>服务器实现了多个不同的接口：</p> <ul> <li>一个用于任何外部客户端的 HTTP 接口。</li> <li>一个用于本机 ClickHouse 客户端以及在分布式查询执行中跨服务器通信的 TCP 接口。</li> <li>一个用于传输数据以进行拷贝的接口。</li> </ul> <p>在内部，它只是一个没有协程、纤程等的基础多线程服务器。服务器不是为处理高速率的简单查询设计的，而是为处理相对低速率的复杂查询设计的，每一个复杂查询能够对大量的数据进行处理分析。</p> <p>服务器使用必要的查询执行需要的环境初始化 <code class=syntax>Context</code> 类：可用数据库列表、用户和访问权限、设置、集群、进程列表和查询日志等。这些环境被解释器使用。</p> <p>我们维护了服务器 TCP 协议的完全向后向前兼容性：旧客户端可以和新服务器通信，新客户端也可以和旧服务器通信。但是我们并不想永久维护它，我们将在大约一年后删除对旧版本的支持。</p> <blockquote> <p>对于所有的外部应用，我们推荐使用 HTTP 接口，因为该接口很简单，容易使用。TCP 接口与内部数据结构的联系更加紧密：它使用内部格式传递数据块，并使用自定义帧来压缩数据。我们没有发布该协议的 C 库，因为它需要链接大部分的 ClickHouse 代码库，这是不切实际的。</p> </blockquote> <h2 id=fen-bu-shi-cha-xun-zhi-xing>分布式查询执行<a class=headerlink href=#fen-bu-shi-cha-xun-zhi-xing title="Permanent link"> </a></h2> <p>集群设置中的服务器大多是独立的。你可以在一个集群中的一个或多个服务器上创建一个 <code class=syntax>Distributed</code> 表。<code class=syntax>Distributed</code> 表本身并不存储数据，它只为集群的多个节点上的所有本地表提供一个«视图（view）»。当从 <code class=syntax>Distributed</code> 表中进行 SELECT 时，它会重写该查询，根据负载平衡设置来选择远程节点，并将查询发送给节点。<code class=syntax>Distributed</code> 表请求远程服务器处理查询，直到可以合并来自不同服务器的中间结果的阶段。然后它接收中间结果并进行合并。分布式表会尝试将尽可能多的工作分配给远程服务器，并且不会通过网络发送太多的中间数据。</p> <blockquote> <p>当 <code class=syntax>IN</code> 或 <code class=syntax>JOIN</code> 子句中包含子查询并且每个子查询都使用分布式表时，事情会变得更加复杂。我们有不同的策略来执行这些查询。</p> </blockquote> <p>分布式查询执行没有全局查询计划。每个节点都有针对自己的工作部分的本地查询计划。我们仅有简单的一次性分布式查询执行：将查询发送给远程节点，然后合并结果。但是对于具有高基数的 <code class=syntax>GROUP BY</code> 或具有大量临时数据的 <code class=syntax>JOIN</code> 这样困难的查询的来说，这是不可行的：在这种情况下，我们需要在服务器之间«改组»数据，这需要额外的协调。ClickHouse 不支持这类查询执行，我们需要在这方面进行努力。</p> <h2 id=merge-tree>合并树<a class=headerlink href=#merge-tree title="Permanent link"> </a></h2> <p><code class=syntax>MergeTree</code> 是一系列支持按主键索引的存储引擎。主键可以是一个任意的列或表达式的元组。<code class=syntax>MergeTree</code> 表中的数据存储于«分块»中。每一个分块以主键序存储数据（数据按主键元组的字典序排序）。表的所有列都存储在这些«分块»中分离的 <code class=syntax>column.bin</code> 文件中。<code class=syntax>column.bin</code> 文件由压缩块组成，每一个块通常是 64 KB 到 1 MB 大小的未压缩数据，具体取决于平均值大小。这些块由一个接一个连续放置的列值组成。每一列的列值顺序相同（顺序由主键定义），因此当你按多列进行迭代时，你能够得到相应列的值。</p> <p>主键本身是«稀疏»的。它并不是索引单一的行，而是索引某个范围内的数据。一个单独的 <code class=syntax>primary.idx</code> 文件具有每个第 N 行的主键值，其中 N 称为 <code class=syntax>index_granularity</code>（通常，N = 8192）。同时，对于每一列，都有带有标记的 <code class=syntax>column.mrk</code> 文件，该文件记录的是每个第 N 行在数据文件中的偏移量。每个标记是一个 pair：文件中的偏移量到压缩块的起始，以及解压缩块中的偏移量到数据的起始。通常，压缩块根据标记对齐，并且解压缩块中的偏移量为 0。<code class=syntax>primary.idx</code> 的数据始终驻留在内存，同时 <code class=syntax>column.mrk</code> 的数据被缓存。</p> <p>当我们要从 <code class=syntax>MergeTree</code> 的一个分块中读取部分内容时，我们会查看 <code class=syntax>primary.idx</code> 数据并查找可能包含所请求数据的范围，然后查看 <code class=syntax>column.mrk</code> 并计算偏移量从而得知从哪里开始读取些范围的数据。由于稀疏性，可能会读取额外的数据。ClickHouse 不适用于高负载的简单点查询，因为对于每一个键，整个 <code class=syntax>index_granularity</code> 范围的行的数据都需要读取，并且对于每一列需要解压缩整个压缩块。我们使索引稀疏，是因为每一个单一的服务器需要在索引没有明显内存消耗的情况下，维护数万亿行的数据。另外，由于主键是稀疏的，导致其不是唯一的：无法在 INSERT 时检查一个键在表中是否存在。你可以在一个表中使用同一个键创建多个行。</p> <p>当你向 <code class=syntax>MergeTree</code> 中插入一堆数据时，数据按主键排序并形成一个新的分块。为了保证分块的数量相对较少，有后台线程定期选择一些分块并将它们合并成一个有序的分块，这就是 <code class=syntax>MergeTree</code> 的名称来源。当然，合并会导致«写入放大»。所有的分块都是不可变的：它们仅会被创建和删除，不会被修改。当运行 <code class=syntax>SELECT</code> 查询时，<code class=syntax>MergeTree</code> 会保存一个表的快照（分块集合）。合并之后，还会保留旧的分块一段时间，以便发生故障后更容易恢复，因此如果我们发现某些合并后的分块可能已损坏，我们可以将其替换为原分块。</p> <p><code class=syntax>MergeTree</code> 不是 LSM 树，因为它不包含»memtable«和»log«：插入的数据直接写入文件系统。这使得它仅适用于批量插入数据，而不适用于非常频繁地一行一行插入 - 大约每秒一次是没问题的，但是每秒一千次就会有问题。我们这样做是为了简单起见，因为我们已经在我们的应用中批量插入数据。</p> <blockquote> <p><code class=syntax>MergeTree</code> 表只能有一个（主）索引：没有任何辅助索引。在一个逻辑表下，允许有多个物理表示，比如，可以以多个物理顺序存储数据，或者同时表示预聚合数据和原始数据。</p> </blockquote> <p>有些 <code class=syntax>MergeTree</code> 引擎会在后台合并期间做一些额外工作，比如 <code class=syntax>CollapsingMergeTree</code> 和 <code class=syntax>AggregatingMergeTree</code>。这可以视为对更新的特殊支持。请记住这些不是真正的更新，因为用户通常无法控制后台合并将会执行的时间，并且 <code class=syntax>MergeTree</code> 中的数据几乎总是存储在多个分块中，而不是完全合并的形式。</p> <h2 id=fu-zhi-replication>复制（Replication）<a class=headerlink href=#fu-zhi-replication title="Permanent link"> </a></h2> <p>ClickHouse 中的复制是基于表实现的。你可以在同一个服务器上有一些可复制的表和不可复制的表。你也可以以不同的方式进行表的复制，比如一个表进行双因子复制，另一个进行三因子复制。</p> <p>复制是在 <code class=syntax>ReplicatedMergeTree</code> 存储引擎中实现的。<code class=syntax>ZooKeeper</code> 中的路径被指定为存储引擎的参数。<code class=syntax>ZooKeeper</code> 中所有具有相同路径的表互为副本：它们同步数据并保持一致性。只需创建或删除表，就可以实现动态添加或删除副本。</p> <p>复制使用异步多主机方案。你可以将数据插入到与 <code class=syntax>ZooKeeper</code> 进行会话的任意副本中，并将数据复制到所有其它副本中。由于 ClickHouse 不支持 UPDATEs，因此复制是无冲突的。由于没有对插入的仲裁确认，如果一个节点发生故障，刚刚插入的数据可能会丢失。</p> <p>用于复制的元数据存储在 ZooKeeper 中。其中一个复制日志列出了要执行的操作。操作包括：获取分块、合并分块和删除分区等。每一个副本将复制日志复制到其队列中，然后执行队列中的操作。比如，在插入时，在复制日志中创建«获取分块»这一操作，然后每一个副本都会去下载该分块。所有副本之间会协调进行合并以获得相同字节的结果。所有的分块在所有的副本上以相同的方式合并。为实现该目的，其中一个副本被选为领导者，该副本首先进行合并，并把«合并分块»操作写到日志中。</p> <p>复制是物理的：只有压缩的分块会在节点之间传输，查询则不会。为了降低网络成本（避免网络放大），大多数情况下，会在每一个副本上独立地处理合并。只有在存在显著的合并延迟的情况下，才会通过网络发送大块的合并分块。</p> <p>另外，每一个副本将其状态作为分块和校验和组成的集合存储在 ZooKeeper 中。当本地文件系统中的状态与 ZooKeeper 中引用的状态不同时，该副本会通过从其它副本下载缺失和损坏的分块来恢复其一致性。当本地文件系统中出现一些意外或损坏的数据时，ClickHouse 不会将其删除，而是将其移动到一个单独的目录下并忘记它。</p> <blockquote> <p>ClickHouse 集群由独立的分片组成，每一个分片由多个副本组成。集群不是弹性的，因此在添加新的分片后，数据不会自动在分片之间重新平衡。相反，集群负载将变得不均衡。该实现为你提供了更多控制，对于相对较小的集群，例如只有数十个节点的集群来说是很好的。但是对于我们在生产中使用的具有数百个节点的集群来说，这种方法成为一个重大缺陷。我们应该实现一个表引擎，使得该引擎能够跨集群扩展数据，同时具有动态复制的区域，这些区域能够在集群之间自动拆分和平衡。</p> </blockquote> <p><a href=https://clickhouse.tech/docs/en/development/architecture/ target=_blank>来源文章</a> <!--hide--></p> </div> <div class="alert alert-light my-3"> <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p> <span class="alert-heading display-6">Was this content helpful?</span> <div id=rating-stars class="display-6 mb-0" data-titles="['Unusable', 'Poor', 'OK', 'Good', 'Excellent']" data-documentation=documentation>RATING_STARS</div> </div> <div id=content-footer class="text-muted pt-3 mb-5"> <div class=float-md-right>©2016–2020 Yandex LLC</div> <div>Built from <a href=https://github.com/ClickHouse/ClickHouse/commit/b030bfedd7db4603034643fd183cf7784a820193 rel="external nofollow noreferrer" target=_blank class=text-reset>b030bfedd7</a> </div> </div> </div> <div id=toc class="col-xl-2 d-none d-xl-block d-print-none p-3 overflow-auto toc-right mb-5"> <nav class="nav flex-column text-wrap"> <label for=toc>Table of Contents</label> <a href=#lie-columns title=列（Columns） class="nav-link text-wrap d-inline-block w-100"> 列（Columns） </a> <a href=#field title=字段 class="nav-link text-wrap d-inline-block w-100"> 字段 </a> <a href=#chou-xiang-lou-dong title=抽象漏洞 class="nav-link text-wrap d-inline-block w-100"> 抽象漏洞 </a> <a href=#shu-ju-lei-xing title=数据类型 class="nav-link text-wrap d-inline-block w-100"> 数据类型 </a> <a href=#kuai-block title=块（Block） class="nav-link text-wrap d-inline-block w-100"> 块（Block） </a> <a href=#kuai-liu-block-streams title="块流（Block Streams）" class="nav-link text-wrap d-inline-block w-100"> 块流（Block Streams） </a> <a href=#ge-shi-formats title=格式（Formats） class="nav-link text-wrap d-inline-block w-100"> 格式（Formats） </a> <a href=#io title=I/O class="nav-link text-wrap d-inline-block w-100"> I/O </a> <a href=#biao-tables title=表（Tables） class="nav-link text-wrap d-inline-block w-100"> 表（Tables） </a> <a href=#jie-xi-qi-parsers title=解析器（Parsers） class="nav-link text-wrap d-inline-block w-100"> 解析器（Parsers） </a> <a href=#jie-shi-qi-interpreters title=解释器（Interpreters） class="nav-link text-wrap d-inline-block w-100"> 解释器（Interpreters） </a> <a href=#han-shu-functions title=函数（Functions） class="nav-link text-wrap d-inline-block w-100"> 函数（Functions） </a> <a href=#ju-he-han-shu title=聚合函数 class="nav-link text-wrap d-inline-block w-100"> 聚合函数 </a> <a href=#fu-wu-qi-server title=服务器（Server） class="nav-link text-wrap d-inline-block w-100"> 服务器（Server） </a> <a href=#fen-bu-shi-cha-xun-zhi-xing title=分布式查询执行 class="nav-link text-wrap d-inline-block w-100"> 分布式查询执行 </a> <a href=#merge-tree title=合并树 class="nav-link text-wrap d-inline-block w-100"> 合并树 </a> <a href=#fu-zhi-replication title=复制（Replication） class="nav-link text-wrap d-inline-block w-100"> 复制（Replication） </a> </nav> </div> </div> </div> <script async type=text/javascript src=/js/base.js?00223b07></script> <noscript> <div><img src=https://mc.yandex.ru/watch/18343495 alt=Yandex></div> </noscript> </body> </html>