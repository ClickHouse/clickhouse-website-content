<!doctype html><html ⚡ lang=ja> <head><meta charset=utf-8><script async src=https://cdn.ampproject.org/v0.js></script><title>参照 | ClickHouseドキュメント</title><link href=https://clickhouse.tech/docs/ja/sql-reference/aggregate-functions/reference/ rel=canonical><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><script type=application/ld+json>[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "参照 | ClickHouseドキュメント",
"mainEntityOfPage": "https://clickhouse.tech/docs/ja/sql-reference/aggregate-functions/reference/",




"image": "https://clickhouse.tech/images/logo-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "Yandex LLC",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.tech/images/yandex.png",
    "width": 163,
    "height": 60
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "参照 | ClickHouseドキュメント",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script><style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript><style amp-custom>:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--white:#fff;--gray:#6c757d;--gray-dark:#343a40;--primary:#007bff;--secondary:#6c757d;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f8f9fa;--dark:#343a40;--breakpoint-xs:0;--breakpoint-sm:576px;--breakpoint-md:768px;--breakpoint-lg:992px;--breakpoint-xl:1200px;--font-family-sans-serif:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,::after,::before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}article,footer,main,section{display:block}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem}p{margin-top:0;margin-bottom:1rem}ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}b,strong{font-weight:bolder}small{font-size:80%}a{color:#007bff;text-decoration:none;background-color:transparent}a:hover{color:#0056b3;text-decoration:underline}a:not([href]){color:inherit;text-decoration:none}a:not([href]):hover{color:inherit;text-decoration:none}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}img{vertical-align:middle;border-style:none}svg{overflow:hidden;vertical-align:middle}table{border-collapse:collapse}label{display:inline-block;margin-bottom:.5rem}select{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit]{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{padding:0;border-style:none}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:.5rem;font-weight:500;line-height:1.2}.h1,h1{font-size:2rem}.h2,h2{font-size:1.5rem}.h3,h3{font-size:1.25rem}.h4,h4{font-size:1rem}.h5,h5{font-size:1rem}.h6,h6{font-size:1rem}.lead{font-size:1.25rem;font-weight:300}.display-1{font-size:6rem;font-weight:300;line-height:1.2}.display-2{font-size:5.5rem;font-weight:300;line-height:1.2}.display-3{font-size:4.5rem;font-weight:300;line-height:1.2}.display-4{font-size:3.5rem;font-weight:300;line-height:1.2}.small,small{font-size:80%;font-weight:400}.img-fluid{max-width:100%;height:auto}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}pre{display:block;font-size:87.5%;color:#212529}pre code{font-size:inherit;color:inherit;word-break:normal}.container{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container{max-width:720px}}@media(min-width:992px){.container{max-width:960px}}@media(min-width:1200px){.container{max-width:1140px}}.container-fluid,.container-lg,.container-md{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container,.container-md{max-width:720px}}@media(min-width:992px){.container,.container-lg,.container-md{max-width:960px}}@media(min-width:1200px){.container,.container-lg,.container-md{max-width:1140px}}.row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-15px;margin-left:-15px}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9{position:relative;width:100%;padding-right:15px;padding-left:15px}.col{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-first{-ms-flex-order:-1;order:-1}.order-0{-ms-flex-order:0;order:0}.order-1{-ms-flex-order:1;order:1}.order-2{-ms-flex-order:2;order:2}.order-3{-ms-flex-order:3;order:3}.order-4{-ms-flex-order:4;order:4}.order-5{-ms-flex-order:5;order:5}.order-6{-ms-flex-order:6;order:6}.order-7{-ms-flex-order:7;order:7}.order-8{-ms-flex-order:8;order:8}.order-9{-ms-flex-order:9;order:9}.order-10{-ms-flex-order:10;order:10}.order-11{-ms-flex-order:11;order:11}.order-12{-ms-flex-order:12;order:12}@media(min-width:768px){.col-md{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-md-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-md-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-md-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-md-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-md-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-md-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-md-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-md-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-md-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-md-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-md-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-md-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-md-first{-ms-flex-order:-1;order:-1}.order-md-0{-ms-flex-order:0;order:0}.order-md-1{-ms-flex-order:1;order:1}.order-md-2{-ms-flex-order:2;order:2}.order-md-3{-ms-flex-order:3;order:3}.order-md-4{-ms-flex-order:4;order:4}.order-md-5{-ms-flex-order:5;order:5}.order-md-6{-ms-flex-order:6;order:6}.order-md-7{-ms-flex-order:7;order:7}.order-md-8{-ms-flex-order:8;order:8}.order-md-9{-ms-flex-order:9;order:9}.order-md-10{-ms-flex-order:10;order:10}.order-md-11{-ms-flex-order:11;order:11}.order-md-12{-ms-flex-order:12;order:12}}@media(min-width:992px){.col-lg{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-lg-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-lg-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-lg-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-lg-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-lg-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-lg-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-lg-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-lg-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-lg-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-lg-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-lg-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-lg-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-lg-first{-ms-flex-order:-1;order:-1}.order-lg-0{-ms-flex-order:0;order:0}.order-lg-1{-ms-flex-order:1;order:1}.order-lg-2{-ms-flex-order:2;order:2}.order-lg-3{-ms-flex-order:3;order:3}.order-lg-4{-ms-flex-order:4;order:4}.order-lg-5{-ms-flex-order:5;order:5}.order-lg-6{-ms-flex-order:6;order:6}.order-lg-7{-ms-flex-order:7;order:7}.order-lg-8{-ms-flex-order:8;order:8}.order-lg-9{-ms-flex-order:9;order:9}.order-lg-10{-ms-flex-order:10;order:10}.order-lg-11{-ms-flex-order:11;order:11}.order-lg-12{-ms-flex-order:12;order:12}}.table{width:100%;margin-bottom:1rem;color:#212529}.table-primary{background-color:#b8daff}.table-light{background-color:#fdfdfe}.table-dark{background-color:#c6c8ca}.table-dark{color:#fff;background-color:#343a40}.btn{display:inline-block;font-weight:400;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:.375rem .75rem;font-size:1rem;line-height:1.5;border-radius:.25rem}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus{outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.btn:disabled{opacity:.65}.btn-primary{color:#fff;background-color:#007bff;border-color:#007bff}.btn-primary:hover{color:#fff;background-color:#0069d9;border-color:#0062cc}.btn-primary:focus{color:#fff;background-color:#0069d9;border-color:#0062cc;box-shadow:0 0 0 .2rem rgba(38,143,255,.5)}.btn-primary:disabled{color:#fff;background-color:#007bff;border-color:#007bff}.btn-light{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-light:hover{color:#212529;background-color:#e2e6ea;border-color:#dae0e5}.btn-light:focus{color:#212529;background-color:#e2e6ea;border-color:#dae0e5;box-shadow:0 0 0 .2rem rgba(216,217,219,.5)}.btn-light:disabled{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-dark{color:#fff;background-color:#343a40;border-color:#343a40}.btn-dark:hover{color:#fff;background-color:#23272b;border-color:#1d2124}.btn-dark:focus{color:#fff;background-color:#23272b;border-color:#1d2124;box-shadow:0 0 0 .2rem rgba(82,88,93,.5)}.btn-dark:disabled{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-primary{color:#007bff;border-color:#007bff}.btn-outline-primary:hover{color:#fff;background-color:#007bff;border-color:#007bff}.btn-outline-primary:focus{box-shadow:0 0 0 .2rem rgba(0,123,255,.5)}.btn-outline-primary:disabled{color:#007bff;background-color:transparent}.btn-outline-light{color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:hover{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:focus{box-shadow:0 0 0 .2rem rgba(248,249,250,.5)}.btn-outline-light:disabled{color:#f8f9fa;background-color:transparent}.btn-outline-dark{color:#343a40;border-color:#343a40}.btn-outline-dark:hover{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-dark:focus{box-shadow:0 0 0 .2rem rgba(52,58,64,.5)}.btn-outline-dark:disabled{color:#343a40;background-color:transparent}.btn-link{font-weight:400;color:#007bff;text-decoration:none}.btn-link:hover{color:#0056b3;text-decoration:underline}.btn-link:focus{text-decoration:underline;box-shadow:none}.btn-link:disabled{color:#6c757d;pointer-events:none}.btn-group-lg>.btn,.btn-lg{padding:.5rem 1rem;font-size:1.25rem;line-height:1.5;border-radius:.3rem}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:.5rem}.btn-group{position:relative;display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle}.btn-group>.btn{position:relative;-ms-flex:1 1 auto;flex:1 1 auto}.btn-group>.btn:hover{z-index:1}.btn-group>.btn:active,.btn-group>.btn:focus{z-index:1}.btn-group>.btn-group:not(:first-child),.btn-group>.btn:not(:first-child){margin-left:-1px}.btn-group>.btn-group:not(:last-child)>.btn{border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn-group:not(:first-child)>.btn,.btn-group>.btn:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.custom-select{display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;vertical-align:middle;background:#fff url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5' viewBox='0 0 4 5'%3e%3cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3e%3c/svg%3e") no-repeat right .75rem center/8px 10px;border:1px solid #ced4da;border-radius:.25rem;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.custom-select:focus::-ms-value{color:#495057;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #495057}.custom-select-lg{height:calc(1.5em+1rem+2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.25rem}@media(prefers-reduced-motion:reduce){.custom-select{transition:none}}.page-link{position:relative;display:block;padding:.5rem .75rem;margin-left:-1px;line-height:1.25;color:#007bff;background-color:#fff;border:1px solid #dee2e6}.page-link:hover{z-index:2;color:#0056b3;text-decoration:none;background-color:#e9ecef;border-color:#dee2e6}.page-link:focus{z-index:3;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.alert{position:relative;padding:.75rem 1.25rem;margin-bottom:1rem;border:1px solid transparent;border-radius:.25rem}.alert-heading{color:inherit}.alert-link{font-weight:700}.alert-primary{color:#004085;background-color:#cce5ff;border-color:#b8daff}.alert-primary .alert-link{color:#002752}.alert-light{color:#818182;background-color:#fefefe;border-color:#fdfdfe}.alert-light .alert-link{color:#686868}.alert-dark{color:#1b1e21;background-color:#d6d8d9;border-color:#c6c8ca}.alert-dark .alert-link{color:#040505}@-webkit-keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@-webkit-keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}@keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}.bg-primary{background-color:#007bff}a.bg-primary:focus,a.bg-primary:hover{background-color:#0062cc}.bg-light{background-color:#f8f9fa}a.bg-light:focus,a.bg-light:hover{background-color:#dae0e5}.bg-dark{background-color:#343a40}a.bg-dark:focus,a.bg-dark:hover{background-color:#1d2124}.bg-white{background-color:#fff}.d-none{display:none}.d-inline{display:inline}.d-inline-block{display:inline-block}.d-block{display:block}.d-table{display:table}.d-table-row{display:table-row}@media(min-width:768px){.d-md-none{display:none}.d-md-inline{display:inline}.d-md-inline-block{display:inline-block}.d-md-block{display:block}.d-md-table{display:table}.d-md-table-row{display:table-row}}@media(min-width:992px){.d-lg-none{display:none}.d-lg-inline{display:inline}.d-lg-inline-block{display:inline-block}.d-lg-block{display:block}.d-lg-table{display:table}.d-lg-table-row{display:table-row}}.float-right{float:right}.float-none{float:none}@media(min-width:768px){.float-md-right{float:right}.float-md-none{float:none}}@media(min-width:992px){.float-lg-right{float:right}.float-lg-none{float:none}}.position-fixed{position:fixed}.fixed-bottom{position:fixed;right:0;bottom:0;left:0;z-index:1030}.w-25{width:25%}.w-50{width:50%}.w-75{width:75%}.w-100{width:100%}.h-25{height:25%}.h-50{height:50%}.h-75{height:75%}.h-100{height:100%}.m-0{margin:0}.mt-0,.my-0{margin-top:0}.mr-0{margin-right:0}.mb-0,.my-0{margin-bottom:0}.m-1{margin:.25rem}.mt-1,.my-1{margin-top:.25rem}.mr-1{margin-right:.25rem}.mb-1,.my-1{margin-bottom:.25rem}.m-2{margin:.5rem}.mt-2,.my-2{margin-top:.5rem}.mr-2{margin-right:.5rem}.mb-2,.my-2{margin-bottom:.5rem}.m-3{margin:1rem}.mt-3,.my-3{margin-top:1rem}.mr-3{margin-right:1rem}.mb-3,.my-3{margin-bottom:1rem}.m-4{margin:1.5rem}.mt-4,.my-4{margin-top:1.5rem}.mr-4{margin-right:1.5rem}.mb-4,.my-4{margin-bottom:1.5rem}.m-5{margin:3rem}.mt-5,.my-5{margin-top:3rem}.mr-5{margin-right:3rem}.mb-5,.my-5{margin-bottom:3rem}.p-0{padding:0}.pt-0,.py-0{padding-top:0}.pb-0,.py-0{padding-bottom:0}.p-1{padding:.25rem}.pt-1,.py-1{padding-top:.25rem}.pb-1,.py-1{padding-bottom:.25rem}.p-2{padding:.5rem}.pt-2,.py-2{padding-top:.5rem}.pb-2,.py-2{padding-bottom:.5rem}.p-3{padding:1rem}.pt-3,.py-3{padding-top:1rem}.pb-3,.py-3{padding-bottom:1rem}.p-4{padding:1.5rem}.pt-4,.py-4{padding-top:1.5rem}.pb-4,.py-4{padding-bottom:1.5rem}.p-5{padding:3rem}.pt-5,.py-5{padding-top:3rem}.pb-5,.py-5{padding-bottom:3rem}.m-n1{margin:-.25rem}.mt-n1,.my-n1{margin-top:-.25rem}.mr-n1{margin-right:-.25rem}.mb-n1,.my-n1{margin-bottom:-.25rem}.m-n2{margin:-.5rem}.mt-n2,.my-n2{margin-top:-.5rem}.mr-n2{margin-right:-.5rem}.mb-n2,.my-n2{margin-bottom:-.5rem}.m-n3{margin:-1rem}.mt-n3,.my-n3{margin-top:-1rem}.mr-n3{margin-right:-1rem}.mb-n3,.my-n3{margin-bottom:-1rem}.m-n4{margin:-1.5rem}.mt-n4,.my-n4{margin-top:-1.5rem}.mr-n4{margin-right:-1.5rem}.mb-n4,.my-n4{margin-bottom:-1.5rem}.m-n5{margin:-3rem}.mt-n5,.my-n5{margin-top:-3rem}.mr-n5{margin-right:-3rem}.mb-n5,.my-n5{margin-bottom:-3rem}@media(min-width:768px){.m-md-0{margin:0}.mt-md-0,.my-md-0{margin-top:0}.mr-md-0{margin-right:0}.mb-md-0,.my-md-0{margin-bottom:0}.m-md-1{margin:.25rem}.mt-md-1,.my-md-1{margin-top:.25rem}.mr-md-1{margin-right:.25rem}.mb-md-1,.my-md-1{margin-bottom:.25rem}.m-md-2{margin:.5rem}.mt-md-2,.my-md-2{margin-top:.5rem}.mr-md-2{margin-right:.5rem}.mb-md-2,.my-md-2{margin-bottom:.5rem}.m-md-3{margin:1rem}.mt-md-3,.my-md-3{margin-top:1rem}.mr-md-3{margin-right:1rem}.mb-md-3,.my-md-3{margin-bottom:1rem}.m-md-4{margin:1.5rem}.mt-md-4,.my-md-4{margin-top:1.5rem}.mr-md-4{margin-right:1.5rem}.mb-md-4,.my-md-4{margin-bottom:1.5rem}.m-md-5{margin:3rem}.mt-md-5,.my-md-5{margin-top:3rem}.mr-md-5{margin-right:3rem}.mb-md-5,.my-md-5{margin-bottom:3rem}.p-md-0{padding:0}.pt-md-0,.py-md-0{padding-top:0}.pb-md-0,.py-md-0{padding-bottom:0}.p-md-1{padding:.25rem}.pt-md-1,.py-md-1{padding-top:.25rem}.pb-md-1,.py-md-1{padding-bottom:.25rem}.p-md-2{padding:.5rem}.pt-md-2,.py-md-2{padding-top:.5rem}.pb-md-2,.py-md-2{padding-bottom:.5rem}.p-md-3{padding:1rem}.pt-md-3,.py-md-3{padding-top:1rem}.pb-md-3,.py-md-3{padding-bottom:1rem}.p-md-4{padding:1.5rem}.pt-md-4,.py-md-4{padding-top:1.5rem}.pb-md-4,.py-md-4{padding-bottom:1.5rem}.p-md-5{padding:3rem}.pt-md-5,.py-md-5{padding-top:3rem}.pb-md-5,.py-md-5{padding-bottom:3rem}.m-md-n1{margin:-.25rem}.mt-md-n1,.my-md-n1{margin-top:-.25rem}.mr-md-n1{margin-right:-.25rem}.mb-md-n1,.my-md-n1{margin-bottom:-.25rem}.m-md-n2{margin:-.5rem}.mt-md-n2,.my-md-n2{margin-top:-.5rem}.mr-md-n2{margin-right:-.5rem}.mb-md-n2,.my-md-n2{margin-bottom:-.5rem}.m-md-n3{margin:-1rem}.mt-md-n3,.my-md-n3{margin-top:-1rem}.mr-md-n3{margin-right:-1rem}.mb-md-n3,.my-md-n3{margin-bottom:-1rem}.m-md-n4{margin:-1.5rem}.mt-md-n4,.my-md-n4{margin-top:-1.5rem}.mr-md-n4{margin-right:-1.5rem}.mb-md-n4,.my-md-n4{margin-bottom:-1.5rem}.m-md-n5{margin:-3rem}.mt-md-n5,.my-md-n5{margin-top:-3rem}.mr-md-n5{margin-right:-3rem}.mb-md-n5,.my-md-n5{margin-bottom:-3rem}}@media(min-width:992px){.m-lg-0{margin:0}.mt-lg-0,.my-lg-0{margin-top:0}.mr-lg-0{margin-right:0}.mb-lg-0,.my-lg-0{margin-bottom:0}.m-lg-1{margin:.25rem}.mt-lg-1,.my-lg-1{margin-top:.25rem}.mr-lg-1{margin-right:.25rem}.mb-lg-1,.my-lg-1{margin-bottom:.25rem}.m-lg-2{margin:.5rem}.mt-lg-2,.my-lg-2{margin-top:.5rem}.mr-lg-2{margin-right:.5rem}.mb-lg-2,.my-lg-2{margin-bottom:.5rem}.m-lg-3{margin:1rem}.mt-lg-3,.my-lg-3{margin-top:1rem}.mr-lg-3{margin-right:1rem}.mb-lg-3,.my-lg-3{margin-bottom:1rem}.m-lg-4{margin:1.5rem}.mt-lg-4,.my-lg-4{margin-top:1.5rem}.mr-lg-4{margin-right:1.5rem}.mb-lg-4,.my-lg-4{margin-bottom:1.5rem}.m-lg-5{margin:3rem}.mt-lg-5,.my-lg-5{margin-top:3rem}.mr-lg-5{margin-right:3rem}.mb-lg-5,.my-lg-5{margin-bottom:3rem}.p-lg-0{padding:0}.pt-lg-0,.py-lg-0{padding-top:0}.pb-lg-0,.py-lg-0{padding-bottom:0}.p-lg-1{padding:.25rem}.pt-lg-1,.py-lg-1{padding-top:.25rem}.pb-lg-1,.py-lg-1{padding-bottom:.25rem}.p-lg-2{padding:.5rem}.pt-lg-2,.py-lg-2{padding-top:.5rem}.pb-lg-2,.py-lg-2{padding-bottom:.5rem}.p-lg-3{padding:1rem}.pt-lg-3,.py-lg-3{padding-top:1rem}.pb-lg-3,.py-lg-3{padding-bottom:1rem}.p-lg-4{padding:1.5rem}.pt-lg-4,.py-lg-4{padding-top:1.5rem}.pb-lg-4,.py-lg-4{padding-bottom:1.5rem}.p-lg-5{padding:3rem}.pt-lg-5,.py-lg-5{padding-top:3rem}.pb-lg-5,.py-lg-5{padding-bottom:3rem}.m-lg-n1{margin:-.25rem}.mt-lg-n1,.my-lg-n1{margin-top:-.25rem}.mr-lg-n1{margin-right:-.25rem}.mb-lg-n1,.my-lg-n1{margin-bottom:-.25rem}.m-lg-n2{margin:-.5rem}.mt-lg-n2,.my-lg-n2{margin-top:-.5rem}.mr-lg-n2{margin-right:-.5rem}.mb-lg-n2,.my-lg-n2{margin-bottom:-.5rem}.m-lg-n3{margin:-1rem}.mt-lg-n3,.my-lg-n3{margin-top:-1rem}.mr-lg-n3{margin-right:-1rem}.mb-lg-n3,.my-lg-n3{margin-bottom:-1rem}.m-lg-n4{margin:-1.5rem}.mt-lg-n4,.my-lg-n4{margin-top:-1.5rem}.mr-lg-n4{margin-right:-1.5rem}.mb-lg-n4,.my-lg-n4{margin-bottom:-1.5rem}.m-lg-n5{margin:-3rem}.mt-lg-n5,.my-lg-n5{margin-top:-3rem}.mr-lg-n5{margin-right:-3rem}.mb-lg-n5,.my-lg-n5{margin-bottom:-3rem}}.text-right{text-align:right}.text-center{text-align:center}@media(min-width:768px){.text-md-right{text-align:right}.text-md-center{text-align:center}}@media(min-width:992px){.text-lg-right{text-align:right}.text-lg-center{text-align:center}}.text-white{color:#fff}.text-primary{color:#007bff}a.text-primary:focus,a.text-primary:hover{color:#0056b3}.text-light{color:#f8f9fa}a.text-light:focus,a.text-light:hover{color:#cbd3da}.text-dark{color:#343a40}a.text-dark:focus,a.text-dark:hover{color:#121416}.text-body{color:#212529}.text-muted{color:#6c757d}.text-black-50{color:rgba(0,0,0,.5)}.text-white-50{color:rgba(255,255,255,.5)}.text-hide{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;border:0}.text-decoration-none{text-decoration:none}.text-reset{color:inherit}.visible{visibility:visible}@media print{*,::after,::before{text-shadow:none;box-shadow:none}a:not(.btn){text-decoration:underline}pre{white-space:pre-wrap}pre{border:1px solid #adb5bd;page-break-inside:avoid}img{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}body{min-width:992px}.container{min-width:992px}.table{border-collapse:collapse}.table-dark{color:inherit}}@-webkit-keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}@keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"}a:link,a:visited{color:#f14600;text-decoration:none}a:active,a:hover{text-decoration:underline}.btn:disabled{cursor:default;opacity:.4}#logo-text{width:180px;margin-left:12px}.display-5{font-size:2rem;font-weight:300;line-height:1.2}.display-6{font-size:1.75rem;font-weight:300;line-height:1.2}.bg-dark-alt,.bg-dark-alt:focus{background:#36363f}.bg-orange,.bg-orange:focus{background:#f14600}.text-dark-alt{color:#36363f}.btn-dark-alt{background:#36363f}.btn-dark-alt:focus{background:#36363f}.btn-outline-orange{border-color:#f14600;color:#f14600}.btn-orange,.btn-outline-orange:hover{background:#f14600;color:#fff}.btn:active,.btn:hover{text-decoration:none}.text-orange{color:#f14600}.bg-number{position:absolute;font-size:900%;font-weight:700;color:rgba(241,70,0,.1);line-height:1;margin-top:-1rem}.w-15{width:15%}.headerlink{text-decoration:none;margin-left:.5rem}#content table{border:1px solid #dee2e6;width:100%;margin-bottom:1rem;overflow-x:auto}#content code{color:#000;background:#eee;padding:.125rem .25rem}#content code.syntax{padding:0}#content pre{background:#efefef;padding:1rem;line-height:1.25}@media print{body{min-width:0}code,h1,h2,h3,h4,h5,h6,img,li,p,pre{page-break-inside:avoid}}@media(prefers-color-scheme:dark){#to-full-website,body.amp,body[data-spy]{background:#1c1c1c;color:#efefef}.invert-dark{filter:invert(100%)}#content table{border:1px solid #2a2b2c}#content code{background:#444;color:#eee;padding:.125rem .25rem}#content pre{background:#444;color:#eee}}@media(prefers-color-scheme:dark){.syntax .hll{background-color:#515151}.syntax{background:#2d2d2d;color:#f2f0ec}.syntax .c{color:#747369}.syntax .err{color:#f2777a}.syntax .k{color:#c9c}.syntax .l{color:#f99157}.syntax .n{color:#f2f0ec}.syntax .o{color:#6cc}.syntax .p{color:#f2f0ec}.syntax .c1{color:#747369}.syntax .cs{color:#747369}.syntax .kd{color:#c9c}.syntax .kr{color:#c9c}.syntax .ld{color:#9c9}.syntax .m{color:#f99157}.syntax .s{color:#9c9}.syntax .nb{color:#f2f0ec}.syntax .py{color:#f2f0ec}.syntax .nv{color:#f2777a}.syntax .ow{color:#6cc}.syntax .w{color:#f2f0ec}.syntax .mf{color:#f99157}.syntax .mi{color:#f99157}.syntax .s2{color:#9c9}.syntax .s1{color:#9c9}}</style><script async custom-element=amp-analytics src=https://cdn.ampproject.org/v0/amp-analytics-0.1.js></script><script async custom-element=amp-iframe src=https://cdn.ampproject.org/v0/amp-iframe-0.1.js></script></head> <body class=amp dir=ltr> <div class="container-fluid container-lg pb-5"> <div class="row pt-3 mb-3"> <div class=col> <a href=/ class=text-decoration-none> <amp-img class="d-inline-block mr-3" layout=fixed width=40 height=36 src=/images/logo.svg alt="ClickHouse logo" title="ClickHouse logo"></amp-img><amp-img class="invert-dark d-inline-block" layout=fixed width=238 height=36 src=/images/clickhouse-black.svg alt=ClickHouse title=ClickHouse></amp-img> </a> </div> </div> <div class=row> <div id=content class=col> <div class="alert alert-primary" role=alert> <p class="display-5 mb-2">Help wanted!</p> <p class=lead>The following content of this documentation page has been machine-translated. But unlike other websites, it is not done on the fly. This translated text lives on GitHub repository alongside main ClickHouse codebase and waits for fellow native speakers to make it more human-readable. <a href=/docs/en/sql-reference/aggregate-functions/reference/ class=alert-link>You can also use the original English version as a reference.</a></p> <p class=lead> <a class="btn btn-lg btn-primary text-white" href=https://github.com/ClickHouse/ClickHouse/edit/master/docs/ja/sql-reference/aggregate-functions/reference.md target=_blank rel="external nofollow noreferrer"> Help ClickHouse documentation by editing this page </a> </p> </div> <h1 id=aggregate-functions-reference>集計関数の参照<a class=headerlink href=../amp/#aggregate-functions-reference title="Permanent link"> </a></h1> <h2 id=agg_function-count>カウント<a class=headerlink href=../amp/#agg_function-count title="Permanent link"> </a></h2> <p>行数またはnot-NULL値をカウントします。</p> <p>ClickHouseは以下の構文をサポートしています <code class=syntax>count</code>:<br> - <code class=syntax>count(expr)</code> または <code class=syntax>COUNT(DISTINCT expr)</code>.<br> - <code class=syntax>count()</code> または <code class=syntax>COUNT(*)</code>. その <code class=syntax>count()</code> 構文はClickHouse固有です。</p> <p><strong>パラメータ</strong></p> <p>機能は取ることができます:</p> <ul> <li>ゼロパラメータ。</li> <li>ワン <a href=../../../syntax/amp/#syntax-expressions>式</a>.</li> </ul> <p><strong>戻り値</strong></p> <ul> <li>関数がパラメータなしで呼び出された場合、行の数がカウントされます。</li> <li>もし <a href=../../../syntax/amp/#syntax-expressions>式</a> 渡されると、関数はこの式がnot nullを返した回数をカウントします。 式がaを返す場合 <a href=../../../data-types/nullable/amp/ >Null可能</a>-型の値、その後の結果 <code class=syntax>count</code> 滞在しない <code class=syntax>Nullable</code>. 式が返された場合、関数は0を返します <code class=syntax>NULL</code> すべての行について。</li> </ul> <p>どちらの場合も、戻り値の型は次のとおりです <a href=../../../data-types/int-uint/amp/ >UInt64</a>.</p> <p><strong>詳細</strong></p> <p>クリックハウスは <code class=syntax>COUNT(DISTINCT ...)</code> 構文。 この構造の動作は、 <a href=../../../../operations/settings/settings/amp/#settings-count_distinct_implementation>count_distinct_implementation</a> 設定。 それはのどれを定義します <a href=../amp/#agg_function-uniq>uniq*</a> 関数は、操作を実行するために使用されます。 デフォルトは <a href=../amp/#agg_function-uniqexact>uniqExact</a> 機能。</p> <p>その <code class=syntax>SELECT count() FROM table</code> テーブル内のエントリの数が別々に格納されないため、クエリは最適化されません。 テーブルから小さな列を選択し、その中の値の数をカウントします。</p> <p><strong>例</strong></p> <p>例1:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=k>count</span><span class=p>()</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─count()─┐
│       5 │
└─────────┘
</code></pre></div> <p>例2:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>name</span><span class=p>,</span> <span class=n>value</span> <span class=k>FROM</span> <span class=k>system</span><span class=p>.</span><span class=n>settings</span> <span class=k>WHERE</span> <span class=n>name</span> <span class=o>=</span> <span class=s1>'count_distinct_implementation'</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─name──────────────────────────┬─value─────┐
│ count_distinct_implementation │ uniqExact │
└───────────────────────────────┴───────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=k>count</span><span class=p>(</span><span class=k>DISTINCT</span> <span class=n>num</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─uniqExact(num)─┐
│              3 │
└────────────────┘
</code></pre></div> <p>この例では、 <code class=syntax>count(DISTINCT num)</code> によって実行されます。 <code class=syntax>uniqExact</code> に従う機能 <code class=syntax>count_distinct_implementation</code> 設定値。</p> <h2 id=agg_function-any>任意(x)<a class=headerlink href=../amp/#agg_function-any title="Permanent link"> </a></h2> <p>最初に検出された値を選択します。<br> クエリは毎回異なる順序でも任意の順序で実行できるため、この関数の結果は不確定です。<br> 決定的な結果を得るには、 ‘min’ または ‘max’ 関数の代わりに ‘any’.</p> <p>場合によっては、実行の順序に依存することができます。 これは、SELECTがORDER BYを使用するサブクエリから来ている場合に適用されます。</p> <p>ときa <code class=syntax>SELECT</code> クエリには <code class=syntax>GROUP BY</code> クラスタ内のすべての式は、クラスタ内のすべての式を必要とします。 <code class=syntax>SELECT</code>, <code class=syntax>HAVING</code>,and <code class=syntax>ORDER BY</code> 句は、キーまたは集計関数から計算されます。 つまり、テーブルから選択された各列は、キーまたは集計関数内で使用する必要があります。 MySQLのような動作を得るには、他の列を <code class=syntax>any</code> 集計関数。</p> <h2 id=anyheavyx>anyHeavy(x)<a class=headerlink href=../amp/#anyheavyx title="Permanent link"> </a></h2> <p>を使用して頻繁に発生する値を選択します。 <a href=http://www.cs.umd.edu/~samir/498/karp.pdf rel="external nofollow noreferrer" target=_blank>ヘビーヒッター</a> アルゴリズム 各クエリの実行スレッドでケースの半分を超える値がある場合、この値が返されます。 通常、結果は非決定的です。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>anyHeavy</span><span class=p>(</span><span class=k>column</span><span class=p>)</span>
</code></pre></div> <p><strong>引数</strong></p> <ul> <li><code class=syntax>column</code> – The column name.</li> </ul> <p><strong>例</strong></p> <p>を取る <a href=../../../../getting-started/example-datasets/ontime/amp/ >オンタイム</a> データ-セットはの頻繁に発生する値を選び、 <code class=syntax>AirlineID</code> 列。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>anyHeavy</span><span class=p>(</span><span class=n>AirlineID</span><span class=p>)</span> <span class=k>AS</span> <span class=n>res</span>
<span class=k>FROM</span> <span class=n>ontime</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌───res─┐
│ 19690 │
└───────┘
</code></pre></div> <h2 id=anylastx>anyLast(x)<a class=headerlink href=../amp/#anylastx title="Permanent link"> </a></h2> <p>最後に検出された値を選択します。<br> 結果は同じように不確定です。 <code class=syntax>any</code> 機能。</p> <h2 id=groupbitand>グループビタンド<a class=headerlink href=../amp/#groupbitand title="Permanent link"> </a></h2> <p>ビット単位で適用 <code class=syntax>AND</code> 数のシリーズのために。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>groupBitAnd</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p><strong>パラメータ</strong></p> <p><code class=syntax>expr</code> – An expression that results in <code class=syntax>UInt*</code> タイプ。</p> <p><strong>戻り値</strong></p> <p>の値 <code class=syntax>UInt*</code> タイプ。</p> <p><strong>例</strong></p> <p>テストデータ:</p> <div class=codehilite><pre><span></span><code class=syntax>binary     decimal
00101100 = 44
00011100 = 28
00001101 = 13
01010101 = 85
</code></pre></div> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>groupBitAnd</span><span class=p>(</span><span class=n>num</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <p>どこに <code class=syntax>num</code> テストデータを含む列です。</p> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>binary     decimal
00000100 = 4
</code></pre></div> <h2 id=groupbitor>groupBitOr<a class=headerlink href=../amp/#groupbitor title="Permanent link"> </a></h2> <p>ビット単位で適用 <code class=syntax>OR</code> 数のシリーズのために。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>groupBitOr</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p><strong>パラメータ</strong></p> <p><code class=syntax>expr</code> – An expression that results in <code class=syntax>UInt*</code> タイプ。</p> <p><strong>戻り値</strong></p> <p>の値 <code class=syntax>UInt*</code> タイプ。</p> <p><strong>例</strong></p> <p>テストデータ:</p> <div class=codehilite><pre><span></span><code class=syntax>binary     decimal
00101100 = 44
00011100 = 28
00001101 = 13
01010101 = 85
</code></pre></div> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>groupBitOr</span><span class=p>(</span><span class=n>num</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <p>どこに <code class=syntax>num</code> テストデータを含む列です。</p> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>binary     decimal
01111101 = 125
</code></pre></div> <h2 id=groupbitxor>groupBitXor<a class=headerlink href=../amp/#groupbitxor title="Permanent link"> </a></h2> <p>ビット単位で適用 <code class=syntax>XOR</code> 数のシリーズのために。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>groupBitXor</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p><strong>パラメータ</strong></p> <p><code class=syntax>expr</code> – An expression that results in <code class=syntax>UInt*</code> タイプ。</p> <p><strong>戻り値</strong></p> <p>の値 <code class=syntax>UInt*</code> タイプ。</p> <p><strong>例</strong></p> <p>テストデータ:</p> <div class=codehilite><pre><span></span><code class=syntax>binary     decimal
00101100 = 44
00011100 = 28
00001101 = 13
01010101 = 85
</code></pre></div> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>groupBitXor</span><span class=p>(</span><span class=n>num</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <p>どこに <code class=syntax>num</code> テストデータを含む列です。</p> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>binary     decimal
01101000 = 104
</code></pre></div> <h2 id=groupbitmap>groupBitmap<a class=headerlink href=../amp/#groupbitmap title="Permanent link"> </a></h2> <p>符号なし整数列からのビットマップまたは集計計算、uint64型の基数を返します。 <a href=../../../functions/bitmap-functions/amp/ >ビットマップ</a>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>groupBitmap</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p><strong>パラメータ</strong></p> <p><code class=syntax>expr</code> – An expression that results in <code class=syntax>UInt*</code> タイプ。</p> <p><strong>戻り値</strong></p> <p>の値 <code class=syntax>UInt64</code> タイプ。</p> <p><strong>例</strong></p> <p>テストデータ:</p> <div class=codehilite><pre><span></span><code class=syntax>UserID
1
1
2
3
</code></pre></div> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>groupBitmap</span><span class=p>(</span><span class=n>UserID</span><span class=p>)</span> <span class=k>as</span> <span class=n>num</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>num
3
</code></pre></div> <h2 id=agg_function-min>min(x)<a class=headerlink href=../amp/#agg_function-min title="Permanent link"> </a></h2> <p>最小値を計算します。</p> <h2 id=agg_function-max>max(x)<a class=headerlink href=../amp/#agg_function-max title="Permanent link"> </a></h2> <p>最大値を計算します。</p> <h2 id=agg-function-argmin>アルグミン(arg,val)<a class=headerlink href=../amp/#agg-function-argmin title="Permanent link"> </a></h2> <p>計算します ‘arg’ 最小値の値 ‘val’ 値。 のいくつかの異なる値がある場合 ‘arg’ の最小値に対して ‘val’、検出された最初のこれらの値が出力されます。</p> <p><strong>例:</strong></p> <div class=codehilite><pre><span></span><code class=syntax>┌─user─────┬─salary─┐
│ director │   5000 │
│ manager  │   3000 │
│ worker   │   1000 │
└──────────┴────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>argMin</span><span class=p>(</span><span class=k>user</span><span class=p>,</span> <span class=n>salary</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>salary</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─argMin(user, salary)─┐
│ worker               │
└──────────────────────┘
</code></pre></div> <h2 id=agg-function-argmax>アルグマックス(arg,val)<a class=headerlink href=../amp/#agg-function-argmax title="Permanent link"> </a></h2> <p>計算します ‘arg’ 最大値 ‘val’ 値。 のいくつかの異なる値がある場合 ‘arg’ の最大値の場合 ‘val’、検出された最初のこれらの値が出力されます。</p> <h2 id=agg_function-sum>sum(x)<a class=headerlink href=../amp/#agg_function-sum title="Permanent link"> </a></h2> <p>合計を計算します。<br> 数字のみで動作します。</p> <h2 id=sumwithoverflowx>sumWithOverflow(x)<a class=headerlink href=../amp/#sumwithoverflowx title="Permanent link"> </a></h2> <p>結果には、入力パラメーターと同じデータ型を使用して、数値の合計を計算します。 合計がこのデータ型の最大値を超えると、関数はエラーを返します。</p> <p>数字のみで動作します。</p> <h2 id=agg_functions-summap>sumMap(キー,値),sumMap(タプル(キー,値)))<a class=headerlink href=../amp/#agg_functions-summap title="Permanent link"> </a></h2> <p>合計 ‘value’ に指定されたキーに従って配列 ‘key’ 配列<br> キーと値の配列のタプルを渡すことは、キーと値の二つの配列を渡すことと同義です。<br> 要素の数 ‘key’ と ‘value’ 合計される行ごとに同じである必要があります。<br> Returns a tuple of two arrays: keys in sorted order, and values ​​summed for the corresponding keys.</p> <p>例:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>sum_map</span><span class=p>(</span>
    <span class=nb>date</span> <span class=nb>Date</span><span class=p>,</span>
    <span class=n>timeslot</span> <span class=n>DateTime</span><span class=p>,</span>
    <span class=n>statusMap</span> <span class=n>Nested</span><span class=p>(</span>
        <span class=n>status</span> <span class=n>UInt16</span><span class=p>,</span>
        <span class=n>requests</span> <span class=n>UInt64</span>
    <span class=p>),</span>
    <span class=n>statusMapTuple</span> <span class=n>Tuple</span><span class=p>(</span><span class=nb>Array</span><span class=p>(</span><span class=n>Int32</span><span class=p>),</span> <span class=nb>Array</span><span class=p>(</span><span class=n>Int32</span><span class=p>))</span>
<span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>Log</span><span class=p>;</span>
<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>sum_map</span> <span class=k>VALUES</span>
    <span class=p>(</span><span class=s1>'2000-01-01'</span><span class=p>,</span> <span class=s1>'2000-01-01 00:00:00'</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>],</span> <span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>])),</span>
    <span class=p>(</span><span class=s1>'2000-01-01'</span><span class=p>,</span> <span class=s1>'2000-01-01 00:00:00'</span><span class=p>,</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>],</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>],</span> <span class=p>([</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>],</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>])),</span>
    <span class=p>(</span><span class=s1>'2000-01-01'</span><span class=p>,</span> <span class=s1>'2000-01-01 00:01:00'</span><span class=p>,</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>],</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>],</span> <span class=p>([</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>],</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>])),</span>
    <span class=p>(</span><span class=s1>'2000-01-01'</span><span class=p>,</span> <span class=s1>'2000-01-01 00:01:00'</span><span class=p>,</span> <span class=p>[</span><span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>],</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>],</span> <span class=p>([</span><span class=mi>6</span><span class=p>,</span> <span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>],</span> <span class=p>[</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>]));</span>

<span class=k>SELECT</span>
    <span class=n>timeslot</span><span class=p>,</span>
    <span class=n>sumMap</span><span class=p>(</span><span class=n>statusMap</span><span class=p>.</span><span class=n>status</span><span class=p>,</span> <span class=n>statusMap</span><span class=p>.</span><span class=n>requests</span><span class=p>),</span>
    <span class=n>sumMap</span><span class=p>(</span><span class=n>statusMapTuple</span><span class=p>)</span>
<span class=k>FROM</span> <span class=n>sum_map</span>
<span class=k>GROUP</span> <span class=k>BY</span> <span class=n>timeslot</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌────────────timeslot─┬─sumMap(statusMap.status, statusMap.requests)─┬─sumMap(statusMapTuple)─────────┐
│ 2000-01-01 00:00:00 │ ([1,2,3,4,5],[10,10,20,10,10])               │ ([1,2,3,4,5],[10,10,20,10,10]) │
│ 2000-01-01 00:01:00 │ ([4,5,6,7,8],[10,10,20,10,10])               │ ([4,5,6,7,8],[10,10,20,10,10]) │
└─────────────────────┴──────────────────────────────────────────────┴────────────────────────────────┘
</code></pre></div> <h2 id=skewpop>skewPop<a class=headerlink href=../amp/#skewpop title="Permanent link"> </a></h2> <p>を計算する <a href=https://en.wikipedia.org/wiki/Skewness rel="external nofollow noreferrer" target=_blank>歪み</a> シーケンスの。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>skewPop</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p><strong>パラメータ</strong></p> <p><code class=syntax>expr</code> — <a href=../../../syntax/amp/#syntax-expressions>式</a> 番号を返す。</p> <p><strong>戻り値</strong></p> <p>The skewness of the given distribution. Type — <a href=../../../data-types/float/amp/ >Float64</a></p> <p><strong>例</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>skewPop</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>series_with_value_column</span>
</code></pre></div> <h2 id=skewsamp>skewSamp<a class=headerlink href=../amp/#skewsamp title="Permanent link"> </a></h2> <p>を計算する <a href=https://en.wikipedia.org/wiki/Skewness rel="external nofollow noreferrer" target=_blank>サンプル歪度</a> シーケンスの。</p> <p>渡された値がサンプルを形成する場合、確率変数の歪度の不偏推定値を表します。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>skewSamp</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p><strong>パラメータ</strong></p> <p><code class=syntax>expr</code> — <a href=../../../syntax/amp/#syntax-expressions>式</a> 番号を返す。</p> <p><strong>戻り値</strong></p> <p>The skewness of the given distribution. Type — <a href=../../../data-types/float/amp/ >Float64</a>. もし <code class=syntax>n &lt;= 1</code> (<code class=syntax>n</code> はサンプルのサイズです）、その後、関数が返します <code class=syntax>nan</code>.</p> <p><strong>例</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>skewSamp</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>series_with_value_column</span>
</code></pre></div> <h2 id=kurtpop>クルトポップ<a class=headerlink href=../amp/#kurtpop title="Permanent link"> </a></h2> <p>を計算する <a href=https://en.wikipedia.org/wiki/Kurtosis rel="external nofollow noreferrer" target=_blank>尖度</a> シーケンスの。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>kurtPop</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p><strong>パラメータ</strong></p> <p><code class=syntax>expr</code> — <a href=../../../syntax/amp/#syntax-expressions>式</a> 番号を返す。</p> <p><strong>戻り値</strong></p> <p>The kurtosis of the given distribution. Type — <a href=../../../data-types/float/amp/ >Float64</a></p> <p><strong>例</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>kurtPop</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>series_with_value_column</span>
</code></pre></div> <h2 id=kurtsamp>クルツァンプ<a class=headerlink href=../amp/#kurtsamp title="Permanent link"> </a></h2> <p>を計算する <a href=https://en.wikipedia.org/wiki/Kurtosis rel="external nofollow noreferrer" target=_blank>尖度のサンプル</a> シーケンスの。</p> <p>渡された値がその標本を形成する場合、確率変数の尖度の不偏推定値を表します。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>kurtSamp</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p><strong>パラメータ</strong></p> <p><code class=syntax>expr</code> — <a href=../../../syntax/amp/#syntax-expressions>式</a> 番号を返す。</p> <p><strong>戻り値</strong></p> <p>The kurtosis of the given distribution. Type — <a href=../../../data-types/float/amp/ >Float64</a>. もし <code class=syntax>n &lt;= 1</code> (<code class=syntax>n</code> はサンプルのサイズです）、関数は <code class=syntax>nan</code>.</p> <p><strong>例</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>kurtSamp</span><span class=p>(</span><span class=n>value</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>series_with_value_column</span>
</code></pre></div> <h2 id=agg_function-avg>avg(x)<a class=headerlink href=../amp/#agg_function-avg title="Permanent link"> </a></h2> <p>平均を計算します。<br> 数字のみで動作します。<br> 結果は常にFloat64です。</p> <h2 id=avgweighted>avgWeighted<a class=headerlink href=../amp/#avgweighted title="Permanent link"> </a></h2> <p>計算します <a href=https://en.wikipedia.org/wiki/Weighted_arithmetic_mean rel="external nofollow noreferrer" target=_blank>加重算術平均</a>.</p> <p><strong>構文</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>avgWeighted</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>weight</span><span class=p>)</span>
</code></pre></div> <p><strong>パラメータ</strong></p> <ul> <li><code class=syntax>x</code> — Values. <a href=../../../data-types/int-uint/amp/ >整数</a> または <a href=../../../data-types/float/amp/ >浮動小数点数</a>.</li> <li><code class=syntax>weight</code> — Weights of the values. <a href=../../../data-types/int-uint/amp/ >整数</a> または <a href=../../../data-types/float/amp/ >浮動小数点数</a>.</li> </ul> <p>タイプの <code class=syntax>x</code> と <code class=syntax>weight</code> 同じである必要があります。</p> <p><strong>戻り値</strong></p> <ul> <li>加重平均。</li> <li><code class=syntax>NaN</code>. すべての重みが0に等しい場合。</li> </ul> <p>タイプ: <a href=../../../data-types/float/amp/ >Float64</a>.</p> <p><strong>例</strong></p> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>avgWeighted</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>w</span><span class=p>)</span>
<span class=k>FROM</span> <span class=k>values</span><span class=p>(</span><span class=s1>'x Int8, w Int8'</span><span class=p>,</span> <span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
</code></pre></div> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─avgWeighted(x, weight)─┐
│                      8 │
└────────────────────────┘
</code></pre></div> <h2 id=agg_function-uniq>uniq<a class=headerlink href=../amp/#agg_function-uniq title="Permanent link"> </a></h2> <p>引数の異なる値のおおよその数を計算します。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>uniq</span><span class=p>(</span><span class=n>x</span><span class=p>[,</span> <span class=p>...])</span>
</code></pre></div> <p><strong>パラメータ</strong></p> <p>この関数は、可変数のパラメータを取ります。 変数はあります <code class=syntax>Tuple</code>, <code class=syntax>Array</code>, <code class=syntax>Date</code>, <code class=syntax>DateTime</code>, <code class=syntax>String</code> または数値型。</p> <p><strong>戻り値</strong></p> <ul> <li>A <a href=../../../data-types/int-uint/amp/ >UInt64</a>-タイプ番号。</li> </ul> <p><strong>実装の詳細</strong></p> <p>関数:</p> <ul> <li> <p>集計内のすべてのパラメーターのハッシュを計算し、それを計算に使用します。</p> </li> <li> <p>を使用して適応サンプリングアルゴリズムです。 計算状態では、関数は65536までの要素ハッシュ値のサンプルを使用します。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>This</span> <span class=k>algorithm</span> <span class=k>is</span> <span class=n>very</span> <span class=n>accurate</span> <span class=k>and</span> <span class=n>very</span> <span class=n>efficient</span> <span class=k>on</span> <span class=n>the</span> <span class=k>CPU</span><span class=p>.</span> <span class=k>When</span> <span class=n>the</span> <span class=k>query</span> <span class=k>contains</span> <span class=n>several</span> <span class=k>of</span> <span class=n>these</span> <span class=n>functions</span><span class=p>,</span> <span class=k>using</span> <span class="n n-Quoted">`uniq`</span> <span class=k>is</span> <span class=n>almost</span> <span class=k>as</span> <span class=k>fast</span> <span class=k>as</span> <span class=k>using</span> <span class=n>other</span> <span class=k>aggregate</span> <span class=n>functions</span><span class=p>.</span>
</code></pre></div> </li> <li> <p>結果を確定的に提供します(クエリ処理順序に依存しません)。</p> </li> </ul> <p>使用をお勧めしますこの機能はほとんど全てのシナリオ.</p> <p><strong>も参照。</strong></p> <ul> <li><a href=../amp/#agg_function-uniqcombined>uniqCombined</a></li> <li><a href=../amp/#agg_function-uniqcombined64>uniqCombined64</a></li> <li><a href=../amp/#agg_function-uniqhll12>uniqHLL12</a></li> <li><a href=../amp/#agg_function-uniqexact>uniqExact</a></li> </ul> <h2 id=agg_function-uniqcombined>uniqCombined<a class=headerlink href=../amp/#agg_function-uniqcombined title="Permanent link"> </a></h2> <p>異なる引数値のおおよその数を計算します。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>uniqCombined</span><span class=p>(</span><span class=n>HLL_precision</span><span class=p>)(</span><span class=n>x</span><span class=p>[,</span> <span class=p>...])</span>
</code></pre></div> <p>その <code class=syntax>uniqCombined</code> 関数は、異なる値の数を計算するための良い選択です。</p> <p><strong>パラメータ</strong></p> <p>この関数は、可変数のパラメータを取ります。 変数はあります <code class=syntax>Tuple</code>, <code class=syntax>Array</code>, <code class=syntax>Date</code>, <code class=syntax>DateTime</code>, <code class=syntax>String</code> または数値型。</p> <p><code class=syntax>HLL_precision</code> は、セルの数の底2対数です。 <a href=https://en.wikipedia.org/wiki/HyperLogLog rel="external nofollow noreferrer" target=_blank>HyperLogLog</a>. オプションで、次のように関数を使用できます <code class=syntax>uniqCombined(x[, ...])</code>. のデフォルト値 <code class=syntax>HLL_precision</code> は17であり、これは実質的に96KiBの空間（2^17セル、各6ビット）である。</p> <p><strong>戻り値</strong></p> <ul> <li>番号 <a href=../../../data-types/int-uint/amp/ >UInt64</a>-タイプ番号。</li> </ul> <p><strong>実装の詳細</strong></p> <p>関数:</p> <ul> <li> <p>ハッシュ(64ビットのハッシュ <code class=syntax>String</code> それ以外の場合は32ビット）集計内のすべてのパラメータについて、それを計算に使用します。</p> </li> <li> <p>配列、ハッシュテーブル、HyperLogLogと誤り訂正表の組み合わせを使用します。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>For</span> <span class=nv>a</span> <span class=nv>small</span> <span class=nv>number</span> <span class=nv>of</span> <span class=nv>distinct</span> <span class=nv>elements</span>, <span class=nv>an</span> <span class=nv>array</span> <span class=nv>is</span> <span class=nv>used</span>. <span class=nv>When</span> <span class=nv>the</span> <span class=nv>set</span> <span class=nv>size</span> <span class=nv>is</span> <span class=nv>larger</span>, <span class=nv>a</span> <span class=nv>hash</span> <span class=nv>table</span> <span class=nv>is</span> <span class=nv>used</span>. <span class=k>For</span> <span class=nv>a</span> <span class=nv>larger</span> <span class=nv>number</span> <span class=nv>of</span> <span class=nv>elements</span>, <span class=nv>HyperLogLog</span> <span class=nv>is</span> <span class=nv>used</span>, <span class=nv>which</span> <span class=nv>will</span> <span class=nv>occupy</span> <span class=nv>a</span> <span class=nv>fixed</span> <span class=nv>amount</span> <span class=nv>of</span> <span class=nv>memory</span>.
</code></pre></div> </li> <li> <p>結果を確定的に提供します(クエリ処理順序に依存しません)。</p> </li> </ul> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">注</p> <p>非32ビットハッシュを使用するので-<code class=syntax>String</code> タイプは、結果よりも有意に大きい基数のための非常に高い誤差を有する <code class=syntax>UINT_MAX</code> （エラーは数十億の異なる値の後にすぐに発生します）、この場合は以下を使用する必要があります <a class=alert-link href=../amp/#agg_function-uniqcombined64>uniqCombined64</a></p> </div> <p>と比較される <a href=../amp/#agg_function-uniq>uniq</a> 関数は、 <code class=syntax>uniqCombined</code>:</p> <ul> <li>数倍少ないメモリを消費します。</li> <li>数倍高い精度で計算します。</li> <li>通常はやや性能が低い。 シナリオによっては, <code class=syntax>uniqCombined</code> ではどのように絡んでいるのかを調べ <code class=syntax>uniq</code> たとえば、ネットワーク経由で多数の集約状態を送信する分散クエリです。</li> </ul> <p><strong>も参照。</strong></p> <ul> <li><a href=../amp/#agg_function-uniq>uniq</a></li> <li><a href=../amp/#agg_function-uniqcombined64>uniqCombined64</a></li> <li><a href=../amp/#agg_function-uniqhll12>uniqHLL12</a></li> <li><a href=../amp/#agg_function-uniqexact>uniqExact</a></li> </ul> <h2 id=agg_function-uniqcombined64>uniqCombined64<a class=headerlink href=../amp/#agg_function-uniqcombined64 title="Permanent link"> </a></h2> <p>同じ <a href=../amp/#agg_function-uniqcombined>uniqCombined</a> しかし、すべてのデータ型に64ビットハッシュを使用します。</p> <h2 id=agg_function-uniqhll12>uniqHLL12<a class=headerlink href=../amp/#agg_function-uniqhll12 title="Permanent link"> </a></h2> <p>異なる引数値のおおよその数を計算します。 <a href=https://en.wikipedia.org/wiki/HyperLogLog rel="external nofollow noreferrer" target=_blank>HyperLogLog</a> アルゴリズム</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>uniqHLL12</span><span class=p>(</span><span class=n>x</span><span class=p>[,</span> <span class=p>...])</span>
</code></pre></div> <p><strong>パラメータ</strong></p> <p>この関数は、可変数のパラメータを取ります。 変数はあります <code class=syntax>Tuple</code>, <code class=syntax>Array</code>, <code class=syntax>Date</code>, <code class=syntax>DateTime</code>, <code class=syntax>String</code> または数値型。</p> <p><strong>戻り値</strong></p> <ul> <li>A <a href=../../../data-types/int-uint/amp/ >UInt64</a>-タイプ番号。</li> </ul> <p><strong>実装の詳細</strong></p> <p>関数:</p> <ul> <li> <p>集計内のすべてのパラメーターのハッシュを計算し、それを計算に使用します。</p> </li> <li> <p>HyperLogLogアルゴリズムを使用して、異なる引数値の数を近似します。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=mf>2</span><span class=o>^</span><span class=mf>12</span> <span class=mf>5</span><span class=o>-</span><span class=n>bit</span> <span class=n>cells</span> <span class=n>are</span> <span class=n>used</span><span class=mf>.</span> <span class=n>The</span> <span class=n>size</span> <span class=n>of</span> <span class=n>the</span> <span class=n>state</span> <span class=n>is</span> <span class=n>slightly</span> <span class=n>more</span> <span class=n>than</span> <span class=mf>2.5</span> <span class=n>KB</span><span class=mf>.</span> <span class=n>The</span> <span class=n>result</span> <span class=n>is</span> <span class=ow>not</span> <span class=n>very</span> <span class=n>accurate</span> <span class=p>(</span><span class=n>up</span> <span class=kr>to</span> <span class=err>~</span><span class=mf>10</span><span class=err>%</span> <span class=n>error</span><span class=p>)</span> <span class=kr>for</span> <span class=n>small</span> <span class=kd>data</span> <span class=n>sets</span> <span class=p>(</span><span class=o>&lt;</span><span class=mf>10</span><span class=n>K</span> <span class=n>elements</span><span class=p>)</span><span class=mf>.</span> <span class=n>However</span><span class=p>,</span> <span class=n>the</span> <span class=n>result</span> <span class=n>is</span> <span class=n>fairly</span> <span class=n>accurate</span> <span class=kr>for</span> <span class=n>high</span><span class=o>-</span><span class=n>cardinality</span> <span class=kd>data</span> <span class=n>sets</span> <span class=p>(</span><span class=mf>10</span><span class=n>K</span><span class=o>-</span><span class=mf>100</span><span class=n>M</span><span class=p>),</span> <span class=n>with</span> <span class=n>a</span> <span class=n>maximum</span> <span class=n>error</span> <span class=n>of</span> <span class=err>~</span><span class=mf>1.6</span><span class=err>%</span><span class=mf>.</span> <span class=n>Starting</span> <span class=n>from</span> <span class=mf>100</span><span class=n>M</span><span class=p>,</span> <span class=n>the</span> <span class=n>estimation</span> <span class=n>error</span> <span class=n>increases</span><span class=p>,</span> <span class=ow>and</span> <span class=n>the</span> <span class=n>function</span> <span class=n>will</span> <span class=kr>return</span> <span class=n>very</span> <span class=n>inaccurate</span> <span class=n>results</span> <span class=kr>for</span> <span class=kd>data</span> <span class=n>sets</span> <span class=n>with</span> <span class=n>extremely</span> <span class=n>high</span> <span class=n>cardinality</span> <span class=p>(</span><span class=mf>1</span><span class=n>B</span><span class=o>+</span> <span class=n>elements</span><span class=p>)</span><span class=mf>.</span>
</code></pre></div> </li> <li> <p>決定的な結果を提供します(クエリ処理順序に依存しません)。</p> </li> </ul> <p>この機能の使用はお勧めしません。 ほとんどの場合、 <a href=../amp/#agg_function-uniq>uniq</a> または <a href=../amp/#agg_function-uniqcombined>uniqCombined</a> 機能。</p> <p><strong>も参照。</strong></p> <ul> <li><a href=../amp/#agg_function-uniq>uniq</a></li> <li><a href=../amp/#agg_function-uniqcombined>uniqCombined</a></li> <li><a href=../amp/#agg_function-uniqexact>uniqExact</a></li> </ul> <h2 id=agg_function-uniqexact>uniqExact<a class=headerlink href=../amp/#agg_function-uniqexact title="Permanent link"> </a></h2> <p>異なる引数値の正確な数を計算します。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>uniqExact</span><span class=p>(</span><span class=n>x</span><span class=p>[,</span> <span class=p>...])</span>
</code></pre></div> <p>使用する <code class=syntax>uniqExact</code> あなたが絶対に正確な結果が必要な場合は、関数。 それ以外の場合は、 <a href=../amp/#agg_function-uniq>uniq</a> 機能。</p> <p>その <code class=syntax>uniqExact</code> 関数はより多くのメモリを使用 <code class=syntax>uniq</code>、状態の大きさは、異なる値の数が増加するにつれて無限の成長を有するからである。</p> <p><strong>パラメータ</strong></p> <p>この関数は、可変数のパラメータを取ります。 変数はあります <code class=syntax>Tuple</code>, <code class=syntax>Array</code>, <code class=syntax>Date</code>, <code class=syntax>DateTime</code>, <code class=syntax>String</code> または数値型。</p> <p><strong>も参照。</strong></p> <ul> <li><a href=../amp/#agg_function-uniq>uniq</a></li> <li><a href=../amp/#agg_function-uniqcombined>uniqCombined</a></li> <li><a href=../amp/#agg_function-uniqhll12>uniqHLL12</a></li> </ul> <h2 id=agg_function-grouparray>groupArray(x),groupArray(max_size)(x)<a class=headerlink href=../amp/#agg_function-grouparray title="Permanent link"> </a></h2> <p>引数値の配列を作成します。<br> 値は、任意の（不確定な）順序で配列に追加できます。</p> <p>第二のバージョン（と <code class=syntax>max_size</code> パラメータ)結果の配列のサイズを以下に制限します <code class=syntax>max_size</code> 要素。<br> 例えば, <code class=syntax>groupArray (1) (x)</code> に等しい。 <code class=syntax>[any (x)]</code>.</p> <p>場合によっては、実行順序に依存することもあります。 これは、次の場合に適用されます <code class=syntax>SELECT</code> を使用するサブクエリから来ています <code class=syntax>ORDER BY</code>.</p> <h2 id=grouparrayinsertat>グループパラインセルタット<a class=headerlink href=../amp/#grouparrayinsertat title="Permanent link"> </a></h2> <p>指定された位置に配列に値を挿入します。</p> <p><strong>構文</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>groupArrayInsertAt</span><span class=p>(</span><span class=n>default_x</span><span class=p>,</span> <span class=k>size</span><span class=p>)(</span><span class=n>x</span><span class=p>,</span> <span class=n>pos</span><span class=p>);</span>
</code></pre></div> <p>あるクエリで複数の値が同じ位置に挿入された場合、関数は次のように動作します:</p> <ul> <li>クエリが単一のスレッドで実行される場合、挿入された最初の値が使用されます。</li> <li>クエリが複数のスレッドで実行される場合、結果の値は挿入された値のいずれかになります。</li> </ul> <p><strong>パラメータ</strong></p> <ul> <li><code class=syntax>x</code> — Value to be inserted. <a href=../../../syntax/amp/#syntax-expressions>式</a> のいずれかになります <a href=../../../data-types/amp/ >対応するデータ型</a>.</li> <li><code class=syntax>pos</code> — Position at which the specified element <code class=syntax>x</code> 挿入されるべきです。 配列のインデックス番号はゼロから始まります。 <a href=../../../data-types/int-uint/amp/#uint-ranges>UInt32</a>.</li> <li><code class=syntax>default_x</code>— Default value for substituting in empty positions. Optional parameter. <a href=../../../syntax/amp/#syntax-expressions>式</a> その結果、データ型は <code class=syntax>x</code> パラメータ。 もし <code class=syntax>default_x</code> は定義されていない。 <a href=../../../statements/create/amp/#create-default-values>デフォルト値</a> 使用されます。</li> <li><code class=syntax>size</code>— Length of the resulting array. Optional parameter. When using this parameter, the default value <code class=syntax>default_x</code> 指定する必要があります。 <a href=../../../data-types/int-uint/amp/#uint-ranges>UInt32</a>.</li> </ul> <p><strong>戻り値</strong></p> <ul> <li>値が挿入された配列。</li> </ul> <p>タイプ: <a href=../../../data-types/array/amp/#data-type-array>配列</a>.</p> <p><strong>例</strong></p> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>groupArrayInsertAt</span><span class=p>(</span><span class=n>toString</span><span class=p>(</span><span class=nb>number</span><span class=p>),</span> <span class=nb>number</span> <span class=o>*</span> <span class=mi>2</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>5</span><span class=p>);</span>
</code></pre></div> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─groupArrayInsertAt(toString(number), multiply(number, 2))─┐
│ ['0','','1','','2','','3','','4']                         │
└───────────────────────────────────────────────────────────┘
</code></pre></div> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>groupArrayInsertAt</span><span class=p>(</span><span class=s1>'-'</span><span class=p>)(</span><span class=n>toString</span><span class=p>(</span><span class=nb>number</span><span class=p>),</span> <span class=nb>number</span> <span class=o>*</span> <span class=mi>2</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>5</span><span class=p>);</span>
</code></pre></div> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─groupArrayInsertAt('-')(toString(number), multiply(number, 2))─┐
│ ['0','-','1','-','2','-','3','-','4']                          │
└────────────────────────────────────────────────────────────────┘
</code></pre></div> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>groupArrayInsertAt</span><span class=p>(</span><span class=s1>'-'</span><span class=p>,</span> <span class=mi>5</span><span class=p>)(</span><span class=n>toString</span><span class=p>(</span><span class=nb>number</span><span class=p>),</span> <span class=nb>number</span> <span class=o>*</span> <span class=mi>2</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>5</span><span class=p>);</span>
</code></pre></div> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─groupArrayInsertAt('-', 5)(toString(number), multiply(number, 2))─┐
│ ['0','-','1','-','2']                                             │
└───────────────────────────────────────────────────────────────────┘
</code></pre></div> <p>一つの位置に要素のマルチスレッド挿入。</p> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>groupArrayInsertAt</span><span class=p>(</span><span class=nb>number</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>numbers_mt</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span> <span class=n>SETTINGS</span> <span class=n>max_block_size</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</code></pre></div> <p>このクエリの結果として、あなたはランダムな整数を取得します <code class=syntax>[0,9]</code> 範囲 例えば:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─groupArrayInsertAt(number, 0)─┐
│ [7]                           │
└───────────────────────────────┘
</code></pre></div> <h2 id=agg_function-grouparraymovingsum>グループパレイモビングスム<a class=headerlink href=../amp/#agg_function-grouparraymovingsum title="Permanent link"> </a></h2> <p>入力値の移動合計を計算します。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>groupArrayMovingSum</span><span class=p>(</span><span class=n>numbers_for_summing</span><span class=p>)</span>
<span class=n>groupArrayMovingSum</span><span class=p>(</span><span class=n>window_size</span><span class=p>)(</span><span class=n>numbers_for_summing</span><span class=p>)</span>
</code></pre></div> <p>この機能できるウィンドウサイズとしてのパラメータとします。 指定されていない場合、関数は列の行数に等しいウィンドウサイズを取ります。</p> <p><strong>パラメータ</strong></p> <ul> <li><code class=syntax>numbers_for_summing</code> — <a href=../../../syntax/amp/#syntax-expressions>式</a> 数値データ型の値になります。</li> <li><code class=syntax>window_size</code> — Size of the calculation window.</li> </ul> <p><strong>戻り値</strong></p> <ul> <li>入力データと同じサイズと型の配列。</li> </ul> <p><strong>例</strong></p> <p>サンプルテーブル:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>t</span>
<span class=p>(</span>
    <span class=o>`</span><span class=nb>int</span><span class=o>`</span> <span class=n>UInt8</span><span class=p>,</span>
    <span class=o>`</span><span class=nb>float</span><span class=o>`</span> <span class=n>Float32</span><span class=p>,</span>
    <span class=o>`</span><span class=nb>dec</span><span class=o>`</span> <span class=n>Decimal32</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
<span class=p>)</span>
<span class=n>ENGINE</span> <span class=o>=</span> <span class=n>TinyLog</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─int─┬─float─┬──dec─┐
│   1 │   1.1 │ 1.10 │
│   2 │   2.2 │ 2.20 │
│   4 │   4.4 │ 4.40 │
│   7 │  7.77 │ 7.77 │
└─────┴───────┴──────┘
</code></pre></div> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=n>groupArrayMovingSum</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span> <span class=k>AS</span> <span class=n>I</span><span class=p>,</span>
    <span class=n>groupArrayMovingSum</span><span class=p>(</span><span class=nb>float</span><span class=p>)</span> <span class=k>AS</span> <span class=n>F</span><span class=p>,</span>
    <span class=n>groupArrayMovingSum</span><span class=p>(</span><span class=nb>dec</span><span class=p>)</span> <span class=k>AS</span> <span class=n>D</span>
<span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─I──────────┬─F───────────────────────────────┬─D──────────────────────┐
│ [1,3,7,14] │ [1.1,3.3000002,7.7000003,15.47] │ [1.10,3.30,7.70,15.47] │
└────────────┴─────────────────────────────────┴────────────────────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=n>groupArrayMovingSum</span><span class=p>(</span><span class=mi>2</span><span class=p>)(</span><span class=nb>int</span><span class=p>)</span> <span class=k>AS</span> <span class=n>I</span><span class=p>,</span>
    <span class=n>groupArrayMovingSum</span><span class=p>(</span><span class=mi>2</span><span class=p>)(</span><span class=nb>float</span><span class=p>)</span> <span class=k>AS</span> <span class=n>F</span><span class=p>,</span>
    <span class=n>groupArrayMovingSum</span><span class=p>(</span><span class=mi>2</span><span class=p>)(</span><span class=nb>dec</span><span class=p>)</span> <span class=k>AS</span> <span class=n>D</span>
<span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─I──────────┬─F───────────────────────────────┬─D──────────────────────┐
│ [1,3,6,11] │ [1.1,3.3000002,6.6000004,12.17] │ [1.10,3.30,6.60,12.17] │
└────────────┴─────────────────────────────────┴────────────────────────┘
</code></pre></div> <h2 id=agg_function-grouparraymovingavg>groupArrayMovingAvg<a class=headerlink href=../amp/#agg_function-grouparraymovingavg title="Permanent link"> </a></h2> <p>入力値の移動平均を計算します。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>groupArrayMovingAvg</span><span class=p>(</span><span class=n>numbers_for_summing</span><span class=p>)</span>
<span class=n>groupArrayMovingAvg</span><span class=p>(</span><span class=n>window_size</span><span class=p>)(</span><span class=n>numbers_for_summing</span><span class=p>)</span>
</code></pre></div> <p>この機能できるウィンドウサイズとしてのパラメータとします。 指定されていない場合、関数は列の行数に等しいウィンドウサイズを取ります。</p> <p><strong>パラメータ</strong></p> <ul> <li><code class=syntax>numbers_for_summing</code> — <a href=../../../syntax/amp/#syntax-expressions>式</a> 数値データ型の値になります。</li> <li><code class=syntax>window_size</code> — Size of the calculation window.</li> </ul> <p><strong>戻り値</strong></p> <ul> <li>入力データと同じサイズと型の配列。</li> </ul> <p>この関数は <a href=https://en.wikipedia.org/wiki/Rounding#Rounding_towards_zero rel="external nofollow noreferrer" target=_blank>ゼロへの丸め</a>. 結果のデータ型の小数点以下の桁数を切り捨てます。</p> <p><strong>例</strong></p> <p>サンプルテーブル <code class=syntax>b</code>:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>t</span>
<span class=p>(</span>
    <span class=o>`</span><span class=nb>int</span><span class=o>`</span> <span class=n>UInt8</span><span class=p>,</span>
    <span class=o>`</span><span class=nb>float</span><span class=o>`</span> <span class=n>Float32</span><span class=p>,</span>
    <span class=o>`</span><span class=nb>dec</span><span class=o>`</span> <span class=n>Decimal32</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
<span class=p>)</span>
<span class=n>ENGINE</span> <span class=o>=</span> <span class=n>TinyLog</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─int─┬─float─┬──dec─┐
│   1 │   1.1 │ 1.10 │
│   2 │   2.2 │ 2.20 │
│   4 │   4.4 │ 4.40 │
│   7 │  7.77 │ 7.77 │
└─────┴───────┴──────┘
</code></pre></div> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=n>groupArrayMovingAvg</span><span class=p>(</span><span class=nb>int</span><span class=p>)</span> <span class=k>AS</span> <span class=n>I</span><span class=p>,</span>
    <span class=n>groupArrayMovingAvg</span><span class=p>(</span><span class=nb>float</span><span class=p>)</span> <span class=k>AS</span> <span class=n>F</span><span class=p>,</span>
    <span class=n>groupArrayMovingAvg</span><span class=p>(</span><span class=nb>dec</span><span class=p>)</span> <span class=k>AS</span> <span class=n>D</span>
<span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─I─────────┬─F───────────────────────────────────┬─D─────────────────────┐
│ [0,0,1,3] │ [0.275,0.82500005,1.9250001,3.8675] │ [0.27,0.82,1.92,3.86] │
└───────────┴─────────────────────────────────────┴───────────────────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=n>groupArrayMovingAvg</span><span class=p>(</span><span class=mi>2</span><span class=p>)(</span><span class=nb>int</span><span class=p>)</span> <span class=k>AS</span> <span class=n>I</span><span class=p>,</span>
    <span class=n>groupArrayMovingAvg</span><span class=p>(</span><span class=mi>2</span><span class=p>)(</span><span class=nb>float</span><span class=p>)</span> <span class=k>AS</span> <span class=n>F</span><span class=p>,</span>
    <span class=n>groupArrayMovingAvg</span><span class=p>(</span><span class=mi>2</span><span class=p>)(</span><span class=nb>dec</span><span class=p>)</span> <span class=k>AS</span> <span class=n>D</span>
<span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─I─────────┬─F────────────────────────────────┬─D─────────────────────┐
│ [0,1,3,5] │ [0.55,1.6500001,3.3000002,6.085] │ [0.55,1.65,3.30,6.08] │
└───────────┴──────────────────────────────────┴───────────────────────┘
</code></pre></div> <h2 id=groupuniqarrayx-groupuniqarraymax-sizex>groupUniqArray(x),groupUniqArray(max_size)(x)<a class=headerlink href=../amp/#groupuniqarrayx-groupuniqarraymax-sizex title="Permanent link"> </a></h2> <p>異なる引数値から配列を作成します。 メモリ消費量は <code class=syntax>uniqExact</code> 機能。</p> <p>第二のバージョン（と <code class=syntax>max_size</code> パラメータ)結果の配列のサイズを以下に制限します <code class=syntax>max_size</code> 要素。<br> 例えば, <code class=syntax>groupUniqArray(1)(x)</code> に等しい。 <code class=syntax>[any(x)]</code>.</p> <h2 id=quantile>分位数<a class=headerlink href=../amp/#quantile title="Permanent link"> </a></h2> <p>近似を計算します <a href=https://en.wikipedia.org/wiki/Quantile rel="external nofollow noreferrer" target=_blank>分位数</a> 数値データシーケンスの。</p> <p>この関数が適用されます <a href=https://en.wikipedia.org/wiki/Reservoir_sampling rel="external nofollow noreferrer" target=_blank>貯蔵所の見本抽出</a> 8192までの貯蔵所のサイズおよび見本抽出のための乱数発生器を使って。 結果は非決定的です。 正確な分位値を取得するには、次の式を使用します <a href=../amp/#quantileexact>quantileExact</a> 機能。</p> <p>複数を使用する場合 <code class=syntax>quantile*</code> クエリ内の異なるレベルを持つ関数では、内部状態は結合されません(つまり、クエリの動作ができるほど効率的ではありません)。 この場合、 <a href=../amp/#quantiles>分位数</a> 機能。</p> <p><strong>構文</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>quantile</span><span class=p>(</span><span class=k>level</span><span class=p>)(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p>別名: <code class=syntax>median</code>.</p> <p><strong>パラメータ</strong></p> <ul> <li><code class=syntax>level</code> — Level of quantile. Optional parameter. Constant floating-point number from 0 to 1. We recommend using a <code class=syntax>level</code> の範囲の値 <code class=syntax>[0.01, 0.99]</code>. デフォルト値は0.5です。 で <code class=syntax>level=0.5</code> この関数は <a href=https://en.wikipedia.org/wiki/Median rel="external nofollow noreferrer" target=_blank>中央値</a>.</li> <li><code class=syntax>expr</code> — Expression over the column values resulting in numeric <a href=../../../data-types/amp/#data_types>データ型</a>, <a href=../../../data-types/date/amp/ >日付</a> または <a href=../../../data-types/datetime/amp/ >DateTime</a>.</li> </ul> <p><strong>戻り値</strong></p> <ul> <li>指定されたレベルの近似分位値。</li> </ul> <p>タイプ:</p> <ul> <li><a href=../../../data-types/float/amp/ >Float64</a> 数値データ型入力の場合。</li> <li><a href=../../../data-types/date/amp/ >日付</a> 入力値が <code class=syntax>Date</code> タイプ。</li> <li><a href=../../../data-types/datetime/amp/ >DateTime</a> 入力値が <code class=syntax>DateTime</code> タイプ。</li> </ul> <p><strong>例</strong></p> <p>入力テーブル:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─val─┐
│   1 │
│   1 │
│   2 │
│   3 │
└─────┘
</code></pre></div> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>quantile</span><span class=p>(</span><span class=n>val</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─quantile(val)─┐
│           1.5 │
└───────────────┘
</code></pre></div> <p><strong>も参照。</strong></p> <ul> <li><a href=../amp/#median>中央値</a></li> <li><a href=../amp/#quantiles>分位数</a></li> </ul> <h2 id=quantiledeterministic>quantileDeterministic<a class=headerlink href=../amp/#quantiledeterministic title="Permanent link"> </a></h2> <p>近似を計算します <a href=https://en.wikipedia.org/wiki/Quantile rel="external nofollow noreferrer" target=_blank>分位数</a> 数値データシーケンスの。</p> <p>この関数が適用されます <a href=https://en.wikipedia.org/wiki/Reservoir_sampling rel="external nofollow noreferrer" target=_blank>貯蔵所の見本抽出</a> 貯蔵所のサイズ8192までおよび見本抽出の決定論的なアルゴリズムを使って。 結果は決定的です。 正確な分位値を取得するには、次の式を使用します <a href=../amp/#quantileexact>quantileExact</a> 機能。</p> <p>複数を使用する場合 <code class=syntax>quantile*</code> クエリ内の異なるレベルを持つ関数では、内部状態は結合されません(つまり、クエリの動作ができるほど効率的ではありません)。 この場合、 <a href=../amp/#quantiles>分位数</a> 機能。</p> <p><strong>構文</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>quantileDeterministic</span><span class=p>(</span><span class=k>level</span><span class=p>)(</span><span class=n>expr</span><span class=p>,</span> <span class=n>determinator</span><span class=p>)</span>
</code></pre></div> <p>別名: <code class=syntax>medianDeterministic</code>.</p> <p><strong>パラメータ</strong></p> <ul> <li><code class=syntax>level</code> — Level of quantile. Optional parameter. Constant floating-point number from 0 to 1. We recommend using a <code class=syntax>level</code> の範囲の値 <code class=syntax>[0.01, 0.99]</code>. デフォルト値は0.5です。 で <code class=syntax>level=0.5</code> この関数は <a href=https://en.wikipedia.org/wiki/Median rel="external nofollow noreferrer" target=_blank>中央値</a>.</li> <li><code class=syntax>expr</code> — Expression over the column values resulting in numeric <a href=../../../data-types/amp/#data_types>データ型</a>, <a href=../../../data-types/date/amp/ >日付</a> または <a href=../../../data-types/datetime/amp/ >DateTime</a>.</li> <li><code class=syntax>determinator</code> — Number whose hash is used instead of a random number generator in the reservoir sampling algorithm to make the result of sampling deterministic. As a determinator you can use any deterministic positive number, for example, a user id or an event id. If the same determinator value occures too often, the function works incorrectly.</li> </ul> <p><strong>戻り値</strong></p> <ul> <li>指定されたレベルの近似分位値。</li> </ul> <p>タイプ:</p> <ul> <li><a href=../../../data-types/float/amp/ >Float64</a> 数値データ型入力の場合。</li> <li><a href=../../../data-types/date/amp/ >日付</a> 入力値が <code class=syntax>Date</code> タイプ。</li> <li><a href=../../../data-types/datetime/amp/ >DateTime</a> 入力値が <code class=syntax>DateTime</code> タイプ。</li> </ul> <p><strong>例</strong></p> <p>入力テーブル:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─val─┐
│   1 │
│   1 │
│   2 │
│   3 │
└─────┘
</code></pre></div> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>quantileDeterministic</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─quantileDeterministic(val, 1)─┐
│                           1.5 │
└───────────────────────────────┘
</code></pre></div> <p><strong>も参照。</strong></p> <ul> <li><a href=../amp/#median>中央値</a></li> <li><a href=../amp/#quantiles>分位数</a></li> </ul> <h2 id=quantileexact>quantileExact<a class=headerlink href=../amp/#quantileexact title="Permanent link"> </a></h2> <p>正確に計算する <a href=https://en.wikipedia.org/wiki/Quantile rel="external nofollow noreferrer" target=_blank>分位数</a> 数値データシーケンスの。</p> <p>To get exact value, all the passed values ​​are combined into an array, which is then partially sorted. Therefore, the function consumes <code class=syntax>O(n)</code> メモリ、どこ <code class=syntax>n</code> 渡された値の数です。 しかし、少数の値の場合、この関数は非常に効果的です。</p> <p>複数を使用する場合 <code class=syntax>quantile*</code> クエリ内の異なるレベルを持つ関数では、内部状態は結合されません(つまり、クエリの動作ができるほど効率的ではありません)。 この場合、 <a href=../amp/#quantiles>分位数</a> 機能。</p> <p><strong>構文</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>quantileExact</span><span class=p>(</span><span class=k>level</span><span class=p>)(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p>別名: <code class=syntax>medianExact</code>.</p> <p><strong>パラメータ</strong></p> <ul> <li><code class=syntax>level</code> — Level of quantile. Optional parameter. Constant floating-point number from 0 to 1. We recommend using a <code class=syntax>level</code> の範囲の値 <code class=syntax>[0.01, 0.99]</code>. デフォルト値は0.5です。 で <code class=syntax>level=0.5</code> この関数は <a href=https://en.wikipedia.org/wiki/Median rel="external nofollow noreferrer" target=_blank>中央値</a>.</li> <li><code class=syntax>expr</code> — Expression over the column values resulting in numeric <a href=../../../data-types/amp/#data_types>データ型</a>, <a href=../../../data-types/date/amp/ >日付</a> または <a href=../../../data-types/datetime/amp/ >DateTime</a>.</li> </ul> <p><strong>戻り値</strong></p> <ul> <li>指定されたレベルの分位値。</li> </ul> <p>タイプ:</p> <ul> <li><a href=../../../data-types/float/amp/ >Float64</a> 数値データ型入力の場合。</li> <li><a href=../../../data-types/date/amp/ >日付</a> 入力値が <code class=syntax>Date</code> タイプ。</li> <li><a href=../../../data-types/datetime/amp/ >DateTime</a> 入力値が <code class=syntax>DateTime</code> タイプ。</li> </ul> <p><strong>例</strong></p> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>quantileExact</span><span class=p>(</span><span class=nb>number</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</code></pre></div> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─quantileExact(number)─┐
│                     5 │
└───────────────────────┘
</code></pre></div> <p><strong>も参照。</strong></p> <ul> <li><a href=../amp/#median>中央値</a></li> <li><a href=../amp/#quantiles>分位数</a></li> </ul> <h2 id=quantileexactweighted>quantileExactWeighted<a class=headerlink href=../amp/#quantileexactweighted title="Permanent link"> </a></h2> <p>正確に計算する <a href=https://en.wikipedia.org/wiki/Quantile rel="external nofollow noreferrer" target=_blank>分位数</a> 各要素の重みを考慮して、数値データシーケンスの重みを指定します。</p> <p>To get exact value, all the passed values ​​are combined into an array, which is then partially sorted. Each value is counted with its weight, as if it is present <code class=syntax>weight</code> times. A hash table is used in the algorithm. Because of this, if the passed values ​​are frequently repeated, the function consumes less RAM than <a href=../amp/#quantileexact>quantileExact</a>. この関数は、次の代わりに使用できます <code class=syntax>quantileExact</code> そして、重み1を指定します。</p> <p>複数を使用する場合 <code class=syntax>quantile*</code> クエリ内の異なるレベルを持つ関数では、内部状態は結合されません(つまり、クエリの動作ができるほど効率的ではありません)。 この場合、 <a href=../amp/#quantiles>分位数</a> 機能。</p> <p><strong>構文</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>quantileExactWeighted</span><span class=p>(</span><span class=k>level</span><span class=p>)(</span><span class=n>expr</span><span class=p>,</span> <span class=n>weight</span><span class=p>)</span>
</code></pre></div> <p>別名: <code class=syntax>medianExactWeighted</code>.</p> <p><strong>パラメータ</strong></p> <ul> <li><code class=syntax>level</code> — Level of quantile. Optional parameter. Constant floating-point number from 0 to 1. We recommend using a <code class=syntax>level</code> の範囲の値 <code class=syntax>[0.01, 0.99]</code>. デフォルト値は0.5です。 で <code class=syntax>level=0.5</code> この関数は <a href=https://en.wikipedia.org/wiki/Median rel="external nofollow noreferrer" target=_blank>中央値</a>.</li> <li><code class=syntax>expr</code> — Expression over the column values resulting in numeric <a href=../../../data-types/amp/#data_types>データ型</a>, <a href=../../../data-types/date/amp/ >日付</a> または <a href=../../../data-types/datetime/amp/ >DateTime</a>.</li> <li><code class=syntax>weight</code> — Column with weights of sequence members. Weight is a number of value occurrences.</li> </ul> <p><strong>戻り値</strong></p> <ul> <li>指定されたレベルの分位値。</li> </ul> <p>タイプ:</p> <ul> <li><a href=../../../data-types/float/amp/ >Float64</a> 数値データ型入力の場合。</li> <li><a href=../../../data-types/date/amp/ >日付</a> 入力値が <code class=syntax>Date</code> タイプ。</li> <li><a href=../../../data-types/datetime/amp/ >DateTime</a> 入力値が <code class=syntax>DateTime</code> タイプ。</li> </ul> <p><strong>例</strong></p> <p>入力テーブル:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─n─┬─val─┐
│ 0 │   3 │
│ 1 │   2 │
│ 2 │   1 │
│ 5 │   4 │
└───┴─────┘
</code></pre></div> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>quantileExactWeighted</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>val</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─quantileExactWeighted(n, val)─┐
│                             1 │
└───────────────────────────────┘
</code></pre></div> <p><strong>も参照。</strong></p> <ul> <li><a href=../amp/#median>中央値</a></li> <li><a href=../amp/#quantiles>分位数</a></li> </ul> <h2 id=quantiletiming>クオンタイミング<a class=headerlink href=../amp/#quantiletiming title="Permanent link"> </a></h2> <p>決定された精度では、 <a href=https://en.wikipedia.org/wiki/Quantile rel="external nofollow noreferrer" target=_blank>分位数</a> 数値データシーケンスの。</p> <p>結果は決定的です（クエリ処理順序に依存しません）。 この機能を最適化と配列における分布のような積載ウェブページではバックエンド対応。</p> <p>複数を使用する場合 <code class=syntax>quantile*</code> クエリ内の異なるレベルを持つ関数では、内部状態は結合されません(つまり、クエリの動作ができるほど効率的ではありません)。 この場合、 <a href=../amp/#quantiles>分位数</a> 機能。</p> <p><strong>構文</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>quantileTiming</span><span class=p>(</span><span class=k>level</span><span class=p>)(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p>別名: <code class=syntax>medianTiming</code>.</p> <p><strong>パラメータ</strong></p> <ul> <li> <p><code class=syntax>level</code> — Level of quantile. Optional parameter. Constant floating-point number from 0 to 1. We recommend using a <code class=syntax>level</code> の範囲の値 <code class=syntax>[0.01, 0.99]</code>. デフォルト値は0.5です。 で <code class=syntax>level=0.5</code> この関数は <a href=https://en.wikipedia.org/wiki/Median rel="external nofollow noreferrer" target=_blank>中央値</a>.</p> </li> <li> <p><code class=syntax>expr</code> — <a href=../../../syntax/amp/#syntax-expressions>式</a> aを返す列の値に対して <a href=../../../data-types/float/amp/ >フロート*</a>-タイプ番号。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=o>-</span> <span class=n>If</span> <span class=n>negative</span> <span class=n>values</span> <span class=n>are</span> <span class=n>passed</span> <span class=n>to</span> <span class=n>the</span> <span class=n>function</span><span class=p>,</span> <span class=n>the</span> <span class=n>behavior</span> <span class=k>is</span> <span class=n>undefined</span><span class=o>.</span>
<span class=o>-</span> <span class=n>If</span> <span class=n>the</span> <span class=n>value</span> <span class=k>is</span> <span class=n>greater</span> <span class=n>than</span> <span class=mi>30</span><span class=p>,</span><span class=mi>000</span> <span class=p>(</span><span class=n>a</span> <span class=n>page</span> <span class=n>loading</span> <span class=n>time</span> <span class=n>of</span> <span class=n>more</span> <span class=n>than</span> <span class=mi>30</span> <span class=n>seconds</span><span class=p>),</span> <span class=n>it</span> <span class=k>is</span> <span class=n>assumed</span> <span class=n>to</span> <span class=n>be</span> <span class=mi>30</span><span class=p>,</span><span class=mf>000.</span>
</code></pre></div> </li> </ul> <p><strong>精度</strong></p> <p>計算は次の場合に正確です:</p> <ul> <li>値の総数は5670を超えません。</li> <li>値の総数は5670を超えますが、ページの読み込み時間は1024ms未満です。</li> </ul> <p>それ以外の場合、計算の結果は16msの最も近い倍数に丸められます。</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">注</p> <p>ページの読み込み時間の分位数を計算するために、この機能はより有効、正確です <a class=alert-link href=../amp/#quantile>分位数</a>.</p> </div> <p><strong>戻り値</strong></p> <ul> <li>指定されたレベルの分位値。</li> </ul> <p>タイプ: <code class=syntax>Float32</code>.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">注</p> <p>関数に値が渡されない場合（使用する場合 <code class=syntax>quantileTimingIf</code>), <a class=alert-link href=../../../data-types/float/amp/#data_type-float-nan-inf>ナン</a> 返されます。 この目的は、これらのケースをゼロになるケースと区別することです。 見る <a class=alert-link href=../../../statements/select/order-by/amp/#select-order-by>ORDER BY句</a> ソートに関する注意事項 <code class=syntax>NaN</code> 値。</p> </div> <p><strong>例</strong></p> <p>入力テーブル:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─response_time─┐
│            72 │
│           112 │
│           126 │
│           145 │
│           104 │
│           242 │
│           313 │
│           168 │
│           108 │
└───────────────┘
</code></pre></div> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>quantileTiming</span><span class=p>(</span><span class=n>response_time</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─quantileTiming(response_time)─┐
│                           126 │
└───────────────────────────────┘
</code></pre></div> <p><strong>も参照。</strong></p> <ul> <li><a href=../amp/#median>中央値</a></li> <li><a href=../amp/#quantiles>分位数</a></li> </ul> <h2 id=quantiletimingweighted>quantitetimingweighted<a class=headerlink href=../amp/#quantiletimingweighted title="Permanent link"> </a></h2> <p>決定された精度では、 <a href=https://en.wikipedia.org/wiki/Quantile rel="external nofollow noreferrer" target=_blank>分位数</a> 各シーケンスメンバの重みに応じた数値データシーケンスの。</p> <p>結果は決定的です（クエリ処理順序に依存しません）。 この機能を最適化と配列における分布のような積載ウェブページではバックエンド対応。</p> <p>複数を使用する場合 <code class=syntax>quantile*</code> クエリ内の異なるレベルを持つ関数では、内部状態は結合されません(つまり、クエリの動作ができるほど効率的ではありません)。 この場合、 <a href=../amp/#quantiles>分位数</a> 機能。</p> <p><strong>構文</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>quantileTimingWeighted</span><span class=p>(</span><span class=k>level</span><span class=p>)(</span><span class=n>expr</span><span class=p>,</span> <span class=n>weight</span><span class=p>)</span>
</code></pre></div> <p>別名: <code class=syntax>medianTimingWeighted</code>.</p> <p><strong>パラメータ</strong></p> <ul> <li> <p><code class=syntax>level</code> — Level of quantile. Optional parameter. Constant floating-point number from 0 to 1. We recommend using a <code class=syntax>level</code> の範囲の値 <code class=syntax>[0.01, 0.99]</code>. デフォルト値は0.5です。 で <code class=syntax>level=0.5</code> この関数は <a href=https://en.wikipedia.org/wiki/Median rel="external nofollow noreferrer" target=_blank>中央値</a>.</p> </li> <li> <p><code class=syntax>expr</code> — <a href=../../../syntax/amp/#syntax-expressions>式</a> aを返す列の値に対して <a href=../../../data-types/float/amp/ >フロート*</a>-タイプ番号。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=o>-</span> <span class=n>If</span> <span class=n>negative</span> <span class=n>values</span> <span class=n>are</span> <span class=n>passed</span> <span class=n>to</span> <span class=n>the</span> <span class=n>function</span><span class=p>,</span> <span class=n>the</span> <span class=n>behavior</span> <span class=k>is</span> <span class=n>undefined</span><span class=o>.</span>
<span class=o>-</span> <span class=n>If</span> <span class=n>the</span> <span class=n>value</span> <span class=k>is</span> <span class=n>greater</span> <span class=n>than</span> <span class=mi>30</span><span class=p>,</span><span class=mi>000</span> <span class=p>(</span><span class=n>a</span> <span class=n>page</span> <span class=n>loading</span> <span class=n>time</span> <span class=n>of</span> <span class=n>more</span> <span class=n>than</span> <span class=mi>30</span> <span class=n>seconds</span><span class=p>),</span> <span class=n>it</span> <span class=k>is</span> <span class=n>assumed</span> <span class=n>to</span> <span class=n>be</span> <span class=mi>30</span><span class=p>,</span><span class=mf>000.</span>
</code></pre></div> </li> <li> <p><code class=syntax>weight</code> — Column with weights of sequence elements. Weight is a number of value occurrences.</p> </li> </ul> <p><strong>精度</strong></p> <p>計算は次の場合に正確です:</p> <ul> <li>値の総数は5670を超えません。</li> <li>値の総数は5670を超えますが、ページの読み込み時間は1024ms未満です。</li> </ul> <p>それ以外の場合、計算の結果は16msの最も近い倍数に丸められます。</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">注</p> <p>ページの読み込み時間の分位数を計算するために、この機能はより有効、正確です <a class=alert-link href=../amp/#quantile>分位数</a>.</p> </div> <p><strong>戻り値</strong></p> <ul> <li>指定されたレベルの分位値。</li> </ul> <p>タイプ: <code class=syntax>Float32</code>.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">注</p> <p>関数に値が渡されない場合（使用する場合 <code class=syntax>quantileTimingIf</code>), <a class=alert-link href=../../../data-types/float/amp/#data_type-float-nan-inf>ナン</a> 返されます。 この目的は、これらのケースをゼロになるケースと区別することです。 見る <a class=alert-link href=../../../statements/select/order-by/amp/#select-order-by>ORDER BY句</a> ソートに関する注意事項 <code class=syntax>NaN</code> 値。</p> </div> <p><strong>例</strong></p> <p>入力テーブル:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─response_time─┬─weight─┐
│            68 │      1 │
│           104 │      2 │
│           112 │      3 │
│           126 │      2 │
│           138 │      1 │
│           162 │      1 │
└───────────────┴────────┘
</code></pre></div> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>quantileTimingWeighted</span><span class=p>(</span><span class=n>response_time</span><span class=p>,</span> <span class=n>weight</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─quantileTimingWeighted(response_time, weight)─┐
│                                           112 │
└───────────────────────────────────────────────┘
</code></pre></div> <p><strong>も参照。</strong></p> <ul> <li><a href=../amp/#median>中央値</a></li> <li><a href=../amp/#quantiles>分位数</a></li> </ul> <h2 id=quantiletdigest>quantileTDigest<a class=headerlink href=../amp/#quantiletdigest title="Permanent link"> </a></h2> <p>近似を計算します <a href=https://en.wikipedia.org/wiki/Quantile rel="external nofollow noreferrer" target=_blank>分位数</a> を用いた数値データシーケンスの <a href=https://github.com/tdunning/t-digest/blob/master/docs/t-digest-paper/histo.pdf rel="external nofollow noreferrer" target=_blank>t-ダイジェスト</a> アルゴリズム</p> <p>最大誤差は1%です。 メモリ消費は <code class=syntax>log(n)</code>,ここで <code class=syntax>n</code> 値の数です。 結果は、クエリの実行順序に依存し、非決定的です。</p> <p>機能の性能はの性能より低いです <a href=../amp/#quantile>分位数</a> または <a href=../amp/#quantiletiming>クオンタイミング</a>. 状態サイズと精度の比に関しては、この関数は <code class=syntax>quantile</code>.</p> <p>複数を使用する場合 <code class=syntax>quantile*</code> クエリ内の異なるレベルを持つ関数では、内部状態は結合されません(つまり、クエリの動作ができるほど効率的ではありません)。 この場合、 <a href=../amp/#quantiles>分位数</a> 機能。</p> <p><strong>構文</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>quantileTDigest</span><span class=p>(</span><span class=k>level</span><span class=p>)(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p>別名: <code class=syntax>medianTDigest</code>.</p> <p><strong>パラメータ</strong></p> <ul> <li><code class=syntax>level</code> — Level of quantile. Optional parameter. Constant floating-point number from 0 to 1. We recommend using a <code class=syntax>level</code> の範囲の値 <code class=syntax>[0.01, 0.99]</code>. デフォルト値は0.5です。 で <code class=syntax>level=0.5</code> この関数は <a href=https://en.wikipedia.org/wiki/Median rel="external nofollow noreferrer" target=_blank>中央値</a>.</li> <li><code class=syntax>expr</code> — Expression over the column values resulting in numeric <a href=../../../data-types/amp/#data_types>データ型</a>, <a href=../../../data-types/date/amp/ >日付</a> または <a href=../../../data-types/datetime/amp/ >DateTime</a>.</li> </ul> <p><strong>戻り値</strong></p> <ul> <li>指定されたレベルの近似分位値。</li> </ul> <p>タイプ:</p> <ul> <li><a href=../../../data-types/float/amp/ >Float64</a> 数値データ型入力の場合。</li> <li><a href=../../../data-types/date/amp/ >日付</a> 入力値が <code class=syntax>Date</code> タイプ。</li> <li><a href=../../../data-types/datetime/amp/ >DateTime</a> 入力値が <code class=syntax>DateTime</code> タイプ。</li> </ul> <p><strong>例</strong></p> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>quantileTDigest</span><span class=p>(</span><span class=nb>number</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</code></pre></div> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─quantileTDigest(number)─┐
│                     4.5 │
└─────────────────────────┘
</code></pre></div> <p><strong>も参照。</strong></p> <ul> <li><a href=../amp/#median>中央値</a></li> <li><a href=../amp/#quantiles>分位数</a></li> </ul> <h2 id=quantiletdigestweighted>quantileTDigestWeighted<a class=headerlink href=../amp/#quantiletdigestweighted title="Permanent link"> </a></h2> <p>近似を計算します <a href=https://en.wikipedia.org/wiki/Quantile rel="external nofollow noreferrer" target=_blank>分位数</a> を用いた数値データシーケンスの <a href=https://github.com/tdunning/t-digest/blob/master/docs/t-digest-paper/histo.pdf rel="external nofollow noreferrer" target=_blank>t-ダイジェスト</a> アルゴリズム この関数は、各シーケンスメンバーの重みを考慮に入れます。 最大誤差は1%です。 メモリ消費は <code class=syntax>log(n)</code>,ここで <code class=syntax>n</code> 値の数です。</p> <p>機能の性能はの性能より低いです <a href=../amp/#quantile>分位数</a> または <a href=../amp/#quantiletiming>クオンタイミング</a>. 状態サイズと精度の比に関しては、この関数は <code class=syntax>quantile</code>.</p> <p>結果は、クエリの実行順序に依存し、非決定的です。</p> <p>複数を使用する場合 <code class=syntax>quantile*</code> クエリ内の異なるレベルを持つ関数では、内部状態は結合されません(つまり、クエリの動作ができるほど効率的ではありません)。 この場合、 <a href=../amp/#quantiles>分位数</a> 機能。</p> <p><strong>構文</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>quantileTDigest</span><span class=p>(</span><span class=k>level</span><span class=p>)(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p>別名: <code class=syntax>medianTDigest</code>.</p> <p><strong>パラメータ</strong></p> <ul> <li><code class=syntax>level</code> — Level of quantile. Optional parameter. Constant floating-point number from 0 to 1. We recommend using a <code class=syntax>level</code> の範囲の値 <code class=syntax>[0.01, 0.99]</code>. デフォルト値は0.5です。 で <code class=syntax>level=0.5</code> この関数は <a href=https://en.wikipedia.org/wiki/Median rel="external nofollow noreferrer" target=_blank>中央値</a>.</li> <li><code class=syntax>expr</code> — Expression over the column values resulting in numeric <a href=../../../data-types/amp/#data_types>データ型</a>, <a href=../../../data-types/date/amp/ >日付</a> または <a href=../../../data-types/datetime/amp/ >DateTime</a>.</li> <li><code class=syntax>weight</code> — Column with weights of sequence elements. Weight is a number of value occurrences.</li> </ul> <p><strong>戻り値</strong></p> <ul> <li>指定されたレベルの近似分位値。</li> </ul> <p>タイプ:</p> <ul> <li><a href=../../../data-types/float/amp/ >Float64</a> 数値データ型入力の場合。</li> <li><a href=../../../data-types/date/amp/ >日付</a> 入力値が <code class=syntax>Date</code> タイプ。</li> <li><a href=../../../data-types/datetime/amp/ >DateTime</a> 入力値が <code class=syntax>DateTime</code> タイプ。</li> </ul> <p><strong>例</strong></p> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>quantileTDigestWeighted</span><span class=p>(</span><span class=nb>number</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</code></pre></div> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─quantileTDigestWeighted(number, 1)─┐
│                                4.5 │
└────────────────────────────────────┘
</code></pre></div> <p><strong>も参照。</strong></p> <ul> <li><a href=../amp/#median>中央値</a></li> <li><a href=../amp/#quantiles>分位数</a></li> </ul> <h2 id=median>中央値<a class=headerlink href=../amp/#median title="Permanent link"> </a></h2> <p>その <code class=syntax>median*</code> 関数は、対応する関数のエイリアスです <code class=syntax>quantile*</code> 機能。 数値データサンプルの中央値を計算します。</p> <p>関数:</p> <ul> <li><code class=syntax>median</code> — Alias for <a href=../amp/#quantile>分位数</a>.</li> <li><code class=syntax>medianDeterministic</code> — Alias for <a href=../amp/#quantiledeterministic>quantileDeterministic</a>.</li> <li><code class=syntax>medianExact</code> — Alias for <a href=../amp/#quantileexact>quantileExact</a>.</li> <li><code class=syntax>medianExactWeighted</code> — Alias for <a href=../amp/#quantileexactweighted>quantileExactWeighted</a>.</li> <li><code class=syntax>medianTiming</code> — Alias for <a href=../amp/#quantiletiming>クオンタイミング</a>.</li> <li><code class=syntax>medianTimingWeighted</code> — Alias for <a href=../amp/#quantiletimingweighted>quantitetimingweighted</a>.</li> <li><code class=syntax>medianTDigest</code> — Alias for <a href=../amp/#quantiletdigest>quantileTDigest</a>.</li> <li><code class=syntax>medianTDigestWeighted</code> — Alias for <a href=../amp/#quantiletdigestweighted>quantileTDigestWeighted</a>.</li> </ul> <p><strong>例</strong></p> <p>入力テーブル:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─val─┐
│   1 │
│   1 │
│   2 │
│   3 │
└─────┘
</code></pre></div> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>medianDeterministic</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─medianDeterministic(val, 1)─┐
│                         1.5 │
└─────────────────────────────┘
</code></pre></div> <h2 id=quantiles>quantiles(level1, level2, …)(x)<a class=headerlink href=../amp/#quantiles title="Permanent link"> </a></h2> <p>すべての分位関数にも対応する分位関数があります: <code class=syntax>quantiles</code>, <code class=syntax>quantilesDeterministic</code>, <code class=syntax>quantilesTiming</code>, <code class=syntax>quantilesTimingWeighted</code>, <code class=syntax>quantilesExact</code>, <code class=syntax>quantilesExactWeighted</code>, <code class=syntax>quantilesTDigest</code>. これらの関数は、リストされたレベルのすべての分位数を一つのパスで計算し、結果の値の配列を返します。</p> <h2 id=varsampx>varSamp(x)<a class=headerlink href=../amp/#varsampx title="Permanent link"> </a></h2> <p>金額を計算します <code class=syntax>Σ((x - x̅)^2) / (n - 1)</code>,ここで <code class=syntax>n</code> はサンプルサイズであり、 <code class=syntax>x̅</code>の平均値です <code class=syntax>x</code>.</p> <p>渡された値がその標本を形成する場合、確率変数の分散の不偏推定値を表します。</p> <p>ﾂづｩﾂ。 <code class=syntax>Float64</code>. とき <code class=syntax>n &lt;= 1</code>,戻り値 <code class=syntax>+∞</code>.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">注</p> <p>この機能の利用を数値的に不安定なアルゴリズムです。 必要とすれば <a class=alert-link href=https://en.wikipedia.org/wiki/Numerical_stability rel="external nofollow noreferrer" target=_blank>数値安定性</a> 計算では、 <code class=syntax>varSampStable</code> 機能。 それは遅く動作しますが、計算誤差は低くなります。</p> </div> <h2 id=varpopx>varPop(x)<a class=headerlink href=../amp/#varpopx title="Permanent link"> </a></h2> <p>金額を計算します <code class=syntax>Σ((x - x̅)^2) / n</code>,ここで <code class=syntax>n</code> はサンプルサイズであり、 <code class=syntax>x̅</code>の平均値です <code class=syntax>x</code>.</p> <p>言い換えれば、値の集合に対する分散。 ﾂづｩﾂ。 <code class=syntax>Float64</code>.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">注</p> <p>この機能の利用を数値的に不安定なアルゴリズムです。 必要とすれば <a class=alert-link href=https://en.wikipedia.org/wiki/Numerical_stability rel="external nofollow noreferrer" target=_blank>数値安定性</a> 計算では、 <code class=syntax>varPopStable</code> 機能。 それは遅く動作しますが、計算誤差は低くなります。</p> </div> <h2 id=stddevsampx>stddevSamp(x)<a class=headerlink href=../amp/#stddevsampx title="Permanent link"> </a></h2> <p>結果はの平方根に等しくなります <code class=syntax>varSamp(x)</code>.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">注</p> <p>この機能の利用を数値的に不安定なアルゴリズムです。 必要とすれば <a class=alert-link href=https://en.wikipedia.org/wiki/Numerical_stability rel="external nofollow noreferrer" target=_blank>数値安定性</a> 計算では、 <code class=syntax>stddevSampStable</code> 機能。 それは遅く動作しますが、計算誤差は低くなります。</p> </div> <h2 id=stddevpopx>stddevPop(x)<a class=headerlink href=../amp/#stddevpopx title="Permanent link"> </a></h2> <p>結果はの平方根に等しくなります <code class=syntax>varPop(x)</code>.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">注</p> <p>この機能の利用を数値的に不安定なアルゴリズムです。 必要とすれば <a class=alert-link href=https://en.wikipedia.org/wiki/Numerical_stability rel="external nofollow noreferrer" target=_blank>数値安定性</a> 計算では、 <code class=syntax>stddevPopStable</code> 機能。 それは遅く動作しますが、計算誤差は低くなります。</p> </div> <h2 id=topknx>topK(N)(x)<a class=headerlink href=../amp/#topknx title="Permanent link"> </a></h2> <p>指定された列の中で最も頻度の高い値の配列を返します。 結果の配列は、値の近似頻度の降順でソートされます（値自体ではありません）。</p> <p>を実装する。 <a href=http://www.l2f.inesc-id.pt/~fmmb/wiki/uploads/Work/misnis.ref0a.pdf rel="external nofollow noreferrer" target=_blank>ろ過されたスペース節約</a> TopKを解析するためのアルゴリズム。 <a href=https://arxiv.org/pdf/1401.0702.pdf rel="external nofollow noreferrer" target=_blank>並列スペース節約</a>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>topK</span><span class=p>(</span><span class=n>N</span><span class=p>)(</span><span class=k>column</span><span class=p>)</span>
</code></pre></div> <p>この関数は保証された結果を提供しません。 特定の状況では、エラーが発生し、最も頻繁な値ではない頻繁な値が返されることがあります。</p> <p>私達は使用を推薦します <code class=syntax>N &lt; 10</code> 価値;性能は大きいと減ります <code class=syntax>N</code> 値。 の最大値 <code class=syntax>N = 65536</code>.</p> <p><strong>パラメータ</strong></p> <ul> <li>‘N’ 返す要素の数です。</li> </ul> <p>このパラメーターを省略すると、既定値10が使用されます。</p> <p><strong>引数</strong></p> <ul> <li>' x ' – The value to calculate frequency.</li> </ul> <p><strong>例</strong></p> <p>を取る <a href=../../../../getting-started/example-datasets/ontime/amp/ >オンタイム</a> データセットで最も頻繁に発生する三つの値を選択します。 <code class=syntax>AirlineID</code> 列。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>topK</span><span class=p>(</span><span class=mi>3</span><span class=p>)(</span><span class=n>AirlineID</span><span class=p>)</span> <span class=k>AS</span> <span class=n>res</span>
<span class=k>FROM</span> <span class=n>ontime</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─res─────────────────┐
│ [19393,19790,19805] │
└─────────────────────┘
</code></pre></div> <h2 id=topkweighted>トップウェイト<a class=headerlink href=../amp/#topkweighted title="Permanent link"> </a></h2> <p>に類似した <code class=syntax>topK</code> しかし、整数型の追加引数を取ります - <code class=syntax>weight</code>. すべての値が考慮されます <code class=syntax>weight</code> 周波数計算のための時間。</p> <p><strong>構文</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>topKWeighted</span><span class=p>(</span><span class=n>N</span><span class=p>)(</span><span class=n>x</span><span class=p>,</span> <span class=n>weight</span><span class=p>)</span>
</code></pre></div> <p><strong>パラメータ</strong></p> <ul> <li><code class=syntax>N</code> — The number of elements to return.</li> </ul> <p><strong>引数</strong></p> <ul> <li><code class=syntax>x</code> – The value.</li> <li><code class=syntax>weight</code> — The weight. <a href=../../../data-types/int-uint/amp/ >UInt8</a>.</li> </ul> <p><strong>戻り値</strong></p> <p>おおよその重みの合計が最大の値の配列を返します。</p> <p><strong>例</strong></p> <p>クエリ:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>topKWeighted</span><span class=p>(</span><span class=mi>10</span><span class=p>)(</span><span class=nb>number</span><span class=p>,</span> <span class=nb>number</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>1000</span><span class=p>)</span>
</code></pre></div> <p>結果:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─topKWeighted(10)(number, number)──────────┐
│ [999,998,997,996,995,994,993,992,991,990] │
└───────────────────────────────────────────┘
</code></pre></div> <h2 id=covarsampx-y>コバルサンプ(x,y)<a class=headerlink href=../amp/#covarsampx-y title="Permanent link"> </a></h2> <p>の値を計算します <code class=syntax>Σ((x - x̅)(y - y̅)) / (n - 1)</code>.</p> <p>Float64を返します。 とき <code class=syntax>n &lt;= 1</code>, returns +∞.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">注</p> <p>この機能の利用を数値的に不安定なアルゴリズムです。 必要とすれば <a class=alert-link href=https://en.wikipedia.org/wiki/Numerical_stability rel="external nofollow noreferrer" target=_blank>数値安定性</a> 計算では、 <code class=syntax>covarSampStable</code> 機能。 それは遅く動作しますが、計算誤差は低くなります。</p> </div> <h2 id=covarpopx-y>コバルポップ(x,y)<a class=headerlink href=../amp/#covarpopx-y title="Permanent link"> </a></h2> <p>の値を計算します <code class=syntax>Σ((x - x̅)(y - y̅)) / n</code>.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">注</p> <p>この機能の利用を数値的に不安定なアルゴリズムです。 必要とすれば <a class=alert-link href=https://en.wikipedia.org/wiki/Numerical_stability rel="external nofollow noreferrer" target=_blank>数値安定性</a> 計算では、 <code class=syntax>covarPopStable</code> 機能。 それは遅く動作しますが、計算誤差は低くなります。</p> </div> <h2 id=corrx-y>corr(x,y)<a class=headerlink href=../amp/#corrx-y title="Permanent link"> </a></h2> <p>ピアソン相関係数を計算します: <code class=syntax>Σ((x - x̅)(y - y̅)) / sqrt(Σ((x - x̅)^2) * Σ((y - y̅)^2))</code>.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">注</p> <p>この機能の利用を数値的に不安定なアルゴリズムです。 必要とすれば <a class=alert-link href=https://en.wikipedia.org/wiki/Numerical_stability rel="external nofollow noreferrer" target=_blank>数値安定性</a> 計算では、 <code class=syntax>corrStable</code> 機能。 それは遅く動作しますが、計算誤差は低くなります。</p> </div> <h2 id=categoricalinformationvalue>categoricalInformationValue<a class=headerlink href=../amp/#categoricalinformationvalue title="Permanent link"> </a></h2> <p>の値を計算します <code class=syntax>(P(tag = 1) - P(tag = 0))(log(P(tag = 1)) - log(P(tag = 0)))</code> カテゴリごとに。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>categoricalInformationValue</span><span class=p>(</span><span class=n>category1</span><span class=p>,</span> <span class=n>category2</span><span class=p>,</span> <span class=p>...,</span> <span class=n>tag</span><span class=p>)</span>
</code></pre></div> <p>結果は、離散(カテゴリカル)フィーチャの方法を示します <code class=syntax>[category1, category2, ...]</code> の値を予測する学習モデルに貢献する <code class=syntax>tag</code>.</p> <h2 id=simplelinearregression>simpleLinearRegression<a class=headerlink href=../amp/#simplelinearregression title="Permanent link"> </a></h2> <p>単純(一次元)線形回帰を実行します。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>simpleLinearRegression</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</code></pre></div> <p>パラメータ:</p> <ul> <li><code class=syntax>x</code> — Column with dependent variable values.</li> <li><code class=syntax>y</code> — Column with explanatory variable values.</li> </ul> <p>戻り値:</p> <p>定数 <code class=syntax>(a, b)</code> 結果の行の <code class=syntax>y = a*x + b</code>.</p> <p><strong>例</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayReduce</span><span class=p>(</span><span class=s1>'simpleLinearRegression'</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>])</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─arrayReduce('simpleLinearRegression', [0, 1, 2, 3], [0, 1, 2, 3])─┐
│ (1,0)                                                             │
└───────────────────────────────────────────────────────────────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>arrayReduce</span><span class=p>(</span><span class=s1>'simpleLinearRegression'</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>])</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─arrayReduce('simpleLinearRegression', [0, 1, 2, 3], [3, 4, 5, 6])─┐
│ (1,3)                                                             │
└───────────────────────────────────────────────────────────────────┘
</code></pre></div> <h2 id=agg_functions-stochasticlinearregression>stochasticLinearRegression<a class=headerlink href=../amp/#agg_functions-stochasticlinearregression title="Permanent link"> </a></h2> <p>この関数は、確率的線形回帰を実装します。 学習率、L2正則化係数、ミニバッチサイズのカスタムパラメータをサポートし、重みを更新する方法はほとんどありません (<a href=https://en.wikipedia.org/wiki/Stochastic_gradient_descent#Adam rel="external nofollow noreferrer" target=_blank>アダム</a> （デフォルトで使用), <a href=https://en.wikipedia.org/wiki/Stochastic_gradient_descent rel="external nofollow noreferrer" target=_blank>シンプルSGD</a>, <a href=https://en.wikipedia.org/wiki/Stochastic_gradient_descent#Momentum rel="external nofollow noreferrer" target=_blank>勢い</a>, <a href=https://mipt.ru/upload/medialibrary/d7e/41-91.pdf rel="external nofollow noreferrer" target=_blank>ネステロフ</a>).</p> <h3 id=agg_functions-stochasticlinearregression-parameters>パラメータ<a class=headerlink href=../amp/#agg_functions-stochasticlinearregression-parameters title="Permanent link"> </a></h3> <p>が4カスタマイズ可能パラメータ。 デフォルト値が使用されますが、良いモデルではパラメータの調整が必要です。</p> <div class=codehilite><pre><span></span><code class=syntax>stochasticLinearRegression(1.0, 1.0, 10, 'SGD')
</code></pre></div> <ol> <li><code class=syntax>learning rate</code> 勾配降下ステップを実行したときのステップ長の係数です。 大きすぎる学習率の原因となり無限の量のモデルです。 デフォルトは <code class=syntax>0.00001</code>.</li> <li><code class=syntax>l2 regularization coefficient</code> 過適合を防ぐのに役立つかもしれません。 デフォルトは <code class=syntax>0.1</code>.</li> <li><code class=syntax>mini-batch size</code> グラデーションが計算され、グラデーション降下のステップを実行するために合計される要素の数を設定します。 純粋な確率降下は一つの要素を使用しますが、小さなバッチ（約10要素）を持つと勾配ステップがより安定します。 デフォルトは <code class=syntax>15</code>.</li> <li><code class=syntax>method for updating weights</code>、彼らは: <code class=syntax>Adam</code> （デフォルトでは), <code class=syntax>SGD</code>, <code class=syntax>Momentum</code>, <code class=syntax>Nesterov</code>. <code class=syntax>Momentum</code> と <code class=syntax>Nesterov</code> もう少し多くの計算とメモリを必要とするが、収束の速度と確率勾配法の安定性の点で有用であることが起こる。</li> </ol> <h3 id=agg_functions-stochasticlinearregression-usage>使用法<a class=headerlink href=../amp/#agg_functions-stochasticlinearregression-usage title="Permanent link"> </a></h3> <p><code class=syntax>stochasticLinearRegression</code> モデルの近似と新しいデータの予測です。 モデルを適合させ、後で使用するためにその状態を保存するために、 <code class=syntax>-State</code> 基本的に状態（モデルの重みなど）を保存するcombinator。<br> 予測するには関数を使います <a href=../../../functions/machine-learning-functions/amp/#machine_learning_methods-evalmlmethod>evalMLMethod</a> は、状態を引数として取り、予測する機能も備えています。</p> <p><a name=stochasticlinearregression-usage-fitting></a></p> <p><strong>1.</strong> フィット</p> <p>このようなクエリが使用され得る。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=k>IF</span> <span class=k>NOT</span> <span class=k>EXISTS</span> <span class=n>train_data</span>
<span class=p>(</span>
    <span class=n>param1</span> <span class=n>Float64</span><span class=p>,</span>
    <span class=n>param2</span> <span class=n>Float64</span><span class=p>,</span>
    <span class=n>target</span> <span class=n>Float64</span>
<span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>Memory</span><span class=p>;</span>

<span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>your_model</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=n>Memory</span> <span class=k>AS</span> <span class=k>SELECT</span>
<span class=n>stochasticLinearRegressionState</span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=s1>'SGD'</span><span class=p>)(</span><span class=n>target</span><span class=p>,</span> <span class=n>param1</span><span class=p>,</span> <span class=n>param2</span><span class=p>)</span>
<span class=k>AS</span> <span class=k>state</span> <span class=k>FROM</span> <span class=n>train_data</span><span class=p>;</span>
</code></pre></div> <p>ここでは、データを挿入する必要もあります <code class=syntax>train_data</code> テーブル。 パラメータの数は固定されておらず、渡された引数の数にのみ依存します <code class=syntax>linearRegressionState</code>. すべて数値でなければなりません。<br> ターゲット値を持つ列（予測することを学びたい）が最初の引数として挿入されることに注意してください。</p> <p><strong>2.</strong> 予測</p> <p>テーブルに状態を保存した後、予測に複数回使用したり、他の状態とマージして新しいより良いモデルを作成したりすることもできます。</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>WITH</span> <span class=p>(</span><span class=k>SELECT</span> <span class=k>state</span> <span class=k>FROM</span> <span class=n>your_model</span><span class=p>)</span> <span class=k>AS</span> <span class=n>model</span> <span class=k>SELECT</span>
<span class=n>evalMLMethod</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>param1</span><span class=p>,</span> <span class=n>param2</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>test_data</span>
</code></pre></div> <p>クエリは予測値の列を返します。 その最初の引数に注意してください <code class=syntax>evalMLMethod</code> は <code class=syntax>AggregateFunctionState</code> オブジェクト、次はフィーチャの列です。</p> <p><code class=syntax>test_data</code> のようなテーブルです <code class=syntax>train_data</code> が含まれないことがあります。</p> <h3 id=agg_functions-stochasticlinearregression-notes>ノート<a class=headerlink href=../amp/#agg_functions-stochasticlinearregression-notes title="Permanent link"> </a></h3> <ol> <li> <p>統合モデルにはユーザーの作成などのクエリ:<br> <code class=syntax>sql SELECT state1 + state2 FROM your_models</code><br> どこに <code class=syntax>your_models</code> テーブルの両方のモデルです。 このクエリはnewを返します <code class=syntax>AggregateFunctionState</code> オブジェクト</p> </li> <li> <p>ユーザーは、作成されたモデルのウェイトを独自の目的で取得することができます。 <code class=syntax>-State</code> combinatorが使用されます。<br> <code class=syntax>sql SELECT stochasticLinearRegression(0.01)(target, param1, param2) FROM train_data</code><br> このようなクエリはモデルに適合し、その重みを返します-最初はモデルのパラメータに対応する重みであり、最後はバイアスです。 したがって、上記の例では、クエリは3つの値を持つ列を返します。</p> </li> </ol> <p><strong>も参照。</strong></p> <ul> <li><a href=../amp/#agg_functions-stochasticlogisticregression>stochasticLogisticRegression</a></li> <li><a href=https://stackoverflow.com/questions/12146914/what-is-the-difference-between-linear-regression-and-logistic-regression rel="external nofollow noreferrer" target=_blank>線形回帰とロジスティック回帰の違い</a></li> </ul> <h2 id=agg_functions-stochasticlogisticregression>stochasticLogisticRegression<a class=headerlink href=../amp/#agg_functions-stochasticlogisticregression title="Permanent link"> </a></h2> <p>この関数は、確率的ロジスティック回帰を実装します。 これは、バイナリ分類問題に使用することができ、stochasticLinearRegressionと同じカスタムパラメータをサポートし、同じように動作します。</p> <h3 id=agg_functions-stochasticlogisticregression-parameters>パラメータ<a class=headerlink href=../amp/#agg_functions-stochasticlogisticregression-parameters title="Permanent link"> </a></h3> <p>パラメーターはstochasticLinearRegressionとまったく同じです:<br> <code class=syntax>learning rate</code>, <code class=syntax>l2 regularization coefficient</code>, <code class=syntax>mini-batch size</code>, <code class=syntax>method for updating weights</code>.<br> 詳細については、 <a href=../amp/#agg_functions-stochasticlinearregression-parameters>パラメータ</a>.</p> <div class=codehilite><pre><span></span><code class=syntax>stochasticLogisticRegression(1.0, 1.0, 10, 'SGD')
</code></pre></div> <ol> <li>フィット</li> </ol> <!-- --> <div class=codehilite><pre><span></span><code class=syntax><span class=n>See</span> <span class=n>the</span> <span class="n n-Quoted">`Fitting`</span> <span class=n>section</span> <span class=k>in</span> <span class=n>the</span> <span class=err>[</span><span class=n>stochasticLinearRegression</span><span class=err>]</span><span class=p>(</span><span class=c1>#stochasticlinearregression-usage-fitting) description.</span>

<span class=n>Predicted</span> <span class=n>labels</span> <span class=n>have</span> <span class=k>to</span> <span class=n>be</span> <span class=k>in</span> <span class=err>\[</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=err>\]</span><span class=p>.</span>
</code></pre></div> <ol> <li>予測</li> </ol> <!-- --> <div class=codehilite><pre><span></span><code class=syntax><span class=k>Using</span> <span class=n>saved</span> <span class=n>state</span> <span class=n>we</span> <span class=n>can</span> <span class=n>predict</span> <span class=n>probability</span> <span class=k>of</span> <span class=n>object</span> <span class=k>having</span> <span class=n>label</span> <span class="n n-Quoted">`1`</span><span class=p>.</span>

<span class="n n-Quoted">`</span><span class="n n-Quoted n-Quoted-Escape">``</span><span class="n n-Quoted"> sql</span>
<span class="n n-Quoted">WITH (SELECT state FROM your_model) AS model SELECT</span>
<span class="n n-Quoted">evalMLMethod(model, param1, param2) FROM test_data</span>
<span class="n n-Quoted n-Quoted-Escape">``</span><span class="n n-Quoted">`</span>

<span class=n>The</span> <span class=k>query</span> <span class=n>will</span> <span class=k>return</span> <span class=n>a</span> <span class=k>column</span> <span class=k>of</span> <span class=n>probabilities</span><span class=p>.</span> <span class=n>Note</span> <span class=n>that</span> <span class=k>first</span> <span class=n>argument</span> <span class=k>of</span> <span class="n n-Quoted">`evalMLMethod`</span> <span class=k>is</span> <span class="n n-Quoted">`AggregateFunctionState`</span> <span class=n>object</span><span class=p>,</span> <span class=k>next</span> <span class=n>are</span> <span class=k>columns</span> <span class=k>of</span> <span class=n>features</span><span class=p>.</span>

<span class=n>We</span> <span class=n>can</span> <span class=n>also</span> <span class=k>set</span> <span class=n>a</span> <span class=n>bound</span> <span class=k>of</span> <span class=n>probability</span><span class=p>,</span> <span class=n>which</span> <span class=n>assigns</span> <span class=n>elements</span> <span class=k>to</span> <span class=n>different</span> <span class=n>labels</span><span class=p>.</span>

<span class="n n-Quoted">`</span><span class="n n-Quoted n-Quoted-Escape">``</span><span class="n n-Quoted"> sql</span>
<span class="n n-Quoted">SELECT ans &lt; 1.1 AND ans &gt; 0.5 FROM</span>
<span class="n n-Quoted">(WITH (SELECT state FROM your_model) AS model SELECT</span>
<span class="n n-Quoted">evalMLMethod(model, param1, param2) AS ans FROM test_data)</span>
<span class="n n-Quoted n-Quoted-Escape">``</span><span class="n n-Quoted">`</span>

<span class=k>Then</span> <span class=n>the</span> <span class=n>result</span> <span class=n>will</span> <span class=n>be</span> <span class=n>labels</span><span class=p>.</span>

<span class="n n-Quoted">`test_data`</span> <span class=k>is</span> <span class=n>a</span> <span class=k>table</span> <span class=k>like</span> <span class="n n-Quoted">`train_data`</span> <span class=n>but</span> <span class=n>may</span> <span class=k>not</span> <span class=n>contain</span> <span class=n>target</span> <span class=k>value</span><span class=p>.</span>
</code></pre></div> <p><strong>も参照。</strong></p> <ul> <li><a href=../amp/#agg_functions-stochasticlinearregression>stochasticLinearRegression</a></li> <li><a href=https://stackoverflow.com/questions/12146914/what-is-the-difference-between-linear-regression-and-logistic-regression rel="external nofollow noreferrer" target=_blank>線形回帰とロジスティック回帰の違い。</a></li> </ul> <h2 id=groupbitmapand>groupBitmapAnd<a class=headerlink href=../amp/#groupbitmapand title="Permanent link"> </a></h2> <p>ビットマップ列のANDを計算し、uint64型の基数を返します。 <a href=../../../functions/bitmap-functions/amp/ >ビットマップ</a>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>groupBitmapAnd</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p><strong>パラメータ</strong></p> <p><code class=syntax>expr</code> – An expression that results in <code class=syntax>AggregateFunction(groupBitmap, UInt*)</code> タイプ。</p> <p><strong>戻り値</strong></p> <p>の値 <code class=syntax>UInt64</code> タイプ。</p> <p><strong>例</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>DROP</span> <span class=k>TABLE</span> <span class=k>IF</span> <span class=k>EXISTS</span> <span class=n>bitmap_column_expr_test2</span><span class=p>;</span>
<span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>bitmap_column_expr_test2</span>
<span class=p>(</span>
    <span class=n>tag_id</span> <span class=n>String</span><span class=p>,</span>
    <span class=n>z</span> <span class=n>AggregateFunction</span><span class=p>(</span><span class=n>groupBitmap</span><span class=p>,</span> <span class=n>UInt32</span><span class=p>)</span>
<span class=p>)</span>
<span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=n>tag_id</span><span class=p>;</span>

<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>bitmap_column_expr_test2</span> <span class=k>VALUES</span> <span class=p>(</span><span class=s1>'tag1'</span><span class=p>,</span> <span class=n>bitmapBuild</span><span class=p>(</span><span class=k>cast</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>9</span><span class=p>,</span><span class=mi>10</span><span class=p>]</span> <span class=k>as</span> <span class=nb>Array</span><span class=p>(</span><span class=n>UInt32</span><span class=p>))));</span>
<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>bitmap_column_expr_test2</span> <span class=k>VALUES</span> <span class=p>(</span><span class=s1>'tag2'</span><span class=p>,</span> <span class=n>bitmapBuild</span><span class=p>(</span><span class=k>cast</span><span class=p>([</span><span class=mi>6</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>9</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>11</span><span class=p>,</span><span class=mi>12</span><span class=p>,</span><span class=mi>13</span><span class=p>,</span><span class=mi>14</span><span class=p>,</span><span class=mi>15</span><span class=p>]</span> <span class=k>as</span> <span class=nb>Array</span><span class=p>(</span><span class=n>UInt32</span><span class=p>))));</span>
<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>bitmap_column_expr_test2</span> <span class=k>VALUES</span> <span class=p>(</span><span class=s1>'tag3'</span><span class=p>,</span> <span class=n>bitmapBuild</span><span class=p>(</span><span class=k>cast</span><span class=p>([</span><span class=mi>2</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>12</span><span class=p>]</span> <span class=k>as</span> <span class=nb>Array</span><span class=p>(</span><span class=n>UInt32</span><span class=p>))));</span>

<span class=k>SELECT</span> <span class=n>groupBitmapAnd</span><span class=p>(</span><span class=n>z</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>bitmap_column_expr_test2</span> <span class=k>WHERE</span> <span class=k>like</span><span class=p>(</span><span class=n>tag_id</span><span class=p>,</span> <span class=s1>'tag%'</span><span class=p>);</span>
<span class=err>┌─</span><span class=n>groupBitmapAnd</span><span class=p>(</span><span class=n>z</span><span class=p>)</span><span class=err>─┐</span>
<span class=err>│</span>               <span class=mi>3</span>   <span class=err>│</span>
<span class=err>└───────────────────┘</span>

<span class=k>SELECT</span> <span class=n>arraySort</span><span class=p>(</span><span class=n>bitmapToArray</span><span class=p>(</span><span class=n>groupBitmapAndState</span><span class=p>(</span><span class=n>z</span><span class=p>)))</span> <span class=k>FROM</span> <span class=n>bitmap_column_expr_test2</span> <span class=k>WHERE</span> <span class=k>like</span><span class=p>(</span><span class=n>tag_id</span><span class=p>,</span> <span class=s1>'tag%'</span><span class=p>);</span>
<span class=err>┌─</span><span class=n>arraySort</span><span class=p>(</span><span class=n>bitmapToArray</span><span class=p>(</span><span class=n>groupBitmapAndState</span><span class=p>(</span><span class=n>z</span><span class=p>)))</span><span class=err>─┐</span>
<span class=err>│</span> <span class=p>[</span><span class=mi>6</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>10</span><span class=p>]</span>                                         <span class=err>│</span>
<span class=err>└──────────────────────────────────────────────────┘</span>
</code></pre></div> <h2 id=groupbitmapor>groupBitmapOr<a class=headerlink href=../amp/#groupbitmapor title="Permanent link"> </a></h2> <p>ビットマップ列のORを計算し、uint64型の基数を返します。 <a href=../../../functions/bitmap-functions/amp/ >ビットマップ</a>. これは <code class=syntax>groupBitmapMerge</code>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>groupBitmapOr</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p><strong>パラメータ</strong></p> <p><code class=syntax>expr</code> – An expression that results in <code class=syntax>AggregateFunction(groupBitmap, UInt*)</code> タイプ。</p> <p><strong>戻り値</strong></p> <p>の値 <code class=syntax>UInt64</code> タイプ。</p> <p><strong>例</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>DROP</span> <span class=k>TABLE</span> <span class=k>IF</span> <span class=k>EXISTS</span> <span class=n>bitmap_column_expr_test2</span><span class=p>;</span>
<span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>bitmap_column_expr_test2</span>
<span class=p>(</span>
    <span class=n>tag_id</span> <span class=n>String</span><span class=p>,</span>
    <span class=n>z</span> <span class=n>AggregateFunction</span><span class=p>(</span><span class=n>groupBitmap</span><span class=p>,</span> <span class=n>UInt32</span><span class=p>)</span>
<span class=p>)</span>
<span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=n>tag_id</span><span class=p>;</span>

<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>bitmap_column_expr_test2</span> <span class=k>VALUES</span> <span class=p>(</span><span class=s1>'tag1'</span><span class=p>,</span> <span class=n>bitmapBuild</span><span class=p>(</span><span class=k>cast</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>9</span><span class=p>,</span><span class=mi>10</span><span class=p>]</span> <span class=k>as</span> <span class=nb>Array</span><span class=p>(</span><span class=n>UInt32</span><span class=p>))));</span>
<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>bitmap_column_expr_test2</span> <span class=k>VALUES</span> <span class=p>(</span><span class=s1>'tag2'</span><span class=p>,</span> <span class=n>bitmapBuild</span><span class=p>(</span><span class=k>cast</span><span class=p>([</span><span class=mi>6</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>9</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>11</span><span class=p>,</span><span class=mi>12</span><span class=p>,</span><span class=mi>13</span><span class=p>,</span><span class=mi>14</span><span class=p>,</span><span class=mi>15</span><span class=p>]</span> <span class=k>as</span> <span class=nb>Array</span><span class=p>(</span><span class=n>UInt32</span><span class=p>))));</span>
<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>bitmap_column_expr_test2</span> <span class=k>VALUES</span> <span class=p>(</span><span class=s1>'tag3'</span><span class=p>,</span> <span class=n>bitmapBuild</span><span class=p>(</span><span class=k>cast</span><span class=p>([</span><span class=mi>2</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>12</span><span class=p>]</span> <span class=k>as</span> <span class=nb>Array</span><span class=p>(</span><span class=n>UInt32</span><span class=p>))));</span>

<span class=k>SELECT</span> <span class=n>groupBitmapOr</span><span class=p>(</span><span class=n>z</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>bitmap_column_expr_test2</span> <span class=k>WHERE</span> <span class=k>like</span><span class=p>(</span><span class=n>tag_id</span><span class=p>,</span> <span class=s1>'tag%'</span><span class=p>);</span>
<span class=err>┌─</span><span class=n>groupBitmapOr</span><span class=p>(</span><span class=n>z</span><span class=p>)</span><span class=err>─┐</span>
<span class=err>│</span>             <span class=mi>15</span>   <span class=err>│</span>
<span class=err>└──────────────────┘</span>

<span class=k>SELECT</span> <span class=n>arraySort</span><span class=p>(</span><span class=n>bitmapToArray</span><span class=p>(</span><span class=n>groupBitmapOrState</span><span class=p>(</span><span class=n>z</span><span class=p>)))</span> <span class=k>FROM</span> <span class=n>bitmap_column_expr_test2</span> <span class=k>WHERE</span> <span class=k>like</span><span class=p>(</span><span class=n>tag_id</span><span class=p>,</span> <span class=s1>'tag%'</span><span class=p>);</span>
<span class=err>┌─</span><span class=n>arraySort</span><span class=p>(</span><span class=n>bitmapToArray</span><span class=p>(</span><span class=n>groupBitmapOrState</span><span class=p>(</span><span class=n>z</span><span class=p>)))</span><span class=err>─┐</span>
<span class=err>│</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>9</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>11</span><span class=p>,</span><span class=mi>12</span><span class=p>,</span><span class=mi>13</span><span class=p>,</span><span class=mi>14</span><span class=p>,</span><span class=mi>15</span><span class=p>]</span>           <span class=err>│</span>
<span class=err>└─────────────────────────────────────────────────┘</span>
</code></pre></div> <h2 id=groupbitmapxor>groupBitmapXor<a class=headerlink href=../amp/#groupbitmapxor title="Permanent link"> </a></h2> <p>ビットマップ列のXORを計算し、uint64型の基数を返します。 <a href=../../../functions/bitmap-functions/amp/ >ビットマップ</a>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>groupBitmapOr</span><span class=p>(</span><span class=n>expr</span><span class=p>)</span>
</code></pre></div> <p><strong>パラメータ</strong></p> <p><code class=syntax>expr</code> – An expression that results in <code class=syntax>AggregateFunction(groupBitmap, UInt*)</code> タイプ。</p> <p><strong>戻り値</strong></p> <p>の値 <code class=syntax>UInt64</code> タイプ。</p> <p><strong>例</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>DROP</span> <span class=k>TABLE</span> <span class=k>IF</span> <span class=k>EXISTS</span> <span class=n>bitmap_column_expr_test2</span><span class=p>;</span>
<span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>bitmap_column_expr_test2</span>
<span class=p>(</span>
    <span class=n>tag_id</span> <span class=n>String</span><span class=p>,</span>
    <span class=n>z</span> <span class=n>AggregateFunction</span><span class=p>(</span><span class=n>groupBitmap</span><span class=p>,</span> <span class=n>UInt32</span><span class=p>)</span>
<span class=p>)</span>
<span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=n>tag_id</span><span class=p>;</span>

<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>bitmap_column_expr_test2</span> <span class=k>VALUES</span> <span class=p>(</span><span class=s1>'tag1'</span><span class=p>,</span> <span class=n>bitmapBuild</span><span class=p>(</span><span class=k>cast</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>9</span><span class=p>,</span><span class=mi>10</span><span class=p>]</span> <span class=k>as</span> <span class=nb>Array</span><span class=p>(</span><span class=n>UInt32</span><span class=p>))));</span>
<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>bitmap_column_expr_test2</span> <span class=k>VALUES</span> <span class=p>(</span><span class=s1>'tag2'</span><span class=p>,</span> <span class=n>bitmapBuild</span><span class=p>(</span><span class=k>cast</span><span class=p>([</span><span class=mi>6</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>9</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>11</span><span class=p>,</span><span class=mi>12</span><span class=p>,</span><span class=mi>13</span><span class=p>,</span><span class=mi>14</span><span class=p>,</span><span class=mi>15</span><span class=p>]</span> <span class=k>as</span> <span class=nb>Array</span><span class=p>(</span><span class=n>UInt32</span><span class=p>))));</span>
<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>bitmap_column_expr_test2</span> <span class=k>VALUES</span> <span class=p>(</span><span class=s1>'tag3'</span><span class=p>,</span> <span class=n>bitmapBuild</span><span class=p>(</span><span class=k>cast</span><span class=p>([</span><span class=mi>2</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>12</span><span class=p>]</span> <span class=k>as</span> <span class=nb>Array</span><span class=p>(</span><span class=n>UInt32</span><span class=p>))));</span>

<span class=k>SELECT</span> <span class=n>groupBitmapXor</span><span class=p>(</span><span class=n>z</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>bitmap_column_expr_test2</span> <span class=k>WHERE</span> <span class=k>like</span><span class=p>(</span><span class=n>tag_id</span><span class=p>,</span> <span class=s1>'tag%'</span><span class=p>);</span>
<span class=err>┌─</span><span class=n>groupBitmapXor</span><span class=p>(</span><span class=n>z</span><span class=p>)</span><span class=err>─┐</span>
<span class=err>│</span>              <span class=mi>10</span>   <span class=err>│</span>
<span class=err>└───────────────────┘</span>

<span class=k>SELECT</span> <span class=n>arraySort</span><span class=p>(</span><span class=n>bitmapToArray</span><span class=p>(</span><span class=n>groupBitmapXorState</span><span class=p>(</span><span class=n>z</span><span class=p>)))</span> <span class=k>FROM</span> <span class=n>bitmap_column_expr_test2</span> <span class=k>WHERE</span> <span class=k>like</span><span class=p>(</span><span class=n>tag_id</span><span class=p>,</span> <span class=s1>'tag%'</span><span class=p>);</span>
<span class=err>┌─</span><span class=n>arraySort</span><span class=p>(</span><span class=n>bitmapToArray</span><span class=p>(</span><span class=n>groupBitmapXorState</span><span class=p>(</span><span class=n>z</span><span class=p>)))</span><span class=err>─┐</span>
<span class=err>│</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>8</span><span class=p>,</span><span class=mi>10</span><span class=p>,</span><span class=mi>11</span><span class=p>,</span><span class=mi>13</span><span class=p>,</span><span class=mi>14</span><span class=p>,</span><span class=mi>15</span><span class=p>]</span>                       <span class=err>│</span>
<span class=err>└──────────────────────────────────────────────────┘</span>
</code></pre></div> <p><a href=https://clickhouse.tech/docs/en/query_language/agg_functions/reference/ target=_blank>元の記事</a> <!--hide--></p> </div> </div> <div class=row> <div class=col> <div class="alert alert-light my-3"> <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p> <span class="alert-heading display-6">Article Rating</span> <div id=rating-stars class="display-6 mb-0">RATING_STARS</div> </div> <div id=content-footer class="text-muted pt-3 mb-5"> <div class=float-md-right>©2016–2021 Yandex LLC</div> <div>Built from <a href=https://github.com/ClickHouse/ClickHouse/commit/878a159538935028f2d2dce3eb3074d44eb191df rel="external nofollow noreferrer" target=_blank class=text-reset>878a159538</a> </div> </div> </div> </div> <div id=to-full-website class="row fixed-bottom text-center bg-white py-3"> <div class=col> <a href=https://clickhouse.tech/docs/ja/sql-reference/aggregate-functions/reference/ class="btn btn-lg btn-outline-orange">To full website</a> </div> </div> </div> <amp-analytics type=metrika> <script type=application/json>{
"vars": {
  "counterId": "18343495",
  "triggers": {
    "notBounce": {
      "on": "timer",
      "timerSpec": {
        "immediate": false,
        "interval": 15,
        "maxTimerLength": 16
      },
      "request": "notBounce"
    }
  }
}
}</script> </amp-analytics> </body> </html> 