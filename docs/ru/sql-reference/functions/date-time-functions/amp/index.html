<!doctype html><html ⚡ lang=ru> <head><meta charset=utf-8><script async src=https://cdn.ampproject.org/v0.js></script><title>Функции для работы с датами и временем | Документация ClickHouse</title><link href=https://clickhouse.tech/docs/ru/sql-reference/functions/date-time-functions/ rel=canonical><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><script type=application/ld+json>[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "Функции для работы с датами и временем | Документация ClickHouse",
"mainEntityOfPage": "https://clickhouse.tech/docs/ru/sql-reference/functions/date-time-functions/",




"image": "https://clickhouse.tech/images/logo-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "Yandex LLC",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.tech/images/yandex.png",
    "width": 163,
    "height": 60
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "Функции для работы с датами и временем | Документация ClickHouse",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script><style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript><style amp-custom>:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--white:#fff;--gray:#6c757d;--gray-dark:#343a40;--primary:#007bff;--secondary:#6c757d;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f8f9fa;--dark:#343a40;--breakpoint-xs:0;--breakpoint-sm:576px;--breakpoint-md:768px;--breakpoint-lg:992px;--breakpoint-xl:1200px;--font-family-sans-serif:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,::after,::before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}article,footer{display:block}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem}p{margin-top:0;margin-bottom:1rem}ul{margin-top:0;margin-bottom:1rem}ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}b,strong{font-weight:bolder}sub{position:relative;font-size:75%;line-height:0;vertical-align:baseline}sub{bottom:-.25em}a{color:#007bff;text-decoration:none;background-color:transparent}a:hover{color:#0056b3;text-decoration:underline}a:not([href]){color:inherit;text-decoration:none}a:not([href]):hover{color:inherit;text-decoration:none}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}img{vertical-align:middle;border-style:none}svg{overflow:hidden;vertical-align:middle}table{border-collapse:collapse}th{text-align:inherit}select{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit]{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{padding:0;border-style:none}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:.5rem;font-weight:500;line-height:1.2}.h1,h1{font-size:2rem}.h2,h2{font-size:1.5rem}.h3,h3{font-size:1.25rem}.h4,h4{font-size:1rem}.h5,h5{font-size:1rem}.h6,h6{font-size:1rem}.display-1{font-size:6rem;font-weight:300;line-height:1.2}.display-2{font-size:5.5rem;font-weight:300;line-height:1.2}.display-3{font-size:4.5rem;font-weight:300;line-height:1.2}.display-4{font-size:3.5rem;font-weight:300;line-height:1.2}.img-fluid{max-width:100%;height:auto}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}pre{display:block;font-size:87.5%;color:#212529}pre code{font-size:inherit;color:inherit;word-break:normal}.container{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container{max-width:720px}}@media(min-width:992px){.container{max-width:960px}}@media(min-width:1200px){.container{max-width:1140px}}.container-fluid,.container-lg,.container-md{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container,.container-md{max-width:720px}}@media(min-width:992px){.container,.container-lg,.container-md{max-width:960px}}@media(min-width:1200px){.container,.container-lg,.container-md{max-width:1140px}}.row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-15px;margin-left:-15px}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9{position:relative;width:100%;padding-right:15px;padding-left:15px}.col{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}@media(min-width:768px){.col-md{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-md-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-md-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-md-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-md-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-md-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-md-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-md-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-md-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-md-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-md-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-md-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-md-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}}@media(min-width:992px){.col-lg{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-lg-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-lg-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-lg-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-lg-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-lg-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-lg-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-lg-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-lg-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-lg-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-lg-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-lg-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-lg-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}}.table{width:100%;margin-bottom:1rem;color:#212529}.table td,.table th{padding:.75rem;vertical-align:top;border-top:1px solid #dee2e6}.table thead th{vertical-align:bottom;border-bottom:2px solid #dee2e6}.table tbody+tbody{border-top:2px solid #dee2e6}.table-warning,.table-warning>td,.table-warning>th{background-color:#ffeeba}.table-warning tbody+tbody,.table-warning td,.table-warning th,.table-warning thead th{border-color:#ffdf7e}.table-light,.table-light>td,.table-light>th{background-color:#fdfdfe}.table-light tbody+tbody,.table-light td,.table-light th,.table-light thead th{border-color:#fbfcfc}.table-dark,.table-dark>td,.table-dark>th{background-color:#c6c8ca}.table-dark tbody+tbody,.table-dark td,.table-dark th,.table-dark thead th{border-color:#95999c}.table .thead-dark th{color:#fff;background-color:#343a40;border-color:#454d55}.table .thead-light th{color:#495057;background-color:#e9ecef;border-color:#dee2e6}.table-dark{color:#fff;background-color:#343a40}.table-dark td,.table-dark th,.table-dark thead th{border-color:#454d55}.btn{display:inline-block;font-weight:400;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:.375rem .75rem;font-size:1rem;line-height:1.5;border-radius:.25rem}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus{outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.btn:disabled{opacity:.65}.btn-warning{color:#212529;background-color:#ffc107;border-color:#ffc107}.btn-warning:hover{color:#212529;background-color:#e0a800;border-color:#d39e00}.btn-warning:focus{color:#212529;background-color:#e0a800;border-color:#d39e00;box-shadow:0 0 0 .2rem rgba(222,170,12,.5)}.btn-warning:disabled{color:#212529;background-color:#ffc107;border-color:#ffc107}.btn-light{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-light:hover{color:#212529;background-color:#e2e6ea;border-color:#dae0e5}.btn-light:focus{color:#212529;background-color:#e2e6ea;border-color:#dae0e5;box-shadow:0 0 0 .2rem rgba(216,217,219,.5)}.btn-light:disabled{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-dark{color:#fff;background-color:#343a40;border-color:#343a40}.btn-dark:hover{color:#fff;background-color:#23272b;border-color:#1d2124}.btn-dark:focus{color:#fff;background-color:#23272b;border-color:#1d2124;box-shadow:0 0 0 .2rem rgba(82,88,93,.5)}.btn-dark:disabled{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-warning{color:#ffc107;border-color:#ffc107}.btn-outline-warning:hover{color:#212529;background-color:#ffc107;border-color:#ffc107}.btn-outline-warning:focus{box-shadow:0 0 0 .2rem rgba(255,193,7,.5)}.btn-outline-warning:disabled{color:#ffc107;background-color:transparent}.btn-outline-light{color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:hover{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:focus{box-shadow:0 0 0 .2rem rgba(248,249,250,.5)}.btn-outline-light:disabled{color:#f8f9fa;background-color:transparent}.btn-outline-dark{color:#343a40;border-color:#343a40}.btn-outline-dark:hover{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-dark:focus{box-shadow:0 0 0 .2rem rgba(52,58,64,.5)}.btn-outline-dark:disabled{color:#343a40;background-color:transparent}.btn-link{font-weight:400;color:#007bff;text-decoration:none}.btn-link:hover{color:#0056b3;text-decoration:underline}.btn-link:focus{text-decoration:underline;box-shadow:none}.btn-link:disabled{color:#6c757d;pointer-events:none}.btn-lg{padding:.5rem 1rem;font-size:1.25rem;line-height:1.5;border-radius:.3rem}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:.5rem}.custom-select{display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;vertical-align:middle;background:#fff url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5' viewBox='0 0 4 5'%3e%3cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3e%3c/svg%3e") no-repeat right .75rem center/8px 10px;border:1px solid #ced4da;border-radius:.25rem;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.custom-select:focus::-ms-value{color:#495057;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #495057}.custom-select-lg{height:calc(1.5em+1rem+2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.25rem}@media(prefers-reduced-motion:reduce){.custom-select{transition:none}}.alert{position:relative;padding:.75rem 1.25rem;margin-bottom:1rem;border:1px solid transparent;border-radius:.25rem}.alert-heading{color:inherit}.alert-link{font-weight:700}.alert-warning{color:#856404;background-color:#fff3cd;border-color:#ffeeba}.alert-warning .alert-link{color:#533f03}.alert-light{color:#818182;background-color:#fefefe;border-color:#fdfdfe}.alert-light .alert-link{color:#686868}.alert-dark{color:#1b1e21;background-color:#d6d8d9;border-color:#c6c8ca}.alert-dark .alert-link{color:#040505}@-webkit-keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@-webkit-keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}@keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}.bg-warning{background-color:#ffc107}a.bg-warning:focus,a.bg-warning:hover{background-color:#d39e00}.bg-light{background-color:#f8f9fa}a.bg-light:focus,a.bg-light:hover{background-color:#dae0e5}.bg-dark{background-color:#343a40}a.bg-dark:focus,a.bg-dark:hover{background-color:#1d2124}.bg-white{background-color:#fff}.d-none{display:none}.d-inline{display:inline}.d-inline-block{display:inline-block}.d-block{display:block}.d-table{display:table}.d-table-row{display:table-row}@media(min-width:768px){.d-md-none{display:none}.d-md-inline{display:inline}.d-md-inline-block{display:inline-block}.d-md-block{display:block}.d-md-table{display:table}.d-md-table-row{display:table-row}}@media(min-width:992px){.d-lg-none{display:none}.d-lg-inline{display:inline}.d-lg-inline-block{display:inline-block}.d-lg-block{display:block}.d-lg-table{display:table}.d-lg-table-row{display:table-row}}.float-right{float:right}.float-none{float:none}@media(min-width:768px){.float-md-right{float:right}.float-md-none{float:none}}@media(min-width:992px){.float-lg-right{float:right}.float-lg-none{float:none}}.fixed-bottom{position:fixed;right:0;bottom:0;left:0;z-index:1030}.w-25{width:25%}.w-50{width:50%}.w-75{width:75%}.w-100{width:100%}.h-25{height:25%}.h-50{height:50%}.h-75{height:75%}.h-100{height:100%}.m-0{margin:0}.my-0{margin-top:0}.mr-0{margin-right:0}.mb-0,.my-0{margin-bottom:0}.m-1{margin:.25rem}.my-1{margin-top:.25rem}.mr-1{margin-right:.25rem}.mb-1,.my-1{margin-bottom:.25rem}.m-2{margin:.5rem}.my-2{margin-top:.5rem}.mr-2{margin-right:.5rem}.mb-2,.my-2{margin-bottom:.5rem}.m-3{margin:1rem}.my-3{margin-top:1rem}.mr-3{margin-right:1rem}.mb-3,.my-3{margin-bottom:1rem}.m-4{margin:1.5rem}.my-4{margin-top:1.5rem}.mr-4{margin-right:1.5rem}.mb-4,.my-4{margin-bottom:1.5rem}.m-5{margin:3rem}.my-5{margin-top:3rem}.mr-5{margin-right:3rem}.mb-5,.my-5{margin-bottom:3rem}.p-0{padding:0}.pt-0,.py-0{padding-top:0}.pb-0,.py-0{padding-bottom:0}.p-1{padding:.25rem}.pt-1,.py-1{padding-top:.25rem}.pb-1,.py-1{padding-bottom:.25rem}.p-2{padding:.5rem}.pt-2,.py-2{padding-top:.5rem}.pb-2,.py-2{padding-bottom:.5rem}.p-3{padding:1rem}.pt-3,.py-3{padding-top:1rem}.pb-3,.py-3{padding-bottom:1rem}.p-4{padding:1.5rem}.pt-4,.py-4{padding-top:1.5rem}.pb-4,.py-4{padding-bottom:1.5rem}.p-5{padding:3rem}.pt-5,.py-5{padding-top:3rem}.pb-5,.py-5{padding-bottom:3rem}.m-n1{margin:-.25rem}.my-n1{margin-top:-.25rem}.mr-n1{margin-right:-.25rem}.mb-n1,.my-n1{margin-bottom:-.25rem}.m-n2{margin:-.5rem}.my-n2{margin-top:-.5rem}.mr-n2{margin-right:-.5rem}.mb-n2,.my-n2{margin-bottom:-.5rem}.m-n3{margin:-1rem}.my-n3{margin-top:-1rem}.mr-n3{margin-right:-1rem}.mb-n3,.my-n3{margin-bottom:-1rem}.m-n4{margin:-1.5rem}.my-n4{margin-top:-1.5rem}.mr-n4{margin-right:-1.5rem}.mb-n4,.my-n4{margin-bottom:-1.5rem}.m-n5{margin:-3rem}.my-n5{margin-top:-3rem}.mr-n5{margin-right:-3rem}.mb-n5,.my-n5{margin-bottom:-3rem}@media(min-width:768px){.m-md-0{margin:0}.my-md-0{margin-top:0}.mr-md-0{margin-right:0}.mb-md-0,.my-md-0{margin-bottom:0}.m-md-1{margin:.25rem}.my-md-1{margin-top:.25rem}.mr-md-1{margin-right:.25rem}.mb-md-1,.my-md-1{margin-bottom:.25rem}.m-md-2{margin:.5rem}.my-md-2{margin-top:.5rem}.mr-md-2{margin-right:.5rem}.mb-md-2,.my-md-2{margin-bottom:.5rem}.m-md-3{margin:1rem}.my-md-3{margin-top:1rem}.mr-md-3{margin-right:1rem}.mb-md-3,.my-md-3{margin-bottom:1rem}.m-md-4{margin:1.5rem}.my-md-4{margin-top:1.5rem}.mr-md-4{margin-right:1.5rem}.mb-md-4,.my-md-4{margin-bottom:1.5rem}.m-md-5{margin:3rem}.my-md-5{margin-top:3rem}.mr-md-5{margin-right:3rem}.mb-md-5,.my-md-5{margin-bottom:3rem}.p-md-0{padding:0}.pt-md-0,.py-md-0{padding-top:0}.pb-md-0,.py-md-0{padding-bottom:0}.p-md-1{padding:.25rem}.pt-md-1,.py-md-1{padding-top:.25rem}.pb-md-1,.py-md-1{padding-bottom:.25rem}.p-md-2{padding:.5rem}.pt-md-2,.py-md-2{padding-top:.5rem}.pb-md-2,.py-md-2{padding-bottom:.5rem}.p-md-3{padding:1rem}.pt-md-3,.py-md-3{padding-top:1rem}.pb-md-3,.py-md-3{padding-bottom:1rem}.p-md-4{padding:1.5rem}.pt-md-4,.py-md-4{padding-top:1.5rem}.pb-md-4,.py-md-4{padding-bottom:1.5rem}.p-md-5{padding:3rem}.pt-md-5,.py-md-5{padding-top:3rem}.pb-md-5,.py-md-5{padding-bottom:3rem}.m-md-n1{margin:-.25rem}.my-md-n1{margin-top:-.25rem}.mr-md-n1{margin-right:-.25rem}.mb-md-n1,.my-md-n1{margin-bottom:-.25rem}.m-md-n2{margin:-.5rem}.my-md-n2{margin-top:-.5rem}.mr-md-n2{margin-right:-.5rem}.mb-md-n2,.my-md-n2{margin-bottom:-.5rem}.m-md-n3{margin:-1rem}.my-md-n3{margin-top:-1rem}.mr-md-n3{margin-right:-1rem}.mb-md-n3,.my-md-n3{margin-bottom:-1rem}.m-md-n4{margin:-1.5rem}.my-md-n4{margin-top:-1.5rem}.mr-md-n4{margin-right:-1.5rem}.mb-md-n4,.my-md-n4{margin-bottom:-1.5rem}.m-md-n5{margin:-3rem}.my-md-n5{margin-top:-3rem}.mr-md-n5{margin-right:-3rem}.mb-md-n5,.my-md-n5{margin-bottom:-3rem}}@media(min-width:992px){.m-lg-0{margin:0}.my-lg-0{margin-top:0}.mr-lg-0{margin-right:0}.mb-lg-0,.my-lg-0{margin-bottom:0}.m-lg-1{margin:.25rem}.my-lg-1{margin-top:.25rem}.mr-lg-1{margin-right:.25rem}.mb-lg-1,.my-lg-1{margin-bottom:.25rem}.m-lg-2{margin:.5rem}.my-lg-2{margin-top:.5rem}.mr-lg-2{margin-right:.5rem}.mb-lg-2,.my-lg-2{margin-bottom:.5rem}.m-lg-3{margin:1rem}.my-lg-3{margin-top:1rem}.mr-lg-3{margin-right:1rem}.mb-lg-3,.my-lg-3{margin-bottom:1rem}.m-lg-4{margin:1.5rem}.my-lg-4{margin-top:1.5rem}.mr-lg-4{margin-right:1.5rem}.mb-lg-4,.my-lg-4{margin-bottom:1.5rem}.m-lg-5{margin:3rem}.my-lg-5{margin-top:3rem}.mr-lg-5{margin-right:3rem}.mb-lg-5,.my-lg-5{margin-bottom:3rem}.p-lg-0{padding:0}.pt-lg-0,.py-lg-0{padding-top:0}.pb-lg-0,.py-lg-0{padding-bottom:0}.p-lg-1{padding:.25rem}.pt-lg-1,.py-lg-1{padding-top:.25rem}.pb-lg-1,.py-lg-1{padding-bottom:.25rem}.p-lg-2{padding:.5rem}.pt-lg-2,.py-lg-2{padding-top:.5rem}.pb-lg-2,.py-lg-2{padding-bottom:.5rem}.p-lg-3{padding:1rem}.pt-lg-3,.py-lg-3{padding-top:1rem}.pb-lg-3,.py-lg-3{padding-bottom:1rem}.p-lg-4{padding:1.5rem}.pt-lg-4,.py-lg-4{padding-top:1.5rem}.pb-lg-4,.py-lg-4{padding-bottom:1.5rem}.p-lg-5{padding:3rem}.pt-lg-5,.py-lg-5{padding-top:3rem}.pb-lg-5,.py-lg-5{padding-bottom:3rem}.m-lg-n1{margin:-.25rem}.my-lg-n1{margin-top:-.25rem}.mr-lg-n1{margin-right:-.25rem}.mb-lg-n1,.my-lg-n1{margin-bottom:-.25rem}.m-lg-n2{margin:-.5rem}.my-lg-n2{margin-top:-.5rem}.mr-lg-n2{margin-right:-.5rem}.mb-lg-n2,.my-lg-n2{margin-bottom:-.5rem}.m-lg-n3{margin:-1rem}.my-lg-n3{margin-top:-1rem}.mr-lg-n3{margin-right:-1rem}.mb-lg-n3,.my-lg-n3{margin-bottom:-1rem}.m-lg-n4{margin:-1.5rem}.my-lg-n4{margin-top:-1.5rem}.mr-lg-n4{margin-right:-1.5rem}.mb-lg-n4,.my-lg-n4{margin-bottom:-1.5rem}.m-lg-n5{margin:-3rem}.my-lg-n5{margin-top:-3rem}.mr-lg-n5{margin-right:-3rem}.mb-lg-n5,.my-lg-n5{margin-bottom:-3rem}}.text-right{text-align:right}.text-center{text-align:center}@media(min-width:768px){.text-md-right{text-align:right}.text-md-center{text-align:center}}@media(min-width:992px){.text-lg-right{text-align:right}.text-lg-center{text-align:center}}.text-white{color:#fff}.text-warning{color:#ffc107}a.text-warning:focus,a.text-warning:hover{color:#ba8b00}.text-light{color:#f8f9fa}a.text-light:focus,a.text-light:hover{color:#cbd3da}.text-dark{color:#343a40}a.text-dark:focus,a.text-dark:hover{color:#121416}.text-body{color:#212529}.text-muted{color:#6c757d}.text-black-50{color:rgba(0,0,0,.5)}.text-white-50{color:rgba(255,255,255,.5)}.text-hide{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;border:0}.text-decoration-none{text-decoration:none}.text-reset{color:inherit}.visible{visibility:visible}@media print{*,::after,::before{text-shadow:none;box-shadow:none}a:not(.btn){text-decoration:underline}pre{white-space:pre-wrap}pre{border:1px solid #adb5bd;page-break-inside:avoid}thead{display:table-header-group}img,tr{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}body{min-width:992px}.container{min-width:992px}.table{border-collapse:collapse}.table td,.table th{background-color:#fff}.table-dark{color:inherit}.table-dark tbody+tbody,.table-dark td,.table-dark th,.table-dark thead th{border-color:#dee2e6}.table .thead-dark th{color:inherit;border-color:#dee2e6}}@-webkit-keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}@keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"}a:link,a:visited{color:#f14600;text-decoration:none}a:active,a:hover{text-decoration:underline}.btn:disabled{cursor:default;opacity:.4}#logo-text{width:180px;margin-left:12px}.display-5{font-size:2rem;font-weight:300;line-height:1.2}.display-6{font-size:1.75rem;font-weight:300;line-height:1.2}.bg-dark-alt,.bg-dark-alt:focus{background:#36363f}.bg-orange,.bg-orange:focus{background:#f14600}.text-dark-alt{color:#36363f}.btn-dark-alt{background:#36363f}.btn-dark-alt:focus{background:#36363f}.btn-outline-orange{border-color:#f14600;color:#f14600}.btn-orange,.btn-outline-orange:hover{background:#f14600;color:#fff}.btn:active,.btn:hover{text-decoration:none}.text-orange{color:#f14600}.w-15{width:15%}.headerlink{text-decoration:none;margin-left:.5rem}#content table{border:1px solid #dee2e6;width:100%;margin-bottom:1rem;overflow-x:auto}#content thead{background:#444451;color:#fff}#content td,#content th{padding:.75rem;vertical-align:top}#content td{border:1px solid #dee2e6}#content th{border:1px solid #444451}#content code{color:#000;background:#eee;padding:.125rem .25rem}#content code.syntax{padding:0}#content pre{background:#efefef;padding:1rem;line-height:1.25}@media print{body{min-width:0}code,h1,h2,h3,h4,h5,h6,img,li,p,pre,td,th,thead,tr{page-break-inside:avoid}}@media(prefers-color-scheme:dark){#to-full-website,body.amp,body[data-spy]{background:#1c1c1c;color:#efefef}.invert-dark{filter:invert(100%)}#content table{border:1px solid #2a2b2c}#content thead{background:#333}#content td{border:1px solid #444451}#content code{background:#444;color:#eee;padding:.125rem .25rem}#content pre{background:#444;color:#eee}}.syntax{background:#f8f9fa;color:#2f1e2e}.syntax .c{color:#8d8687}.syntax .k{color:#000;font-weight:700}.syntax .n{color:#2f1e2e}.syntax .o{color:#800}.syntax .p{color:#2f1e2e}.syntax .c1{color:#8d8687}.syntax .ld{color:#48b685}.syntax .m{color:#08f}.syntax .s{color:#48b685}.syntax .nb{color:#2f1e2e}.syntax .py{color:#2f1e2e}.syntax .w{color:#2f1e2e}.syntax .mi{color:#08f}.syntax .s2{color:#48b685}.syntax .s1{color:#080}.syntax .ss{color:#48b685}@media(prefers-color-scheme:dark){.syntax .k{color:#c78cff}.syntax .ld{color:#64ffbb}.syntax .s{color:#64ffbb}.syntax .s2{color:#64ffbb}.syntax .s1{color:#64ffbb}.syntax .ss{color:#64ffbb}.syntax .c{color:#64ffbb}.syntax .n{color:#f8f9fa}.syntax .p{color:#f8f9fa}.syntax .nb{color:#f8f9fa}.syntax .py{color:#f8f9fa}.syntax .w{color:#f8f9fa}}</style><script async custom-element=amp-analytics src=https://cdn.ampproject.org/v0/amp-analytics-0.1.js></script><script async custom-element=amp-iframe src=https://cdn.ampproject.org/v0/amp-iframe-0.1.js></script></head> <body class=amp dir=ltr> <div class="container-fluid container-lg pb-5"> <div class="row pt-3 mb-3"> <div class=col> <a href=/ class=text-decoration-none> <amp-img class="d-inline-block mr-3" layout=fixed width=40 height=36 src=/images/logo.svg alt="ClickHouse logo" title="ClickHouse logo"></amp-img><amp-img class="invert-dark d-inline-block" layout=fixed width=238 height=36 src=/images/clickhouse-black.svg alt=ClickHouse title=ClickHouse></amp-img> </a> </div> </div> <div class=row> <div id=content class=col> <h1 id=funktsii-dlia-raboty-s-datami-i-vremenem>Функции для работы с датами и временем<a class=headerlink href=../amp/#funktsii-dlia-raboty-s-datami-i-vremenem title="Permanent link"> </a></h1> <p>Поддержка часовых поясов</p> <p>Все функции по работе с датой и временем, для которых это имеет смысл, могут принимать второй, необязательный аргумент - имя часового пояса. Пример: Asia/Yekaterinburg. В этом случае, они используют не локальный часовой пояс (по умолчанию), а указанный.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=n>toDateTime</span><span class=p>(</span><span class=s1>'2016-06-15 23:00:00'</span><span class=p>)</span> <span class=k>AS</span> <span class=n>time</span><span class=p>,</span>
    <span class=n>toDate</span><span class=p>(</span><span class=n>time</span><span class=p>)</span> <span class=k>AS</span> <span class=n>date_local</span><span class=p>,</span>
    <span class=n>toDate</span><span class=p>(</span><span class=n>time</span><span class=p>,</span> <span class=s1>'Asia/Yekaterinburg'</span><span class=p>)</span> <span class=k>AS</span> <span class=n>date_yekat</span><span class=p>,</span>
    <span class=n>toString</span><span class=p>(</span><span class=n>time</span><span class=p>,</span> <span class=s1>'US/Samoa'</span><span class=p>)</span> <span class=k>AS</span> <span class=n>time_samoa</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌────────────────time─┬─date_local─┬─date_yekat─┬─time_samoa──────────┐
│ 2016-06-15 23:00:00 │ 2016-06-15 │ 2016-06-16 │ 2016-06-15 09:00:00 │
└─────────────────────┴────────────┴────────────┴─────────────────────┘
</code></pre></div> <h2 id=totimezone>toTimeZone<a class=headerlink href=../amp/#totimezone title="Permanent link"> </a></h2> <p>Переводит дату или дату-с-временем в указанный часовой пояс. Часовой пояс (таймзона) это атрибут типов Date/DateTime, внутреннее значение (количество секунд) поля таблицы или колонки результата не изменяется, изменяется тип поля и автоматически его текстовое отображение.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=n>toDateTime</span><span class=p>(</span><span class=s1>'2019-01-01 00:00:00'</span><span class=p>,</span> <span class=s1>'UTC'</span><span class=p>)</span> <span class=k>AS</span> <span class=n>time_utc</span><span class=p>,</span>
    <span class=n>toTypeName</span><span class=p>(</span><span class=n>time_utc</span><span class=p>)</span> <span class=k>AS</span> <span class=n>type_utc</span><span class=p>,</span>
    <span class=n>toInt32</span><span class=p>(</span><span class=n>time_utc</span><span class=p>)</span> <span class=k>AS</span> <span class=n>int32utc</span><span class=p>,</span>
    <span class=n>toTimeZone</span><span class=p>(</span><span class=n>time_utc</span><span class=p>,</span> <span class=s1>'Asia/Yekaterinburg'</span><span class=p>)</span> <span class=k>AS</span> <span class=n>time_yekat</span><span class=p>,</span>
    <span class=n>toTypeName</span><span class=p>(</span><span class=n>time_yekat</span><span class=p>)</span> <span class=k>AS</span> <span class=n>type_yekat</span><span class=p>,</span>
    <span class=n>toInt32</span><span class=p>(</span><span class=n>time_yekat</span><span class=p>)</span> <span class=k>AS</span> <span class=n>int32yekat</span><span class=p>,</span>
    <span class=n>toTimeZone</span><span class=p>(</span><span class=n>time_utc</span><span class=p>,</span> <span class=s1>'US/Samoa'</span><span class=p>)</span> <span class=k>AS</span> <span class=n>time_samoa</span><span class=p>,</span>
    <span class=n>toTypeName</span><span class=p>(</span><span class=n>time_samoa</span><span class=p>)</span> <span class=k>AS</span> <span class=n>type_samoa</span><span class=p>,</span>
    <span class=n>toInt32</span><span class=p>(</span><span class=n>time_samoa</span><span class=p>)</span> <span class=k>AS</span> <span class=n>int32samoa</span>
<span class=n>FORMAT</span> <span class=n>Vertical</span><span class=p>;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>Row 1:
──────
time_utc:   2019-01-01 00:00:00
type_utc:   DateTime('UTC')
int32utc:   1546300800
time_yekat: 2019-01-01 05:00:00
type_yekat: DateTime('Asia/Yekaterinburg')
int32yekat: 1546300800
time_samoa: 2018-12-31 13:00:00
type_samoa: DateTime('US/Samoa')
int32samoa: 1546300800
</code></pre></div> <p><code class=syntax>toTimeZone(time_utc, 'Asia/Yekaterinburg')</code> изменяет тип <code class=syntax>DateTime('UTC')</code> в <code class=syntax>DateTime('Asia/Yekaterinburg')</code>. Значение (unix-время) 1546300800 остается неизменным, но текстовое отображение (результат функции toString()) меняется <code class=syntax>time_utc: 2019-01-01 00:00:00</code> в <code class=syntax>time_yekat: 2019-01-01 05:00:00</code>.</p> <h2 id=toyear>toYear<a class=headerlink href=../amp/#toyear title="Permanent link"> </a></h2> <p>Переводит дату или дату-с-временем в число типа UInt16, содержащее номер года (AD).</p> <p>Синоним: <code class=syntax>YEAR</code>.</p> <h2 id=toquarter>toQuarter<a class=headerlink href=../amp/#toquarter title="Permanent link"> </a></h2> <p>Переводит дату или дату-с-временем в число типа UInt8, содержащее номер квартала.</p> <p>Синоним: <code class=syntax>QUARTER</code>.</p> <h2 id=tomonth>toMonth<a class=headerlink href=../amp/#tomonth title="Permanent link"> </a></h2> <p>Переводит дату или дату-с-временем в число типа UInt8, содержащее номер месяца (1-12).</p> <p>Синоним: <code class=syntax>MONTH</code>.</p> <h2 id=todayofyear>toDayOfYear<a class=headerlink href=../amp/#todayofyear title="Permanent link"> </a></h2> <p>Переводит дату или дату-с-временем в число типа UInt16, содержащее номер дня года (1-366).</p> <p>Синоним: <code class=syntax>DAYOFYEAR</code>.</p> <h2 id=todayofmonth>toDayOfMonth<a class=headerlink href=../amp/#todayofmonth title="Permanent link"> </a></h2> <p>Переводит дату или дату-с-временем в число типа UInt8, содержащее номер дня в месяце (1-31).</p> <p>Синонимы: <code class=syntax>DAYOFMONTH</code>, <code class=syntax>DAY</code>.</p> <h2 id=todayofweek>toDayOfWeek<a class=headerlink href=../amp/#todayofweek title="Permanent link"> </a></h2> <p>Переводит дату или дату-с-временем в число типа UInt8, содержащее номер дня в неделе (понедельник - 1, воскресенье - 7).</p> <p>Синоним: <code class=syntax>DAYOFWEEK</code>.</p> <h2 id=tohour>toHour<a class=headerlink href=../amp/#tohour title="Permanent link"> </a></h2> <p>Переводит дату-с-временем в число типа UInt8, содержащее номер часа в сутках (0-23).<br> Функция исходит из допущения, что перевод стрелок вперёд, если осуществляется, то на час, в два часа ночи, а перевод стрелок назад, если осуществляется, то на час, в три часа ночи (что, в общем, не верно - даже в Москве два раза перевод стрелок был осуществлён в другое время).</p> <p>Синоним: <code class=syntax>HOUR</code>.</p> <h2 id=tominute>toMinute<a class=headerlink href=../amp/#tominute title="Permanent link"> </a></h2> <p>Переводит дату-с-временем в число типа UInt8, содержащее номер минуты в часе (0-59).</p> <p>Синоним: <code class=syntax>MINUTE</code>.</p> <h2 id=tosecond>toSecond<a class=headerlink href=../amp/#tosecond title="Permanent link"> </a></h2> <p>Переводит дату-с-временем в число типа UInt8, содержащее номер секунды в минуте (0-59).<br> Секунды координации не учитываются.</p> <p>Синоним: <code class=syntax>SECOND</code>.</p> <h2 id=to-unix-timestamp>toUnixTimestamp<a class=headerlink href=../amp/#to-unix-timestamp title="Permanent link"> </a></h2> <p>Переводит дату-с-временем в число типа UInt32 -- Unix Timestamp (<a href=https://en.wikipedia.org/wiki/Unix_time target=_blank>https://en.wikipedia.org/wiki/Unix_time</a>).<br> Для аргумента String, строка конвертируется в дату и время в соответствии с часовым поясом (необязательный второй аргумент, часовой пояс сервера используется по умолчанию).</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>toUnixTimestamp</span><span class=p>(</span><span class=n>datetime</span><span class=p>)</span>
<span class=n>toUnixTimestamp</span><span class=p>(</span><span class=n>str</span><span class=p>,</span> <span class=p>[</span><span class=n>timezone</span><span class=p>])</span>
</code></pre></div> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Возвращает Unix Timestamp.</li> </ul> <p>Тип: <code class=syntax>UInt32</code>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>toUnixTimestamp</span><span class=p>(</span><span class=s1>'2017-11-05 08:07:47'</span><span class=p>,</span> <span class=s1>'Asia/Tokyo'</span><span class=p>)</span> <span class=k>AS</span> <span class=n>unix_timestamp</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─unix_timestamp─┐
│     1509836867 │
└────────────────┘
</code></pre></div> <h2 id=tostartofyear>toStartOfYear<a class=headerlink href=../amp/#tostartofyear title="Permanent link"> </a></h2> <p>Округляет дату или дату-с-временем вниз до первого дня года.<br> Возвращается дата.</p> <h2 id=tostartofisoyear>toStartOfISOYear<a class=headerlink href=../amp/#tostartofisoyear title="Permanent link"> </a></h2> <p>Округляет дату или дату-с-временем вниз до первого дня ISO года. Возвращается дата.<br> Начало ISO года отличается от начала обычного года, потому что в соответствии с <a href=https://en.wikipedia.org/wiki/ISO_8601 rel="external nofollow noreferrer" target=_blank>ISO 8601:1988</a> первая неделя года - это неделя с четырьмя или более днями в этом году.</p> <p>1 Января 2017 г. - воскресение, т.е. первая ISO неделя 2017 года началась в понедельник 2 января, поэтому 1 января 2017 это 2016 ISO-год, который начался 2016-01-04.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>toStartOfISOYear</span><span class=p>(</span><span class=n>toDate</span><span class=p>(</span><span class=s1>'2017-01-01'</span><span class=p>))</span> <span class=k>AS</span> <span class=n>ISOYear20170101</span><span class=p>;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─ISOYear20170101─┐
│      2016-01-04 │
└─────────────────┘
</code></pre></div> <h2 id=tostartofquarter>toStartOfQuarter<a class=headerlink href=../amp/#tostartofquarter title="Permanent link"> </a></h2> <p>Округляет дату или дату-с-временем вниз до первого дня квартала.<br> Первый день квартала - это одно из 1 января, 1 апреля, 1 июля, 1 октября.<br> Возвращается дата.</p> <h2 id=tostartofmonth>toStartOfMonth<a class=headerlink href=../amp/#tostartofmonth title="Permanent link"> </a></h2> <p>Округляет дату или дату-с-временем вниз до первого дня месяца.<br> Возвращается дата.</p> <div class="admonition attention alert pb-0 mb-4 alert-warning" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Attention</p> <p>Возвращаемое значение для некорректных дат зависит от реализации. ClickHouse может вернуть нулевую дату, выбросить исключение, или выполнить «естественное» перетекание дат между месяцами.</p> </div> <h2 id=tomonday>toMonday<a class=headerlink href=../amp/#tomonday title="Permanent link"> </a></h2> <p>Округляет дату или дату-с-временем вниз до ближайшего понедельника.<br> Возвращается дата.</p> <h2 id=tostartofweek>toStartOfWeek(t[,mode])<a class=headerlink href=../amp/#tostartofweek title="Permanent link"> </a></h2> <p>Округляет дату или дату со временем до ближайшего воскресенья или понедельника в соответствии с mode.<br> Возвращается дата.<br> Аргумент mode работает точно так же, как аргумент mode <a href=../amp/#toweek>toWeek()</a>. Если аргумент mode опущен, то используется режим 0.</p> <h2 id=tostartofday>toStartOfDay<a class=headerlink href=../amp/#tostartofday title="Permanent link"> </a></h2> <p>Округляет дату-с-временем вниз до начала дня. Возвращается дата-с-временем.</p> <h2 id=tostartofhour>toStartOfHour<a class=headerlink href=../amp/#tostartofhour title="Permanent link"> </a></h2> <p>Округляет дату-с-временем вниз до начала часа.</p> <h2 id=tostartofminute>toStartOfMinute<a class=headerlink href=../amp/#tostartofminute title="Permanent link"> </a></h2> <p>Округляет дату-с-временем вниз до начала минуты.</p> <h2 id=tostartofsecond>toStartOfSecond<a class=headerlink href=../amp/#tostartofsecond title="Permanent link"> </a></h2> <p>Отсекает доли секунды.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>toStartOfSecond</span><span class=p>(</span><span class=n>value</span><span class=p>[,</span> <span class=n>timezone</span><span class=p>])</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>value</code> — Дата и время. <a href=../../../data-types/datetime64/amp/ >DateTime64</a>.</li> <li><code class=syntax>timezone</code> — <a href=../../../../operations/server-configuration-parameters/settings/amp/#server_configuration_parameters-timezone>Часовой пояс</a> для возвращаемого значения (необязательно). Если параметр не задан, используется часовой пояс параметра <code class=syntax>value</code>. <a href=../../../data-types/string/amp/ >String</a>. </li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Входное значение с отсеченными долями секунды.</li> </ul> <p>Тип: <a href=../../../data-types/datetime64/amp/ >DateTime64</a>.</p> <p><strong>Примеры</strong></p> <p>Пример без часового пояса:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>WITH</span> <span class=n>toDateTime64</span><span class=p>(</span><span class=s1>'2020-01-01 10:20:30.999'</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span> <span class=k>AS</span> <span class=n>dt64</span> <span class=k>SELECT</span> <span class=n>toStartOfSecond</span><span class=p>(</span><span class=n>dt64</span><span class=p>);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌───toStartOfSecond(dt64)─┐
│ 2020-01-01 10:20:30.000 │
└─────────────────────────┘
</code></pre></div> <p>Пример с часовым поясом:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>WITH</span> <span class=n>toDateTime64</span><span class=p>(</span><span class=s1>'2020-01-01 10:20:30.999'</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span> <span class=k>AS</span> <span class=n>dt64</span> <span class=k>SELECT</span> <span class=n>toStartOfSecond</span><span class=p>(</span><span class=n>dt64</span><span class=p>,</span> <span class=s1>'Europe/Moscow'</span><span class=p>);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─toStartOfSecond(dt64, 'Europe/Moscow')─┐
│                2020-01-01 13:20:30.000 │
└────────────────────────────────────────┘
</code></pre></div> <p><strong>См. также</strong></p> <ul> <li>Часовая зона сервера, конфигурационный параметр <a href=../../../../operations/server-configuration-parameters/settings/amp/#server_configuration_parameters-timezone>timezone</a>.</li> </ul> <h2 id=tostartoffiveminute>toStartOfFiveMinute<a class=headerlink href=../amp/#tostartoffiveminute title="Permanent link"> </a></h2> <p>Округляет дату-с-временем вниз до начала пятиминутного интервала.</p> <h2 id=tostartoftenminutes>toStartOfTenMinutes<a class=headerlink href=../amp/#tostartoftenminutes title="Permanent link"> </a></h2> <p>Округляет дату-с-временем вниз до начала десятиминутного интервала.</p> <h2 id=tostartoffifteenminutes>toStartOfFifteenMinutes<a class=headerlink href=../amp/#tostartoffifteenminutes title="Permanent link"> </a></h2> <p>Округляет дату-с-временем вниз до начала пятнадцатиминутного интервала.</p> <h2 id=tostartofintervaltime-or-data-interval-x-unit-time-zone>toStartOfInterval(time_or_data, INTERVAL x unit [, time_zone])<a class=headerlink href=../amp/#tostartofintervaltime-or-data-interval-x-unit-time-zone title="Permanent link"> </a></h2> <p>Обобщение остальных функций <code class=syntax>toStartOf*</code>. Например,<br> <code class=syntax>toStartOfInterval(t, INTERVAL 1 year)</code> возвращает то же самое, что и <code class=syntax>toStartOfYear(t)</code>,<br> <code class=syntax>toStartOfInterval(t, INTERVAL 1 month)</code> возвращает то же самое, что и <code class=syntax>toStartOfMonth(t)</code>,<br> <code class=syntax>toStartOfInterval(t, INTERVAL 1 day)</code> возвращает то же самое, что и <code class=syntax>toStartOfDay(t)</code>,<br> <code class=syntax>toStartOfInterval(t, INTERVAL 15 minute)</code> возвращает то же самое, что и <code class=syntax>toStartOfFifteenMinutes(t)</code>, и т.п.</p> <h2 id=totime>toTime<a class=headerlink href=../amp/#totime title="Permanent link"> </a></h2> <p>Переводит дату-с-временем на некоторую фиксированную дату, сохраняя при этом время.</p> <h2 id=torelativeyearnum>toRelativeYearNum<a class=headerlink href=../amp/#torelativeyearnum title="Permanent link"> </a></h2> <p>Переводит дату-с-временем или дату в номер года, начиная с некоторого фиксированного момента в прошлом.</p> <h2 id=torelativequarternum>toRelativeQuarterNum<a class=headerlink href=../amp/#torelativequarternum title="Permanent link"> </a></h2> <p>Переводит дату-с-временем или дату в номер квартала, начиная с некоторого фиксированного момента в прошлом.</p> <h2 id=torelativemonthnum>toRelativeMonthNum<a class=headerlink href=../amp/#torelativemonthnum title="Permanent link"> </a></h2> <p>Переводит дату-с-временем или дату в номер месяца, начиная с некоторого фиксированного момента в прошлом.</p> <h2 id=torelativeweeknum>toRelativeWeekNum<a class=headerlink href=../amp/#torelativeweeknum title="Permanent link"> </a></h2> <p>Переводит дату-с-временем или дату в номер недели, начиная с некоторого фиксированного момента в прошлом.</p> <h2 id=torelativedaynum>toRelativeDayNum<a class=headerlink href=../amp/#torelativedaynum title="Permanent link"> </a></h2> <p>Переводит дату-с-временем или дату в номер дня, начиная с некоторого фиксированного момента в прошлом.</p> <h2 id=torelativehournum>toRelativeHourNum<a class=headerlink href=../amp/#torelativehournum title="Permanent link"> </a></h2> <p>Переводит дату-с-временем в номер часа, начиная с некоторого фиксированного момента в прошлом.</p> <h2 id=torelativeminutenum>toRelativeMinuteNum<a class=headerlink href=../amp/#torelativeminutenum title="Permanent link"> </a></h2> <p>Переводит дату-с-временем в номер минуты, начиная с некоторого фиксированного момента в прошлом.</p> <h2 id=torelativesecondnum>toRelativeSecondNum<a class=headerlink href=../amp/#torelativesecondnum title="Permanent link"> </a></h2> <p>Переводит дату-с-временем в номер секунды, начиная с некоторого фиксированного момента в прошлом.</p> <h2 id=toisoyear>toISOYear<a class=headerlink href=../amp/#toisoyear title="Permanent link"> </a></h2> <p>Переводит дату-с-временем или дату в число типа UInt16, содержащее номер ISO года. ISO год отличается от обычного года, потому что в соответствии с <a href=https://en.wikipedia.org/wiki/ISO_8601 rel="external nofollow noreferrer" target=_blank>ISO 8601:1988</a> ISO год начинается необязательно первого января.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=n>toDate</span><span class=p>(</span><span class=s1>'2017-01-01'</span><span class=p>)</span> <span class=k>AS</span> <span class=nb>date</span><span class=p>,</span>
    <span class=n>toYear</span><span class=p>(</span><span class=nb>date</span><span class=p>),</span>
    <span class=n>toISOYear</span><span class=p>(</span><span class=nb>date</span><span class=p>)</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌───────date─┬─toYear(toDate('2017-01-01'))─┬─toISOYear(toDate('2017-01-01'))─┐
│ 2017-01-01 │                         2017 │                            2016 │
└────────────┴──────────────────────────────┴─────────────────────────────────┘
</code></pre></div> <h2 id=toisoweek>toISOWeek<a class=headerlink href=../amp/#toisoweek title="Permanent link"> </a></h2> <p>Переводит дату-с-временем или дату в число типа UInt8, содержащее номер ISO недели.<br> Начало ISO года отличается от начала обычного года, потому что в соответствии с <a href=https://en.wikipedia.org/wiki/ISO_8601 rel="external nofollow noreferrer" target=_blank>ISO 8601:1988</a> первая неделя года - это неделя с четырьмя или более днями в этом году.</p> <p>1 Января 2017 г. - воскресение, т.е. первая ISO неделя 2017 года началась в понедельник 2 января, поэтому 1 января 2017 это последняя неделя 2016 года.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=n>toISOWeek</span><span class=p>(</span><span class=n>toDate</span><span class=p>(</span><span class=s1>'2017-01-01'</span><span class=p>))</span> <span class=k>AS</span> <span class=n>ISOWeek20170101</span><span class=p>,</span>
    <span class=n>toISOWeek</span><span class=p>(</span><span class=n>toDate</span><span class=p>(</span><span class=s1>'2017-01-02'</span><span class=p>))</span> <span class=k>AS</span> <span class=n>ISOWeek20170102</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─ISOWeek20170101─┬─ISOWeek20170102─┐
│              52 │               1 │
└─────────────────┴─────────────────┘
</code></pre></div> <h2 id=toweek>toWeek(date[, mode][, timezone])<a class=headerlink href=../amp/#toweek title="Permanent link"> </a></h2> <p>Переводит дату-с-временем или дату в число UInt8, содержащее номер недели. Второй аргументам mode задает режим, начинается ли неделя с воскресенья или с понедельника и должно ли возвращаемое значение находиться в диапазоне от 0 до 53 или от 1 до 53. Если аргумент mode опущен, то используется режим 0.</p> <p><code class=syntax>toISOWeek()</code> эквивалентно <code class=syntax>toWeek(date,3)</code>.</p> <p>Описание режимов (mode):</p> <table> <thead> <tr> <th>Mode</th> <th>Первый день недели</th> <th>Диапазон</th> <th>Неделя 1 это первая неделя …</th> </tr> </thead> <tbody> <tr> <td>0</td> <td>Воскресенье</td> <td>0-53</td> <td>с воскресеньем в этом году</td> </tr> <tr> <td>1</td> <td>Понедельник</td> <td>0-53</td> <td>с 4-мя или более днями в этом году</td> </tr> <tr> <td>2</td> <td>Воскресенье</td> <td>1-53</td> <td>с воскресеньем в этом году</td> </tr> <tr> <td>3</td> <td>Понедельник</td> <td>1-53</td> <td>с 4-мя или более днями в этом году</td> </tr> <tr> <td>4</td> <td>Воскресенье</td> <td>0-53</td> <td>с 4-мя или более днями в этом году</td> </tr> <tr> <td>5</td> <td>Понедельник</td> <td>0-53</td> <td>с понедельником в этом году</td> </tr> <tr> <td>6</td> <td>Воскресенье</td> <td>1-53</td> <td>с 4-мя или более днями в этом году</td> </tr> <tr> <td>7</td> <td>Понедельник</td> <td>1-53</td> <td>с понедельником в этом году</td> </tr> <tr> <td>8</td> <td>Воскресенье</td> <td>1-53</td> <td>содержащая 1 января</td> </tr> <tr> <td>9</td> <td>Понедельник</td> <td>1-53</td> <td>содержащая 1 января</td> </tr> </tbody> </table> <p>Для режимов со значением «с 4 или более днями в этом году» недели нумеруются в соответствии с ISO 8601:1988:</p> <ul> <li> <p>Если неделя, содержащая 1 января, имеет 4 или более дней в новом году, это неделя 1.</p> </li> <li> <p>В противном случае это последняя неделя предыдущего года, а следующая неделя - неделя 1.</p> </li> </ul> <p>Для режимов со значением «содержит 1 января», неделя 1 – это неделя содержащая 1 января. Не имеет значения, сколько дней в новом году содержала неделя, даже если она содержала только один день.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>toDate</span><span class=p>(</span><span class=s1>'2016-12-27'</span><span class=p>)</span> <span class=k>AS</span> <span class=nb>date</span><span class=p>,</span> <span class=n>toWeek</span><span class=p>(</span><span class=nb>date</span><span class=p>)</span> <span class=k>AS</span> <span class=n>week0</span><span class=p>,</span> <span class=n>toWeek</span><span class=p>(</span><span class=nb>date</span><span class=p>,</span><span class=mi>1</span><span class=p>)</span> <span class=k>AS</span> <span class=n>week1</span><span class=p>,</span> <span class=n>toWeek</span><span class=p>(</span><span class=nb>date</span><span class=p>,</span><span class=mi>9</span><span class=p>)</span> <span class=k>AS</span> <span class=n>week9</span><span class=p>;</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌───────date─┬─week0─┬─week1─┬─week9─┐
│ 2016-12-27 │    52 │    52 │     1 │
└────────────┴───────┴───────┴───────┘
</code></pre></div> <h2 id=toyearweek>toYearWeek(date[,mode])<a class=headerlink href=../amp/#toyearweek title="Permanent link"> </a></h2> <p>Возвращает год и неделю для даты. Год в результате может отличаться от года в аргументе даты для первой и последней недели года.</p> <p>Аргумент mode работает точно так же, как аргумент mode <a href=../amp/#toweek>toWeek()</a>. Если mode не задан, используется режим 0.</p> <p><code class=syntax>toISOYear()</code> эквивалентно <code class=syntax>intDiv(toYearWeek(date,3),100)</code>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>toDate</span><span class=p>(</span><span class=s1>'2016-12-27'</span><span class=p>)</span> <span class=k>AS</span> <span class=nb>date</span><span class=p>,</span> <span class=n>toYearWeek</span><span class=p>(</span><span class=nb>date</span><span class=p>)</span> <span class=k>AS</span> <span class=n>yearWeek0</span><span class=p>,</span> <span class=n>toYearWeek</span><span class=p>(</span><span class=nb>date</span><span class=p>,</span><span class=mi>1</span><span class=p>)</span> <span class=k>AS</span> <span class=n>yearWeek1</span><span class=p>,</span> <span class=n>toYearWeek</span><span class=p>(</span><span class=nb>date</span><span class=p>,</span><span class=mi>9</span><span class=p>)</span> <span class=k>AS</span> <span class=n>yearWeek9</span><span class=p>;</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌───────date─┬─yearWeek0─┬─yearWeek1─┬─yearWeek9─┐
│ 2016-12-27 │    201652 │    201652 │    201701 │
└────────────┴───────────┴───────────┴───────────┘
</code></pre></div> <h2 id=date_trunc>date_trunc<a class=headerlink href=../amp/#date_trunc title="Permanent link"> </a></h2> <p>Отсекает от даты и времени части, меньшие чем указанная часть.</p> <p><strong>Синтаксис</strong> </p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>date_trunc</span><span class=p>(</span><span class=n>unit</span><span class=p>,</span> <span class=n>value</span><span class=p>[,</span> <span class=n>timezone</span><span class=p>])</span>
</code></pre></div> <p>Синоним: <code class=syntax>dateTrunc</code>. </p> <p><strong>Аргументы</strong></p> <ul> <li> <p><code class=syntax>unit</code> — название части даты или времени. <a href=../../../syntax/amp/#syntax-string-literal>String Literal</a>.<br> Возможные значения:</p> <ul> <li><code class=syntax>second</code></li> <li><code class=syntax>minute</code></li> <li><code class=syntax>hour</code></li> <li><code class=syntax>day</code></li> <li><code class=syntax>week</code></li> <li><code class=syntax>month</code></li> <li><code class=syntax>quarter</code></li> <li><code class=syntax>year</code></li> </ul> </li> <li> <p><code class=syntax>value</code> — дата и время. <a href=../../../data-types/datetime/amp/ >DateTime</a> или <a href=../../../data-types/datetime64/amp/ >DateTime64</a>.</p> </li> <li><code class=syntax>timezone</code> — <a href=../../../../operations/server-configuration-parameters/settings/amp/#server_configuration_parameters-timezone>часовой пояс</a> для возвращаемого значения (необязательно). Если параметр не задан, используется часовой пояс параметра <code class=syntax>value</code>. <a href=../../../data-types/string/amp/ >String</a></li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Дата и время, отсеченные до указанной части.</li> </ul> <p>Тип: <a href=../../../data-types/datetime/amp/ >Datetime</a>.</p> <p><strong>Примеры</strong></p> <p>Запрос без указания часового пояса:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>now</span><span class=p>(),</span> <span class=n>date_trunc</span><span class=p>(</span><span class=s1>'hour'</span><span class=p>,</span> <span class=n>now</span><span class=p>());</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌───────────────now()─┬─date_trunc('hour', now())─┐
│ 2020-09-28 10:40:45 │       2020-09-28 10:00:00 │
└─────────────────────┴───────────────────────────┘
</code></pre></div> <p>Запрос с указанием часового пояса:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>now</span><span class=p>(),</span> <span class=n>date_trunc</span><span class=p>(</span><span class=s1>'hour'</span><span class=p>,</span> <span class=n>now</span><span class=p>(),</span> <span class=s1>'Europe/Moscow'</span><span class=p>);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌───────────────now()─┬─date_trunc('hour', now(), 'Europe/Moscow')─┐
│ 2020-09-28 10:46:26 │                        2020-09-28 13:00:00 │
└─────────────────────┴────────────────────────────────────────────┘
</code></pre></div> <p><strong>См. также</strong></p> <ul> <li><a href=../amp/#tostartofintervaltime-or-data-interval-x-unit-time-zone>toStartOfInterval</a></li> </ul> <h2 id=now>now<a class=headerlink href=../amp/#now title="Permanent link"> </a></h2> <p>Возвращает текущую дату и время. </p> <p><strong>Синтаксис</strong> </p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>now</span><span class=p>([</span><span class=n>timezone</span><span class=p>])</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>timezone</code> — <a href=../../../../operations/server-configuration-parameters/settings/amp/#server_configuration_parameters-timezone>часовой пояс</a> для возвращаемого значения (необязательно). <a href=../../../data-types/string/amp/ >String</a></li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Текущие дата и время.</li> </ul> <p>Тип: <a href=../../../data-types/datetime/amp/ >Datetime</a>.</p> <p><strong>Пример</strong></p> <p>Запрос без указания часового пояса:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>now</span><span class=p>();</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌───────────────now()─┐
│ 2020-10-17 07:42:09 │
└─────────────────────┘
</code></pre></div> <p>Запрос с указанием часового пояса:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>now</span><span class=p>(</span><span class=s1>'Europe/Moscow'</span><span class=p>);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─now('Europe/Moscow')─┐
│  2020-10-17 10:42:23 │
└──────────────────────┘
</code></pre></div> <h2 id=today>today<a class=headerlink href=../amp/#today title="Permanent link"> </a></h2> <p>Принимает ноль аргументов и возвращает текущую дату на один из моментов выполнения запроса.<br> То же самое, что toDate(now())</p> <h2 id=yesterday>yesterday<a class=headerlink href=../amp/#yesterday title="Permanent link"> </a></h2> <p>Принимает ноль аргументов и возвращает вчерашнюю дату на один из моментов выполнения запроса.<br> Делает то же самое, что today() - 1.</p> <h2 id=datediff>dateDiff<a class=headerlink href=../amp/#datediff title="Permanent link"> </a></h2> <p>Вычисляет разницу между двумя значениями дат с временем.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>dateDiff</span><span class=p>(</span><span class=s1>'unit'</span><span class=p>,</span> <span class=n>startdate</span><span class=p>,</span> <span class=n>enddate</span><span class=p>,</span> <span class=p>[</span><span class=n>timezone</span><span class=p>])</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li> <p><code class=syntax>unit</code> — Единица измерения времени, в которой будет вычислена разница между <code class=syntax>startdate</code> и <code class=syntax>enddate</code>. <a href=../../../syntax/amp/#syntax-string-literal>String</a>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=err>Поддерживаемые</span> <span class=err>значения</span><span class=p>:</span>

<span class=o>|</span> <span class=n>unit</span>   <span class=o>|</span>
<span class=o>|</span> <span class=c1>------ |</span>
<span class=o>|</span><span class=k>second</span>  <span class=o>|</span>
<span class=o>|</span><span class=k>minute</span>  <span class=o>|</span>
<span class=o>|</span><span class=n>hour</span>    <span class=o>|</span>
<span class=o>|</span><span class=k>day</span>     <span class=o>|</span>
<span class=o>|</span><span class=n>week</span>    <span class=o>|</span>
<span class=o>|</span><span class=k>month</span>   <span class=o>|</span>
<span class=o>|</span><span class=n>quarter</span> <span class=o>|</span>
<span class=o>|</span><span class=k>year</span>    <span class=o>|</span>
</code></pre></div> </li> <li> <p><code class=syntax>startdate</code> — Первая дата. <a href=.././amp/ >Date</a> или <a href=.././amp/ >DateTime</a>.</p> </li> <li> <p><code class=syntax>enddate</code> — Вторая дата. <a href=.././amp/ >Date</a> или <a href=.././amp/ >DateTime</a>.</p> </li> <li> <p><code class=syntax>timezone</code> — Опциональный параметр. Если определен, применяется к обоим значениям: <code class=syntax>startdate</code> и <code class=syntax>enddate</code>. Если не определен, используются часовые пояса <code class=syntax>startdate</code> и <code class=syntax>enddate</code>. Если часовые пояса не совпадают, вернется неожидаемый результат.</p> </li> </ul> <p><strong>Возвращаемое значение</strong></p> <p>Разница между <code class=syntax>startdate</code> и <code class=syntax>enddate</code>, выраженная в <code class=syntax>unit</code>.</p> <p>Тип: <code class=syntax>int</code>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>dateDiff</span><span class=p>(</span><span class=s1>'hour'</span><span class=p>,</span> <span class=n>toDateTime</span><span class=p>(</span><span class=s1>'2018-01-01 22:00:00'</span><span class=p>),</span> <span class=n>toDateTime</span><span class=p>(</span><span class=s1>'2018-01-02 23:00:00'</span><span class=p>));</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─dateDiff('hour', toDateTime('2018-01-01 22:00:00'), toDateTime('2018-01-02 23:00:00'))─┐
│                                                                                     25 │
└────────────────────────────────────────────────────────────────────────────────────────┘
</code></pre></div> <h2 id=date_sub>date_sub<a class=headerlink href=../amp/#date_sub title="Permanent link"> </a></h2> <p>Вычитает интервал времени или даты из указанной даты или даты со временем.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>date_sub</span><span class=p>(</span><span class=n>unit</span><span class=p>,</span> <span class=n>value</span><span class=p>,</span> <span class=nb>date</span><span class=p>)</span>
</code></pre></div> <p>Синонимы: <code class=syntax>dateSub</code>, <code class=syntax>DATE_SUB</code>.</p> <p><strong>Аргументы</strong></p> <ul> <li> <p><code class=syntax>unit</code> — единица измерения времени, в которой задан интервал для вычитания. <a href=../../../data-types/string/amp/ >String</a>.<br> Возможные значения:</p> <ul> <li><code class=syntax>second</code></li> <li><code class=syntax>minute</code></li> <li><code class=syntax>hour</code></li> <li><code class=syntax>day</code></li> <li><code class=syntax>week</code></li> <li><code class=syntax>month</code></li> <li><code class=syntax>quarter</code></li> <li><code class=syntax>year</code></li> </ul> </li> <li> <p><code class=syntax>value</code> — значение интервала для вычитания. <a href=../../../data-types/int-uint/amp/ >Int</a>. </p> </li> <li><code class=syntax>date</code> — дата или дата со временем, из которой вычитается <code class=syntax>value</code>. <a href=../../../data-types/date/amp/ >Date</a> или <a href=../../../data-types/datetime/amp/ >DateTime</a>.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <p>Возвращает дату или дату со временем, полученную в результате вычитания <code class=syntax>value</code>, выраженного в <code class=syntax>unit</code>, из <code class=syntax>date</code>.</p> <p>Тип: <a href=../../../data-types/date/amp/ >Date</a> или <a href=../../../data-types/datetime/amp/ >DateTime</a>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>date_sub</span><span class=p>(</span><span class=k>YEAR</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>toDate</span><span class=p>(</span><span class=s1>'2018-01-01'</span><span class=p>));</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─minus(toDate('2018-01-01'), toIntervalYear(3))─┐
│                                     2015-01-01 │
└────────────────────────────────────────────────┘
</code></pre></div> <h2 id=timeslot>timeSlot<a class=headerlink href=../amp/#timeslot title="Permanent link"> </a></h2> <p>Округляет время до получаса.<br> Эта функция является специфичной для Яндекс.Метрики, так как пол часа - минимальное время, для которого, если соседние по времени хиты одного посетителя на одном счётчике отстоят друг от друга строго более, чем на это время, визит может быть разбит на два визита. То есть, кортежи (номер счётчика, идентификатор посетителя, тайм-слот) могут использоваться для поиска хитов, входящий в соответствующий визит.</p> <h2 id=timeslotsstarttime-duration-size>timeSlots(StartTime, Duration,[, Size])<a class=headerlink href=../amp/#timeslotsstarttime-duration-size title="Permanent link"> </a></h2> <p>Для интервала времени, начинающегося в ‘StartTime’ и продолжающегося ‘Duration’ секунд, возвращает массив моментов времени, состоящий из округлений вниз до ‘Size’ точек в секундах из этого интервала. ‘Size’ - необязательный параметр, константный UInt32, по умолчанию равен 1800.</p> <p>Например, <code class=syntax>timeSlots(toDateTime('2012-01-01 12:20:00'), toUInt32(600)) = [toDateTime('2012-01-01 12:00:00'), toDateTime('2012-01-01 12:30:00')]</code>.<br> Это нужно для поиска хитов, входящих в соответствующий визит.</p> <h2 id=toyyyymm>toYYYYMM<a class=headerlink href=../amp/#toyyyymm title="Permanent link"> </a></h2> <p>Переводит дату или дату со временем в число типа UInt32, содержащее номер года и месяца (YYYY * 100 + MM).</p> <h2 id=toyyyymmdd>toYYYYMMDD<a class=headerlink href=../amp/#toyyyymmdd title="Permanent link"> </a></h2> <p>Переводит дату или дату со временем в число типа UInt32, содержащее номер года, месяца и дня (YYYY * 10000 + MM * 100 + DD).</p> <h2 id=toyyyymmddhhmmss>toYYYYMMDDhhmmss<a class=headerlink href=../amp/#toyyyymmddhhmmss title="Permanent link"> </a></h2> <p>Переводит дату или дату со временем в число типа UInt64 содержащее номер года, месяца, дня и время (YYYY * 10000000000 + MM * 100000000 + DD * 1000000 + hh * 10000 + mm * 100 + ss).</p> <h2 id=formatdatetime>formatDateTime<a class=headerlink href=../amp/#formatdatetime title="Permanent link"> </a></h2> <p>Функция преобразует дату-и-время в строку по заданному шаблону. Важно: шаблон — константное выражение, поэтому использовать разные шаблоны в одной колонке не получится.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>formatDateTime</span><span class=p>(</span><span class=n>Time</span><span class=p>,</span> <span class=n>Format</span><span class=err>\</span><span class=p>[,</span> <span class=n>Timezone</span><span class=err>\</span><span class=p>])</span>
</code></pre></div> <p><strong>Возвращаемое значение</strong></p> <p>Возвращает значение времени и даты в определенном вами формате.</p> <p><strong>Поля подстановки</strong><br> Используйте поля подстановки для того, чтобы определить шаблон для выводимой строки. В колонке «Пример» результат работы функции для времени <code class=syntax>2018-01-02 22:33:44</code>.</p> <table> <thead> <tr> <th>Поле</th> <th>Описание</th> <th>Пример</th> </tr> </thead> <tbody> <tr> <td>%C</td> <td>номер года, поделённый на 100 (00-99)</td> <td>20</td> </tr> <tr> <td>%d</td> <td>день месяца, с ведущим нулём (01-31)</td> <td>02</td> </tr> <tr> <td>%D</td> <td>короткая запись %m/%d/%y</td> <td>01/02/18</td> </tr> <tr> <td>%e</td> <td>день месяца, с ведущим пробелом ( 1-31)</td> <td>2</td> </tr> <tr> <td>%F</td> <td>короткая запись %Y-%m-%d</td> <td>2018-01-02</td> </tr> <tr> <td>%G</td> <td>четырехзначный формат вывода ISO-года, который основывается на особом подсчете номера недели согласно <a href=https://ru.wikipedia.org/wiki/ISO_8601 rel="external nofollow noreferrer" target=_blank>стандарту ISO 8601</a>, обычно используется вместе с %V</td> <td>2018</td> </tr> <tr> <td>%g</td> <td>двузначный формат вывода года по стандарту ISO 8601</td> <td>18</td> </tr> <tr> <td>%H</td> <td>час в 24-часовом формате (00-23)</td> <td>22</td> </tr> <tr> <td>%I</td> <td>час в 12-часовом формате (01-12)</td> <td>10</td> </tr> <tr> <td>%j</td> <td>номер дня в году, с ведущими нулями (001-366)</td> <td>002</td> </tr> <tr> <td>%m</td> <td>месяц, с ведущим нулём (01-12)</td> <td>01</td> </tr> <tr> <td>%M</td> <td>минуты, с ведущим нулём (00-59)</td> <td>33</td> </tr> <tr> <td>%n</td> <td>символ переноса строки (‘’)</td> <td></td> </tr> <tr> <td>%p</td> <td>обозначения AM или PM</td> <td>PM</td> </tr> <tr> <td>%R</td> <td>короткая запись %H:%M</td> <td>22:33</td> </tr> <tr> <td>%S</td> <td>секунды, с ведущими нулями (00-59)</td> <td>44</td> </tr> <tr> <td>%t</td> <td>символ табуляции (’)</td> <td></td> </tr> <tr> <td>%T</td> <td>формат времени ISO 8601, одинаковый с %H:%M:%S</td> <td>22:33:44</td> </tr> <tr> <td>%u</td> <td>номер дня недели согласно ISO 8601, понедельник - 1, воскресенье - 7</td> <td>2</td> </tr> <tr> <td>%V</td> <td>номер недели согласно ISO 8601 (01-53)</td> <td>01</td> </tr> <tr> <td>%w</td> <td>номер дня недели, начиная с воскресенья (0-6)</td> <td>2</td> </tr> <tr> <td>%y</td> <td>год, последние 2 цифры (00-99)</td> <td>18</td> </tr> <tr> <td>%Y</td> <td>год, 4 цифры</td> <td>2018</td> </tr> <tr> <td>%%</td> <td>символ %</td> <td>%</td> </tr> </tbody> </table> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>formatDateTime</span><span class=p>(</span><span class=n>toDate</span><span class=p>(</span><span class=s1>'2010-01-04'</span><span class=p>),</span> <span class=s1>'%g'</span><span class=p>);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=err>┌─formatDateTime(toDate('2010-01-04'), '%g')─┐</span>
<span class=err>│ 10                                         │</span>
<span class=err>└────────────────────────────────────────────┘</span>
</code></pre></div> <h2 id=fromunixtime>FROM_UNIXTIME<a class=headerlink href=../amp/#fromunixtime title="Permanent link"> </a></h2> <p>Функция преобразует Unix timestamp в календарную дату и время. </p> <p><strong>Примеры</strong></p> <p>Если указан только один аргумент типа <a href=../../../data-types/int-uint/amp/ >Integer</a>, то функция действует так же, как <a href=../../type-conversion-functions/amp/#todatetime>toDateTime</a>, и возвращает тип <a href=../../../data-types/datetime/amp/ >DateTime</a>.</p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>FROM_UNIXTIME</span><span class=p>(</span><span class=mi>423543535</span><span class=p>);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─FROM_UNIXTIME(423543535)─┐
│      1983-06-04 10:58:55 │
└──────────────────────────┘
</code></pre></div> <p>В случае, когда есть два аргумента: первый типа <a href=../../../data-types/int-uint/amp/ >Integer</a> или <a href=../../../data-types/datetime/amp/ >DateTime</a>, а второй является строкой постоянного формата — функция работает также, как <a href=../amp/#formatdatetime>formatDateTime</a>, и возвращает значение типа <a href=../../../data-types/string/amp/#string>String</a>.</p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>FROM_UNIXTIME</span><span class=p>(</span><span class=mi>1234334543</span><span class=p>,</span> <span class=s1>'%Y-%m-%d %R:%S'</span><span class=p>)</span> <span class=k>AS</span> <span class=n>DateTime</span><span class=p>;</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─DateTime────────────┐
│ 2009-02-11 14:42:23 │
└─────────────────────┘
</code></pre></div> <p><a href=https://clickhouse.tech/docs/ru/query_language/functions/date_time_functions/ target=_blank>Оригинальная статья</a> <!--hide--></p> </div> </div> <div class=row> <div class=col> <div class="alert alert-light my-3"> <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p> <span class="alert-heading display-6">Article Rating</span> <div id=rating-stars class="display-6 mb-0">RATING_STARS</div> </div> <div id=content-footer class="text-muted pt-3 mb-5"> <div class=float-md-right>©2016–2020 Yandex LLC</div> <div>Built from <a href=https://github.com/ClickHouse/ClickHouse/commit/b030bfedd7db4603034643fd183cf7784a820193 rel="external nofollow noreferrer" target=_blank class=text-reset>b030bfedd7</a> </div> </div> </div> </div> <div id=to-full-website class="row fixed-bottom text-center bg-white py-3"> <div class=col> <a href=https://clickhouse.tech/docs/ru/sql-reference/functions/date-time-functions/ class="btn btn-lg btn-outline-orange">To full website</a> </div> </div> </div> <amp-analytics type=metrika> <script type=application/json>{
"vars": {
  "counterId": "18343495",
  "triggers": {
    "notBounce": {
      "on": "timer",
      "timerSpec": {
        "immediate": false,
        "interval": 15,
        "maxTimerLength": 16
      },
      "request": "notBounce"
    }
  }
}
}</script> </amp-analytics> </body> </html> 