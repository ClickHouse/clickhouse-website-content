<!doctype html><html ⚡ lang=fr> <head><meta charset=utf-8><script async src=https://cdn.ampproject.org/v0.js></script><title>Stockage des dictionnaires en mémoire | Documentation ClickHouse</title><link href=https://clickhouse.tech/docs/fr/sql-reference/dictionaries/external-dictionaries/external-dicts-dict-layout/ rel=canonical><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><script type=application/ld+json>[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "Stockage des dictionnaires en mémoire | Documentation ClickHouse",
"mainEntityOfPage": "https://clickhouse.tech/docs/fr/sql-reference/dictionaries/external-dictionaries/external-dicts-dict-layout/",




"image": "https://clickhouse.tech/images/logo-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "Yandex LLC",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.tech/images/yandex.png",
    "width": 163,
    "height": 60
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "Stockage des dictionnaires en mémoire | Documentation ClickHouse",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script><style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript><style amp-custom>:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--white:#fff;--gray:#6c757d;--gray-dark:#343a40;--primary:#007bff;--secondary:#6c757d;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f8f9fa;--dark:#343a40;--breakpoint-xs:0;--breakpoint-sm:576px;--breakpoint-md:768px;--breakpoint-lg:992px;--breakpoint-xl:1200px;--font-family-sans-serif:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,::after,::before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}article,footer,main,section{display:block}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem}p{margin-top:0;margin-bottom:1rem}ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}b{font-weight:bolder}a{color:#007bff;text-decoration:none;background-color:transparent}a:hover{color:#0056b3;text-decoration:underline}a:not([href]){color:inherit;text-decoration:none}a:not([href]):hover{color:inherit;text-decoration:none}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}img{vertical-align:middle;border-style:none}svg{overflow:hidden;vertical-align:middle}table{border-collapse:collapse}select{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit]{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{padding:0;border-style:none}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:.5rem;font-weight:500;line-height:1.2}.h1,h1{font-size:2rem}.h2,h2{font-size:1.5rem}.h3,h3{font-size:1.25rem}.h4,h4{font-size:1rem}.h5,h5{font-size:1rem}.h6,h6{font-size:1rem}.lead{font-size:1.25rem;font-weight:300}.display-1{font-size:6rem;font-weight:300;line-height:1.2}.display-2{font-size:5.5rem;font-weight:300;line-height:1.2}.display-3{font-size:4.5rem;font-weight:300;line-height:1.2}.display-4{font-size:3.5rem;font-weight:300;line-height:1.2}.img-fluid{max-width:100%;height:auto}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}pre{display:block;font-size:87.5%;color:#212529}pre code{font-size:inherit;color:inherit;word-break:normal}.container{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container{max-width:720px}}@media(min-width:992px){.container{max-width:960px}}@media(min-width:1200px){.container{max-width:1140px}}.container-fluid,.container-lg,.container-md{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container,.container-md{max-width:720px}}@media(min-width:992px){.container,.container-lg,.container-md{max-width:960px}}@media(min-width:1200px){.container,.container-lg,.container-md{max-width:1140px}}.row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-15px;margin-left:-15px}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9{position:relative;width:100%;padding-right:15px;padding-left:15px}.col{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}@media(min-width:768px){.col-md{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-md-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-md-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-md-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-md-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-md-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-md-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-md-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-md-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-md-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-md-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-md-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-md-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}}@media(min-width:992px){.col-lg{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-lg-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-lg-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-lg-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-lg-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-lg-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-lg-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-lg-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-lg-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-lg-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-lg-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-lg-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-lg-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}}.table{width:100%;margin-bottom:1rem;color:#212529}.table-primary{background-color:#b8daff}.table-warning{background-color:#ffeeba}.table-light{background-color:#fdfdfe}.table-dark{background-color:#c6c8ca}.table-dark{color:#fff;background-color:#343a40}.btn{display:inline-block;font-weight:400;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:.375rem .75rem;font-size:1rem;line-height:1.5;border-radius:.25rem}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus{outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.btn:disabled{opacity:.65}.btn-primary{color:#fff;background-color:#007bff;border-color:#007bff}.btn-primary:hover{color:#fff;background-color:#0069d9;border-color:#0062cc}.btn-primary:focus{color:#fff;background-color:#0069d9;border-color:#0062cc;box-shadow:0 0 0 .2rem rgba(38,143,255,.5)}.btn-primary:disabled{color:#fff;background-color:#007bff;border-color:#007bff}.btn-warning{color:#212529;background-color:#ffc107;border-color:#ffc107}.btn-warning:hover{color:#212529;background-color:#e0a800;border-color:#d39e00}.btn-warning:focus{color:#212529;background-color:#e0a800;border-color:#d39e00;box-shadow:0 0 0 .2rem rgba(222,170,12,.5)}.btn-warning:disabled{color:#212529;background-color:#ffc107;border-color:#ffc107}.btn-light{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-light:hover{color:#212529;background-color:#e2e6ea;border-color:#dae0e5}.btn-light:focus{color:#212529;background-color:#e2e6ea;border-color:#dae0e5;box-shadow:0 0 0 .2rem rgba(216,217,219,.5)}.btn-light:disabled{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-dark{color:#fff;background-color:#343a40;border-color:#343a40}.btn-dark:hover{color:#fff;background-color:#23272b;border-color:#1d2124}.btn-dark:focus{color:#fff;background-color:#23272b;border-color:#1d2124;box-shadow:0 0 0 .2rem rgba(82,88,93,.5)}.btn-dark:disabled{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-primary{color:#007bff;border-color:#007bff}.btn-outline-primary:hover{color:#fff;background-color:#007bff;border-color:#007bff}.btn-outline-primary:focus{box-shadow:0 0 0 .2rem rgba(0,123,255,.5)}.btn-outline-primary:disabled{color:#007bff;background-color:transparent}.btn-outline-warning{color:#ffc107;border-color:#ffc107}.btn-outline-warning:hover{color:#212529;background-color:#ffc107;border-color:#ffc107}.btn-outline-warning:focus{box-shadow:0 0 0 .2rem rgba(255,193,7,.5)}.btn-outline-warning:disabled{color:#ffc107;background-color:transparent}.btn-outline-light{color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:hover{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:focus{box-shadow:0 0 0 .2rem rgba(248,249,250,.5)}.btn-outline-light:disabled{color:#f8f9fa;background-color:transparent}.btn-outline-dark{color:#343a40;border-color:#343a40}.btn-outline-dark:hover{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-dark:focus{box-shadow:0 0 0 .2rem rgba(52,58,64,.5)}.btn-outline-dark:disabled{color:#343a40;background-color:transparent}.btn-link{font-weight:400;color:#007bff;text-decoration:none}.btn-link:hover{color:#0056b3;text-decoration:underline}.btn-link:focus{text-decoration:underline;box-shadow:none}.btn-link:disabled{color:#6c757d;pointer-events:none}.btn-group-lg>.btn,.btn-lg{padding:.5rem 1rem;font-size:1.25rem;line-height:1.5;border-radius:.3rem}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:.5rem}.btn-group{position:relative;display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle}.btn-group>.btn{position:relative;-ms-flex:1 1 auto;flex:1 1 auto}.btn-group>.btn:hover{z-index:1}.btn-group>.btn:active,.btn-group>.btn:focus{z-index:1}.btn-group>.btn-group:not(:first-child),.btn-group>.btn:not(:first-child){margin-left:-1px}.btn-group>.btn-group:not(:last-child)>.btn{border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn-group:not(:first-child)>.btn,.btn-group>.btn:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.custom-select{display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;vertical-align:middle;background:#fff url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5' viewBox='0 0 4 5'%3e%3cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3e%3c/svg%3e") no-repeat right .75rem center/8px 10px;border:1px solid #ced4da;border-radius:.25rem;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.custom-select:focus::-ms-value{color:#495057;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #495057}.custom-select-lg{height:calc(1.5em+1rem+2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.25rem}.custom-range{width:100%;height:1.4rem;padding:0;background-color:transparent;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-range:focus{outline:0}.custom-range:focus::-webkit-slider-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .2rem rgba(0,123,255,.25)}.custom-range:focus::-moz-range-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .2rem rgba(0,123,255,.25)}.custom-range:focus::-ms-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .2rem rgba(0,123,255,.25)}.custom-range::-moz-focus-outer{border:0}.custom-range::-webkit-slider-thumb{width:1rem;height:1rem;margin-top:-.25rem;background-color:#007bff;border:0;border-radius:1rem;-webkit-appearance:none;appearance:none}@media(prefers-reduced-motion:reduce){.custom-range::-webkit-slider-thumb{-webkit-transition:none;transition:none}}.custom-range::-webkit-slider-thumb:active{background-color:#b3d7ff}.custom-range::-webkit-slider-runnable-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:#dee2e6;border-color:transparent;border-radius:1rem}.custom-range::-moz-range-thumb{width:1rem;height:1rem;background-color:#007bff;border:0;border-radius:1rem;-moz-appearance:none;appearance:none}@media(prefers-reduced-motion:reduce){.custom-range::-moz-range-thumb{-moz-transition:none;transition:none}}.custom-range::-moz-range-thumb:active{background-color:#b3d7ff}.custom-range::-moz-range-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:#dee2e6;border-color:transparent;border-radius:1rem}.custom-range::-ms-thumb{width:1rem;height:1rem;margin-top:0;margin-right:.2rem;margin-left:.2rem;background-color:#007bff;border:0;border-radius:1rem;appearance:none}@media(prefers-reduced-motion:reduce){.custom-range::-ms-thumb{-ms-transition:none;transition:none}}.custom-range::-ms-thumb:active{background-color:#b3d7ff}.custom-range::-ms-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:transparent;border-color:transparent;border-width:.5rem}.custom-range::-ms-fill-lower{background-color:#dee2e6;border-radius:1rem}.custom-range::-ms-fill-upper{margin-right:15px;background-color:#dee2e6;border-radius:1rem}.custom-range:disabled::-webkit-slider-thumb{background-color:#adb5bd}.custom-range:disabled::-webkit-slider-runnable-track{cursor:default}.custom-range:disabled::-moz-range-thumb{background-color:#adb5bd}.custom-range:disabled::-moz-range-track{cursor:default}.custom-range:disabled::-ms-thumb{background-color:#adb5bd}@media(prefers-reduced-motion:reduce){.custom-select{transition:none}}.page-link{position:relative;display:block;padding:.5rem .75rem;margin-left:-1px;line-height:1.25;color:#007bff;background-color:#fff;border:1px solid #dee2e6}.page-link:hover{z-index:2;color:#0056b3;text-decoration:none;background-color:#e9ecef;border-color:#dee2e6}.page-link:focus{z-index:3;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.alert{position:relative;padding:.75rem 1.25rem;margin-bottom:1rem;border:1px solid transparent;border-radius:.25rem}.alert-heading{color:inherit}.alert-link{font-weight:700}.alert-primary{color:#004085;background-color:#cce5ff;border-color:#b8daff}.alert-primary .alert-link{color:#002752}.alert-warning{color:#856404;background-color:#fff3cd;border-color:#ffeeba}.alert-warning .alert-link{color:#533f03}.alert-light{color:#818182;background-color:#fefefe;border-color:#fdfdfe}.alert-light .alert-link{color:#686868}.alert-dark{color:#1b1e21;background-color:#d6d8d9;border-color:#c6c8ca}.alert-dark .alert-link{color:#040505}@-webkit-keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@-webkit-keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}@keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}.bg-primary{background-color:#007bff}a.bg-primary:focus,a.bg-primary:hover{background-color:#0062cc}.bg-warning{background-color:#ffc107}a.bg-warning:focus,a.bg-warning:hover{background-color:#d39e00}.bg-light{background-color:#f8f9fa}a.bg-light:focus,a.bg-light:hover{background-color:#dae0e5}.bg-dark{background-color:#343a40}a.bg-dark:focus,a.bg-dark:hover{background-color:#1d2124}.bg-white{background-color:#fff}.rounded{border-radius:.25rem}.rounded-right{border-top-right-radius:.25rem;border-bottom-right-radius:.25rem}.rounded-bottom{border-bottom-right-radius:.25rem;border-bottom-left-radius:.25rem}.rounded-lg{border-radius:.3rem}.rounded-0{border-radius:0}.d-none{display:none}.d-inline{display:inline}.d-inline-block{display:inline-block}.d-block{display:block}.d-table{display:table}.d-table-row{display:table-row}@media(min-width:768px){.d-md-none{display:none}.d-md-inline{display:inline}.d-md-inline-block{display:inline-block}.d-md-block{display:block}.d-md-table{display:table}.d-md-table-row{display:table-row}}@media(min-width:992px){.d-lg-none{display:none}.d-lg-inline{display:inline}.d-lg-inline-block{display:inline-block}.d-lg-block{display:block}.d-lg-table{display:table}.d-lg-table-row{display:table-row}}.float-right{float:right}.float-none{float:none}@media(min-width:768px){.float-md-right{float:right}.float-md-none{float:none}}@media(min-width:992px){.float-lg-right{float:right}.float-lg-none{float:none}}.fixed-bottom{position:fixed;right:0;bottom:0;left:0;z-index:1030}.h-25{height:25%}.h-50{height:50%}.h-75{height:75%}.h-100{height:100%}.m-0{margin:0}.my-0{margin-top:0}.mr-0{margin-right:0}.mb-0,.my-0{margin-bottom:0}.m-1{margin:.25rem}.my-1{margin-top:.25rem}.mr-1{margin-right:.25rem}.mb-1,.my-1{margin-bottom:.25rem}.m-2{margin:.5rem}.my-2{margin-top:.5rem}.mr-2{margin-right:.5rem}.mb-2,.my-2{margin-bottom:.5rem}.m-3{margin:1rem}.my-3{margin-top:1rem}.mr-3{margin-right:1rem}.mb-3,.my-3{margin-bottom:1rem}.m-4{margin:1.5rem}.my-4{margin-top:1.5rem}.mr-4{margin-right:1.5rem}.mb-4,.my-4{margin-bottom:1.5rem}.m-5{margin:3rem}.my-5{margin-top:3rem}.mr-5{margin-right:3rem}.mb-5,.my-5{margin-bottom:3rem}.p-0{padding:0}.pt-0,.py-0{padding-top:0}.pr-0{padding-right:0}.pb-0,.py-0{padding-bottom:0}.p-1{padding:.25rem}.pt-1,.py-1{padding-top:.25rem}.pr-1{padding-right:.25rem}.pb-1,.py-1{padding-bottom:.25rem}.p-2{padding:.5rem}.pt-2,.py-2{padding-top:.5rem}.pr-2{padding-right:.5rem}.pb-2,.py-2{padding-bottom:.5rem}.p-3{padding:1rem}.pt-3,.py-3{padding-top:1rem}.pr-3{padding-right:1rem}.pb-3,.py-3{padding-bottom:1rem}.p-4{padding:1.5rem}.pt-4,.py-4{padding-top:1.5rem}.pr-4{padding-right:1.5rem}.pb-4,.py-4{padding-bottom:1.5rem}.p-5{padding:3rem}.pt-5,.py-5{padding-top:3rem}.pr-5{padding-right:3rem}.pb-5,.py-5{padding-bottom:3rem}.m-n1{margin:-.25rem}.my-n1{margin-top:-.25rem}.mr-n1{margin-right:-.25rem}.mb-n1,.my-n1{margin-bottom:-.25rem}.m-n2{margin:-.5rem}.my-n2{margin-top:-.5rem}.mr-n2{margin-right:-.5rem}.mb-n2,.my-n2{margin-bottom:-.5rem}.m-n3{margin:-1rem}.my-n3{margin-top:-1rem}.mr-n3{margin-right:-1rem}.mb-n3,.my-n3{margin-bottom:-1rem}.m-n4{margin:-1.5rem}.my-n4{margin-top:-1.5rem}.mr-n4{margin-right:-1.5rem}.mb-n4,.my-n4{margin-bottom:-1.5rem}.m-n5{margin:-3rem}.my-n5{margin-top:-3rem}.mr-n5{margin-right:-3rem}.mb-n5,.my-n5{margin-bottom:-3rem}@media(min-width:768px){.m-md-0{margin:0}.my-md-0{margin-top:0}.mr-md-0{margin-right:0}.mb-md-0,.my-md-0{margin-bottom:0}.m-md-1{margin:.25rem}.my-md-1{margin-top:.25rem}.mr-md-1{margin-right:.25rem}.mb-md-1,.my-md-1{margin-bottom:.25rem}.m-md-2{margin:.5rem}.my-md-2{margin-top:.5rem}.mr-md-2{margin-right:.5rem}.mb-md-2,.my-md-2{margin-bottom:.5rem}.m-md-3{margin:1rem}.my-md-3{margin-top:1rem}.mr-md-3{margin-right:1rem}.mb-md-3,.my-md-3{margin-bottom:1rem}.m-md-4{margin:1.5rem}.my-md-4{margin-top:1.5rem}.mr-md-4{margin-right:1.5rem}.mb-md-4,.my-md-4{margin-bottom:1.5rem}.m-md-5{margin:3rem}.my-md-5{margin-top:3rem}.mr-md-5{margin-right:3rem}.mb-md-5,.my-md-5{margin-bottom:3rem}.p-md-0{padding:0}.pt-md-0,.py-md-0{padding-top:0}.pr-md-0{padding-right:0}.pb-md-0,.py-md-0{padding-bottom:0}.p-md-1{padding:.25rem}.pt-md-1,.py-md-1{padding-top:.25rem}.pr-md-1{padding-right:.25rem}.pb-md-1,.py-md-1{padding-bottom:.25rem}.p-md-2{padding:.5rem}.pt-md-2,.py-md-2{padding-top:.5rem}.pr-md-2{padding-right:.5rem}.pb-md-2,.py-md-2{padding-bottom:.5rem}.p-md-3{padding:1rem}.pt-md-3,.py-md-3{padding-top:1rem}.pr-md-3{padding-right:1rem}.pb-md-3,.py-md-3{padding-bottom:1rem}.p-md-4{padding:1.5rem}.pt-md-4,.py-md-4{padding-top:1.5rem}.pr-md-4{padding-right:1.5rem}.pb-md-4,.py-md-4{padding-bottom:1.5rem}.p-md-5{padding:3rem}.pt-md-5,.py-md-5{padding-top:3rem}.pr-md-5{padding-right:3rem}.pb-md-5,.py-md-5{padding-bottom:3rem}.m-md-n1{margin:-.25rem}.my-md-n1{margin-top:-.25rem}.mr-md-n1{margin-right:-.25rem}.mb-md-n1,.my-md-n1{margin-bottom:-.25rem}.m-md-n2{margin:-.5rem}.my-md-n2{margin-top:-.5rem}.mr-md-n2{margin-right:-.5rem}.mb-md-n2,.my-md-n2{margin-bottom:-.5rem}.m-md-n3{margin:-1rem}.my-md-n3{margin-top:-1rem}.mr-md-n3{margin-right:-1rem}.mb-md-n3,.my-md-n3{margin-bottom:-1rem}.m-md-n4{margin:-1.5rem}.my-md-n4{margin-top:-1.5rem}.mr-md-n4{margin-right:-1.5rem}.mb-md-n4,.my-md-n4{margin-bottom:-1.5rem}.m-md-n5{margin:-3rem}.my-md-n5{margin-top:-3rem}.mr-md-n5{margin-right:-3rem}.mb-md-n5,.my-md-n5{margin-bottom:-3rem}}@media(min-width:992px){.m-lg-0{margin:0}.my-lg-0{margin-top:0}.mr-lg-0{margin-right:0}.mb-lg-0,.my-lg-0{margin-bottom:0}.m-lg-1{margin:.25rem}.my-lg-1{margin-top:.25rem}.mr-lg-1{margin-right:.25rem}.mb-lg-1,.my-lg-1{margin-bottom:.25rem}.m-lg-2{margin:.5rem}.my-lg-2{margin-top:.5rem}.mr-lg-2{margin-right:.5rem}.mb-lg-2,.my-lg-2{margin-bottom:.5rem}.m-lg-3{margin:1rem}.my-lg-3{margin-top:1rem}.mr-lg-3{margin-right:1rem}.mb-lg-3,.my-lg-3{margin-bottom:1rem}.m-lg-4{margin:1.5rem}.my-lg-4{margin-top:1.5rem}.mr-lg-4{margin-right:1.5rem}.mb-lg-4,.my-lg-4{margin-bottom:1.5rem}.m-lg-5{margin:3rem}.my-lg-5{margin-top:3rem}.mr-lg-5{margin-right:3rem}.mb-lg-5,.my-lg-5{margin-bottom:3rem}.p-lg-0{padding:0}.pt-lg-0,.py-lg-0{padding-top:0}.pr-lg-0{padding-right:0}.pb-lg-0,.py-lg-0{padding-bottom:0}.p-lg-1{padding:.25rem}.pt-lg-1,.py-lg-1{padding-top:.25rem}.pr-lg-1{padding-right:.25rem}.pb-lg-1,.py-lg-1{padding-bottom:.25rem}.p-lg-2{padding:.5rem}.pt-lg-2,.py-lg-2{padding-top:.5rem}.pr-lg-2{padding-right:.5rem}.pb-lg-2,.py-lg-2{padding-bottom:.5rem}.p-lg-3{padding:1rem}.pt-lg-3,.py-lg-3{padding-top:1rem}.pr-lg-3{padding-right:1rem}.pb-lg-3,.py-lg-3{padding-bottom:1rem}.p-lg-4{padding:1.5rem}.pt-lg-4,.py-lg-4{padding-top:1.5rem}.pr-lg-4{padding-right:1.5rem}.pb-lg-4,.py-lg-4{padding-bottom:1.5rem}.p-lg-5{padding:3rem}.pt-lg-5,.py-lg-5{padding-top:3rem}.pr-lg-5{padding-right:3rem}.pb-lg-5,.py-lg-5{padding-bottom:3rem}.m-lg-n1{margin:-.25rem}.my-lg-n1{margin-top:-.25rem}.mr-lg-n1{margin-right:-.25rem}.mb-lg-n1,.my-lg-n1{margin-bottom:-.25rem}.m-lg-n2{margin:-.5rem}.my-lg-n2{margin-top:-.5rem}.mr-lg-n2{margin-right:-.5rem}.mb-lg-n2,.my-lg-n2{margin-bottom:-.5rem}.m-lg-n3{margin:-1rem}.my-lg-n3{margin-top:-1rem}.mr-lg-n3{margin-right:-1rem}.mb-lg-n3,.my-lg-n3{margin-bottom:-1rem}.m-lg-n4{margin:-1.5rem}.my-lg-n4{margin-top:-1.5rem}.mr-lg-n4{margin-right:-1.5rem}.mb-lg-n4,.my-lg-n4{margin-bottom:-1.5rem}.m-lg-n5{margin:-3rem}.my-lg-n5{margin-top:-3rem}.mr-lg-n5{margin-right:-3rem}.mb-lg-n5,.my-lg-n5{margin-bottom:-3rem}}.text-right{text-align:right}.text-center{text-align:center}@media(min-width:768px){.text-md-right{text-align:right}.text-md-center{text-align:center}}@media(min-width:992px){.text-lg-right{text-align:right}.text-lg-center{text-align:center}}.text-white{color:#fff}.text-primary{color:#007bff}a.text-primary:focus,a.text-primary:hover{color:#0056b3}.text-warning{color:#ffc107}a.text-warning:focus,a.text-warning:hover{color:#ba8b00}.text-light{color:#f8f9fa}a.text-light:focus,a.text-light:hover{color:#cbd3da}.text-dark{color:#343a40}a.text-dark:focus,a.text-dark:hover{color:#121416}.text-body{color:#212529}.text-muted{color:#6c757d}.text-black-50{color:rgba(0,0,0,.5)}.text-white-50{color:rgba(255,255,255,.5)}.text-hide{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;border:0}.text-decoration-none{text-decoration:none}.text-reset{color:inherit}.visible{visibility:visible}@media print{*,::after,::before{text-shadow:none;box-shadow:none}a:not(.btn){text-decoration:underline}pre{white-space:pre-wrap}pre{border:1px solid #adb5bd;page-break-inside:avoid}img{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}body{min-width:992px}.container{min-width:992px}.table{border-collapse:collapse}.table-dark{color:inherit}}@-webkit-keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}@keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"}a:link,a:visited{color:#f14600;text-decoration:none}a:active,a:hover{text-decoration:underline}.btn:disabled{cursor:default;opacity:.4}#logo-text{width:180px;margin-left:12px}.display-5{font-size:2rem;font-weight:300;line-height:1.2}.display-6{font-size:1.75rem;font-weight:300;line-height:1.2}.bg-dark-alt,.bg-dark-alt:focus{background:#36363f}.bg-orange,.bg-orange:focus{background:#f14600}.text-dark-alt{color:#36363f}.btn-dark-alt{background:#36363f}.btn-dark-alt:focus{background:#36363f}.btn-outline-orange{border-color:#f14600;color:#f14600}.btn-orange,.btn-outline-orange:hover{background:#f14600;color:#fff}.btn:active,.btn:hover{text-decoration:none}.text-orange{color:#f14600}.bg-number{position:absolute;font-size:900%;font-weight:700;color:rgba(241,70,0,.1);line-height:1;margin-top:-1rem}.headerlink{text-decoration:none;margin-left:.5rem}#content table{border:1px solid #dee2e6;width:100%;margin-bottom:1rem;overflow-x:auto}#content code{color:#000;background:#eee;padding:.125rem .25rem}#content code.syntax{padding:0}#content pre{background:#efefef;padding:1rem;line-height:1.25}@media print{body{min-width:0}code,h1,h2,h3,h4,h5,h6,img,li,p,pre{page-break-inside:avoid}}@media(prefers-color-scheme:dark){#to-full-website,body.amp,body[data-spy]{background:#1c1c1c;color:#efefef}.invert-dark{filter:invert(100%)}#content table{border:1px solid #2a2b2c}#content code{background:#444;color:#eee;padding:.125rem .25rem}#content pre{background:#444;color:#eee}}.syntax{background:#f8f9fa;color:#2f1e2e}.syntax .c{color:#8d8687}.syntax .k{color:#000;font-weight:700}.syntax .l{color:#08f}.syntax .n{color:#2f1e2e}.syntax .o{color:#800}.syntax .p{color:#2f1e2e}.syntax .c1{color:#8d8687}.syntax .ld{color:#48b685}.syntax .m{color:#08f}.syntax .s{color:#48b685}.syntax .nb{color:#2f1e2e}.syntax .ne{color:#ef6155}.syntax .py{color:#2f1e2e}.syntax .nt{color:#5bc4bf}.syntax .mi{color:#08f}.syntax .sc{color:#2f1e2e}.syntax .s2{color:#48b685}.syntax .se{color:#08f}.syntax .si{color:#08f}.syntax .s1{color:#080}.syntax .il{color:#08f}@media(prefers-color-scheme:dark){.syntax .k{color:#c78cff}.syntax .ld{color:#64ffbb}.syntax .s{color:#64ffbb}.syntax .s2{color:#64ffbb}.syntax .s1{color:#64ffbb}.syntax .c{color:#64ffbb}.syntax .n{color:#f8f9fa}.syntax .p{color:#f8f9fa}.syntax .nb{color:#f8f9fa}.syntax .py{color:#f8f9fa}.syntax .sc{color:#f8f9fa}}</style><script async custom-element=amp-analytics src=https://cdn.ampproject.org/v0/amp-analytics-0.1.js></script><script async custom-element=amp-iframe src=https://cdn.ampproject.org/v0/amp-iframe-0.1.js></script></head> <body class=amp dir=ltr> <div class="container-fluid container-lg pb-5"> <div class="row pt-3 mb-3"> <div class=col> <a href=/ class=text-decoration-none> <amp-img class="d-inline-block mr-3" layout=fixed width=40 height=36 src=/images/logo.svg alt="ClickHouse logo" title="ClickHouse logo"></amp-img><amp-img class="invert-dark d-inline-block" layout=fixed width=238 height=36 src=/images/clickhouse-black.svg alt=ClickHouse title=ClickHouse></amp-img> </a> </div> </div> <div class=row> <div id=content class=col> <div class="alert alert-primary" role=alert> <p class="display-5 mb-2">Help wanted!</p> <p class=lead>The following content of this documentation page has been machine-translated. But unlike other websites, it is not done on the fly. This translated text lives on GitHub repository alongside main ClickHouse codebase and waits for fellow native speakers to make it more human-readable. <a href=/docs/en/sql-reference/dictionaries/external-dictionaries/external-dicts-dict-layout/ class=alert-link>You can also use the original English version as a reference.</a></p> <p class=lead> <a class="btn btn-lg btn-primary text-white" href=https://github.com/ClickHouse/ClickHouse/edit/master/docs/fr/sql-reference/dictionaries/external-dictionaries/external-dicts-dict-layout.md target=_blank rel="external nofollow noreferrer"> Help ClickHouse documentation by editing this page </a> </p> </div> <h1 id=dicts-external-dicts-dict-layout>Stockage des dictionnaires en mémoire<a class=headerlink href=../amp/#dicts-external-dicts-dict-layout title="Permanent link"> </a></h1> <p>Il existe une variété de façons de stocker les dictionnaires en mémoire.</p> <p>Nous vous recommandons <a href=../amp/#flat>plat</a>, <a href=../amp/#dicts-external_dicts_dict_layout-hashed>haché</a> et <a href=../amp/#complex-key-hashed>complex_key_hashed</a>. qui fournissent la vitesse de traitement optimale.</p> <p>La mise en cache n'est pas recommandée en raison de performances potentiellement médiocres et de difficultés à sélectionner les paramètres optimaux. En savoir plus dans la section “<a href=../amp/#cache>cache</a>”.</p> <p>Il existe plusieurs façons d'améliorer les performances du dictionnaire:</p> <ul> <li>Appelez la fonction pour travailler avec le dictionnaire après <code class=syntax>GROUP BY</code>.</li> <li>Marquer les attributs à extraire comme injectifs. Un attribut est appelé injectif si différentes valeurs d'attribut correspondent à différentes clés. Alors, quand <code class=syntax>GROUP BY</code> utilise une fonction qui récupère une valeur d'attribut par la clé, cette fonction est automatiquement retirée de <code class=syntax>GROUP BY</code>.</li> </ul> <p>ClickHouse génère une exception pour les erreurs avec les dictionnaires. Des exemples d'erreurs:</p> <ul> <li>Le dictionnaire accessible n'a pas pu être chargé.</li> <li>Erreur de la requête d'une <code class=syntax>cached</code> dictionnaire.</li> </ul> <p>Vous pouvez afficher la liste des dictionnaires externes et leurs statuts dans le <code class=syntax>system.dictionaries</code> table.</p> <p>La configuration ressemble à ceci:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;yandex&gt;</span>
    <span class=nt>&lt;dictionary&gt;</span>
        ...
        <span class=nt>&lt;layout&gt;</span>
            <span class=nt>&lt;layout_type&gt;</span>
                <span class=c>&lt;!-- layout settings --&gt;</span>
            <span class=nt>&lt;/layout_type&gt;</span>
        <span class=nt>&lt;/layout&gt;</span>
        ...
    <span class=nt>&lt;/dictionary&gt;</span>
<span class=nt>&lt;/yandex&gt;</span>
</code></pre></div> <p>Correspondant <a href=../../../../statements/create/amp/#create-dictionary-query>DDL-requête</a>:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span> <span class=k>DICTIONARY</span> <span class=p>(...)</span>
<span class=p>...</span>
<span class=n>LAYOUT</span><span class=p>(</span><span class=n>LAYOUT_TYPE</span><span class=p>(</span><span class=n>param</span> <span class=n>value</span><span class=p>))</span> <span class=c1>-- layout settings</span>
<span class=p>...</span>
</code></pre></div> <h2 id=ways-to-store-dictionaries-in-memory>Façons de stocker des dictionnaires en mémoire<a class=headerlink href=../amp/#ways-to-store-dictionaries-in-memory title="Permanent link"> </a></h2> <ul> <li><a href=../amp/#flat>plat</a></li> <li><a href=../amp/#dicts-external_dicts_dict_layout-hashed>haché</a></li> <li><a href=../amp/#dicts-external_dicts_dict_layout-sparse_hashed>sparse_hashed</a></li> <li><a href=../amp/#cache>cache</a></li> <li><a href=../amp/#direct>direct</a></li> <li><a href=../amp/#range-hashed>range_hashed</a></li> <li><a href=../amp/#complex-key-hashed>complex_key_hashed</a></li> <li><a href=../amp/#complex-key-cache>complex_key_cache</a></li> <li><a href=../amp/#complex-key-direct>complex_key_direct</a></li> <li><a href=../amp/#ip-trie>ip_trie</a></li> </ul> <h3 id=flat>plat<a class=headerlink href=../amp/#flat title="Permanent link"> </a></h3> <p>Le dictionnaire est complètement stocké en mémoire sous la forme de tableaux plats. Combien de mémoire le dictionnaire utilise-t-il? Le montant est proportionnel à la taille de la plus grande clé (dans l'espace).</p> <p>La clé du dictionnaire a le <code class=syntax>UInt64</code> type et la valeur est limitée à 500 000. Si une clé plus grande est découverte lors de la création du dictionnaire, ClickHouse lève une exception et ne crée pas le dictionnaire.</p> <p>Tous les types de sources sont pris en charge. Lors de la mise à jour, les données (à partir d'un fichier ou d'une table) sont lues dans leur intégralité.</p> <p>Cette méthode fournit les meilleures performances parmi toutes les méthodes disponibles de stockage du dictionnaire.</p> <p>Exemple de Configuration:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;layout&gt;</span>
  <span class=nt>&lt;flat</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;/layout&gt;</span>
</code></pre></div> <p>ou</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>LAYOUT</span><span class=p>(</span><span class=n>FLAT</span><span class=p>())</span>
</code></pre></div> <h3 id=dicts-external_dicts_dict_layout-hashed>haché<a class=headerlink href=../amp/#dicts-external_dicts_dict_layout-hashed title="Permanent link"> </a></h3> <p>Le dictionnaire est entièrement stockée en mémoire sous la forme d'une table de hachage. Le dictionnaire peut contenir n'importe quel nombre d'éléments avec tous les identificateurs Dans la pratique, le nombre de clés peut atteindre des dizaines de millions d'articles.</p> <p>Tous les types de sources sont pris en charge. Lors de la mise à jour, les données (à partir d'un fichier ou d'une table) sont lues dans leur intégralité.</p> <p>Exemple de Configuration:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;layout&gt;</span>
  <span class=nt>&lt;hashed</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;/layout&gt;</span>
</code></pre></div> <p>ou</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>LAYOUT</span><span class=p>(</span><span class=n>HASHED</span><span class=p>())</span>
</code></pre></div> <h3 id=dicts-external_dicts_dict_layout-sparse_hashed>sparse_hashed<a class=headerlink href=../amp/#dicts-external_dicts_dict_layout-sparse_hashed title="Permanent link"> </a></h3> <p>Semblable à <code class=syntax>hashed</code>, mais utilise moins de mémoire en faveur de plus D'utilisation du processeur.</p> <p>Exemple de Configuration:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;layout&gt;</span>
  <span class=nt>&lt;sparse_hashed</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;/layout&gt;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=n>LAYOUT</span><span class=p>(</span><span class=n>SPARSE_HASHED</span><span class=p>())</span>
</code></pre></div> <h3 id=complex-key-hashed>complex_key_hashed<a class=headerlink href=../amp/#complex-key-hashed title="Permanent link"> </a></h3> <p>Ce type de stockage est pour une utilisation avec composite <a href=../../external-dicts-dict-structure/amp/ >touches</a>. Semblable à <code class=syntax>hashed</code>.</p> <p>Exemple de Configuration:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;layout&gt;</span>
  <span class=nt>&lt;complex_key_hashed</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;/layout&gt;</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=n>LAYOUT</span><span class=p>(</span><span class=n>COMPLEX_KEY_HASHED</span><span class=p>())</span>
</code></pre></div> <h3 id=range-hashed>range_hashed<a class=headerlink href=../amp/#range-hashed title="Permanent link"> </a></h3> <p>Le dictionnaire est stocké en mémoire sous la forme d'une table de hachage avec un tableau ordonné de gammes et leurs valeurs correspondantes.</p> <p>Cette méthode de stockage fonctionne de la même manière que hachée et permet d'utiliser des plages de date / heure (Type numérique arbitraire) en plus de la clé.</p> <p>Exemple: Le tableau contient des réductions pour chaque annonceur dans le format:</p> <div class=codehilite><pre><span></span><code class=syntax>+---------|-------------|-------------|------+
| advertiser id | discount start date | discount end date | amount |
+===============+=====================+===================+========+
| 123           | 2015-01-01          | 2015-01-15        | 0.15   |
+---------|-------------|-------------|------+
| 123           | 2015-01-16          | 2015-01-31        | 0.25   |
+---------|-------------|-------------|------+
| 456           | 2015-01-01          | 2015-01-15        | 0.05   |
+---------|-------------|-------------|------+
</code></pre></div> <p>Pour utiliser un échantillon pour les plages de dates, définissez <code class=syntax>range_min</code> et <code class=syntax>range_max</code> éléments dans le <a href=../../external-dicts-dict-structure/amp/ >structure</a>. Ces éléments doivent contenir des éléments <code class=syntax>name</code> et<code class=syntax>type</code> (si <code class=syntax>type</code> n'est pas spécifié, le type par défaut sera utilisé-Date). <code class=syntax>type</code> peut être n'importe quel type numérique (Date / DateTime / UInt64 / Int32 / autres).</p> <p>Exemple:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;structure&gt;</span>
    <span class=nt>&lt;id&gt;</span>
        <span class=nt>&lt;name&gt;</span>Id<span class=nt>&lt;/name&gt;</span>
    <span class=nt>&lt;/id&gt;</span>
    <span class=nt>&lt;range_min&gt;</span>
        <span class=nt>&lt;name&gt;</span>first<span class=nt>&lt;/name&gt;</span>
        <span class=nt>&lt;type&gt;</span>Date<span class=nt>&lt;/type&gt;</span>
    <span class=nt>&lt;/range_min&gt;</span>
    <span class=nt>&lt;range_max&gt;</span>
        <span class=nt>&lt;name&gt;</span>last<span class=nt>&lt;/name&gt;</span>
        <span class=nt>&lt;type&gt;</span>Date<span class=nt>&lt;/type&gt;</span>
    <span class=nt>&lt;/range_max&gt;</span>
    ...
</code></pre></div> <p>ou</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span> <span class=k>DICTIONARY</span> <span class=n>somedict</span> <span class=p>(</span>
    <span class=n>id</span> <span class=n>UInt64</span><span class=p>,</span>
    <span class=k>first</span> <span class=nb>Date</span><span class=p>,</span>
    <span class=k>last</span> <span class=nb>Date</span>
<span class=p>)</span>
<span class=k>PRIMARY</span> <span class=k>KEY</span> <span class=n>id</span>
<span class=n>LAYOUT</span><span class=p>(</span><span class=n>RANGE_HASHED</span><span class=p>())</span>
<span class=n>RANGE</span><span class=p>(</span><span class=k>MIN</span> <span class=k>first</span> <span class=k>MAX</span> <span class=k>last</span><span class=p>)</span>
</code></pre></div> <p>Pour travailler avec ces dictionnaires, vous devez passer un argument supplémentaire à l' <code class=syntax>dictGetT</code> fonction, pour laquelle une plage est sélectionnée:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>dictGetT</span><span class=p>(</span><span class=s1>'dict_name'</span><span class=p>,</span> <span class=s1>'attr_name'</span><span class=p>,</span> <span class=n>id</span><span class=p>,</span> <span class=nb>date</span><span class=p>)</span>
</code></pre></div> <p>Cette fonction retourne la valeur pour l' <code class=syntax>id</code>s et la plage de dates qui inclut la date passée.</p> <p>Détails de l'algorithme:</p> <ul> <li>Si l' <code class=syntax>id</code> est introuvable ou une plage n'est pas trouvé pour l' <code class=syntax>id</code> il retourne la valeur par défaut pour le dictionnaire.</li> <li>S'il y a des plages qui se chevauchent, vous pouvez en utiliser.</li> <li>Si le délimiteur est <code class=syntax>NULL</code> ou une date non valide (telle que 1900-01-01 ou 2039-01-01), la plage est laissée ouverte. La gamme peut être ouverte des deux côtés.</li> </ul> <p>Exemple de Configuration:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;yandex&gt;</span>
        <span class=nt>&lt;dictionary&gt;</span>

                ...

                <span class=nt>&lt;layout&gt;</span>
                        <span class=nt>&lt;range_hashed</span> <span class=nt>/&gt;</span>
                <span class=nt>&lt;/layout&gt;</span>

                <span class=nt>&lt;structure&gt;</span>
                        <span class=nt>&lt;id&gt;</span>
                                <span class=nt>&lt;name&gt;</span>Abcdef<span class=nt>&lt;/name&gt;</span>
                        <span class=nt>&lt;/id&gt;</span>
                        <span class=nt>&lt;range_min&gt;</span>
                                <span class=nt>&lt;name&gt;</span>StartTimeStamp<span class=nt>&lt;/name&gt;</span>
                                <span class=nt>&lt;type&gt;</span>UInt64<span class=nt>&lt;/type&gt;</span>
                        <span class=nt>&lt;/range_min&gt;</span>
                        <span class=nt>&lt;range_max&gt;</span>
                                <span class=nt>&lt;name&gt;</span>EndTimeStamp<span class=nt>&lt;/name&gt;</span>
                                <span class=nt>&lt;type&gt;</span>UInt64<span class=nt>&lt;/type&gt;</span>
                        <span class=nt>&lt;/range_max&gt;</span>
                        <span class=nt>&lt;attribute&gt;</span>
                                <span class=nt>&lt;name&gt;</span>XXXType<span class=nt>&lt;/name&gt;</span>
                                <span class=nt>&lt;type&gt;</span>String<span class=nt>&lt;/type&gt;</span>
                                <span class=nt>&lt;null_value</span> <span class=nt>/&gt;</span>
                        <span class=nt>&lt;/attribute&gt;</span>
                <span class=nt>&lt;/structure&gt;</span>

        <span class=nt>&lt;/dictionary&gt;</span>
<span class=nt>&lt;/yandex&gt;</span>
</code></pre></div> <p>ou</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span> <span class=k>DICTIONARY</span> <span class=n>somedict</span><span class=p>(</span>
    <span class=n>Abcdef</span> <span class=n>UInt64</span><span class=p>,</span>
    <span class=n>StartTimeStamp</span> <span class=n>UInt64</span><span class=p>,</span>
    <span class=n>EndTimeStamp</span> <span class=n>UInt64</span><span class=p>,</span>
    <span class=n>XXXType</span> <span class=n>String</span> <span class=k>DEFAULT</span> <span class=s1>''</span>
<span class=p>)</span>
<span class=k>PRIMARY</span> <span class=k>KEY</span> <span class=n>Abcdef</span>
<span class=n>RANGE</span><span class=p>(</span><span class=k>MIN</span> <span class=n>StartTimeStamp</span> <span class=k>MAX</span> <span class=n>EndTimeStamp</span><span class=p>)</span>
</code></pre></div> <h3 id=cache>cache<a class=headerlink href=../amp/#cache title="Permanent link"> </a></h3> <p>Le dictionnaire est stocké dans un cache qui a un nombre fixe de cellules. Ces cellules contiennent des éléments fréquemment utilisés.</p> <p>Lors de la recherche d'un dictionnaire, le cache est recherché en premier. Pour chaque bloc de données, toutes les clés qui ne sont pas trouvées dans le cache ou qui sont obsolètes sont demandées à la source en utilisant <code class=syntax>SELECT attrs... FROM db.table WHERE id IN (k1, k2, ...)</code>. Les données reçues sont ensuite écrites dans le cache.</p> <p>Pour les dictionnaires de cache, l'expiration <a href=../../external-dicts-dict-lifetime/amp/ >vie</a> des données dans le cache peuvent être définies. Si plus de temps que <code class=syntax>lifetime</code> passé depuis le chargement des données dans une cellule, la valeur de la cellule n'est pas utilisée et elle est demandée à nouveau la prochaine fois qu'elle doit être utilisée.<br> C'est la moins efficace de toutes les façons de stocker les dictionnaires. La vitesse du cache dépend fortement des paramètres corrects et que le scénario d'utilisation. Un dictionnaire de type de cache fonctionne bien uniquement lorsque les taux de réussite sont suffisamment élevés (recommandé 99% et plus). Vous pouvez afficher le taux de réussite moyen dans le <code class=syntax>system.dictionaries</code> table.</p> <p>Pour améliorer les performances du cache, utilisez une sous-requête avec <code class=syntax>LIMIT</code>, et appelez la fonction avec le dictionnaire en externe.</p> <p>Soutenu <a href=../../external-dicts-dict-sources/amp/ >source</a>: MySQL, ClickHouse, exécutable, HTTP.</p> <p>Exemple de paramètres:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;layout&gt;</span>
    <span class=nt>&lt;cache&gt;</span>
        <span class=c>&lt;!-- The size of the cache, in number of cells. Rounded up to a power of two. --&gt;</span>
        <span class=nt>&lt;size_in_cells&gt;</span>1000000000<span class=nt>&lt;/size_in_cells&gt;</span>
    <span class=nt>&lt;/cache&gt;</span>
<span class=nt>&lt;/layout&gt;</span>
</code></pre></div> <p>ou</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>LAYOUT</span><span class=p>(</span><span class=k>CACHE</span><span class=p>(</span><span class=n>SIZE_IN_CELLS</span> <span class=mi>1000000000</span><span class=p>))</span>
</code></pre></div> <p>Définissez une taille de cache suffisamment grande. Vous devez expérimenter pour sélectionner le nombre de cellules:</p> <ol> <li>Définissez une valeur.</li> <li>Exécutez les requêtes jusqu'à ce que le cache soit complètement plein.</li> <li>Évaluer la consommation de mémoire en utilisant le <code class=syntax>system.dictionaries</code> table.</li> <li>Augmentez ou diminuez le nombre de cellules jusqu'à ce que la consommation de mémoire requise soit atteinte.</li> </ol> <div class="admonition warning alert pb-0 mb-4 alert-warning" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Avertissement</p> <p>N'utilisez pas ClickHouse comme source, car le traitement des requêtes avec des lectures aléatoires est lent.</p> </div> <h3 id=complex-key-cache>complex_key_cache<a class=headerlink href=../amp/#complex-key-cache title="Permanent link"> </a></h3> <p>Ce type de stockage est pour une utilisation avec composite <a href=../../external-dicts-dict-structure/amp/ >touches</a>. Semblable à <code class=syntax>cache</code>.</p> <h3 id=direct>direct<a class=headerlink href=../amp/#direct title="Permanent link"> </a></h3> <p>Le dictionnaire n'est pas stocké dans la mémoire et va directement à la source, pendant le traitement d'une demande.</p> <p>La clé du dictionnaire a le <code class=syntax>UInt64</code> type.</p> <p>Tous les types de <a href=../../external-dicts-dict-sources/amp/ >source</a>, sauf les fichiers locaux, sont pris en charge.</p> <p>Exemple de Configuration:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;layout&gt;</span>
  <span class=nt>&lt;direct</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;/layout&gt;</span>
</code></pre></div> <p>ou</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>LAYOUT</span><span class=p>(</span><span class=n>DIRECT</span><span class=p>())</span>
</code></pre></div> <h3 id=complex-key-direct>complex_key_direct<a class=headerlink href=../amp/#complex-key-direct title="Permanent link"> </a></h3> <p>Ce type de stockage est destiné à être utilisé avec des <a href=../../external-dicts-dict-structure/amp/ >clés</a> composites. Similaire à <code class=syntax>direct</code></p> <h3 id=ip-trie>ip_trie<a class=headerlink href=../amp/#ip-trie title="Permanent link"> </a></h3> <p>Ce type de stockage permet de mapper des préfixes de réseau (adresses IP) à des métadonnées telles que ASN.</p> <p>Exemple: la table contient les préfixes de réseau et leur correspondant en tant que numéro et Code de pays:</p> <div class=codehilite><pre><span></span><code class=syntax>  +-----------|-----|------+
  | prefix          | asn   | cca2   |
  +=================+=======+========+
  | 202.79.32.0/20  | 17501 | NP     |
  +-----------|-----|------+
  | 2620:0:870::/48 | 3856  | US     |
  +-----------|-----|------+
  | 2a02:6b8:1::/48 | 13238 | RU     |
  +-----------|-----|------+
  | 2001:db8::/32   | 65536 | ZZ     |
  +-----------|-----|------+
</code></pre></div> <p>Lorsque vous utilisez ce type de mise en page, la structure doit avoir une clé composite.</p> <p>Exemple:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;structure&gt;</span>
    <span class=nt>&lt;key&gt;</span>
        <span class=nt>&lt;attribute&gt;</span>
            <span class=nt>&lt;name&gt;</span>prefix<span class=nt>&lt;/name&gt;</span>
            <span class=nt>&lt;type&gt;</span>String<span class=nt>&lt;/type&gt;</span>
        <span class=nt>&lt;/attribute&gt;</span>
    <span class=nt>&lt;/key&gt;</span>
    <span class=nt>&lt;attribute&gt;</span>
            <span class=nt>&lt;name&gt;</span>asn<span class=nt>&lt;/name&gt;</span>
            <span class=nt>&lt;type&gt;</span>UInt32<span class=nt>&lt;/type&gt;</span>
            <span class=nt>&lt;null_value</span> <span class=nt>/&gt;</span>
    <span class=nt>&lt;/attribute&gt;</span>
    <span class=nt>&lt;attribute&gt;</span>
            <span class=nt>&lt;name&gt;</span>cca2<span class=nt>&lt;/name&gt;</span>
            <span class=nt>&lt;type&gt;</span>String<span class=nt>&lt;/type&gt;</span>
            <span class=nt>&lt;null_value&gt;</span>??<span class=nt>&lt;/null_value&gt;</span>
    <span class=nt>&lt;/attribute&gt;</span>
    ...
<span class=nt>&lt;/structure&gt;</span>
<span class=nt>&lt;layout&gt;</span>
    <span class=nt>&lt;ip_trie&gt;</span>
        <span class=nt>&lt;access_to_key_from_attributes&gt;</span>true<span class=nt>&lt;/access_to_key_from_attributes&gt;</span>
    <span class=nt>&lt;/ip_trie&gt;</span>
<span class=nt>&lt;/layout&gt;</span>
</code></pre></div> <p>ou</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span> <span class=k>DICTIONARY</span> <span class=n>somedict</span> <span class=p>(</span>
    <span class=k>prefix</span> <span class=n>String</span><span class=p>,</span>
    <span class=n>asn</span> <span class=n>UInt32</span><span class=p>,</span>
    <span class=n>cca2</span> <span class=n>String</span> <span class=k>DEFAULT</span> <span class=s1>'??'</span>
<span class=p>)</span>
<span class=k>PRIMARY</span> <span class=k>KEY</span> <span class=k>prefix</span>
</code></pre></div> <p>La clé ne doit avoir qu'un seul attribut de type chaîne contenant un préfixe IP autorisé. Les autres types ne sont pas encore pris en charge.</p> <p>Pour les requêtes, vous devez utiliser les mêmes fonctions (<code class=syntax>dictGetT</code> avec un n-uplet) comme pour les dictionnaires avec des clés composites:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>dictGetT</span><span class=p>(</span><span class=s1>'dict_name'</span><span class=p>,</span> <span class=s1>'attr_name'</span><span class=p>,</span> <span class=n>tuple</span><span class=p>(</span><span class=n>ip</span><span class=p>))</span>
</code></pre></div> <p>La fonction prend soit <code class=syntax>UInt32</code> pour IPv4, ou <code class=syntax>FixedString(16)</code> pour IPv6:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>dictGetString</span><span class=p>(</span><span class=s1>'prefix'</span><span class=p>,</span> <span class=s1>'asn'</span><span class=p>,</span> <span class=n>tuple</span><span class=p>(</span><span class=n>IPv6StringToNum</span><span class=p>(</span><span class=s1>'2001:db8::1'</span><span class=p>)))</span>
</code></pre></div> <p>Les autres types ne sont pas encore pris en charge. La fonction renvoie l'attribut du préfixe correspondant à cette adresse IP. S'il y a chevauchement des préfixes, le plus spécifique est retourné.</p> <p>Les données doit complètement s'intégrer dans la RAM.</p> <p><a href=https://clickhouse.tech/docs/en/query_language/dicts/external_dicts_dict_layout/ target=_blank>Article Original</a> <!--hide--></p> </div> </div> <div class=row> <div class=col> <div class="alert alert-light my-3"> <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p> <span class="alert-heading display-6">Article Rating</span> <div id=rating-stars class="display-6 mb-0">RATING_STARS</div> </div> <div id=content-footer class="text-muted pt-3 mb-5"> <div class=float-md-right>©2016–2020 Yandex LLC</div> <div>Built from <a href=https://github.com/ClickHouse/ClickHouse/commit/b030bfedd7db4603034643fd183cf7784a820193 rel="external nofollow noreferrer" target=_blank class=text-reset>b030bfedd7</a> </div> </div> </div> </div> <div id=to-full-website class="row fixed-bottom text-center bg-white py-3"> <div class=col> <a href=https://clickhouse.tech/docs/fr/sql-reference/dictionaries/external-dictionaries/external-dicts-dict-layout/ class="btn btn-lg btn-outline-orange">To full website</a> </div> </div> </div> <amp-analytics type=metrika> <script type=application/json>{
"vars": {
  "counterId": "18343495",
  "triggers": {
    "notBounce": {
      "on": "timer",
      "timerSpec": {
        "immediate": false,
        "interval": 15,
        "maxTimerLength": 16
      },
      "request": "notBounce"
    }
  }
}
}</script> </amp-analytics> </body> </html> 