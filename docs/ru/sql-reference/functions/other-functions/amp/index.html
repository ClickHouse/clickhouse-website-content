<!doctype html><html ⚡ lang=ru> <head><meta charset=utf-8><script async src=https://cdn.ampproject.org/v0.js></script><title>Прочие функции | Документация ClickHouse</title><link href=https://clickhouse.tech/docs/ru/sql-reference/functions/other-functions/ rel=canonical><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><script type=application/ld+json>[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "Прочие функции | Документация ClickHouse",
"mainEntityOfPage": "https://clickhouse.tech/docs/ru/sql-reference/functions/other-functions/",




"image": "https://clickhouse.tech/images/logo-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "Yandex LLC",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.tech/images/yandex.png",
    "width": 163,
    "height": 60
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "Прочие функции | Документация ClickHouse",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script><style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript><style amp-custom>:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--white:#fff;--gray:#6c757d;--gray-dark:#343a40;--primary:#007bff;--secondary:#6c757d;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f8f9fa;--dark:#343a40;--breakpoint-xs:0;--breakpoint-sm:576px;--breakpoint-md:768px;--breakpoint-lg:992px;--breakpoint-xl:1200px;--font-family-sans-serif:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,::after,::before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}article,footer{display:block}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem}p{margin-top:0;margin-bottom:1rem}ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dd{margin-bottom:.5rem;margin-left:0}b,strong{font-weight:bolder}a{color:#007bff;text-decoration:none;background-color:transparent}a:hover{color:#0056b3;text-decoration:underline}a:not([href]){color:inherit;text-decoration:none}a:not([href]):hover{color:inherit;text-decoration:none}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}img{vertical-align:middle;border-style:none}svg{overflow:hidden;vertical-align:middle}table{border-collapse:collapse}select{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit]{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{padding:0;border-style:none}progress{vertical-align:baseline}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:.5rem;font-weight:500;line-height:1.2}.h1,h1{font-size:2rem}.h2,h2{font-size:1.5rem}.h3,h3{font-size:1.25rem}.h4,h4{font-size:1rem}.h5,h5{font-size:1rem}.h6,h6{font-size:1rem}.lead{font-size:1.25rem;font-weight:300}.display-1{font-size:6rem;font-weight:300;line-height:1.2}.display-2{font-size:5.5rem;font-weight:300;line-height:1.2}.display-3{font-size:4.5rem;font-weight:300;line-height:1.2}.display-4{font-size:3.5rem;font-weight:300;line-height:1.2}.img-fluid{max-width:100%;height:auto}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}pre{display:block;font-size:87.5%;color:#212529}pre code{font-size:inherit;color:inherit;word-break:normal}.container{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container{max-width:720px}}@media(min-width:992px){.container{max-width:960px}}@media(min-width:1200px){.container{max-width:1140px}}.container-fluid,.container-lg,.container-md{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container,.container-md{max-width:720px}}@media(min-width:992px){.container,.container-lg,.container-md{max-width:960px}}@media(min-width:1200px){.container,.container-lg,.container-md{max-width:1140px}}.row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-15px;margin-left:-15px}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9{position:relative;width:100%;padding-right:15px;padding-left:15px}.col{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-0{-ms-flex-order:0;order:0}.order-1{-ms-flex-order:1;order:1}.order-2{-ms-flex-order:2;order:2}.order-3{-ms-flex-order:3;order:3}.order-4{-ms-flex-order:4;order:4}.order-5{-ms-flex-order:5;order:5}.order-6{-ms-flex-order:6;order:6}.order-7{-ms-flex-order:7;order:7}.order-8{-ms-flex-order:8;order:8}.order-9{-ms-flex-order:9;order:9}.order-10{-ms-flex-order:10;order:10}.order-11{-ms-flex-order:11;order:11}.order-12{-ms-flex-order:12;order:12}.offset-1{margin-left:8.333333%}.offset-2{margin-left:16.666667%}.offset-3{margin-left:25%}.offset-4{margin-left:33.333333%}.offset-5{margin-left:41.666667%}.offset-6{margin-left:50%}.offset-7{margin-left:58.333333%}.offset-8{margin-left:66.666667%}.offset-9{margin-left:75%}.offset-10{margin-left:83.333333%}.offset-11{margin-left:91.666667%}@media(min-width:768px){.col-md{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-md-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-md-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-md-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-md-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-md-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-md-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-md-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-md-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-md-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-md-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-md-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-md-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-md-0{-ms-flex-order:0;order:0}.order-md-1{-ms-flex-order:1;order:1}.order-md-2{-ms-flex-order:2;order:2}.order-md-3{-ms-flex-order:3;order:3}.order-md-4{-ms-flex-order:4;order:4}.order-md-5{-ms-flex-order:5;order:5}.order-md-6{-ms-flex-order:6;order:6}.order-md-7{-ms-flex-order:7;order:7}.order-md-8{-ms-flex-order:8;order:8}.order-md-9{-ms-flex-order:9;order:9}.order-md-10{-ms-flex-order:10;order:10}.order-md-11{-ms-flex-order:11;order:11}.order-md-12{-ms-flex-order:12;order:12}.offset-md-0{margin-left:0}.offset-md-1{margin-left:8.333333%}.offset-md-2{margin-left:16.666667%}.offset-md-3{margin-left:25%}.offset-md-4{margin-left:33.333333%}.offset-md-5{margin-left:41.666667%}.offset-md-6{margin-left:50%}.offset-md-7{margin-left:58.333333%}.offset-md-8{margin-left:66.666667%}.offset-md-9{margin-left:75%}.offset-md-10{margin-left:83.333333%}.offset-md-11{margin-left:91.666667%}}@media(min-width:992px){.col-lg{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-lg-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-lg-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-lg-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-lg-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-lg-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-lg-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-lg-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-lg-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-lg-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-lg-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-lg-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-lg-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-lg-0{-ms-flex-order:0;order:0}.order-lg-1{-ms-flex-order:1;order:1}.order-lg-2{-ms-flex-order:2;order:2}.order-lg-3{-ms-flex-order:3;order:3}.order-lg-4{-ms-flex-order:4;order:4}.order-lg-5{-ms-flex-order:5;order:5}.order-lg-6{-ms-flex-order:6;order:6}.order-lg-7{-ms-flex-order:7;order:7}.order-lg-8{-ms-flex-order:8;order:8}.order-lg-9{-ms-flex-order:9;order:9}.order-lg-10{-ms-flex-order:10;order:10}.order-lg-11{-ms-flex-order:11;order:11}.order-lg-12{-ms-flex-order:12;order:12}.offset-lg-0{margin-left:0}.offset-lg-1{margin-left:8.333333%}.offset-lg-2{margin-left:16.666667%}.offset-lg-3{margin-left:25%}.offset-lg-4{margin-left:33.333333%}.offset-lg-5{margin-left:41.666667%}.offset-lg-6{margin-left:50%}.offset-lg-7{margin-left:58.333333%}.offset-lg-8{margin-left:66.666667%}.offset-lg-9{margin-left:75%}.offset-lg-10{margin-left:83.333333%}.offset-lg-11{margin-left:91.666667%}}.table{width:100%;margin-bottom:1rem;color:#212529}.table-warning{background-color:#ffeeba}.table-light{background-color:#fdfdfe}.table-dark{background-color:#c6c8ca}.table-dark{color:#fff;background-color:#343a40}.btn{display:inline-block;font-weight:400;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:.375rem .75rem;font-size:1rem;line-height:1.5;border-radius:.25rem}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus{outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.btn:disabled{opacity:.65}.btn-warning{color:#212529;background-color:#ffc107;border-color:#ffc107}.btn-warning:hover{color:#212529;background-color:#e0a800;border-color:#d39e00}.btn-warning:focus{color:#212529;background-color:#e0a800;border-color:#d39e00;box-shadow:0 0 0 .2rem rgba(222,170,12,.5)}.btn-warning:disabled{color:#212529;background-color:#ffc107;border-color:#ffc107}.btn-light{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-light:hover{color:#212529;background-color:#e2e6ea;border-color:#dae0e5}.btn-light:focus{color:#212529;background-color:#e2e6ea;border-color:#dae0e5;box-shadow:0 0 0 .2rem rgba(216,217,219,.5)}.btn-light:disabled{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-dark{color:#fff;background-color:#343a40;border-color:#343a40}.btn-dark:hover{color:#fff;background-color:#23272b;border-color:#1d2124}.btn-dark:focus{color:#fff;background-color:#23272b;border-color:#1d2124;box-shadow:0 0 0 .2rem rgba(82,88,93,.5)}.btn-dark:disabled{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-warning{color:#ffc107;border-color:#ffc107}.btn-outline-warning:hover{color:#212529;background-color:#ffc107;border-color:#ffc107}.btn-outline-warning:focus{box-shadow:0 0 0 .2rem rgba(255,193,7,.5)}.btn-outline-warning:disabled{color:#ffc107;background-color:transparent}.btn-outline-light{color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:hover{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:focus{box-shadow:0 0 0 .2rem rgba(248,249,250,.5)}.btn-outline-light:disabled{color:#f8f9fa;background-color:transparent}.btn-outline-dark{color:#343a40;border-color:#343a40}.btn-outline-dark:hover{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-dark:focus{box-shadow:0 0 0 .2rem rgba(52,58,64,.5)}.btn-outline-dark:disabled{color:#343a40;background-color:transparent}.btn-link{font-weight:400;color:#007bff;text-decoration:none}.btn-link:hover{color:#0056b3;text-decoration:underline}.btn-link:focus{text-decoration:underline;box-shadow:none}.btn-link:disabled{color:#6c757d;pointer-events:none}.btn-group-lg>.btn,.btn-lg{padding:.5rem 1rem;font-size:1.25rem;line-height:1.5;border-radius:.3rem}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:.5rem}.btn-group,.btn-group-vertical{position:relative;display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle}.btn-group-vertical>.btn,.btn-group>.btn{position:relative;-ms-flex:1 1 auto;flex:1 1 auto}.btn-group-vertical>.btn:hover,.btn-group>.btn:hover{z-index:1}.btn-group-vertical>.btn:active,.btn-group-vertical>.btn:focus,.btn-group>.btn:active,.btn-group>.btn:focus{z-index:1}.btn-group>.btn-group:not(:first-child),.btn-group>.btn:not(:first-child){margin-left:-1px}.btn-group>.btn-group:not(:last-child)>.btn{border-top-right-radius:0;border-bottom-right-radius:0}.btn-group>.btn-group:not(:first-child)>.btn,.btn-group>.btn:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.btn-group-vertical{-ms-flex-direction:column;flex-direction:column;-ms-flex-align:start;align-items:flex-start;-ms-flex-pack:center;justify-content:center}.btn-group-vertical>.btn,.btn-group-vertical>.btn-group{width:100%}.btn-group-vertical>.btn-group:not(:first-child),.btn-group-vertical>.btn:not(:first-child){margin-top:-1px}.btn-group-vertical>.btn-group:not(:last-child)>.btn{border-bottom-right-radius:0;border-bottom-left-radius:0}.btn-group-vertical>.btn-group:not(:first-child)>.btn,.btn-group-vertical>.btn:not(:first-child){border-top-left-radius:0;border-top-right-radius:0}.custom-select{display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;vertical-align:middle;background:#fff url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5' viewBox='0 0 4 5'%3e%3cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3e%3c/svg%3e") no-repeat right .75rem center/8px 10px;border:1px solid #ced4da;border-radius:.25rem;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.custom-select:focus::-ms-value{color:#495057;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #495057}.custom-select-lg{height:calc(1.5em+1rem+2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.25rem}.custom-file{position:relative;display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);margin-bottom:0}@media(prefers-reduced-motion:reduce){.custom-select{transition:none}}.alert{position:relative;padding:.75rem 1.25rem;margin-bottom:1rem;border:1px solid transparent;border-radius:.25rem}.alert-heading{color:inherit}.alert-link{font-weight:700}.alert-warning{color:#856404;background-color:#fff3cd;border-color:#ffeeba}.alert-warning .alert-link{color:#533f03}.alert-light{color:#818182;background-color:#fefefe;border-color:#fdfdfe}.alert-light .alert-link{color:#686868}.alert-dark{color:#1b1e21;background-color:#d6d8d9;border-color:#c6c8ca}.alert-dark .alert-link{color:#040505}@-webkit-keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}.progress{display:-ms-flexbox;display:flex;height:1rem;overflow:hidden;font-size:.75rem;background-color:#e9ecef;border-radius:.25rem}.progress-bar{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;overflow:hidden;color:#fff;text-align:center;white-space:nowrap;background-color:#007bff}@media(prefers-reduced-motion:reduce){.progress-bar{transition:none}}@-webkit-keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}@keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}.bg-warning{background-color:#ffc107}a.bg-warning:focus,a.bg-warning:hover{background-color:#d39e00}.bg-light{background-color:#f8f9fa}a.bg-light:focus,a.bg-light:hover{background-color:#dae0e5}.bg-dark{background-color:#343a40}a.bg-dark:focus,a.bg-dark:hover{background-color:#1d2124}.bg-white{background-color:#fff}.d-none{display:none}.d-inline{display:inline}.d-inline-block{display:inline-block}.d-block{display:block}.d-table{display:table}.d-table-row{display:table-row}@media(min-width:768px){.d-md-none{display:none}.d-md-inline{display:inline}.d-md-inline-block{display:inline-block}.d-md-block{display:block}.d-md-table{display:table}.d-md-table-row{display:table-row}}@media(min-width:992px){.d-lg-none{display:none}.d-lg-inline{display:inline}.d-lg-inline-block{display:inline-block}.d-lg-block{display:block}.d-lg-table{display:table}.d-lg-table-row{display:table-row}}.float-left{float:left}.float-right{float:right}.float-none{float:none}@media(min-width:768px){.float-md-left{float:left}.float-md-right{float:right}.float-md-none{float:none}}@media(min-width:992px){.float-lg-left{float:left}.float-lg-right{float:right}.float-lg-none{float:none}}.overflow-hidden{overflow:hidden}.fixed-bottom{position:fixed;right:0;bottom:0;left:0;z-index:1030}.w-25{width:25%}.w-50{width:50%}.w-75{width:75%}.w-100{width:100%}.h-25{height:25%}.h-50{height:50%}.h-75{height:75%}.h-100{height:100%}.m-0{margin:0}.my-0{margin-top:0}.mr-0{margin-right:0}.mb-0,.my-0{margin-bottom:0}.m-1{margin:.25rem}.my-1{margin-top:.25rem}.mr-1{margin-right:.25rem}.mb-1,.my-1{margin-bottom:.25rem}.m-2{margin:.5rem}.my-2{margin-top:.5rem}.mr-2{margin-right:.5rem}.mb-2,.my-2{margin-bottom:.5rem}.m-3{margin:1rem}.my-3{margin-top:1rem}.mr-3{margin-right:1rem}.mb-3,.my-3{margin-bottom:1rem}.m-4{margin:1.5rem}.my-4{margin-top:1.5rem}.mr-4{margin-right:1.5rem}.mb-4,.my-4{margin-bottom:1.5rem}.m-5{margin:3rem}.my-5{margin-top:3rem}.mr-5{margin-right:3rem}.mb-5,.my-5{margin-bottom:3rem}.p-0{padding:0}.pt-0,.py-0{padding-top:0}.pb-0,.py-0{padding-bottom:0}.p-1{padding:.25rem}.pt-1,.py-1{padding-top:.25rem}.pb-1,.py-1{padding-bottom:.25rem}.p-2{padding:.5rem}.pt-2,.py-2{padding-top:.5rem}.pb-2,.py-2{padding-bottom:.5rem}.p-3{padding:1rem}.pt-3,.py-3{padding-top:1rem}.pb-3,.py-3{padding-bottom:1rem}.p-4{padding:1.5rem}.pt-4,.py-4{padding-top:1.5rem}.pb-4,.py-4{padding-bottom:1.5rem}.p-5{padding:3rem}.pt-5,.py-5{padding-top:3rem}.pb-5,.py-5{padding-bottom:3rem}.m-n1{margin:-.25rem}.my-n1{margin-top:-.25rem}.mr-n1{margin-right:-.25rem}.mb-n1,.my-n1{margin-bottom:-.25rem}.m-n2{margin:-.5rem}.my-n2{margin-top:-.5rem}.mr-n2{margin-right:-.5rem}.mb-n2,.my-n2{margin-bottom:-.5rem}.m-n3{margin:-1rem}.my-n3{margin-top:-1rem}.mr-n3{margin-right:-1rem}.mb-n3,.my-n3{margin-bottom:-1rem}.m-n4{margin:-1.5rem}.my-n4{margin-top:-1.5rem}.mr-n4{margin-right:-1.5rem}.mb-n4,.my-n4{margin-bottom:-1.5rem}.m-n5{margin:-3rem}.my-n5{margin-top:-3rem}.mr-n5{margin-right:-3rem}.mb-n5,.my-n5{margin-bottom:-3rem}@media(min-width:768px){.m-md-0{margin:0}.my-md-0{margin-top:0}.mr-md-0{margin-right:0}.mb-md-0,.my-md-0{margin-bottom:0}.m-md-1{margin:.25rem}.my-md-1{margin-top:.25rem}.mr-md-1{margin-right:.25rem}.mb-md-1,.my-md-1{margin-bottom:.25rem}.m-md-2{margin:.5rem}.my-md-2{margin-top:.5rem}.mr-md-2{margin-right:.5rem}.mb-md-2,.my-md-2{margin-bottom:.5rem}.m-md-3{margin:1rem}.my-md-3{margin-top:1rem}.mr-md-3{margin-right:1rem}.mb-md-3,.my-md-3{margin-bottom:1rem}.m-md-4{margin:1.5rem}.my-md-4{margin-top:1.5rem}.mr-md-4{margin-right:1.5rem}.mb-md-4,.my-md-4{margin-bottom:1.5rem}.m-md-5{margin:3rem}.my-md-5{margin-top:3rem}.mr-md-5{margin-right:3rem}.mb-md-5,.my-md-5{margin-bottom:3rem}.p-md-0{padding:0}.pt-md-0,.py-md-0{padding-top:0}.pb-md-0,.py-md-0{padding-bottom:0}.p-md-1{padding:.25rem}.pt-md-1,.py-md-1{padding-top:.25rem}.pb-md-1,.py-md-1{padding-bottom:.25rem}.p-md-2{padding:.5rem}.pt-md-2,.py-md-2{padding-top:.5rem}.pb-md-2,.py-md-2{padding-bottom:.5rem}.p-md-3{padding:1rem}.pt-md-3,.py-md-3{padding-top:1rem}.pb-md-3,.py-md-3{padding-bottom:1rem}.p-md-4{padding:1.5rem}.pt-md-4,.py-md-4{padding-top:1.5rem}.pb-md-4,.py-md-4{padding-bottom:1.5rem}.p-md-5{padding:3rem}.pt-md-5,.py-md-5{padding-top:3rem}.pb-md-5,.py-md-5{padding-bottom:3rem}.m-md-n1{margin:-.25rem}.my-md-n1{margin-top:-.25rem}.mr-md-n1{margin-right:-.25rem}.mb-md-n1,.my-md-n1{margin-bottom:-.25rem}.m-md-n2{margin:-.5rem}.my-md-n2{margin-top:-.5rem}.mr-md-n2{margin-right:-.5rem}.mb-md-n2,.my-md-n2{margin-bottom:-.5rem}.m-md-n3{margin:-1rem}.my-md-n3{margin-top:-1rem}.mr-md-n3{margin-right:-1rem}.mb-md-n3,.my-md-n3{margin-bottom:-1rem}.m-md-n4{margin:-1.5rem}.my-md-n4{margin-top:-1.5rem}.mr-md-n4{margin-right:-1.5rem}.mb-md-n4,.my-md-n4{margin-bottom:-1.5rem}.m-md-n5{margin:-3rem}.my-md-n5{margin-top:-3rem}.mr-md-n5{margin-right:-3rem}.mb-md-n5,.my-md-n5{margin-bottom:-3rem}}@media(min-width:992px){.m-lg-0{margin:0}.my-lg-0{margin-top:0}.mr-lg-0{margin-right:0}.mb-lg-0,.my-lg-0{margin-bottom:0}.m-lg-1{margin:.25rem}.my-lg-1{margin-top:.25rem}.mr-lg-1{margin-right:.25rem}.mb-lg-1,.my-lg-1{margin-bottom:.25rem}.m-lg-2{margin:.5rem}.my-lg-2{margin-top:.5rem}.mr-lg-2{margin-right:.5rem}.mb-lg-2,.my-lg-2{margin-bottom:.5rem}.m-lg-3{margin:1rem}.my-lg-3{margin-top:1rem}.mr-lg-3{margin-right:1rem}.mb-lg-3,.my-lg-3{margin-bottom:1rem}.m-lg-4{margin:1.5rem}.my-lg-4{margin-top:1.5rem}.mr-lg-4{margin-right:1.5rem}.mb-lg-4,.my-lg-4{margin-bottom:1.5rem}.m-lg-5{margin:3rem}.my-lg-5{margin-top:3rem}.mr-lg-5{margin-right:3rem}.mb-lg-5,.my-lg-5{margin-bottom:3rem}.p-lg-0{padding:0}.pt-lg-0,.py-lg-0{padding-top:0}.pb-lg-0,.py-lg-0{padding-bottom:0}.p-lg-1{padding:.25rem}.pt-lg-1,.py-lg-1{padding-top:.25rem}.pb-lg-1,.py-lg-1{padding-bottom:.25rem}.p-lg-2{padding:.5rem}.pt-lg-2,.py-lg-2{padding-top:.5rem}.pb-lg-2,.py-lg-2{padding-bottom:.5rem}.p-lg-3{padding:1rem}.pt-lg-3,.py-lg-3{padding-top:1rem}.pb-lg-3,.py-lg-3{padding-bottom:1rem}.p-lg-4{padding:1.5rem}.pt-lg-4,.py-lg-4{padding-top:1.5rem}.pb-lg-4,.py-lg-4{padding-bottom:1.5rem}.p-lg-5{padding:3rem}.pt-lg-5,.py-lg-5{padding-top:3rem}.pb-lg-5,.py-lg-5{padding-bottom:3rem}.m-lg-n1{margin:-.25rem}.my-lg-n1{margin-top:-.25rem}.mr-lg-n1{margin-right:-.25rem}.mb-lg-n1,.my-lg-n1{margin-bottom:-.25rem}.m-lg-n2{margin:-.5rem}.my-lg-n2{margin-top:-.5rem}.mr-lg-n2{margin-right:-.5rem}.mb-lg-n2,.my-lg-n2{margin-bottom:-.5rem}.m-lg-n3{margin:-1rem}.my-lg-n3{margin-top:-1rem}.mr-lg-n3{margin-right:-1rem}.mb-lg-n3,.my-lg-n3{margin-bottom:-1rem}.m-lg-n4{margin:-1.5rem}.my-lg-n4{margin-top:-1.5rem}.mr-lg-n4{margin-right:-1.5rem}.mb-lg-n4,.my-lg-n4{margin-bottom:-1.5rem}.m-lg-n5{margin:-3rem}.my-lg-n5{margin-top:-3rem}.mr-lg-n5{margin-right:-3rem}.mb-lg-n5,.my-lg-n5{margin-bottom:-3rem}}.text-left{text-align:left}.text-right{text-align:right}.text-center{text-align:center}@media(min-width:768px){.text-md-left{text-align:left}.text-md-right{text-align:right}.text-md-center{text-align:center}}@media(min-width:992px){.text-lg-left{text-align:left}.text-lg-right{text-align:right}.text-lg-center{text-align:center}}.text-white{color:#fff}.text-warning{color:#ffc107}a.text-warning:focus,a.text-warning:hover{color:#ba8b00}.text-light{color:#f8f9fa}a.text-light:focus,a.text-light:hover{color:#cbd3da}.text-dark{color:#343a40}a.text-dark:focus,a.text-dark:hover{color:#121416}.text-body{color:#212529}.text-muted{color:#6c757d}.text-black-50{color:rgba(0,0,0,.5)}.text-white-50{color:rgba(255,255,255,.5)}.text-hide{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;border:0}.text-decoration-none{text-decoration:none}.text-reset{color:inherit}.visible{visibility:visible}@media print{*,::after,::before{text-shadow:none;box-shadow:none}a:not(.btn){text-decoration:underline}pre{white-space:pre-wrap}pre{border:1px solid #adb5bd;page-break-inside:avoid}img{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}body{min-width:992px}.container{min-width:992px}.table{border-collapse:collapse}.table-dark{color:inherit}}@-webkit-keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}@keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"}a:link,a:visited{color:#f14600;text-decoration:none}a:active,a:hover{text-decoration:underline}.btn:disabled{cursor:default;opacity:.4}#logo-text{width:180px;margin-left:12px}.display-5{font-size:2rem;font-weight:300;line-height:1.2}.display-6{font-size:1.75rem;font-weight:300;line-height:1.2}.bg-dark-alt,.bg-dark-alt:focus{background:#36363f}.bg-orange,.bg-orange:focus{background:#f14600}.text-dark-alt{color:#36363f}.btn-dark-alt{background:#36363f}.btn-dark-alt:focus{background:#36363f}.btn-outline-orange{border-color:#f14600;color:#f14600}.btn-orange,.btn-outline-orange:hover{background:#f14600;color:#fff}.btn:active,.btn:hover{text-decoration:none}.text-orange{color:#f14600}.bg-number{position:absolute;font-size:900%;font-weight:700;color:rgba(241,70,0,.1);line-height:1;margin-top:-1rem}.w-15{width:15%}.headerlink{text-decoration:none;margin-left:.5rem}#content table{border:1px solid #dee2e6;width:100%;margin-bottom:1rem;overflow-x:auto}#content code{color:#000;background:#eee;padding:.125rem .25rem}#content code.syntax{padding:0}#content pre{background:#efefef;padding:1rem;line-height:1.25}@media print{body{min-width:0}code,h1,h2,h3,h4,h5,h6,img,li,p,pre{page-break-inside:avoid}}@media(prefers-color-scheme:dark){#to-full-website,body.amp,body[data-spy]{background:#1c1c1c;color:#efefef}.invert-dark{filter:invert(100%)}#content table{border:1px solid #2a2b2c}#content code{background:#444;color:#eee;padding:.125rem .25rem}#content pre{background:#444;color:#eee}}.syntax{background:#f8f9fa;color:#2f1e2e}.syntax .c{color:#8d8687}.syntax .k{color:#000;font-weight:700}.syntax .n{color:#2f1e2e}.syntax .o{color:#800}.syntax .p{color:#2f1e2e}.syntax .c1{color:#8d8687}.syntax .ld{color:#48b685}.syntax .m{color:#08f}.syntax .s{color:#48b685}.syntax .nb{color:#2f1e2e}.syntax .no{color:#ef6155}.syntax .py{color:#2f1e2e}.syntax .nt{color:#5bc4bf}.syntax .w{color:#2f1e2e}.syntax .mi{color:#08f}.syntax .s2{color:#48b685}.syntax .s1{color:#080}.syntax .ss{color:#48b685}@media(prefers-color-scheme:dark){.syntax .k{color:#c78cff}.syntax .ld{color:#64ffbb}.syntax .s{color:#64ffbb}.syntax .s2{color:#64ffbb}.syntax .s1{color:#64ffbb}.syntax .ss{color:#64ffbb}.syntax .c{color:#64ffbb}.syntax .n{color:#f8f9fa}.syntax .p{color:#f8f9fa}.syntax .nb{color:#f8f9fa}.syntax .py{color:#f8f9fa}.syntax .w{color:#f8f9fa}}</style><script async custom-element=amp-analytics src=https://cdn.ampproject.org/v0/amp-analytics-0.1.js></script><script async custom-element=amp-iframe src=https://cdn.ampproject.org/v0/amp-iframe-0.1.js></script></head> <body class=amp dir=ltr> <div class="container-fluid container-lg pb-5"> <div class="row pt-3 mb-3"> <div class=col> <a href=/ class=text-decoration-none> <amp-img class="d-inline-block mr-3" layout=fixed width=40 height=36 src=/images/logo.svg alt="ClickHouse logo" title="ClickHouse logo"></amp-img><amp-img class="invert-dark d-inline-block" layout=fixed width=238 height=36 src=/images/clickhouse-black.svg alt=ClickHouse title=ClickHouse></amp-img> </a> </div> </div> <div class=row> <div id=content class=col> <h1 id=other-functions>Прочие функции<a class=headerlink href=../amp/#other-functions title="Permanent link"> </a></h1> <h2 id=hostname>hostName()<a class=headerlink href=../amp/#hostname title="Permanent link"> </a></h2> <p>Возвращает строку - имя хоста, на котором эта функция была выполнена. При распределённой обработке запроса, это будет имя хоста удалённого сервера, если функция выполняется на удалённом сервере.</p> <h2 id=getmacro>getMacro<a class=headerlink href=../amp/#getmacro title="Permanent link"> </a></h2> <p>Возвращает именованное значение из секции <a href=../../../../operations/server-configuration-parameters/settings/amp/#macros>macros</a> конфигурации сервера.</p> <p><strong>Синтаксис</strong> </p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>getMacro</span><span class=p>(</span><span class=n>name</span><span class=p>);</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>name</code> — Имя, которое необходимо получить из секции <code class=syntax>macros</code>. <a href=../../../data-types/string/amp/#string>String</a>.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Значение по указанному имени.</li> </ul> <p>Тип: <a href=../../../data-types/string/amp/ >String</a>.</p> <p><strong>Пример</strong></p> <p>Пример секции <code class=syntax>macros</code> в конфигурационном файле сервера:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=nt>&lt;macros&gt;</span>
    <span class=nt>&lt;test&gt;</span>Value<span class=nt>&lt;/test&gt;</span>
<span class=nt>&lt;/macros&gt;</span>
</code></pre></div> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>getMacro</span><span class=p>(</span><span class=s1>'test'</span><span class=p>);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─getMacro('test')─┐
│ Value            │
└──────────────────┘
</code></pre></div> <p>Альтернативный способ получения значения:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=k>system</span><span class=p>.</span><span class=n>macros</span>
<span class=k>WHERE</span> <span class=n>macro</span> <span class=o>=</span> <span class=s1>'test'</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─macro─┬─substitution─┐
│ test  │ Value        │
└───────┴──────────────┘
</code></pre></div> <h2 id=fqdn>FQDN<a class=headerlink href=../amp/#fqdn title="Permanent link"> </a></h2> <p>Возвращает полное имя домена.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>fqdn</span><span class=p>();</span>
</code></pre></div> <p>Эта функция регистронезависимая.</p> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Полное имя домена.</li> </ul> <p>Тип: <code class=syntax>String</code>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>FQDN</span><span class=p>();</span>
</code></pre></div> <p>Ответ:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─FQDN()──────────────────────────┐
│ clickhouse.ru-central1.internal │
└─────────────────────────────────┘
</code></pre></div> <h2 id=basename>basename<a class=headerlink href=../amp/#basename title="Permanent link"> </a></h2> <p>Извлекает конечную часть строки после последнего слэша или бэкслэша. Функция часто используется для извлечения имени файла из пути.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>basename</span><span class=p>(</span> <span class=n>expr</span> <span class=p>)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>expr</code> — Выражение, возвращающее значение типа <a href=.././amp/ >String</a>. В результирующем значении все бэкслэши должны быть экранированы.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <p>Строка, содержащая:</p> <ul> <li> <p>Конечную часть строки после последнего слэша или бэкслэша.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=err>Если входная строка содержит путь, заканчивающийся слэшем или бэкслэшем, например, `/` или `с:\`, функция возвращает пустую строку.</span>
</code></pre></div> </li> <li> <p>Исходная строка, если нет слэша или бэкслэша.</p> </li> </ul> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=s1>'some/long/path/to/file'</span> <span class=k>AS</span> <span class=n>a</span><span class=p>,</span> <span class=n>basename</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─a──────────────────────┬─basename('some\\long\\path\\to\\file')─┐
│ some\long\path\to\file │ file                                   │
└────────────────────────┴────────────────────────────────────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=s1>'some\\long\\path\\to\\file'</span> <span class=k>AS</span> <span class=n>a</span><span class=p>,</span> <span class=n>basename</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─a──────────────────────┬─basename('some\\long\\path\\to\\file')─┐
│ some\long\path\to\file │ file                                   │
└────────────────────────┴────────────────────────────────────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=s1>'some-file-name'</span> <span class=k>AS</span> <span class=n>a</span><span class=p>,</span> <span class=n>basename</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─a──────────────┬─basename('some-file-name')─┐
│ some-file-name │ some-file-name             │
└────────────────┴────────────────────────────┘
</code></pre></div> <h2 id=visiblewidthx>visibleWidth(x)<a class=headerlink href=../amp/#visiblewidthx title="Permanent link"> </a></h2> <p>Вычисляет приблизительную ширину при выводе значения в текстовом (tab-separated) виде на консоль.<br> Функция используется системой для реализации Pretty форматов.</p> <p><code class=syntax>NULL</code> представляется как строка, соответствующая отображению <code class=syntax>NULL</code> в форматах <code class=syntax>Pretty</code>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>visibleWidth</span><span class=p>(</span><span class=k>NULL</span><span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─visibleWidth(NULL)─┐
│                  4 │
└────────────────────┘
</code></pre></div> <h2 id=totypenamex>toTypeName(x)<a class=headerlink href=../amp/#totypenamex title="Permanent link"> </a></h2> <p>Возвращает строку, содержащую имя типа переданного аргумента.</p> <p>Если на вход функции передать <code class=syntax>NULL</code>, то она вернёт тип <code class=syntax>Nullable(Nothing)</code>, что соответствует внутреннему представлению <code class=syntax>NULL</code> в ClickHouse.</p> <h2 id=function-blocksize>blockSize()<a class=headerlink href=../amp/#function-blocksize title="Permanent link"> </a></h2> <p>Получить размер блока.<br> В ClickHouse выполнение запроса всегда идёт по блокам (наборам кусочков столбцов). Функция позволяет получить размер блока, для которого её вызвали.</p> <h2 id=function-bytesize>byteSize<a class=headerlink href=../amp/#function-bytesize title="Permanent link"> </a></h2> <p>Возвращает оценку в байтах размера аргументов в памяти в несжатом виде.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>byteSize</span><span class=p>(</span><span class=n>argument</span> <span class=p>[,</span> <span class=p>...])</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>argument</code> — значение.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Оценка размера аргументов в памяти в байтах.</li> </ul> <p>Тип: <a href=../../../data-types/int-uint/amp/ >UInt64</a>.</p> <p><strong>Примеры</strong></p> <p>Для аргументов типа <a href=../../../data-types/string/amp/ >String</a> функция возвращает длину строки + 9 (нуль-терминатор + длина)</p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>byteSize</span><span class=p>(</span><span class=s1>'string'</span><span class=p>);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─byteSize('string')─┐
│                 15 │
└────────────────────┘
</code></pre></div> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>test</span>
<span class=p>(</span>
    <span class=o>`</span><span class=k>key</span><span class=o>`</span> <span class=n>Int32</span><span class=p>,</span>
    <span class=o>`</span><span class=n>u8</span><span class=o>`</span> <span class=n>UInt8</span><span class=p>,</span>
    <span class=o>`</span><span class=n>u16</span><span class=o>`</span> <span class=n>UInt16</span><span class=p>,</span>
    <span class=o>`</span><span class=n>u32</span><span class=o>`</span> <span class=n>UInt32</span><span class=p>,</span>
    <span class=o>`</span><span class=n>u64</span><span class=o>`</span> <span class=n>UInt64</span><span class=p>,</span>
    <span class=o>`</span><span class=n>i8</span><span class=o>`</span> <span class=nb>Int8</span><span class=p>,</span>
    <span class=o>`</span><span class=n>i16</span><span class=o>`</span> <span class=n>Int16</span><span class=p>,</span>
    <span class=o>`</span><span class=n>i32</span><span class=o>`</span> <span class=n>Int32</span><span class=p>,</span>
    <span class=o>`</span><span class=n>i64</span><span class=o>`</span> <span class=n>Int64</span><span class=p>,</span>
    <span class=o>`</span><span class=n>f32</span><span class=o>`</span> <span class=n>Float32</span><span class=p>,</span>
    <span class=o>`</span><span class=n>f64</span><span class=o>`</span> <span class=n>Float64</span>
<span class=p>)</span>
<span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=k>key</span><span class=p>;</span>

<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>test</span> <span class=k>VALUES</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>8</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>32</span><span class=p>,</span> <span class=mi>64</span><span class=p>,</span>  <span class=o>-</span><span class=mi>8</span><span class=p>,</span> <span class=o>-</span><span class=mi>16</span><span class=p>,</span> <span class=o>-</span><span class=mi>32</span><span class=p>,</span> <span class=o>-</span><span class=mi>64</span><span class=p>,</span> <span class=mi>32</span><span class=p>.</span><span class=mi>32</span><span class=p>,</span> <span class=mi>64</span><span class=p>.</span><span class=mi>64</span><span class=p>);</span>

<span class=k>SELECT</span> <span class=k>key</span><span class=p>,</span> <span class=n>byteSize</span><span class=p>(</span><span class=n>u8</span><span class=p>)</span> <span class=k>AS</span> <span class=o>`</span><span class=n>byteSize</span><span class=p>(</span><span class=n>UInt8</span><span class=p>)</span><span class=o>`</span><span class=p>,</span> <span class=n>byteSize</span><span class=p>(</span><span class=n>u16</span><span class=p>)</span> <span class=k>AS</span> <span class=o>`</span><span class=n>byteSize</span><span class=p>(</span><span class=n>UInt16</span><span class=p>)</span><span class=o>`</span><span class=p>,</span> <span class=n>byteSize</span><span class=p>(</span><span class=n>u32</span><span class=p>)</span> <span class=k>AS</span> <span class=o>`</span><span class=n>byteSize</span><span class=p>(</span><span class=n>UInt32</span><span class=p>)</span><span class=o>`</span><span class=p>,</span> <span class=n>byteSize</span><span class=p>(</span><span class=n>u64</span><span class=p>)</span> <span class=k>AS</span> <span class=o>`</span><span class=n>byteSize</span><span class=p>(</span><span class=n>UInt64</span><span class=p>)</span><span class=o>`</span><span class=p>,</span> <span class=n>byteSize</span><span class=p>(</span><span class=n>i8</span><span class=p>)</span> <span class=k>AS</span> <span class=o>`</span><span class=n>byteSize</span><span class=p>(</span><span class=nb>Int8</span><span class=p>)</span><span class=o>`</span><span class=p>,</span> <span class=n>byteSize</span><span class=p>(</span><span class=n>i16</span><span class=p>)</span> <span class=k>AS</span> <span class=o>`</span><span class=n>byteSize</span><span class=p>(</span><span class=n>Int16</span><span class=p>)</span><span class=o>`</span><span class=p>,</span> <span class=n>byteSize</span><span class=p>(</span><span class=n>i32</span><span class=p>)</span> <span class=k>AS</span> <span class=o>`</span><span class=n>byteSize</span><span class=p>(</span><span class=n>Int32</span><span class=p>)</span><span class=o>`</span><span class=p>,</span> <span class=n>byteSize</span><span class=p>(</span><span class=n>i64</span><span class=p>)</span> <span class=k>AS</span> <span class=o>`</span><span class=n>byteSize</span><span class=p>(</span><span class=n>Int64</span><span class=p>)</span><span class=o>`</span><span class=p>,</span> <span class=n>byteSize</span><span class=p>(</span><span class=n>f32</span><span class=p>)</span> <span class=k>AS</span> <span class=o>`</span><span class=n>byteSize</span><span class=p>(</span><span class=n>Float32</span><span class=p>)</span><span class=o>`</span><span class=p>,</span> <span class=n>byteSize</span><span class=p>(</span><span class=n>f64</span><span class=p>)</span> <span class=k>AS</span> <span class=o>`</span><span class=n>byteSize</span><span class=p>(</span><span class=n>Float64</span><span class=p>)</span><span class=o>`</span> <span class=k>FROM</span> <span class=n>test</span> <span class=k>ORDER</span> <span class=k>BY</span> <span class=k>key</span> <span class=k>ASC</span> <span class=n>FORMAT</span> <span class=n>Vertical</span><span class=p>;</span>
</code></pre></div> <p>Result:</p> <div class=codehilite><pre><span></span><code class=syntax>Row 1:
──────
key:               1
byteSize(UInt8):   1
byteSize(UInt16):  2
byteSize(UInt32):  4
byteSize(UInt64):  8
byteSize(Int8):    1
byteSize(Int16):   2
byteSize(Int32):   4
byteSize(Int64):   8
byteSize(Float32): 4
byteSize(Float64): 8
</code></pre></div> <p>Если функция принимает несколько аргументов, то она возвращает их совокупный размер в байтах.</p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>byteSize</span><span class=p>(</span><span class=k>NULL</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>.</span><span class=mi>3</span><span class=p>,</span> <span class=s1>''</span><span class=p>);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─byteSize(NULL, 1, 0.3, '')─┐
│                         19 │
└────────────────────────────┘
</code></pre></div> <h2 id=materializex>materialize(x)<a class=headerlink href=../amp/#materializex title="Permanent link"> </a></h2> <p>Превращает константу в полноценный столбец, содержащий только одно значение.<br> В ClickHouse полноценные столбцы и константы представлены в памяти по-разному. Функции по-разному работают для аргументов-констант и обычных аргументов (выполняется разный код), хотя результат почти всегда должен быть одинаковым. Эта функция предназначена для отладки такого поведения.</p> <h2 id=ignore>ignore(…)<a class=headerlink href=../amp/#ignore title="Permanent link"> </a></h2> <p>Принимает любые аргументы, в т.ч. <code class=syntax>NULL</code>, всегда возвращает 0.<br> При этом, аргумент всё равно вычисляется. Это может использоваться для бенчмарков.</p> <h2 id=sleepseconds>sleep(seconds)<a class=headerlink href=../amp/#sleepseconds title="Permanent link"> </a></h2> <p>Спит seconds секунд на каждый блок данных. Можно указать как целое число, так и число с плавающей запятой.</p> <h2 id=currentdatabase>currentDatabase()<a class=headerlink href=../amp/#currentdatabase title="Permanent link"> </a></h2> <p>Возвращает имя текущей базы данных.<br> Эта функция может использоваться в параметрах движка таблицы в запросе CREATE TABLE там, где нужно указать базу данных.</p> <h2 id=other-function-currentuser>currentUser()<a class=headerlink href=../amp/#other-function-currentuser title="Permanent link"> </a></h2> <p>Возвращает логин текущего пользователя. При распределенном запросе, возвращается имя пользователя, инициировавшего запрос.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>currentUser</span><span class=p>();</span>
</code></pre></div> <p>Алиас: <code class=syntax>user()</code>, <code class=syntax>USER()</code>.</p> <p><strong>Возвращаемые значения</strong></p> <ul> <li>Логин текущего пользователя.</li> <li>При распределенном запросе — логин пользователя, инициировавшего запрос.</li> </ul> <p>Тип: <code class=syntax>String</code>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>currentUser</span><span class=p>();</span>
</code></pre></div> <p>Ответ:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─currentUser()─┐
│ default       │
└───────────────┘
</code></pre></div> <h2 id=is-constant>isConstant<a class=headerlink href=../amp/#is-constant title="Permanent link"> </a></h2> <p>Проверяет, является ли аргумент константным выражением.</p> <p>Константное выражение — это выражение, результат которого известен на момент анализа запроса (до его выполнения). Например, выражения над <a href=../../../syntax/amp/#literals>литералами</a> являются константными.</p> <p>Используется в целях разработки, отладки или демонстрирования.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>isConstant</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>x</code> — Выражение для проверки.</li> </ul> <p><strong>Возвращаемые значения</strong></p> <ul> <li><code class=syntax>1</code> — Выражение <code class=syntax>x</code> является константным.</li> <li><code class=syntax>0</code> — Выражение <code class=syntax>x</code> не является константным.</li> </ul> <p>Тип: <a href=../../../data-types/int-uint/amp/ >UInt8</a>.</p> <p><strong>Примеры</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>isConstant</span><span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=k>FROM</span> <span class=p>(</span><span class=k>SELECT</span> <span class=mi>43</span> <span class=k>AS</span> <span class=n>x</span><span class=p>)</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─isConstant(plus(x, 1))─┐
│                      1 │
└────────────────────────┘
</code></pre></div> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>WITH</span> <span class=mi>3</span><span class=p>.</span><span class=mi>14</span> <span class=k>AS</span> <span class=n>pi</span> <span class=k>SELECT</span> <span class=n>isConstant</span><span class=p>(</span><span class=n>cos</span><span class=p>(</span><span class=n>pi</span><span class=p>))</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─isConstant(cos(pi))─┐
│                   1 │
└─────────────────────┘
</code></pre></div> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>isConstant</span><span class=p>(</span><span class=nb>number</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─isConstant(number)─┐
│                  0 │
└────────────────────┘
</code></pre></div> <h2 id=isfinitex>isFinite(x)<a class=headerlink href=../amp/#isfinitex title="Permanent link"> </a></h2> <p>Принимает Float32 или Float64 и возвращает UInt8, равный 1, если аргумент не бесконечный и не NaN, иначе 0.</p> <h2 id=ifnotfinite>ifNotFinite<a class=headerlink href=../amp/#ifnotfinite title="Permanent link"> </a></h2> <p>Проверяет, является ли значение дробного числа с плавающей точкой конечным.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=err>ifNotFinite(x,y)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>x</code> — Значение, которое нужно проверить на бесконечность. Тип: <a href=.././amp/ >Float*</a>.</li> <li><code class=syntax>y</code> — Запасное значение. Тип: <a href=.././amp/ >Float*</a>.</li> </ul> <p><strong>Возвращаемые значения</strong></p> <ul> <li><code class=syntax>x</code>, если <code class=syntax>x</code> принимает конечное значение.</li> <li><code class=syntax>y</code>, если<code class=syntax>x</code> принимает не конечное значение.</li> </ul> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=err>SELECT 1/0 as infimum, ifNotFinite(infimum,42)</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=err>┌─infimum─┬─ifNotFinite(divide(1, 0), 42)─┐</span>
<span class=err>│     inf │                            42 │</span>
<span class=err>└─────────┴───────────────────────────────┘</span>
</code></pre></div> <p>Аналогичный результат можно получить с помощью <a href=../../conditional-functions/amp/#ternary-operator>тернарного оператора</a> <code class=syntax>isFinite(x) ? x : y</code>.</p> <h2 id=isinfinitex>isInfinite(x)<a class=headerlink href=../amp/#isinfinitex title="Permanent link"> </a></h2> <p>Принимает Float32 или Float64 и возвращает UInt8, равный 1, если аргумент бесконечный, иначе 0. Отметим, что в случае NaN возвращается 0.</p> <h2 id=isnanx>isNaN(x)<a class=headerlink href=../amp/#isnanx title="Permanent link"> </a></h2> <p>Принимает Float32 или Float64 и возвращает UInt8, равный 1, если аргумент является NaN, иначе 0.</p> <h2 id=hascolumnintablehostname-username-password-database-table-column>hasColumnInTable([‘hostname’[, ‘username’[, ‘password’]],] ‘database’, ‘table’, ‘column’)<a class=headerlink href=../amp/#hascolumnintablehostname-username-password-database-table-column title="Permanent link"> </a></h2> <p>Принимает константные строки - имя базы данных, имя таблицы и название столбца. Возвращает константное выражение типа UInt8, равное 1,<br> если есть столбец, иначе 0. Если задан параметр hostname, проверка будет выполнена на удалённом сервере.<br> Функция кидает исключение, если таблица не существует.<br> Для элементов вложенной структуры данных функция проверяет существование столбца. Для самой же вложенной структуры данных функция возвращает 0.</p> <h2 id=function-bar>bar<a class=headerlink href=../amp/#function-bar title="Permanent link"> </a></h2> <p>Позволяет построить unicode-art диаграмму.</p> <p><code class=syntax>bar(x, min, max, width)</code> рисует полосу ширины пропорциональной <code class=syntax>(x - min)</code> и равной <code class=syntax>width</code> символов при <code class=syntax>x = max</code>.</p> <p>Параметры:</p> <ul> <li><code class=syntax>x</code> — Величина для отображения.</li> <li><code class=syntax>min, max</code> — Целочисленные константы, значение должно помещаться в <code class=syntax>Int64</code>.</li> <li><code class=syntax>width</code> — Константа, положительное число, может быть дробным.</li> </ul> <p>Полоса рисуется с точностью до одной восьмой символа.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=n>toHour</span><span class=p>(</span><span class=n>EventTime</span><span class=p>)</span> <span class=k>AS</span> <span class=n>h</span><span class=p>,</span>
    <span class=k>count</span><span class=p>()</span> <span class=k>AS</span> <span class=k>c</span><span class=p>,</span>
    <span class=n>bar</span><span class=p>(</span><span class=k>c</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>600000</span><span class=p>,</span> <span class=mi>20</span><span class=p>)</span> <span class=k>AS</span> <span class=n>bar</span>
<span class=k>FROM</span> <span class=n>test</span><span class=p>.</span><span class=n>hits</span>
<span class=k>GROUP</span> <span class=k>BY</span> <span class=n>h</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=n>h</span> <span class=k>ASC</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌──h─┬──────c─┬─bar────────────────┐
│  0 │ 292907 │ █████████▋         │
│  1 │ 180563 │ ██████             │
│  2 │ 114861 │ ███▋               │
│  3 │  85069 │ ██▋                │
│  4 │  68543 │ ██▎                │
│  5 │  78116 │ ██▌                │
│  6 │ 113474 │ ███▋               │
│  7 │ 170678 │ █████▋             │
│  8 │ 278380 │ █████████▎         │
│  9 │ 391053 │ █████████████      │
│ 10 │ 457681 │ ███████████████▎   │
│ 11 │ 493667 │ ████████████████▍  │
│ 12 │ 509641 │ ████████████████▊  │
│ 13 │ 522947 │ █████████████████▍ │
│ 14 │ 539954 │ █████████████████▊ │
│ 15 │ 528460 │ █████████████████▌ │
│ 16 │ 539201 │ █████████████████▊ │
│ 17 │ 523539 │ █████████████████▍ │
│ 18 │ 506467 │ ████████████████▊  │
│ 19 │ 520915 │ █████████████████▎ │
│ 20 │ 521665 │ █████████████████▍ │
│ 21 │ 542078 │ ██████████████████ │
│ 22 │ 493642 │ ████████████████▍  │
│ 23 │ 400397 │ █████████████▎     │
└────┴────────┴────────────────────┘
</code></pre></div> <h2 id=transform>transform<a class=headerlink href=../amp/#transform title="Permanent link"> </a></h2> <p>Преобразовать значение согласно явно указанному отображению одних элементов на другие.<br> Имеется два варианта функции:</p> <h3 id=transformx-array-from-array-to-default>transform(x, array_from, array_to, default)<a class=headerlink href=../amp/#transformx-array-from-array-to-default title="Permanent link"> </a></h3> <p><code class=syntax>x</code> - что преобразовывать.</p> <p><code class=syntax>array_from</code> - константный массив значений для преобразования.</p> <p><code class=syntax>array_to</code> - константный массив значений, в которые должны быть преобразованы значения из from.</p> <p><code class=syntax>default</code> - какое значение использовать, если x не равен ни одному из значений во from.</p> <p><code class=syntax>array_from</code> и <code class=syntax>array_to</code> - массивы одинаковых размеров.</p> <p>Типы:</p> <p><code class=syntax>transform(T, Array(T), Array(U), U) -&gt; U</code></p> <p><code class=syntax>T</code> и <code class=syntax>U</code> - могут быть числовыми, строковыми, или Date или DateTime типами.<br> При этом, где обозначена одна и та же буква (T или U), могут быть, в случае числовых типов, не совпадающие типы, а типы, для которых есть общий тип.<br> Например, первый аргумент может иметь тип Int64, а второй - Array(UInt16).</p> <p>Если значение x равно одному из элементов массива array_from, то возвращает соответствующий (такой же по номеру) элемент массива array_to; иначе возвращает default. Если имеется несколько совпадающих элементов в array_from, то возвращает какой-нибудь из соответствующих.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=k>transform</span><span class=p>(</span><span class=n>SearchEngineID</span><span class=p>,</span> <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=p>[</span><span class=s1>'Yandex'</span><span class=p>,</span> <span class=s1>'Google'</span><span class=p>],</span> <span class=s1>'Other'</span><span class=p>)</span> <span class=k>AS</span> <span class=n>title</span><span class=p>,</span>
    <span class=k>count</span><span class=p>()</span> <span class=k>AS</span> <span class=k>c</span>
<span class=k>FROM</span> <span class=n>test</span><span class=p>.</span><span class=n>hits</span>
<span class=k>WHERE</span> <span class=n>SearchEngineID</span> <span class=o>!=</span> <span class=mi>0</span>
<span class=k>GROUP</span> <span class=k>BY</span> <span class=n>title</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=k>c</span> <span class=k>DESC</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─title─────┬──────c─┐
│ Yandex    │ 498635 │
│ Google    │ 229872 │
│ Other     │ 104472 │
└───────────┴────────┘
</code></pre></div> <h3 id=transformx-array-from-array-to>transform(x, array_from, array_to)<a class=headerlink href=../amp/#transformx-array-from-array-to title="Permanent link"> </a></h3> <p>Отличается от первого варианта отсутствующим аргументом default.<br> Если значение x равно одному из элементов массива array_from, то возвращает соответствующий (такой же по номеру) элемент массива array_to; иначе возвращает x.</p> <p>Типы:</p> <p><code class=syntax>transform(T, Array(T), Array(T)) -&gt; T</code></p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=k>transform</span><span class=p>(</span><span class=k>domain</span><span class=p>(</span><span class=n>Referer</span><span class=p>),</span> <span class=p>[</span><span class=s1>'yandex.ru'</span><span class=p>,</span> <span class=s1>'google.ru'</span><span class=p>,</span> <span class=s1>'vk.com'</span><span class=p>],</span> <span class=p>[</span><span class=s1>'www.yandex'</span><span class=p>,</span> <span class=s1>'example.com'</span><span class=p>])</span> <span class=k>AS</span> <span class=n>s</span><span class=p>,</span>
    <span class=k>count</span><span class=p>()</span> <span class=k>AS</span> <span class=k>c</span>
<span class=k>FROM</span> <span class=n>test</span><span class=p>.</span><span class=n>hits</span>
<span class=k>GROUP</span> <span class=k>BY</span> <span class=k>domain</span><span class=p>(</span><span class=n>Referer</span><span class=p>)</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=k>count</span><span class=p>()</span> <span class=k>DESC</span>
<span class=k>LIMIT</span> <span class=mi>10</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─s──────────────┬───────c─┐
│                │ 2906259 │
│ www.yandex     │  867767 │
│ ███████.ru     │  313599 │
│ mail.yandex.ru │  107147 │
│ ██████.ru      │  100355 │
│ █████████.ru   │   65040 │
│ news.yandex.ru │   64515 │
│ ██████.net     │   59141 │
│ example.com    │   57316 │
└────────────────┴─────────┘
</code></pre></div> <h2 id=formatreadablesizex>formatReadableSize(x)<a class=headerlink href=../amp/#formatreadablesizex title="Permanent link"> </a></h2> <p>Принимает размер (число байт). Возвращает округленный размер с суффиксом (KiB, MiB и т.д.) в виде строки.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=n>arrayJoin</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1024</span><span class=p>,</span> <span class=mi>1024</span><span class=o>*</span><span class=mi>1024</span><span class=p>,</span> <span class=mi>192851925</span><span class=p>])</span> <span class=k>AS</span> <span class=n>filesize_bytes</span><span class=p>,</span>
    <span class=n>formatReadableSize</span><span class=p>(</span><span class=n>filesize_bytes</span><span class=p>)</span> <span class=k>AS</span> <span class=n>filesize</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─filesize_bytes─┬─filesize───┐
│              1 │ 1.00 B     │
│           1024 │ 1.00 KiB   │
│        1048576 │ 1.00 MiB   │
│      192851925 │ 183.92 MiB │
└────────────────┴────────────┘
</code></pre></div> <h2 id=formatreadablequantityx>formatReadableQuantity(x)<a class=headerlink href=../amp/#formatreadablequantityx title="Permanent link"> </a></h2> <p>Принимает число. Возвращает округленное число с суффиксом (thousand, million, billion и т.д.) в виде строки.</p> <p>Облегчает визуальное восприятие больших чисел живым человеком.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=n>arrayJoin</span><span class=p>([</span><span class=mi>1024</span><span class=p>,</span> <span class=mi>1234</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>,</span> <span class=p>(</span><span class=mi>4567</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>)</span> <span class=o>*</span> <span class=mi>1000</span><span class=p>,</span> <span class=mi>98765432101234</span><span class=p>])</span> <span class=k>AS</span> <span class=nb>number</span><span class=p>,</span>
    <span class=n>formatReadableQuantity</span><span class=p>(</span><span class=nb>number</span><span class=p>)</span> <span class=k>AS</span> <span class=n>number_for_humans</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─────────number─┬─number_for_humans─┐
│           1024 │ 1.02 thousand     │
│        1234000 │ 1.23 million      │
│     4567000000 │ 4.57 billion      │
│ 98765432101234 │ 98.77 trillion    │
└────────────────┴───────────────────┘
</code></pre></div> <h2 id=leasta-b>least(a, b)<a class=headerlink href=../amp/#leasta-b title="Permanent link"> </a></h2> <p>Возвращает наименьшее значение из a и b.</p> <h2 id=greatesta-b>greatest(a, b)<a class=headerlink href=../amp/#greatesta-b title="Permanent link"> </a></h2> <p>Возвращает наибольшее значение из a и b.</p> <h2 id=uptime>uptime()<a class=headerlink href=../amp/#uptime title="Permanent link"> </a></h2> <p>Возвращает аптайм сервера в секундах.</p> <h2 id=version>version()<a class=headerlink href=../amp/#version title="Permanent link"> </a></h2> <p>Возвращает версию сервера в виде строки.</p> <h2 id=function-rownumberinblock>rowNumberInBlock<a class=headerlink href=../amp/#function-rownumberinblock title="Permanent link"> </a></h2> <p>Возвращает порядковый номер строки в блоке данных. Для каждого блока данных нумерация начинается с 0.</p> <h2 id=rownumberinallblocks>rowNumberInAllBlocks()<a class=headerlink href=../amp/#rownumberinallblocks title="Permanent link"> </a></h2> <p>Возвращает порядковый номер строки в блоке данных. Функция учитывает только задействованные блоки данных.</p> <h2 id=neighbor>neighbor<a class=headerlink href=../amp/#neighbor title="Permanent link"> </a></h2> <p>Функция позволяет получить доступ к значению в столбце <code class=syntax>column</code>, находящемуся на смещении <code class=syntax>offset</code> относительно текущей строки. Является частичной реализацией <a href=https://en.wikipedia.org/wiki/SQL_window_function rel="external nofollow noreferrer" target=_blank>оконных функций</a> <code class=syntax>LEAD()</code> и <code class=syntax>LAG()</code>.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>neighbor</span><span class=p>(</span><span class=k>column</span><span class=p>,</span> <span class=k>offset</span><span class=p>[,</span> <span class=n>default_value</span><span class=p>])</span>
</code></pre></div> <p>Результат функции зависит от затронутых блоков данных и порядка данных в блоке.</p> <div class="admonition warning alert pb-0 mb-4 alert-warning" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Предупреждение</p> <p>Функция может получить доступ к значению в столбце соседней строки только внутри обрабатываемого в данный момент блока данных.</p> </div> <p>Порядок строк, используемый при вычислении функции <code class=syntax>neighbor</code>, может отличаться от порядка строк, возвращаемых пользователю.<br> Чтобы этого не случилось, вы можете сделать подзапрос с <a href=../../../statements/select/order-by/amp/ >ORDER BY</a> и вызвать функцию изне подзапроса.</p> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>column</code> — Имя столбца или скалярное выражение.</li> <li><code class=syntax>offset</code> - Смещение от текущей строки <code class=syntax>column</code>. <a href=.././amp/ >Int64</a>.</li> <li><code class=syntax>default_value</code> - Опциональный параметр. Значение, которое будет возвращено, если смещение выходит за пределы блока данных.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Значение <code class=syntax>column</code> в смещении от текущей строки, если значение <code class=syntax>offset</code> не выходит за пределы блока.</li> <li>Значение по умолчанию для <code class=syntax>column</code>, если значение <code class=syntax>offset</code> выходит за пределы блока данных. Если передан параметр <code class=syntax>default_value</code>, то значение берется из него.</li> </ul> <p>Тип: зависит от данных в <code class=syntax>column</code> или переданного значения по умолчанию в <code class=syntax>default_value</code>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=nb>number</span><span class=p>,</span> <span class=n>neighbor</span><span class=p>(</span><span class=nb>number</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span> <span class=k>FROM</span> <span class=k>system</span><span class=p>.</span><span class=n>numbers</span> <span class=k>LIMIT</span> <span class=mi>10</span><span class=p>;</span>
</code></pre></div> <p>Ответ:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─number─┬─neighbor(number, 2)─┐
│      0 │                   2 │
│      1 │                   3 │
│      2 │                   4 │
│      3 │                   5 │
│      4 │                   6 │
│      5 │                   7 │
│      6 │                   8 │
│      7 │                   9 │
│      8 │                   0 │
│      9 │                   0 │
└────────┴─────────────────────┘
</code></pre></div> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=nb>number</span><span class=p>,</span> <span class=n>neighbor</span><span class=p>(</span><span class=nb>number</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>999</span><span class=p>)</span> <span class=k>FROM</span> <span class=k>system</span><span class=p>.</span><span class=n>numbers</span> <span class=k>LIMIT</span> <span class=mi>10</span><span class=p>;</span>
</code></pre></div> <p>Ответ:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─number─┬─neighbor(number, 2, 999)─┐
│      0 │                        2 │
│      1 │                        3 │
│      2 │                        4 │
│      3 │                        5 │
│      4 │                        6 │
│      5 │                        7 │
│      6 │                        8 │
│      7 │                        9 │
│      8 │                      999 │
│      9 │                      999 │
└────────┴──────────────────────────┘
</code></pre></div> <p>Эта функция может использоваться для оценки year-over-year значение показателя:</p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>WITH</span> <span class=n>toDate</span><span class=p>(</span><span class=s1>'2018-01-01'</span><span class=p>)</span> <span class=k>AS</span> <span class=n>start_date</span>
<span class=k>SELECT</span>
    <span class=n>toStartOfMonth</span><span class=p>(</span><span class=n>start_date</span> <span class=o>+</span> <span class=p>(</span><span class=nb>number</span> <span class=o>*</span> <span class=mi>32</span><span class=p>))</span> <span class=k>AS</span> <span class=k>month</span><span class=p>,</span>
    <span class=n>toInt32</span><span class=p>(</span><span class=k>month</span><span class=p>)</span> <span class=o>%</span> <span class=mi>100</span> <span class=k>AS</span> <span class=n>money</span><span class=p>,</span>
    <span class=n>neighbor</span><span class=p>(</span><span class=n>money</span><span class=p>,</span> <span class=o>-</span><span class=mi>12</span><span class=p>)</span> <span class=k>AS</span> <span class=n>prev_year</span><span class=p>,</span>
    <span class=n>round</span><span class=p>(</span><span class=n>prev_year</span> <span class=o>/</span> <span class=n>money</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span> <span class=k>AS</span> <span class=n>year_over_year</span>
<span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>
</code></pre></div> <p>Ответ:</p> <div class=codehilite><pre><span></span><code class=syntax>┌──────month─┬─money─┬─prev_year─┬─year_over_year─┐
│ 2018-01-01 │    32 │         0 │              0 │
│ 2018-02-01 │    63 │         0 │              0 │
│ 2018-03-01 │    91 │         0 │              0 │
│ 2018-04-01 │    22 │         0 │              0 │
│ 2018-05-01 │    52 │         0 │              0 │
│ 2018-06-01 │    83 │         0 │              0 │
│ 2018-07-01 │    13 │         0 │              0 │
│ 2018-08-01 │    44 │         0 │              0 │
│ 2018-09-01 │    75 │         0 │              0 │
│ 2018-10-01 │     5 │         0 │              0 │
│ 2018-11-01 │    36 │         0 │              0 │
│ 2018-12-01 │    66 │         0 │              0 │
│ 2019-01-01 │    97 │        32 │           0.33 │
│ 2019-02-01 │    28 │        63 │           2.25 │
│ 2019-03-01 │    56 │        91 │           1.62 │
│ 2019-04-01 │    87 │        22 │           0.25 │
└────────────┴───────┴───────────┴────────────────┘
</code></pre></div> <h2 id=runningdifferencex>runningDifference(x)<a class=headerlink href=../amp/#runningdifferencex title="Permanent link"> </a></h2> <p>Считает разницу между последовательными значениями строк в блоке данных.<br> Возвращает 0 для первой строки и разницу с предыдущей строкой для каждой последующей строки.</p> <div class="admonition warning alert pb-0 mb-4 alert-warning" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Предупреждение</p> <p>Функция может взять значение предыдущей строки только внутри текущего обработанного блока данных.</p> </div> <p>Результат функции зависит от затронутых блоков данных и порядка данных в блоке.</p> <p>Порядок строк, используемый при вычислении функции <code class=syntax>runningDifference</code>, может отличаться от порядка строк, возвращаемых пользователю.<br> Чтобы этого не случилось, вы можете сделать подзапрос с <a href=../../../statements/select/order-by/amp/ >ORDER BY</a> и вызвать функцию извне подзапроса.</p> <p>Пример:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=n>EventID</span><span class=p>,</span>
    <span class=n>EventTime</span><span class=p>,</span>
    <span class=n>runningDifference</span><span class=p>(</span><span class=n>EventTime</span><span class=p>)</span> <span class=k>AS</span> <span class=n>delta</span>
<span class=k>FROM</span>
<span class=p>(</span>
    <span class=k>SELECT</span>
        <span class=n>EventID</span><span class=p>,</span>
        <span class=n>EventTime</span>
    <span class=k>FROM</span> <span class=n>events</span>
    <span class=k>WHERE</span> <span class=n>EventDate</span> <span class=o>=</span> <span class=s1>'2016-11-24'</span>
    <span class=k>ORDER</span> <span class=k>BY</span> <span class=n>EventTime</span> <span class=k>ASC</span>
    <span class=k>LIMIT</span> <span class=mi>5</span>
<span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─EventID─┬───────────EventTime─┬─delta─┐
│    1106 │ 2016-11-24 00:00:04 │     0 │
│    1107 │ 2016-11-24 00:00:05 │     1 │
│    1108 │ 2016-11-24 00:00:05 │     0 │
│    1109 │ 2016-11-24 00:00:09 │     4 │
│    1110 │ 2016-11-24 00:00:10 │     1 │
└─────────┴─────────────────────┴───────┘
</code></pre></div> <p>Обратите внимание — размер блока влияет на результат. С каждым новым блоком состояние <code class=syntax>runningDifference</code> сбрасывается.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=nb>number</span><span class=p>,</span>
    <span class=n>runningDifference</span><span class=p>(</span><span class=nb>number</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=k>AS</span> <span class=n>diff</span>
<span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>100000</span><span class=p>)</span>
<span class=k>WHERE</span> <span class=n>diff</span> <span class=o>!=</span> <span class=mi>1</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─number─┬─diff─┐
│      0 │    0 │
└────────┴──────┘
┌─number─┬─diff─┐
│  65536 │    0 │
└────────┴──────┘
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>set</span> <span class=n>max_block_size</span><span class=o>=</span><span class=mi>100000</span> <span class=c1>-- по умолчанию 65536!</span>

<span class=k>SELECT</span>
    <span class=nb>number</span><span class=p>,</span>
    <span class=n>runningDifference</span><span class=p>(</span><span class=nb>number</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=k>AS</span> <span class=n>diff</span>
<span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>100000</span><span class=p>)</span>
<span class=k>WHERE</span> <span class=n>diff</span> <span class=o>!=</span> <span class=mi>1</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─number─┬─diff─┐
│      0 │    0 │
└────────┴──────┘
</code></pre></div> <h2 id=runningdifferencestartingwithfirstvalue>runningDifferenceStartingWithFirstValue<a class=headerlink href=../amp/#runningdifferencestartingwithfirstvalue title="Permanent link"> </a></h2> <p>То же, что и [runningDifference] (./other_functions.md # other_functions-runningdifference), но в первой строке возвращается значение первой строки, а не ноль.</p> <h2 id=macnumtostringnum>MACNumToString(num)<a class=headerlink href=../amp/#macnumtostringnum title="Permanent link"> </a></h2> <p>Принимает число типа UInt64. Интерпретирует его, как MAC-адрес в big endian. Возвращает строку, содержащую соответствующий MAC-адрес в формате AA:BB:CC:DD:EE:FF (числа в шестнадцатеричной форме через двоеточие).</p> <h2 id=macstringtonums>MACStringToNum(s)<a class=headerlink href=../amp/#macstringtonums title="Permanent link"> </a></h2> <p>Функция, обратная к MACNumToString. Если MAC адрес в неправильном формате, то возвращает 0.</p> <h2 id=macstringtoouis>MACStringToOUI(s)<a class=headerlink href=../amp/#macstringtoouis title="Permanent link"> </a></h2> <p>Принимает MAC адрес в формате AA:BB:CC:DD:EE:FF (числа в шестнадцатеричной форме через двоеточие). Возвращает первые три октета как число в формате UInt64. Если MAC адрес в неправильном формате, то возвращает 0.</p> <h2 id=getsizeofenumtype>getSizeOfEnumType<a class=headerlink href=../amp/#getsizeofenumtype title="Permanent link"> </a></h2> <p>Возвращает количество полей в <a href=.././amp/ >Enum</a>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>getSizeOfEnumType</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>value</code> — Значение типа <code class=syntax>Enum</code>.</li> </ul> <p><strong>Возвращаемые значения</strong></p> <ul> <li>Количество полей входного значения типа <code class=syntax>Enum</code>.</li> <li>Исключение, если тип не <code class=syntax>Enum</code>.</li> </ul> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>getSizeOfEnumType</span><span class=p>(</span> <span class=k>CAST</span><span class=p>(</span><span class=s1>'a'</span> <span class=k>AS</span> <span class=n>Enum8</span><span class=p>(</span><span class=s1>'a'</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>'b'</span> <span class=o>=</span> <span class=mi>2</span><span class=p>)</span> <span class=p>)</span> <span class=p>)</span> <span class=k>AS</span> <span class=n>x</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─x─┐
│ 2 │
└───┘
</code></pre></div> <h2 id=blockserializedsize>blockSerializedSize<a class=headerlink href=../amp/#blockserializedsize title="Permanent link"> </a></h2> <p>Возвращает размер на диске (без учета сжатия).</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>blockSerializedSize</span><span class=p>(</span><span class=n>value</span><span class=p>[,</span> <span class=n>value</span><span class=p>[,</span> <span class=p>...]])</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>value</code> — Значение произвольного типа.</li> </ul> <p><strong>Возвращаемые значения</strong></p> <ul> <li>Количество байтов, которые будут записаны на диск для блока значений (без сжатия).</li> </ul> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>blockSerializedSize</span><span class=p>(</span><span class=n>maxState</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span> <span class=k>as</span> <span class=n>x</span>
</code></pre></div> <p>Ответ:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─x─┐
│ 2 │
└───┘
</code></pre></div> <h2 id=tocolumntypename>toColumnTypeName<a class=headerlink href=../amp/#tocolumntypename title="Permanent link"> </a></h2> <p>Возвращает имя класса, которым представлен тип данных столбца в оперативной памяти.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>toColumnTypeName</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>value</code> — Значение произвольного типа.</li> </ul> <p><strong>Возвращаемые значения</strong></p> <ul> <li>Строка с именем класса, который используется для представления типа данных <code class=syntax>value</code> в оперативной памяти.</li> </ul> <p><strong>Пример разницы между <code class=syntax>toTypeName</code> и <code class=syntax>toColumnTypeName</code></strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>toTypeName</span><span class=p>(</span><span class=k>CAST</span><span class=p>(</span><span class=s1>'2018-01-01 01:02:03'</span> <span class=k>AS</span> <span class=n>DateTime</span><span class=p>))</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─toTypeName(CAST('2018-01-01 01:02:03', 'DateTime'))─┐
│ DateTime                                            │
└─────────────────────────────────────────────────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>toColumnTypeName</span><span class=p>(</span><span class=k>CAST</span><span class=p>(</span><span class=s1>'2018-01-01 01:02:03'</span> <span class=k>AS</span> <span class=n>DateTime</span><span class=p>))</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─toColumnTypeName(CAST('2018-01-01 01:02:03', 'DateTime'))─┐
│ Const(UInt32)                                             │
└───────────────────────────────────────────────────────────┘
</code></pre></div> <p>В примере видно, что тип данных <code class=syntax>DateTime</code> хранится в памяти как <code class=syntax>Const(UInt32)</code>.</p> <h2 id=dumpcolumnstructure>dumpColumnStructure<a class=headerlink href=../amp/#dumpcolumnstructure title="Permanent link"> </a></h2> <p>Выводит развернутое описание структур данных в оперативной памяти</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>dumpColumnStructure</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>value</code> — Значение произвольного типа.</li> </ul> <p><strong>Возвращаемые значения</strong></p> <ul> <li>Строка с описанием структуры, которая используется для представления типа данных <code class=syntax>value</code> в оперативной памяти.</li> </ul> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>dumpColumnStructure</span><span class=p>(</span><span class=k>CAST</span><span class=p>(</span><span class=s1>'2018-01-01 01:02:03'</span><span class=p>,</span> <span class=s1>'DateTime'</span><span class=p>))</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─dumpColumnStructure(CAST('2018-01-01 01:02:03', 'DateTime'))─┐
│ DateTime, Const(size = 1, UInt32(size = 1))                  │
└──────────────────────────────────────────────────────────────┘
</code></pre></div> <h2 id=defaultvalueofargumenttype>defaultValueOfArgumentType<a class=headerlink href=../amp/#defaultvalueofargumenttype title="Permanent link"> </a></h2> <p>Выводит значение по умолчанию для типа данных.</p> <p>Не учитывает значения по умолчанию для столбцов, заданные пользователем.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>defaultValueOfArgumentType</span><span class=p>(</span><span class=n>expression</span><span class=p>)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>expression</code> — Значение произвольного типа или выражение, результатом которого является значение произвольного типа.</li> </ul> <p><strong>Возвращаемые значения</strong></p> <ul> <li><code class=syntax>0</code> для чисел;</li> <li>Пустая строка для строк;</li> <li><code class=syntax>ᴺᵁᴸᴸ</code> для <a href=.././amp/ >Nullable</a>.</li> </ul> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>defaultValueOfArgumentType</span><span class=p>(</span> <span class=k>CAST</span><span class=p>(</span><span class=mi>1</span> <span class=k>AS</span> <span class=nb>Int8</span><span class=p>)</span> <span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─defaultValueOfArgumentType(CAST(1, 'Int8'))─┐
│                                           0 │
└─────────────────────────────────────────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>defaultValueOfArgumentType</span><span class=p>(</span> <span class=k>CAST</span><span class=p>(</span><span class=mi>1</span> <span class=k>AS</span> <span class=k>Nullable</span><span class=p>(</span><span class=nb>Int8</span><span class=p>)</span> <span class=p>)</span> <span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─defaultValueOfArgumentType(CAST(1, 'Nullable(Int8)'))─┐
│                                                  ᴺᵁᴸᴸ │
└───────────────────────────────────────────────────────┘
</code></pre></div> <h2 id=defaultvalueoftypename>defaultValueOfTypeName<a class=headerlink href=../amp/#defaultvalueoftypename title="Permanent link"> </a></h2> <p>Выводит значение по умолчанию для указанного типа данных.</p> <p>Не включает значения по умолчанию для настраиваемых столбцов, установленных пользователем.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>defaultValueOfTypeName</span><span class=p>(</span><span class=k>type</span><span class=p>)</span>
</code></pre></div> <p><strong>Параметры:</strong></p> <ul> <li><code class=syntax>type</code> — тип данных.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li><code class=syntax>0</code> для чисел;</li> <li>Пустая строка для строк;</li> <li><code class=syntax>ᴺᵁᴸᴸ</code> для <a href=../../../data-types/nullable/amp/ >Nullable</a>.</li> </ul> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>defaultValueOfTypeName</span><span class=p>(</span><span class=s1>'Int8'</span><span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─defaultValueOfTypeName('Int8')─┐
│                              0 │
└────────────────────────────────┘
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>defaultValueOfTypeName</span><span class=p>(</span><span class=s1>'Nullable(Int8)'</span><span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─defaultValueOfTypeName('Nullable(Int8)')─┐
│                                     ᴺᵁᴸᴸ │
└──────────────────────────────────────────┘
</code></pre></div> <h2 id=other-functions-replicate>replicate<a class=headerlink href=../amp/#other-functions-replicate title="Permanent link"> </a></h2> <p>Создает массив, заполненный одним значением.</p> <p>Используется для внутренней реализации <a href=../../array-join/amp/#functions_arrayjoin>arrayJoin</a>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>replicate</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>arr</span><span class=p>);</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>arr</code> — Исходный массив. ClickHouse создаёт новый массив такой же длины как исходный и заполняет его значением <code class=syntax>x</code>.</li> <li><code class=syntax>x</code> — Значение, которым будет заполнен результирующий массив.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <p>Массив, заполненный значением <code class=syntax>x</code>.</p> <p>Тип: <code class=syntax>Array</code>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>replicate</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=p>[</span><span class=s1>'a'</span><span class=p>,</span> <span class=s1>'b'</span><span class=p>,</span> <span class=s1>'c'</span><span class=p>]);</span>
</code></pre></div> <p>Ответ:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─replicate(1, ['a', 'b', 'c'])─┐
│ [1,1,1]                       │
└───────────────────────────────┘
</code></pre></div> <h2 id=filesystemavailable>filesystemAvailable<a class=headerlink href=../amp/#filesystemavailable title="Permanent link"> </a></h2> <p>Возвращает объём доступного для записи данных места на файловой системе. Он всегда меньше общего свободного места (<a href=../amp/#filesystemfree>filesystemFree</a>), потому что некоторое пространство зарезервировано для нужд операционной системы.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>filesystemAvailable</span><span class=p>()</span>
</code></pre></div> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Объём доступного для записи данных места в байтах.</li> </ul> <p>Тип: <a href=.././amp/ >UInt64</a>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>formatReadableSize</span><span class=p>(</span><span class=n>filesystemAvailable</span><span class=p>())</span> <span class=k>AS</span> <span class=ss>"Available space"</span><span class=p>,</span> <span class=n>toTypeName</span><span class=p>(</span><span class=n>filesystemAvailable</span><span class=p>())</span> <span class=k>AS</span> <span class=ss>"Type"</span><span class=p>;</span>
</code></pre></div> <p>Ответ:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─Available space─┬─Type───┐
│ 30.75 GiB       │ UInt64 │
└─────────────────┴────────┘
</code></pre></div> <h2 id=filesystemfree>filesystemFree<a class=headerlink href=../amp/#filesystemfree title="Permanent link"> </a></h2> <p>Возвращает объём свободного места на файловой системе. Смотрите также <code class=syntax>filesystemAvailable</code>.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>filesystemFree</span><span class=p>()</span>
</code></pre></div> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Объем свободного места в байтах.</li> </ul> <p>Тип: <a href=.././amp/ >UInt64</a>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>formatReadableSize</span><span class=p>(</span><span class=n>filesystemFree</span><span class=p>())</span> <span class=k>AS</span> <span class=ss>"Free space"</span><span class=p>,</span> <span class=n>toTypeName</span><span class=p>(</span><span class=n>filesystemFree</span><span class=p>())</span> <span class=k>AS</span> <span class=ss>"Type"</span><span class=p>;</span>
</code></pre></div> <p>Ответ:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─Free space─┬─Type───┐
│ 32.39 GiB  │ UInt64 │
└────────────┴────────┘
</code></pre></div> <h2 id=filesystemcapacity>filesystemCapacity<a class=headerlink href=../amp/#filesystemcapacity title="Permanent link"> </a></h2> <p>Возвращает информацию о ёмкости файловой системы в байтах. Для оценки должен быть настроен <a href=.././amp/#server_configuration_parameters-path>путь</a> к каталогу с данными.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>filesystemCapacity</span><span class=p>()</span>
</code></pre></div> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Информация о ёмкости файловой системы в байтах.</li> </ul> <p>Тип: <a href=.././amp/ >UInt64</a>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>formatReadableSize</span><span class=p>(</span><span class=n>filesystemCapacity</span><span class=p>())</span> <span class=k>AS</span> <span class=ss>"Capacity"</span><span class=p>,</span> <span class=n>toTypeName</span><span class=p>(</span><span class=n>filesystemCapacity</span><span class=p>())</span> <span class=k>AS</span> <span class=ss>"Type"</span>
</code></pre></div> <p>Ответ:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─Capacity──┬─Type───┐
│ 39.32 GiB │ UInt64 │
└───────────┴────────┘
</code></pre></div> <h2 id=function-finalizeaggregation>finalizeAggregation<a class=headerlink href=../amp/#function-finalizeaggregation title="Permanent link"> </a></h2> <p>Принимает состояние агрегатной функции. Возвращает результат агрегирования (или конечное состояние при использовании комбинатора <a href=../../../aggregate-functions/combinators/amp/#state>-State</a>).</p> <p><strong>Синтаксис</strong> </p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>finalizeAggregation</span><span class=p>(</span><span class=k>state</span><span class=p>)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>state</code> — состояние агрегатной функции. <a href=../../../data-types/aggregatefunction/amp/#data-type-aggregatefunction>AggregateFunction</a>.</li> </ul> <p><strong>Возвращаемые значения</strong></p> <ul> <li>Значения, которые были агрегированы.</li> </ul> <p>Тип: соответствует типу агрегируемых значений.</p> <p><strong>Примеры</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>finalizeAggregation</span><span class=p>((</span> <span class=k>SELECT</span> <span class=n>countState</span><span class=p>(</span><span class=nb>number</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>10</span><span class=p>)));</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─finalizeAggregation(_subquery16)─┐
│                               10 │
└──────────────────────────────────┘
</code></pre></div> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>finalizeAggregation</span><span class=p>((</span> <span class=k>SELECT</span> <span class=n>sumState</span><span class=p>(</span><span class=nb>number</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>10</span><span class=p>)));</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─finalizeAggregation(_subquery20)─┐
│                               45 │
└──────────────────────────────────┘
</code></pre></div> <p>Обратите внимание, что значения <code class=syntax>NULL</code> игнорируются. </p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>finalizeAggregation</span><span class=p>(</span><span class=n>arrayReduce</span><span class=p>(</span><span class=s1>'anyState'</span><span class=p>,</span> <span class=p>[</span><span class=k>NULL</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>]));</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─finalizeAggregation(arrayReduce('anyState', [NULL, 2, 3]))─┐
│                                                          2 │
└────────────────────────────────────────────────────────────┘
</code></pre></div> <p>Комбинированный пример:</p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>WITH</span> <span class=n>initializeAggregation</span><span class=p>(</span><span class=s1>'sumState'</span><span class=p>,</span> <span class=nb>number</span><span class=p>)</span> <span class=k>AS</span> <span class=n>one_row_sum_state</span>
<span class=k>SELECT</span>
    <span class=nb>number</span><span class=p>,</span>
    <span class=n>finalizeAggregation</span><span class=p>(</span><span class=n>one_row_sum_state</span><span class=p>)</span> <span class=k>AS</span> <span class=n>one_row_sum</span><span class=p>,</span>
    <span class=n>runningAccumulate</span><span class=p>(</span><span class=n>one_row_sum_state</span><span class=p>)</span> <span class=k>AS</span> <span class=n>cumulative_sum</span>
<span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>10</span><span class=p>);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─number─┬─one_row_sum─┬─cumulative_sum─┐
│      0 │           0 │              0 │
│      1 │           1 │              1 │
│      2 │           2 │              3 │
│      3 │           3 │              6 │
│      4 │           4 │             10 │
│      5 │           5 │             15 │
│      6 │           6 │             21 │
│      7 │           7 │             28 │
│      8 │           8 │             36 │
│      9 │           9 │             45 │
└────────┴─────────────┴────────────────┘
</code></pre></div> <p><strong>Смотрите также</strong></p> <ul> <li><a href=../../array-functions/amp/#arrayreduce>arrayReduce</a></li> <li><a href=../../../aggregate-functions/reference/initializeAggregation/amp/ >initializeAggregation</a></li> </ul> <h2 id=runningaccumulate>runningAccumulate<a class=headerlink href=../amp/#runningaccumulate title="Permanent link"> </a></h2> <p>Накапливает состояния агрегатной функции для каждой строки блока данных.</p> <div class="admonition warning alert pb-0 mb-4 alert-warning" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Warning</p> <p>Функция обнуляет состояние для каждого нового блока.</p> </div> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>runningAccumulate</span><span class=p>(</span><span class=n>agg_state</span><span class=p>[,</span> <span class=k>grouping</span><span class=p>]);</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>agg_state</code> — Состояние агрегатной функции. <a href=../../../data-types/aggregatefunction/amp/#data-type-aggregatefunction>AggregateFunction</a>.</li> <li><code class=syntax>grouping</code> — Ключ группировки. Опциональный параметр. Состояние функции обнуляется, если значение <code class=syntax>grouping</code> меняется. Параметр может быть любого <a href=../../../data-types/amp/ >поддерживаемого типа данных</a>, для которого определен оператор равенства.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Каждая результирующая строка содержит результат агрегатной функции, накопленный для всех входных строк от 0 до текущей позиции. <code class=syntax>runningAccumulate</code> обнуляет состояния для каждого нового блока данных или при изменении значения <code class=syntax>grouping</code>.</li> </ul> <p>Тип зависит от используемой агрегатной функции.</p> <p><strong>Примеры</strong></p> <p>Рассмотрим примеры использования <code class=syntax>runningAccumulate</code> для нахождения кумулятивной суммы чисел без и с группировкой.</p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>k</span><span class=p>,</span> <span class=n>runningAccumulate</span><span class=p>(</span><span class=n>sum_k</span><span class=p>)</span> <span class=k>AS</span> <span class=n>res</span> <span class=k>FROM</span> <span class=p>(</span><span class=k>SELECT</span> <span class=nb>number</span> <span class=k>as</span> <span class=n>k</span><span class=p>,</span> <span class=n>sumState</span><span class=p>(</span><span class=n>k</span><span class=p>)</span> <span class=k>AS</span> <span class=n>sum_k</span> <span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span> <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>k</span> <span class=k>ORDER</span> <span class=k>BY</span> <span class=n>k</span><span class=p>);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─k─┬─res─┐
│ 0 │   0 │
│ 1 │   1 │
│ 2 │   3 │
│ 3 │   6 │
│ 4 │  10 │
│ 5 │  15 │
│ 6 │  21 │
│ 7 │  28 │
│ 8 │  36 │
│ 9 │  45 │
└───┴─────┘
</code></pre></div> <p>Подзапрос формирует <code class=syntax>sumState</code> для каждого числа от <code class=syntax>0</code> до <code class=syntax>9</code>. <code class=syntax>sumState</code> возвращает состояние функции <a href=../../../aggregate-functions/reference/sum/amp/#agg_function-sum>sum</a>, содержащее сумму одного числа.</p> <p>Весь запрос делает следующее:</p> <ol> <li>Для первой строки <code class=syntax>runningAccumulate</code> берет <code class=syntax>sumState(0)</code> и возвращает <code class=syntax>0</code>.</li> <li>Для второй строки функция объединяет <code class=syntax>sumState (0)</code> и <code class=syntax>sumState (1)</code>, что приводит к <code class=syntax>sumState (0 + 1)</code>, и возвращает в результате <code class=syntax>1</code>.</li> <li>Для третьей строки функция объединяет <code class=syntax>sumState (0 + 1)</code> и <code class=syntax>sumState (2)</code>, что приводит к <code class=syntax>sumState (0 + 1 + 2)</code>, и в результате возвращает <code class=syntax>3</code>.</li> <li>Действия повторяются до тех пор, пока не закончится блок.</li> </ol> <p>В следующем примере показано использование параметра <code class=syntax>grouping</code>:</p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> 
    <span class=k>grouping</span><span class=p>,</span>
    <span class=n>item</span><span class=p>,</span>
    <span class=n>runningAccumulate</span><span class=p>(</span><span class=k>state</span><span class=p>,</span> <span class=k>grouping</span><span class=p>)</span> <span class=k>AS</span> <span class=n>res</span>
<span class=k>FROM</span> 
<span class=p>(</span>
    <span class=k>SELECT</span> 
        <span class=n>toInt8</span><span class=p>(</span><span class=nb>number</span> <span class=o>/</span> <span class=mi>4</span><span class=p>)</span> <span class=k>AS</span> <span class=k>grouping</span><span class=p>,</span>
        <span class=nb>number</span> <span class=k>AS</span> <span class=n>item</span><span class=p>,</span>
        <span class=n>sumState</span><span class=p>(</span><span class=nb>number</span><span class=p>)</span> <span class=k>AS</span> <span class=k>state</span>
    <span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>15</span><span class=p>)</span>
    <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>item</span>
    <span class=k>ORDER</span> <span class=k>BY</span> <span class=n>item</span> <span class=k>ASC</span>
<span class=p>);</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─grouping─┬─item─┬─res─┐
│        0 │    0 │   0 │
│        0 │    1 │   1 │
│        0 │    2 │   3 │
│        0 │    3 │   6 │
│        1 │    4 │   4 │
│        1 │    5 │   9 │
│        1 │    6 │  15 │
│        1 │    7 │  22 │
│        2 │    8 │   8 │
│        2 │    9 │  17 │
│        2 │   10 │  27 │
│        2 │   11 │  38 │
│        3 │   12 │  12 │
│        3 │   13 │  25 │
│        3 │   14 │  39 │
└──────────┴──────┴─────┘
</code></pre></div> <p>Как вы можете видеть, <code class=syntax>runningAccumulate</code> объединяет состояния для каждой группы строк отдельно.</p> <h2 id=joinget>joinGet<a class=headerlink href=../amp/#joinget title="Permanent link"> </a></h2> <p>Функция позволяет извлекать данные из таблицы таким же образом как из <a href=.././amp/ >словаря</a>.</p> <p>Получает данные из таблиц <a href=.././amp/#creating-a-table>Join</a> по ключу.</p> <p>Поддерживаются только таблицы, созданные с <code class=syntax>ENGINE = Join(ANY, LEFT, &lt;join_keys&gt;)</code>.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>joinGet</span><span class=p>(</span><span class=n>join_storage_table_name</span><span class=p>,</span> <span class=o>`</span><span class=n>value_column</span><span class=o>`</span><span class=p>,</span> <span class=n>join_keys</span><span class=p>)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>join_storage_table_name</code> — <a href=../../../syntax/amp/#syntax-identifiers>идентификатор</a>, который указывает, откуда производится выборка данных. Поиск по идентификатору осуществляется в базе данных по умолчанию (см. конфигурацию <code class=syntax>default_database</code>). Чтобы переопределить базу данных по умолчанию, используйте команду <code class=syntax>USE db_name</code>, или укажите базу данных и таблицу через разделитель <code class=syntax>db_name.db_table</code>, см. пример.</li> <li><code class=syntax>value_column</code> — столбец, из которого нужно произвести выборку данных.</li> <li><code class=syntax>join_keys</code> — список ключей, по которым производится выборка данных.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <p>Возвращает значение по списку ключей.</p> <p>Если значения не существует в исходной таблице, вернется <code class=syntax>0</code> или <code class=syntax>null</code> в соответствии с настройками <a href=../../../../operations/settings/settings/amp/#join_use_nulls>join_use_nulls</a>.</p> <p>Подробнее о настройке <code class=syntax>join_use_nulls</code> в <a href=.././amp/ >операциях Join</a>.</p> <p><strong>Пример</strong></p> <p>Входная таблица:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span> <span class=k>DATABASE</span> <span class=n>db_test</span>
<span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>db_test</span><span class=p>.</span><span class=n>id_val</span><span class=p>(</span><span class=o>`</span><span class=n>id</span><span class=o>`</span> <span class=n>UInt32</span><span class=p>,</span> <span class=o>`</span><span class=n>val</span><span class=o>`</span> <span class=n>UInt32</span><span class=p>)</span> <span class=n>ENGINE</span> <span class=o>=</span> <span class=k>Join</span><span class=p>(</span><span class=k>ANY</span><span class=p>,</span> <span class=k>LEFT</span><span class=p>,</span> <span class=n>id</span><span class=p>)</span> <span class=n>SETTINGS</span> <span class=n>join_use_nulls</span> <span class=o>=</span> <span class=mi>1</span>
<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>db_test</span><span class=p>.</span><span class=n>id_val</span> <span class=k>VALUES</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>11</span><span class=p>)(</span><span class=mi>2</span><span class=p>,</span><span class=mi>12</span><span class=p>)(</span><span class=mi>4</span><span class=p>,</span><span class=mi>13</span><span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─id─┬─val─┐
│  4 │  13 │
│  2 │  12 │
│  1 │  11 │
└────┴─────┘
</code></pre></div> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>joinGet</span><span class=p>(</span><span class=n>db_test</span><span class=p>.</span><span class=n>id_val</span><span class=p>,</span><span class=s1>'val'</span><span class=p>,</span><span class=n>toUInt32</span><span class=p>(</span><span class=nb>number</span><span class=p>))</span> <span class=k>from</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>4</span><span class=p>)</span> <span class=n>SETTINGS</span> <span class=n>join_use_nulls</span> <span class=o>=</span> <span class=mi>1</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─joinGet(db_test.id_val, 'val', toUInt32(number))─┐
│                                                0 │
│                                               11 │
│                                               12 │
│                                                0 │
└──────────────────────────────────────────────────┘
</code></pre></div> <h2 id=function-modelevaluate>modelEvaluate(model_name, …)<a class=headerlink href=../amp/#function-modelevaluate title="Permanent link"> </a></h2> <p>Оценивает внешнюю модель.</p> <p>Принимает на вход имя и аргументы модели. Возвращает Float64.</p> <h2 id=throwifx-custom-message>throwIf(x[, custom_message])<a class=headerlink href=../amp/#throwifx-custom-message title="Permanent link"> </a></h2> <p>Бросает исключение, если аргумент не равен нулю.<br> custom_message - необязательный параметр, константная строка, задает текст сообщения об ошибке.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>throwIf</span><span class=p>(</span><span class=nb>number</span> <span class=o>=</span> <span class=mi>3</span><span class=p>,</span> <span class=s1>'Too many'</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>10</span><span class=p>);</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>↙ Progress: 0.00 rows, 0.00 B (0.00 rows/s., 0.00 B/s.) Received exception from server (version 19.14.1):
Code: 395. DB::Exception: Received from localhost:9000. DB::Exception: Too many.
</code></pre></div> <h2 id=identity>identity<a class=headerlink href=../amp/#identity title="Permanent link"> </a></h2> <p>Возвращает свой аргумент. Используется для отладки и тестирования, позволяет отменить использование индекса, и получить результат и производительность полного сканирования таблицы. Это работает, потому что оптимизатор запросов не может «заглянуть» внутрь функции <code class=syntax>identity</code>.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>identity</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</code></pre></div> <p><strong>Пример</strong></p> <p>Query:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=k>identity</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─identity(42)─┐
│           42 │
└──────────────┘
</code></pre></div> <h2 id=randomascii>randomPrintableASCII<a class=headerlink href=../amp/#randomascii title="Permanent link"> </a></h2> <p>Генерирует строку со случайным набором печатных символов <a href=https://en.wikipedia.org/wiki/ASCII#Printable_characters rel="external nofollow noreferrer" target=_blank>ASCII</a>.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>randomPrintableASCII</span><span class=p>(</span><span class=k>length</span><span class=p>)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>length</code> — Длина результирующей строки. Положительное целое число.<div class=codehilite><pre><span></span><code class=syntax><span class=err>Если передать `length &lt; 0`, то поведение функции не определено.</span>
</code></pre></div> </li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Строка со случайным набором печатных символов <a href=https://en.wikipedia.org/wiki/ASCII#Printable_characters rel="external nofollow noreferrer" target=_blank>ASCII</a>.</li> </ul> <p>Тип: <a href=.././amp/ >String</a></p> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=nb>number</span><span class=p>,</span> <span class=n>randomPrintableASCII</span><span class=p>(</span><span class=mi>30</span><span class=p>)</span> <span class=k>as</span> <span class=n>str</span><span class=p>,</span> <span class=k>length</span><span class=p>(</span><span class=n>str</span><span class=p>)</span> <span class=k>FROM</span> <span class=k>system</span><span class=p>.</span><span class=n>numbers</span> <span class=k>LIMIT</span> <span class=mi>3</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─number─┬─str────────────────────────────┬─length(randomPrintableASCII(30))─┐
│      0 │ SuiCOSTvC0csfABSw=UcSzp2.`rv8x │                               30 │
│      1 │ 1Ag NlJ &amp;RCN:*&gt;HVPG;PE-nO"SUFD │                               30 │
│      2 │ /"+&lt;"wUTh:=LjJ Vm!c&amp;hI*m#XTfzz │                               30 │
└────────┴────────────────────────────────┴──────────────────────────────────┘
</code></pre></div> <h2 id=randomstring>randomString<a class=headerlink href=../amp/#randomstring title="Permanent link"> </a></h2> <p>Генерирует бинарную строку заданной длины, заполненную случайными байтами (в том числе нулевыми).</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>randomString</span><span class=p>(</span><span class=k>length</span><span class=p>)</span>
</code></pre></div> <p><strong>Параметры</strong> </p> <ul> <li><code class=syntax>length</code> — длина строки. Положительное целое число.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Строка, заполненная случайными байтами.</li> </ul> <p>Type: <a href=../../../data-types/string/amp/ >String</a>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>randomString</span><span class=p>(</span><span class=mi>30</span><span class=p>)</span> <span class=k>AS</span> <span class=n>str</span><span class=p>,</span> <span class=k>length</span><span class=p>(</span><span class=n>str</span><span class=p>)</span> <span class=k>AS</span> <span class=n>len</span> <span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span> <span class=n>FORMAT</span> <span class=n>Vertical</span><span class=p>;</span>
</code></pre></div> <p>Ответ:</p> <div class=codehilite><pre><span></span><code class=syntax>Row 1:
──────
str: 3 G  :   pT ?w тi  k aV f6
len: 30

Row 2:
──────
str: 9 ,]    ^   )  ]??  8
len: 30
</code></pre></div> <p><strong>Смотрите также</strong></p> <ul> <li><a href=../../../table-functions/generate/amp/#generaterandom>generateRandom</a></li> <li><a href=.././amp/#randomascii>randomPrintableASCII</a></li> </ul> <h2 id=randomfixedstring>randomFixedString<a class=headerlink href=../amp/#randomfixedstring title="Permanent link"> </a></h2> <p>Генерирует бинарную строку заданной длины, заполненную случайными байтами, включая нулевые.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>randomFixedString</span><span class=p>(</span><span class=k>length</span><span class=p>);</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>length</code> — Длина строки в байтах. <a href=../../../data-types/int-uint/amp/ >UInt64</a>.</li> </ul> <p><strong>Returned value(s)</strong></p> <ul> <li>Строка, заполненная случайными байтами.</li> </ul> <p>Тип: <a href=../../../data-types/fixedstring/amp/ >FixedString</a>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>randomFixedString</span><span class=p>(</span><span class=mi>13</span><span class=p>)</span> <span class=k>as</span> <span class=n>rnd</span><span class=p>,</span> <span class=n>toTypeName</span><span class=p>(</span><span class=n>rnd</span><span class=p>)</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─rnd──────┬─toTypeName(randomFixedString(13))─┐
│ j▒h㋖HɨZ'▒ │ FixedString(13)                 │
└──────────┴───────────────────────────────────┘
</code></pre></div> <h2 id=randomstringutf8>randomStringUTF8<a class=headerlink href=../amp/#randomstringutf8 title="Permanent link"> </a></h2> <p>Генерирует строку заданной длины со случайными символами в кодировке UTF-8.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>randomStringUTF8</span><span class=p>(</span><span class=k>length</span><span class=p>);</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>length</code> — Длина итоговой строки в кодовых точках. <a href=../../../data-types/int-uint/amp/ >UInt64</a>.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Случайная строка в кодировке UTF-8.</li> </ul> <p>Тип: <a href=../../../data-types/string/amp/ >String</a>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>randomStringUTF8</span><span class=p>(</span><span class=mi>13</span><span class=p>)</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─randomStringUTF8(13)─┐
│ 𘤗𙉝д兠庇󡅴󱱎󦐪􂕌𔊹𓰛   │
└──────────────────────┘
</code></pre></div> <h2 id=getSetting>getSetting<a class=headerlink href=../amp/#getSetting title="Permanent link"> </a></h2> <p>Возвращает текущее значение <a href=../../../../operations/settings/amp/#custom_settings>пользовательской настройки</a>.</p> <p><strong>Синтаксис</strong> </p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>getSetting</span><span class=p>(</span><span class=s1>'custom_setting'</span><span class=p>);</span>    
</code></pre></div> <p><strong>Параметр</strong> </p> <ul> <li><code class=syntax>custom_setting</code> — название настройки. <a href=../../../data-types/string/amp/ >String</a>.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Текущее значение пользовательской настройки.</li> </ul> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SET</span> <span class=n>custom_a</span> <span class=o>=</span> <span class=mi>123</span><span class=p>;</span>
<span class=k>SELECT</span> <span class=n>getSetting</span><span class=p>(</span><span class=s1>'custom_a'</span><span class=p>);</span>    
</code></pre></div> <p><strong>Результат</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=err>123</span>
</code></pre></div> <p><strong>См. также</strong> </p> <ul> <li><a href=../../../../operations/settings/amp/#custom_settings>Пользовательские настройки</a></li> </ul> <h2 id=is-decimal-overflow>isDecimalOverflow<a class=headerlink href=../amp/#is-decimal-overflow title="Permanent link"> </a></h2> <p>Проверяет, находится ли число <a href=../../../data-types/decimal/amp/ >Decimal</a> вне собственной (или заданной) области значений.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>isDecimalOverflow</span><span class=p>(</span><span class=n>d</span><span class=p>,</span> <span class=p>[</span><span class=n>p</span><span class=p>])</span>
</code></pre></div> <p><strong>Параметры</strong> </p> <ul> <li><code class=syntax>d</code> — число. <a href=../../../data-types/decimal/amp/ >Decimal</a>.</li> <li><code class=syntax>p</code> — точность. Необязательный параметр. Если опущен, используется исходная точность первого аргумента. Использование этого параметра может быть полезно для извлечения данных в другую СУБД или файл. <a href=../../../data-types/int-uint/amp/#uint-ranges>UInt8</a>. </li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li><code class=syntax>1</code> — число имеет больше цифр, чем позволяет точность.</li> <li><code class=syntax>0</code> — число удовлетворяет заданной точности.</li> </ul> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>isDecimalOverflow</span><span class=p>(</span><span class=n>toDecimal32</span><span class=p>(</span><span class=mi>1000000000</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=mi>9</span><span class=p>),</span>
       <span class=n>isDecimalOverflow</span><span class=p>(</span><span class=n>toDecimal32</span><span class=p>(</span><span class=mi>1000000000</span><span class=p>,</span> <span class=mi>0</span><span class=p>)),</span>
       <span class=n>isDecimalOverflow</span><span class=p>(</span><span class=n>toDecimal32</span><span class=p>(</span><span class=o>-</span><span class=mi>1000000000</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=mi>9</span><span class=p>),</span>
       <span class=n>isDecimalOverflow</span><span class=p>(</span><span class=n>toDecimal32</span><span class=p>(</span><span class=o>-</span><span class=mi>1000000000</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>1   1   1   1
</code></pre></div> <h2 id=count-digits>countDigits<a class=headerlink href=../amp/#count-digits title="Permanent link"> </a></h2> <p>Возвращает количество десятичных цифр, необходимых для представления значения.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>countDigits</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</code></pre></div> <p><strong>Параметры</strong> </p> <ul> <li><code class=syntax>x</code> — <a href=../../../data-types/int-uint/amp/#uint8-uint16-uint32-uint64-int8-int16-int32-int64>целое</a> или <a href=../../../data-types/decimal/amp/ >дробное</a> число.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <p>Количество цифр.</p> <p>Тип: <a href=../../../data-types/int-uint/amp/#uint-ranges>UInt8</a>.</p> <p>!!! note "Примечание"<br> Для <code class=syntax>Decimal</code> значений учитывается их масштаб: вычисляется результат по базовому целочисленному типу, полученному как <code class=syntax>(value * scale)</code>. Например: <code class=syntax>countDigits(42) = 2</code>, <code class=syntax>countDigits(42.000) = 5</code>, <code class=syntax>countDigits(0.04200) = 4</code>. То есть вы можете проверить десятичное переполнение для <code class=syntax>Decimal64</code> с помощью <code class=syntax>countDecimal(x) &gt; 18</code>. Это медленный вариант <a href=../amp/#is-decimal-overflow>isDecimalOverflow</a>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>countDigits</span><span class=p>(</span><span class=n>toDecimal32</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>9</span><span class=p>)),</span> <span class=n>countDigits</span><span class=p>(</span><span class=n>toDecimal32</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>9</span><span class=p>)),</span>
       <span class=n>countDigits</span><span class=p>(</span><span class=n>toDecimal64</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>18</span><span class=p>)),</span> <span class=n>countDigits</span><span class=p>(</span><span class=n>toDecimal64</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>18</span><span class=p>)),</span>
       <span class=n>countDigits</span><span class=p>(</span><span class=n>toDecimal128</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>38</span><span class=p>)),</span> <span class=n>countDigits</span><span class=p>(</span><span class=n>toDecimal128</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>38</span><span class=p>));</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>10  10  19  19  39  39
</code></pre></div> <h2 id=error-code-to-name>errorCodeToName<a class=headerlink href=../amp/#error-code-to-name title="Permanent link"> </a></h2> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Название переменной для кода ошибки.</li> </ul> <p>Тип: <a href=../../../data-types/lowcardinality/amp/ >LowCardinality(String)</a>.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>errorCodeToName</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>UNSUPPORTED_METHOD
</code></pre></div> <h2 id=tcpPort>tcpPort<a class=headerlink href=../amp/#tcpPort title="Permanent link"> </a></h2> <p>Вовращает номер TCP порта, который использует сервер для <a href=../../../../interfaces/tcp/amp/ >нативного протокола</a>.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>tcpPort</span><span class=p>()</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li>Нет.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Номер TCP порта.</li> </ul> <p>Тип: <a href=../../../data-types/int-uint/amp/ >UInt16</a>.</p> <p><strong>Пример</strong></p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>tcpPort</span><span class=p>();</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─tcpPort()─┐
│      9000 │
└───────────┘
</code></pre></div> <p><strong>Смотрите также</strong></p> <ul> <li><a href=../../../../operations/server-configuration-parameters/settings/amp/#server_configuration_parameters-tcp_port>tcp_port</a></li> </ul> <p><a href=https://clickhouse.tech/docs/ru/query_language/functions/other_functions/ target=_blank>Оригинальная статья</a> <!--hide--></p> </div> </div> <div class=row> <div class=col> <div class="alert alert-light my-3"> <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p> <span class="alert-heading display-6">Article Rating</span> <div id=rating-stars class="display-6 mb-0">RATING_STARS</div> </div> <div id=content-footer class="text-muted pt-3 mb-5"> <div class=float-md-right>©2016–2020 Yandex LLC</div> <div>Built from <a href=https://github.com/ClickHouse/ClickHouse/commit/b030bfedd7db4603034643fd183cf7784a820193 rel="external nofollow noreferrer" target=_blank class=text-reset>b030bfedd7</a> </div> </div> </div> </div> <div id=to-full-website class="row fixed-bottom text-center bg-white py-3"> <div class=col> <a href=https://clickhouse.tech/docs/ru/sql-reference/functions/other-functions/ class="btn btn-lg btn-outline-orange">To full website</a> </div> </div> </div> <amp-analytics type=metrika> <script type=application/json>{
"vars": {
  "counterId": "18343495",
  "triggers": {
    "notBounce": {
      "on": "timer",
      "timerSpec": {
        "immediate": false,
        "interval": 15,
        "maxTimerLength": 16
      },
      "request": "notBounce"
    }
  }
}
}</script> </amp-analytics> </body> </html> 