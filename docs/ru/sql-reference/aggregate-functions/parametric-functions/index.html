<!DOCTYPE html><html lang=ru data-version=master data-single-page=false> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Параметрические агрегатные функции | Документация ClickHouse</title><link rel="shortcut icon" href=/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/images/logo-180x180.png><meta property=og:title content="Параметрические агрегатные функции | Документация ClickHouse"><meta property=og:description content="Параметрические агрегатные функции Некоторые агрегатные функции могут принимать не только столбцы-аргументы (по которым "><meta property=og:type content=article><meta property=og:image content=https://clickhouse.tech/images/logo.png><meta content=https://clickhouse.tech/docs/ru/sql-reference/aggregate-functions/parametric-functions/ property=og:url><link href=https://clickhouse.tech/docs/ru/sql-reference/aggregate-functions/parametric-functions/ rel=canonical><link href=https://clickhouse.tech/docs/ru/sql-reference/aggregate-functions/parametric-functions/amp/ rel=amphtml><link rel=search href=/opensearch.xml title=ClickHouse type=application/opensearchdescription+xml><script type=application/ld+json>[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "Параметрические агрегатные функции | Документация ClickHouse",
"mainEntityOfPage": "https://clickhouse.tech/docs/ru/sql-reference/aggregate-functions/parametric-functions/",




"image": "https://clickhouse.tech/images/logo-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "Yandex LLC",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.tech/images/yandex.png",
    "width": 163,
    "height": 60
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "Параметрические агрегатные функции | Документация ClickHouse",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script><meta name=description content="Параметрические агрегатные функции Некоторые агрегатные функции могут принимать не только столбцы-аргументы (по которым "><meta name=keywords content="ClickHouse, DBMS, OLAP, SQL, open-source, relational, analytics, analytical, Big Data, web-analytics"><link rel=alternate href=https://clickhouse.tech/docs/en/sql-reference/aggregate-functions/parametric-functions/ hreflang=en><link rel=alternate href=https://clickhouse.tech/docs/zh/sql-reference/aggregate-functions/parametric-functions/ hreflang=zh><link rel=alternate href=https://clickhouse.tech/docs/ru/sql-reference/aggregate-functions/parametric-functions/ hreflang=ru><link rel=alternate href=https://clickhouse.tech/docs/ja/sql-reference/aggregate-functions/parametric-functions/ hreflang=ja><link rel=alternate href=https://clickhouse.tech/docs/en/sql-reference/aggregate-functions/parametric-functions/ hreflang=x-default><link href=/css/base.css?48d3d791 media=all rel=stylesheet></head> <body dir=ltr data-spy=scroll data-target=#toc data-offset=80> <nav id=top-nav class="navbar navbar-dark navbar-expand-md bg-dark-alt text-white sticky-top"> <div class="container-fluid justify-content-between"> <a href=/ class="d-block navbar-brand mr-3"> <img id=docs-logo-icon src=/images/logo.svg alt="ClickHouse logo" title="ClickHouse logo"> </a> <div class="w-100 navbar-text text-left d-none d-md-block"> <h1 class="h3 m-0 p-0 d-inline"> <a href=# class="text-white text-decoration-none"> Параметрические агрегатные функции </a> </h1> </div> <div class="d-none d-md-block"> <ul class="navbar-nav ml-auto mt-2 mt-lg-0 justify-content-end"> <li id=edit-wrapper class=nav-item> <a id=edit-link href=https://github.com/ClickHouse/ClickHouse/edit/master/docs/ru/sql-reference/aggregate-functions/parametric-functions.md title="Edit this article" class=nav-link rel="external nofollow noreferrer" target=_blank><img src=/images/mkdocs/edit.svg alt="Edit this article" class=mt-1 height=22></a> </li> <li class=nav-item> <a class=nav-link href=https://github.com/ClickHouse/ClickHouse rel="external nofollow noreferrer"> <img src=/images/index/github.svg alt="GitHub repository" title="Go to GitHub" height=32> </a> </li> <li id=languages-wrapper class="nav-item dropdown"> <div id=languages-dropdown> <a class="nav-link dropdown-toggle d-inline-block mt-1 text-muted" href=# id=lang-dropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false> <img src=/images/flags/ru.svg alt=Русский title=Русский width=32 class="d-inline-block mt-n1"> </a> <div class="dropdown-menu bg-dark" aria-labelledby=lang-dropdown> <a href=/docs/en/sql-reference/aggregate-functions/parametric-functions/ class=dropdown-item> <img src=/images/flags/en.svg alt title width=32 class="d-inline-block mr-2">English </a> <a href=/docs/zh/sql-reference/aggregate-functions/parametric-functions/ class=dropdown-item> <img src=/images/flags/zh.svg alt title width=32 class="d-inline-block mr-2">中文 </a> <a href=/docs/ru/sql-reference/aggregate-functions/parametric-functions/ class="dropdown-item disabled"> <img src=/images/flags/ru.svg alt title width=32 class="d-inline-block mr-2">Русский </a> <a href=/docs/ja/sql-reference/aggregate-functions/parametric-functions/ class=dropdown-item> <img src=/images/flags/ja.svg alt title width=32 class="d-inline-block mr-2">日本語 </a> </div> </div> </li> </ul> </div> <form id=search-form class="form-inline m-0"> <div class=input-group> <div class="input-group-prepend w-100"> <span class="input-group-text bg-secondary-alt text-muted border-0 mr-n1" id=search-icon> <img src=/images/mkdocs/search.svg> </span> <input id=docsearch-input class="form-control bg-secondary-alt text-muted border-0 pl-1" type=search placeholder=Search aria-label=Search> </div> </div> </form> <button id=navbar-toggler class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#sidebar aria-controls=sidebar aria-expanded=false aria-label="Toggle navigation"> <span class=navbar-toggler-icon></span> </button> </div> </nav> <div class=container-fluid> <div class="row justify-content-end justify-content-xl-center"> <div id=sidebar class="col-xl-2 col-md-4 bg-secondary-alt p-3 d-print-none min-vh-100 overflow-auto"> <div class=overflow-auto> <div id=single-page-switch class="btn-group mb-2 float-right" role=group aria-label="Multi-page or single-page"> <a href=../../.. role=button class="btn btn-dark active" aria-pressed=true> <img src=/images/mkdocs/multi.svg alt="Multi-page version" title="Multi-page version"> </a> <a href=../../../single/ role=button class="btn btn-dark-alt active" aria-pressed=true> <img src=/images/mkdocs/single.svg alt="Single-page version" title="Single-page version"> </a> </div> <nav id=sidebar-nav class="nav flex-column mb-5"> <a href=#sidebar-sidebar-1 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-1 title=Введение class="nav-link text-light dropdown-toggle px-0">Введение</a> <div id=sidebar-sidebar-1 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../ title=Обзор class="nav-link text-light text-wrap d-inline-block w-100 px-0">Обзор</a> <a href=../../../introduction/distinctive-features/ title="Отличительные возможности ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Отличительные возможности ClickHouse</a> <a href=../../../introduction/performance/ title=Производительность class="nav-link text-light text-wrap d-inline-block w-100 px-0">Производительность</a> <a href=../../../introduction/history/ title="История ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">История ClickHouse</a> <a href=../../../introduction/adopters/ title=Adopters class="nav-link text-light text-wrap d-inline-block w-100 px-0">Adopters</a> <a href=../../../introduction/info/ title="Информационная поддержка" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Информационная поддержка</a> </nav> </div> <a href=#sidebar-sidebar-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-2 title="Начало работы" class="nav-link text-light dropdown-toggle px-0">Начало работы</a> <div id=sidebar-sidebar-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../getting-started/install/ title=Установка class="nav-link text-light text-wrap d-inline-block w-100 px-0">Установка</a> <a href=../../../getting-started/tutorial/ title=Tutorial class="nav-link text-light text-wrap d-inline-block w-100 px-0">Tutorial</a> <a href=../../../getting-started/playground/ title=Playground class="nav-link text-light text-wrap d-inline-block w-100 px-0">Playground</a> <a href=#sidebar-sidebar-2-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-2-5 title="Тестовые массивы данных" class="nav-link text-light dropdown-toggle px-0">Тестовые массивы данных</a> <div id=sidebar-sidebar-2-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../getting-started/example-datasets/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../getting-started/example-datasets/metrica/ title="Анонимизированные данные Яндекс.Метрики" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Анонимизированные данные Яндекс.Метрики</a> <a href=../../../getting-started/example-datasets/star-schema/ title="Star Schema Benchmark" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Star Schema Benchmark</a> <a href=../../../getting-started/example-datasets/recipes/ title="Набор данных кулинарных рецептов" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Набор данных кулинарных рецептов</a> <a href=../../../getting-started/example-datasets/wikistat/ title=WikiStat class="nav-link text-light text-wrap d-inline-block w-100 px-0">WikiStat</a> <a href=../../../getting-started/example-datasets/criteo/ title="Терабайт логов кликов от Criteo" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Терабайт логов кликов от Criteo</a> <a href=../../../getting-started/example-datasets/amplab-benchmark/ title="AMPLab Big Data Benchmark" class="nav-link text-light text-wrap d-inline-block w-100 px-0">AMPLab Big Data Benchmark</a> <a href=../../../getting-started/example-datasets/brown-benchmark/ title="Brown University Benchmark" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Brown University Benchmark</a> <a href=../../../getting-started/example-datasets/nyc-taxi/ title="Данные о такси в Нью-Йорке" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Данные о такси в Нью-Йорке</a> <a href=../../../getting-started/example-datasets/ontime/ title=OnTime class="nav-link text-light text-wrap d-inline-block w-100 px-0">OnTime</a> <a href=../../../getting-started/example-datasets/cell-towers/ title="Вышки сотовой связи" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Вышки сотовой связи</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3 title=Интерфейсы class="nav-link text-light dropdown-toggle px-0">Интерфейсы</a> <div id=sidebar-sidebar-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../interfaces/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../interfaces/cli/ title="Клиент командной строки" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Клиент командной строки</a> <a href=../../../interfaces/tcp/ title="Родной интерфейс (TCP)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Родной интерфейс (TCP)</a> <a href=../../../interfaces/http/ title=HTTP-интерфейс class="nav-link text-light text-wrap d-inline-block w-100 px-0">HTTP-интерфейс</a> <a href=../../../interfaces/mysql/ title=MySQL-интерфейс class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQL-интерфейс</a> <a href=../../../interfaces/formats/ title="Форматы входных и выходных данных" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Форматы входных и выходных данных</a> <a href=../../../interfaces/jdbc/ title=JDBC-драйвер class="nav-link text-light text-wrap d-inline-block w-100 px-0">JDBC-драйвер</a> <a href=../../../interfaces/odbc/ title=ODBC-драйвер class="nav-link text-light text-wrap d-inline-block w-100 px-0">ODBC-драйвер</a> <a href=../../../interfaces/cpp/ title="C++ клиентская библиотека" class="nav-link text-light text-wrap d-inline-block w-100 px-0">C++ клиентская библиотека</a> <a href=#sidebar-sidebar-3-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-3-10 title="Сторонние интерфейсы" class="nav-link text-light dropdown-toggle px-0">Сторонние интерфейсы</a> <div id=sidebar-sidebar-3-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../interfaces/third-party/ title="Сторонние интерфейсы" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Сторонние интерфейсы</a> <a href=../../../interfaces/third-party/client-libraries/ title="Клиентские библиотеки от сторонних разработчиков" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Клиентские библиотеки от сторонних разработчиков</a> <a href=../../../interfaces/third-party/integrations/ title="Библиотеки для интеграции от сторонних разработчиков" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Библиотеки для интеграции от сторонних разработчиков</a> <a href=../../../interfaces/third-party/gui/ title="Визуальные интерфейсы от сторонних разработчиков" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Визуальные интерфейсы от сторонних разработчиков</a> <a href=../../../interfaces/third-party/proxy/ title="Прокси-серверы от сторонних разработчиков" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Прокси-серверы от сторонних разработчиков</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4 title=Engines class="nav-link text-light dropdown-toggle px-0">Engines</a> <div id=sidebar-sidebar-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=#sidebar-sidebar-4-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-2 title="Движки таблиц" class="nav-link text-light dropdown-toggle px-0">Движки таблиц</a> <div id=sidebar-sidebar-4-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../engines/table-engines/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=#sidebar-sidebar-4-2-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-2-2 title="MergeTree Family" class="nav-link text-light dropdown-toggle px-0">MergeTree Family</a> <div id=sidebar-sidebar-4-2-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../engines/table-engines/mergetree-family/mergetree/ title=MergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">MergeTree</a> <a href=../../../engines/table-engines/mergetree-family/replication/ title="Репликация данных" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Репликация данных</a> <a href=../../../engines/table-engines/mergetree-family/custom-partitioning-key/ title="Произвольный ключ партиционирования" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Произвольный ключ партиционирования</a> <a href=../../../engines/table-engines/mergetree-family/replacingmergetree/ title=ReplacingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">ReplacingMergeTree</a> <a href=../../../engines/table-engines/mergetree-family/summingmergetree/ title=SummingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">SummingMergeTree</a> <a href=../../../engines/table-engines/mergetree-family/aggregatingmergetree/ title=AggregatingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">AggregatingMergeTree</a> <a href=../../../engines/table-engines/mergetree-family/collapsingmergetree/ title=CollapsingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">CollapsingMergeTree</a> <a href=../../../engines/table-engines/mergetree-family/versionedcollapsingmergetree/ title=VersionedCollapsingMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">VersionedCollapsingMergeTree</a> <a href=../../../engines/table-engines/mergetree-family/graphitemergetree/ title=GraphiteMergeTree class="nav-link text-light text-wrap d-inline-block w-100 px-0">GraphiteMergeTree</a> </nav> </div> <a href=#sidebar-sidebar-4-2-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-2-3 title="Семейство Log" class="nav-link text-light dropdown-toggle px-0">Семейство Log</a> <div id=sidebar-sidebar-4-2-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../engines/table-engines/log-family/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../engines/table-engines/log-family/stripelog/ title=StripeLog class="nav-link text-light text-wrap d-inline-block w-100 px-0">StripeLog</a> <a href=../../../engines/table-engines/log-family/log/ title=Log class="nav-link text-light text-wrap d-inline-block w-100 px-0">Log</a> <a href=../../../engines/table-engines/log-family/tinylog/ title=TinyLog class="nav-link text-light text-wrap d-inline-block w-100 px-0">TinyLog</a> </nav> </div> <a href=#sidebar-sidebar-4-2-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-2-4 title="Движки таблиц для интеграции" class="nav-link text-light dropdown-toggle px-0">Движки таблиц для интеграции</a> <div id=sidebar-sidebar-4-2-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../engines/table-engines/integrations/odbc/ title=ODBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">ODBC</a> <a href=../../../engines/table-engines/integrations/jdbc/ title=JDBC class="nav-link text-light text-wrap d-inline-block w-100 px-0">JDBC</a> <a href=../../../engines/table-engines/integrations/mysql/ title=MySQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQL</a> <a href=../../../engines/table-engines/integrations/s3/ title=S3 class="nav-link text-light text-wrap d-inline-block w-100 px-0">S3</a> <a href=../../../engines/table-engines/integrations/mongodb/ title=MongoDB class="nav-link text-light text-wrap d-inline-block w-100 px-0">MongoDB</a> <a href=../../../engines/table-engines/integrations/hdfs/ title=HDFS class="nav-link text-light text-wrap d-inline-block w-100 px-0">HDFS</a> <a href=../../../engines/table-engines/integrations/kafka/ title=Kafka class="nav-link text-light text-wrap d-inline-block w-100 px-0">Kafka</a> <a href=../../../engines/table-engines/integrations/embedded-rocksdb/ title=EmbeddedRocksDB class="nav-link text-light text-wrap d-inline-block w-100 px-0">EmbeddedRocksDB</a> <a href=../../../engines/table-engines/integrations/postgresql/ title=PostgreSQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">PostgreSQL</a> <a href=../../../engines/table-engines/integrations/ExternalDistributed/ title=ExternalDistributed class="nav-link text-light text-wrap d-inline-block w-100 px-0">ExternalDistributed</a> <a href=../../../engines/table-engines/integrations/ title="Движки таблиц для интеграции" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Движки таблиц для интеграции</a> <a href=../../../engines/table-engines/integrations/rabbitmq/ title=RabbitMQ class="nav-link text-light text-wrap d-inline-block w-100 px-0">RabbitMQ</a> </nav> </div> <a href=#sidebar-sidebar-4-2-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-2-5 title="Специальные движки таблиц" class="nav-link text-light dropdown-toggle px-0">Специальные движки таблиц</a> <div id=sidebar-sidebar-4-2-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../engines/table-engines/special/ title="Специальные движки таблиц" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Специальные движки таблиц</a> <a href=../../../engines/table-engines/special/distributed/ title=Distributed class="nav-link text-light text-wrap d-inline-block w-100 px-0">Distributed</a> <a href=../../../engines/table-engines/special/dictionary/ title=Dictionary class="nav-link text-light text-wrap d-inline-block w-100 px-0">Dictionary</a> <a href=../../../engines/table-engines/special/merge/ title=Merge class="nav-link text-light text-wrap d-inline-block w-100 px-0">Merge</a> <a href=../../../engines/table-engines/special/file/ title=File class="nav-link text-light text-wrap d-inline-block w-100 px-0">File</a> <a href=../../../engines/table-engines/special/null/ title=Null class="nav-link text-light text-wrap d-inline-block w-100 px-0">Null</a> <a href=../../../engines/table-engines/special/set/ title=Set class="nav-link text-light text-wrap d-inline-block w-100 px-0">Set</a> <a href=../../../engines/table-engines/special/join/ title=Join class="nav-link text-light text-wrap d-inline-block w-100 px-0">Join</a> <a href=../../../engines/table-engines/special/url/ title=URL class="nav-link text-light text-wrap d-inline-block w-100 px-0">URL</a> <a href=../../../engines/table-engines/special/view/ title=View class="nav-link text-light text-wrap d-inline-block w-100 px-0">View</a> <a href=../../../engines/table-engines/special/materializedview/ title=MaterializedView class="nav-link text-light text-wrap d-inline-block w-100 px-0">MaterializedView</a> <a href=../../../engines/table-engines/special/memory/ title=Memory class="nav-link text-light text-wrap d-inline-block w-100 px-0">Memory</a> <a href=../../../engines/table-engines/special/buffer/ title=Buffer class="nav-link text-light text-wrap d-inline-block w-100 px-0">Buffer</a> <a href=../../../engines/table-engines/special/external-data/ title="Внешние данные для обработки запроса" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Внешние данные для обработки запроса</a> <a href=../../../engines/table-engines/special/generate/ title=GenerateRandom class="nav-link text-light text-wrap d-inline-block w-100 px-0">GenerateRandom</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-4-3 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-4-3 title="Движки баз данных" class="nav-link text-light dropdown-toggle px-0">Движки баз данных</a> <div id=sidebar-sidebar-4-3 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../engines/database-engines/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../engines/database-engines/materialize-mysql/ title=MaterializeMySQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">MaterializeMySQL</a> <a href=../../../engines/database-engines/mysql/ title=MySQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">MySQL</a> <a href=../../../engines/database-engines/lazy/ title=Lazy class="nav-link text-light text-wrap d-inline-block w-100 px-0">Lazy</a> <a href=../../../engines/database-engines/atomic/ title=Atomic class="nav-link text-light text-wrap d-inline-block w-100 px-0">Atomic</a> <a href=../../../engines/database-engines/postgresql/ title=PostgreSQL class="nav-link text-light text-wrap d-inline-block w-100 px-0">PostgreSQL</a> </nav> </div> </nav> </div> <a href=#sidebar-sidebar-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5 title="Справка по SQL" class="nav-link text-light dropdown-toggle px-0">Справка по SQL</a> <div id=sidebar-sidebar-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=#sidebar-sidebar-5-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2 title=Выражения class="nav-link text-light dropdown-toggle px-0">Выражения</a> <div id=sidebar-sidebar-5-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../sql-reference/statements/ title="SQL выражения в ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">SQL выражения в ClickHouse</a> <a href=#sidebar-sidebar-5-2-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2-2 title=SELECT class="nav-link text-light dropdown-toggle px-0">SELECT</a> <div id=sidebar-sidebar-5-2-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../sql-reference/statements/select/ title=Обзор class="nav-link text-light text-wrap d-inline-block w-100 px-0">Обзор</a> <a href=../../../sql-reference/statements/select/all/ title=ALL class="nav-link text-light text-wrap d-inline-block w-100 px-0">ALL</a> <a href=../../../sql-reference/statements/select/array-join/ title="ARRAY JOIN" class="nav-link text-light text-wrap d-inline-block w-100 px-0">ARRAY JOIN</a> <a href=../../../sql-reference/statements/select/distinct/ title=DISTINCT class="nav-link text-light text-wrap d-inline-block w-100 px-0">DISTINCT</a> <a href=../../../sql-reference/statements/select/format/ title=FORMAT class="nav-link text-light text-wrap d-inline-block w-100 px-0">FORMAT</a> <a href=../../../sql-reference/statements/select/from/ title=FROM class="nav-link text-light text-wrap d-inline-block w-100 px-0">FROM</a> <a href=../../../sql-reference/statements/select/group-by/ title="GROUP BY" class="nav-link text-light text-wrap d-inline-block w-100 px-0">GROUP BY</a> <a href=../../../sql-reference/statements/select/having/ title=HAVING class="nav-link text-light text-wrap d-inline-block w-100 px-0">HAVING</a> <a href=../../../sql-reference/statements/select/into-outfile/ title="INTO OUTFILE" class="nav-link text-light text-wrap d-inline-block w-100 px-0">INTO OUTFILE</a> <a href=../../../sql-reference/statements/select/join/ title=JOIN class="nav-link text-light text-wrap d-inline-block w-100 px-0">JOIN</a> <a href=../../../sql-reference/statements/select/limit/ title=LIMIT class="nav-link text-light text-wrap d-inline-block w-100 px-0">LIMIT</a> <a href=../../../sql-reference/statements/select/limit-by/ title="LIMIT BY" class="nav-link text-light text-wrap d-inline-block w-100 px-0">LIMIT BY</a> <a href=../../../sql-reference/statements/select/offset/ title=OFFSET class="nav-link text-light text-wrap d-inline-block w-100 px-0">OFFSET</a> <a href=../../../sql-reference/statements/select/order-by/ title="ORDER BY" class="nav-link text-light text-wrap d-inline-block w-100 px-0">ORDER BY</a> <a href=../../../sql-reference/statements/select/prewhere/ title=PREWHERE class="nav-link text-light text-wrap d-inline-block w-100 px-0">PREWHERE</a> <a href=../../../sql-reference/statements/select/sample/ title=SAMPLE class="nav-link text-light text-wrap d-inline-block w-100 px-0">SAMPLE</a> <a href=../../../sql-reference/statements/select/union/ title=UNION class="nav-link text-light text-wrap d-inline-block w-100 px-0">UNION</a> <a href=../../../sql-reference/statements/select/where/ title=WHERE class="nav-link text-light text-wrap d-inline-block w-100 px-0">WHERE</a> <a href=../../../sql-reference/statements/select/with/ title=WITH class="nav-link text-light text-wrap d-inline-block w-100 px-0">WITH</a> </nav> </div> <a href=../../../sql-reference/statements/insert-into/ title="INSERT INTO" class="nav-link text-light text-wrap d-inline-block w-100 px-0">INSERT INTO</a> <a href=#sidebar-sidebar-5-2-4 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2-4 title=CREATE class="nav-link text-light dropdown-toggle px-0">CREATE</a> <div id=sidebar-sidebar-5-2-4 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../sql-reference/statements/create/ title=Обзор class="nav-link text-light text-wrap d-inline-block w-100 px-0">Обзор</a> <a href=../../../sql-reference/statements/create/database/ title="База данных" class="nav-link text-light text-wrap d-inline-block w-100 px-0">База данных</a> <a href=../../../sql-reference/statements/create/table/ title=Таблица class="nav-link text-light text-wrap d-inline-block w-100 px-0">Таблица</a> <a href=../../../sql-reference/statements/create/view/ title=Представление class="nav-link text-light text-wrap d-inline-block w-100 px-0">Представление</a> <a href=../../../sql-reference/statements/create/dictionary/ title=Словарь class="nav-link text-light text-wrap d-inline-block w-100 px-0">Словарь</a> <a href=../../../sql-reference/statements/create/user/ title=Пользователь class="nav-link text-light text-wrap d-inline-block w-100 px-0">Пользователь</a> <a href=../../../sql-reference/statements/create/role/ title=Роль class="nav-link text-light text-wrap d-inline-block w-100 px-0">Роль</a> <a href=../../../sql-reference/statements/create/row-policy/ title="Политика доступа" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Политика доступа</a> <a href=../../../sql-reference/statements/create/quota/ title=Квота class="nav-link text-light text-wrap d-inline-block w-100 px-0">Квота</a> <a href=../../../sql-reference/statements/create/settings-profile/ title="Профиль настроек" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Профиль настроек</a> </nav> </div> <a href=#sidebar-sidebar-5-2-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-2-5 title=ALTER class="nav-link text-light dropdown-toggle px-0">ALTER</a> <div id=sidebar-sidebar-5-2-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../sql-reference/statements/alter/ title=ALTER class="nav-link text-light text-wrap d-inline-block w-100 px-0">ALTER</a> <a href=../../../sql-reference/statements/alter/column/ title="Манипуляции со столбцами" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Манипуляции со столбцами</a> <a href=../../../sql-reference/statements/alter/partition/ title=PARTITION class="nav-link text-light text-wrap d-inline-block w-100 px-0">PARTITION</a> <a href=../../../sql-reference/statements/alter/delete/ title=DELETE class="nav-link text-light text-wrap d-inline-block w-100 px-0">DELETE</a> <a href=../../../sql-reference/statements/alter/update/ title=UPDATE class="nav-link text-light text-wrap d-inline-block w-100 px-0">UPDATE</a> <a href=../../../sql-reference/statements/alter/order-by/ title="ORDER BY" class="nav-link text-light text-wrap d-inline-block w-100 px-0">ORDER BY</a> <a href=../../../sql-reference/statements/alter/sample-by/ title="SAMPLE BY" class="nav-link text-light text-wrap d-inline-block w-100 px-0">SAMPLE BY</a> <a href=../../../sql-reference/statements/alter/index/ title="Манипуляции с индексами" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Манипуляции с индексами</a> <a href=../../../sql-reference/statements/alter/constraint/ title="Манипуляции с ограничениями" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Манипуляции с ограничениями</a> <a href=../../../sql-reference/statements/alter/ttl/ title=TTL class="nav-link text-light text-wrap d-inline-block w-100 px-0">TTL</a> <a href=../../../sql-reference/statements/alter/user/ title=USER class="nav-link text-light text-wrap d-inline-block w-100 px-0">USER</a> <a href=../../../sql-reference/statements/alter/quota/ title=QUOTA class="nav-link text-light text-wrap d-inline-block w-100 px-0">QUOTA</a> <a href=../../../sql-reference/statements/alter/role/ title=ROLE class="nav-link text-light text-wrap d-inline-block w-100 px-0">ROLE</a> <a href=../../../sql-reference/statements/alter/row-policy/ title="ROW POLICY" class="nav-link text-light text-wrap d-inline-block w-100 px-0">ROW POLICY</a> <a href=../../../sql-reference/statements/alter/settings-profile/ title="SETTINGS PROFILE" class="nav-link text-light text-wrap d-inline-block w-100 px-0">SETTINGS PROFILE</a> </nav> </div> <a href=../../../sql-reference/statements/system/ title=SYSTEM class="nav-link text-light text-wrap d-inline-block w-100 px-0">SYSTEM</a> <a href=../../../sql-reference/statements/show/ title=SHOW class="nav-link text-light text-wrap d-inline-block w-100 px-0">SHOW</a> <a href=../../../sql-reference/statements/grant/ title=GRANT class="nav-link text-light text-wrap d-inline-block w-100 px-0">GRANT</a> <a href=../../../sql-reference/statements/explain/ title=EXPLAIN class="nav-link text-light text-wrap d-inline-block w-100 px-0">EXPLAIN</a> <a href=../../../sql-reference/statements/revoke/ title=REVOKE class="nav-link text-light text-wrap d-inline-block w-100 px-0">REVOKE</a> <a href=../../../sql-reference/statements/attach/ title=ATTACH class="nav-link text-light text-wrap d-inline-block w-100 px-0">ATTACH</a> <a href=../../../sql-reference/statements/check-table/ title=CHECK class="nav-link text-light text-wrap d-inline-block w-100 px-0">CHECK</a> <a href=../../../sql-reference/statements/describe-table/ title=DESCRIBE class="nav-link text-light text-wrap d-inline-block w-100 px-0">DESCRIBE</a> <a href=../../../sql-reference/statements/detach/ title=DETACH class="nav-link text-light text-wrap d-inline-block w-100 px-0">DETACH</a> <a href=../../../sql-reference/statements/drop/ title=DROP class="nav-link text-light text-wrap d-inline-block w-100 px-0">DROP</a> <a href=../../../sql-reference/statements/exists/ title=EXISTS class="nav-link text-light text-wrap d-inline-block w-100 px-0">EXISTS</a> <a href=../../../sql-reference/statements/kill/ title=KILL class="nav-link text-light text-wrap d-inline-block w-100 px-0">KILL</a> <a href=../../../sql-reference/statements/optimize/ title=OPTIMIZE class="nav-link text-light text-wrap d-inline-block w-100 px-0">OPTIMIZE</a> <a href=../../../sql-reference/statements/rename/ title=RENAME class="nav-link text-light text-wrap d-inline-block w-100 px-0">RENAME</a> <a href=../../../sql-reference/statements/set/ title=SET class="nav-link text-light text-wrap d-inline-block w-100 px-0">SET</a> <a href=../../../sql-reference/statements/set-role/ title="SET ROLE" class="nav-link text-light text-wrap d-inline-block w-100 px-0">SET ROLE</a> <a href=../../../sql-reference/statements/truncate/ title=TRUNCATE class="nav-link text-light text-wrap d-inline-block w-100 px-0">TRUNCATE</a> <a href=../../../sql-reference/statements/use/ title=USE class="nav-link text-light text-wrap d-inline-block w-100 px-0">USE</a> <a href=../../../sql-reference/statements/watch/ title=WATCH class="nav-link text-light text-wrap d-inline-block w-100 px-0">WATCH</a> </nav> </div> <a href=../../../sql-reference/syntax/ title=Синтаксис class="nav-link text-light text-wrap d-inline-block w-100 px-0">Синтаксис</a> <a href=../../../sql-reference/distributed-ddl/ title="Распределенные DDL запросы" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Распределенные DDL запросы</a> <a href=#sidebar-sidebar-5-5 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-5 title=Функции class="nav-link text-light dropdown-toggle px-0">Функции</a> <div id=sidebar-sidebar-5-5 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../sql-reference/functions/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../sql-reference/functions/arithmetic-functions/ title="Арифметические функции" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Арифметические функции</a> <a href=../../../sql-reference/functions/array-functions/ title=Массивы class="nav-link text-light text-wrap d-inline-block w-100 px-0">Массивы</a> <a href=../../../sql-reference/functions/comparison-functions/ title="Функции сравнения" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции сравнения</a> <a href=../../../sql-reference/functions/logical-functions/ title="Логические функции" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Логические функции</a> <a href=../../../sql-reference/functions/type-conversion-functions/ title="Функции преобразования типов" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции преобразования типов</a> <a href=../../../sql-reference/functions/date-time-functions/ title="Функции для работы с датами и временем" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы с датами и временем</a> <a href=../../../sql-reference/functions/string-functions/ title="Функции для работы со строками" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы со строками</a> <a href=../../../sql-reference/functions/string-search-functions/ title="Функции поиска в строках" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции поиска в строках</a> <a href=../../../sql-reference/functions/string-replace-functions/ title="Функции поиска и замены в строках" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции поиска и замены в строках</a> <a href=../../../sql-reference/functions/conditional-functions/ title="Условные функции" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Условные функции</a> <a href=../../../sql-reference/functions/files/ title="Функции для работы с файлами" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы с файлами</a> <a href=../../../sql-reference/functions/math-functions/ title="Математические функции" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Математические функции</a> <a href=../../../sql-reference/functions/rounding-functions/ title="Функции округления" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции округления</a> <a href=../../../sql-reference/functions/tuple-map-functions/ title="Работа с контейнерами map" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Работа с контейнерами map</a> <a href=../../../sql-reference/functions/splitting-merging-functions/ title="Функции разбиения и слияния строк и массивов" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции разбиения и слияния строк и массивов</a> <a href=../../../sql-reference/functions/bit-functions/ title="Битовые функции" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Битовые функции</a> <a href=../../../sql-reference/functions/bitmap-functions/ title="Функции для битмапов" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для битмапов</a> <a href=../../../sql-reference/functions/hash-functions/ title="Функции хэширования" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции хэширования</a> <a href=../../../sql-reference/functions/random-functions/ title="Функции генерации псевдослучайных чисел" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции генерации псевдослучайных чисел</a> <a href=../../../sql-reference/functions/encoding-functions/ title="Функции кодирования" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции кодирования</a> <a href=../../../sql-reference/functions/uuid-functions/ title="Функции для работы с UUID" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы с UUID</a> <a href=../../../sql-reference/functions/url-functions/ title="Функции для работы с URL" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы с URL</a> <a href=../../../sql-reference/functions/ip-address-functions/ title="Функции для работы с IP-адресами" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы с IP-адресами</a> <a href=../../../sql-reference/functions/json-functions/ title=JSON class="nav-link text-light text-wrap d-inline-block w-100 px-0">JSON</a> <a href=../../../sql-reference/functions/ext-dict-functions/ title="Функции для работы с внешними словарями" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы с внешними словарями</a> <a href=../../../sql-reference/functions/ym-dict-functions/ title="Функции для работы со словарями Яндекс.Метрики" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы со словарями Яндекс.Метрики</a> <a href=../../../sql-reference/functions/in-functions/ title="Функции для реализации оператора IN" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для реализации оператора IN</a> <a href=../../../sql-reference/functions/array-join/ title="Функция ArrayJoin" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функция ArrayJoin</a> <a href=#sidebar-sidebar-5-5-30 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-5-30 title=Гео-данные class="nav-link text-light dropdown-toggle px-0">Гео-данные</a> <div id=sidebar-sidebar-5-5-30 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../sql-reference/functions/geo/coordinates/ title="Функции для работы с географическими координатами" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы с географическими координатами</a> <a href=../../../sql-reference/functions/geo/h3/ title="Функции для работы с индексами H3" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы с индексами H3</a> <a href=../../../sql-reference/functions/geo/geohash/ title="Функции для работы с системой Geohash" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы с системой Geohash</a> </nav> </div> <a href=../../../sql-reference/functions/functions-for-nulls/ title="Функции для работы с Nullable-аргументами" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы с Nullable-аргументами</a> <a href=../../../sql-reference/functions/machine-learning-functions/ title="Функции машинного обучения" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции машинного обучения</a> <a href=../../../sql-reference/functions/introspection/ title="Функции интроспекции" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции интроспекции</a> <a href=../../../sql-reference/functions/other-functions/ title="Прочие функции" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Прочие функции</a> <a href=../../../sql-reference/functions/encryption-functions/ title="Функции для шифрования" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для шифрования</a> <a href=../../../sql-reference/functions/tuple-functions/ title="Функции для работы с кортежами" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Функции для работы с кортежами</a> </nav> </div> <a href=#sidebar-sidebar-5-6 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-6 title="Агрегатные функции" class="nav-link text-light dropdown-toggle px-0">Агрегатные функции</a> <div id=sidebar-sidebar-5-6 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../sql-reference/aggregate-functions/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=#sidebar-sidebar-5-6-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-6-2 title=Справочник class="nav-link text-light dropdown-toggle px-0">Справочник</a> <div id=sidebar-sidebar-5-6-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../sql-reference/aggregate-functions/reference/count/ title=count class="nav-link text-light text-wrap d-inline-block w-100 px-0">count</a> <a href=../../../sql-reference/aggregate-functions/reference/min/ title=min class="nav-link text-light text-wrap d-inline-block w-100 px-0">min</a> <a href=../../../sql-reference/aggregate-functions/reference/max/ title=max class="nav-link text-light text-wrap d-inline-block w-100 px-0">max</a> <a href=../../../sql-reference/aggregate-functions/reference/sum/ title=sum class="nav-link text-light text-wrap d-inline-block w-100 px-0">sum</a> <a href=../../../sql-reference/aggregate-functions/reference/avg/ title=avg class="nav-link text-light text-wrap d-inline-block w-100 px-0">avg</a> <a href=../../../sql-reference/aggregate-functions/reference/any/ title=any class="nav-link text-light text-wrap d-inline-block w-100 px-0">any</a> <a href=../../../sql-reference/aggregate-functions/reference/stddevpop/ title=stddevPop class="nav-link text-light text-wrap d-inline-block w-100 px-0">stddevPop</a> <a href=../../../sql-reference/aggregate-functions/reference/stddevsamp/ title=stddevSamp class="nav-link text-light text-wrap d-inline-block w-100 px-0">stddevSamp</a> <a href=../../../sql-reference/aggregate-functions/reference/varpop/ title=varPop(x) class="nav-link text-light text-wrap d-inline-block w-100 px-0">varPop(x)</a> <a href=../../../sql-reference/aggregate-functions/reference/varsamp/ title=varSamp class="nav-link text-light text-wrap d-inline-block w-100 px-0">varSamp</a> <a href=../../../sql-reference/aggregate-functions/reference/covarpop/ title=covarPop class="nav-link text-light text-wrap d-inline-block w-100 px-0">covarPop</a> <a href=../../../sql-reference/aggregate-functions/reference/covarsamp/ title=covarSamp class="nav-link text-light text-wrap d-inline-block w-100 px-0">covarSamp</a> <a href=../../../sql-reference/aggregate-functions/reference/anyheavy/ title=anyHeavy class="nav-link text-light text-wrap d-inline-block w-100 px-0">anyHeavy</a> <a href=../../../sql-reference/aggregate-functions/reference/anylast/ title=anyLast class="nav-link text-light text-wrap d-inline-block w-100 px-0">anyLast</a> <a href=../../../sql-reference/aggregate-functions/reference/argmin/ title=argMin class="nav-link text-light text-wrap d-inline-block w-100 px-0">argMin</a> <a href=../../../sql-reference/aggregate-functions/reference/argmax/ title=argMax class="nav-link text-light text-wrap d-inline-block w-100 px-0">argMax</a> <a href=../../../sql-reference/aggregate-functions/reference/avgweighted/ title=avgWeighted class="nav-link text-light text-wrap d-inline-block w-100 px-0">avgWeighted</a> <a href=../../../sql-reference/aggregate-functions/reference/corr/ title=corr class="nav-link text-light text-wrap d-inline-block w-100 px-0">corr</a> <a href=../../../sql-reference/aggregate-functions/reference/topk/ title=topK class="nav-link text-light text-wrap d-inline-block w-100 px-0">topK</a> <a href=../../../sql-reference/aggregate-functions/reference/topkweighted/ title=topKWeighted class="nav-link text-light text-wrap d-inline-block w-100 px-0">topKWeighted</a> <a href=../../../sql-reference/aggregate-functions/reference/grouparray/ title=groupArray class="nav-link text-light text-wrap d-inline-block w-100 px-0">groupArray</a> <a href=../../../sql-reference/aggregate-functions/reference/groupuniqarray/ title=groupUniqArray class="nav-link text-light text-wrap d-inline-block w-100 px-0">groupUniqArray</a> <a href=../../../sql-reference/aggregate-functions/reference/grouparrayinsertat/ title=groupArrayInsertAt class="nav-link text-light text-wrap d-inline-block w-100 px-0">groupArrayInsertAt</a> <a href=../../../sql-reference/aggregate-functions/reference/grouparraymovingsum/ title=groupArrayMovingSum class="nav-link text-light text-wrap d-inline-block w-100 px-0">groupArrayMovingSum</a> <a href=../../../sql-reference/aggregate-functions/reference/grouparraymovingavg/ title=groupArrayMovingAvg class="nav-link text-light text-wrap d-inline-block w-100 px-0">groupArrayMovingAvg</a> <a href=../../../sql-reference/aggregate-functions/reference/grouparraysample/ title=groupArraySample class="nav-link text-light text-wrap d-inline-block w-100 px-0">groupArraySample</a> <a href=../../../sql-reference/aggregate-functions/reference/groupbitand/ title=groupBitAnd class="nav-link text-light text-wrap d-inline-block w-100 px-0">groupBitAnd</a> <a href=../../../sql-reference/aggregate-functions/reference/groupbitor/ title=groupBitOr class="nav-link text-light text-wrap d-inline-block w-100 px-0">groupBitOr</a> <a href=../../../sql-reference/aggregate-functions/reference/groupbitxor/ title=groupBitXor class="nav-link text-light text-wrap d-inline-block w-100 px-0">groupBitXor</a> <a href=../../../sql-reference/aggregate-functions/reference/groupbitmap/ title=groupBitmap class="nav-link text-light text-wrap d-inline-block w-100 px-0">groupBitmap</a> <a href=../../../sql-reference/aggregate-functions/reference/sumwithoverflow/ title=sumWithOverflow class="nav-link text-light text-wrap d-inline-block w-100 px-0">sumWithOverflow</a> <a href=../../../sql-reference/aggregate-functions/reference/deltasum/ title=deltaSum class="nav-link text-light text-wrap d-inline-block w-100 px-0">deltaSum</a> <a href=../../../sql-reference/aggregate-functions/reference/deltasumtimestamp/ title=deltaSumTimestamp class="nav-link text-light text-wrap d-inline-block w-100 px-0">deltaSumTimestamp</a> <a href=../../../sql-reference/aggregate-functions/reference/summap/ title="sumMap(key, value), sumMap(Tuple(key, value))" class="nav-link text-light text-wrap d-inline-block w-100 px-0">sumMap(key, value), sumMap(Tuple(key, value))</a> <a href=../../../sql-reference/aggregate-functions/reference/minmap/ title=minMap class="nav-link text-light text-wrap d-inline-block w-100 px-0">minMap</a> <a href=../../../sql-reference/aggregate-functions/reference/maxmap/ title=maxMap class="nav-link text-light text-wrap d-inline-block w-100 px-0">maxMap</a> <a href=../../../sql-reference/aggregate-functions/reference/sumcount/ title=sumCount class="nav-link text-light text-wrap d-inline-block w-100 px-0">sumCount</a> <a href=../../../sql-reference/aggregate-functions/reference/rankCorr/ title=rankCorr class="nav-link text-light text-wrap d-inline-block w-100 px-0">rankCorr</a> <a href=../../../sql-reference/aggregate-functions/reference/sumkahan/ title=sumKahan class="nav-link text-light text-wrap d-inline-block w-100 px-0">sumKahan</a> <a href=../../../sql-reference/aggregate-functions/reference/intervalLengthSum/ title=intervalLengthSum class="nav-link text-light text-wrap d-inline-block w-100 px-0">intervalLengthSum</a> <a href=../../../sql-reference/aggregate-functions/reference/skewpop/ title=skewPop class="nav-link text-light text-wrap d-inline-block w-100 px-0">skewPop</a> <a href=../../../sql-reference/aggregate-functions/reference/skewsamp/ title=skewSamp class="nav-link text-light text-wrap d-inline-block w-100 px-0">skewSamp</a> <a href=../../../sql-reference/aggregate-functions/reference/kurtpop/ title=kurtPop class="nav-link text-light text-wrap d-inline-block w-100 px-0">kurtPop</a> <a href=../../../sql-reference/aggregate-functions/reference/kurtsamp/ title=kurtSamp class="nav-link text-light text-wrap d-inline-block w-100 px-0">kurtSamp</a> <a href=../../../sql-reference/aggregate-functions/reference/uniq/ title=uniq class="nav-link text-light text-wrap d-inline-block w-100 px-0">uniq</a> <a href=../../../sql-reference/aggregate-functions/reference/uniqexact/ title=uniqExact class="nav-link text-light text-wrap d-inline-block w-100 px-0">uniqExact</a> <a href=../../../sql-reference/aggregate-functions/reference/uniqcombined/ title=uniqCombined class="nav-link text-light text-wrap d-inline-block w-100 px-0">uniqCombined</a> <a href=../../../sql-reference/aggregate-functions/reference/uniqcombined64/ title=uniqCombined64 class="nav-link text-light text-wrap d-inline-block w-100 px-0">uniqCombined64</a> <a href=../../../sql-reference/aggregate-functions/reference/uniqhll12/ title=uniqHLL12 class="nav-link text-light text-wrap d-inline-block w-100 px-0">uniqHLL12</a> <a href=../../../sql-reference/aggregate-functions/reference/quantile/ title=quantile class="nav-link text-light text-wrap d-inline-block w-100 px-0">quantile</a> <a href=../../../sql-reference/aggregate-functions/reference/quantiles/ title=quantiles class="nav-link text-light text-wrap d-inline-block w-100 px-0">quantiles</a> <a href=../../../sql-reference/aggregate-functions/reference/quantileexact/ title=quantileExact class="nav-link text-light text-wrap d-inline-block w-100 px-0">quantileExact</a> <a href=../../../sql-reference/aggregate-functions/reference/quantileexactweighted/ title=quantileExactWeighted class="nav-link text-light text-wrap d-inline-block w-100 px-0">quantileExactWeighted</a> <a href=../../../sql-reference/aggregate-functions/reference/quantiletiming/ title=quantileTiming class="nav-link text-light text-wrap d-inline-block w-100 px-0">quantileTiming</a> <a href=../../../sql-reference/aggregate-functions/reference/quantiletimingweighted/ title=quantileTimingWeighted class="nav-link text-light text-wrap d-inline-block w-100 px-0">quantileTimingWeighted</a> <a href=../../../sql-reference/aggregate-functions/reference/quantiledeterministic/ title=quantileDeterministic class="nav-link text-light text-wrap d-inline-block w-100 px-0">quantileDeterministic</a> <a href=../../../sql-reference/aggregate-functions/reference/quantiletdigest/ title=quantileTDigest class="nav-link text-light text-wrap d-inline-block w-100 px-0">quantileTDigest</a> <a href=../../../sql-reference/aggregate-functions/reference/quantiletdigestweighted/ title=quantileTDigestWeighted class="nav-link text-light text-wrap d-inline-block w-100 px-0">quantileTDigestWeighted</a> <a href=../../../sql-reference/aggregate-functions/reference/simplelinearregression/ title=simpleLinearRegression class="nav-link text-light text-wrap d-inline-block w-100 px-0">simpleLinearRegression</a> <a href=../../../sql-reference/aggregate-functions/reference/stochasticlinearregression/ title=stochasticLinearRegression class="nav-link text-light text-wrap d-inline-block w-100 px-0">stochasticLinearRegression</a> <a href=../../../sql-reference/aggregate-functions/reference/stochasticlogisticregression/ title=stochasticLogisticRegression class="nav-link text-light text-wrap d-inline-block w-100 px-0">stochasticLogisticRegression</a> <a href=../../../sql-reference/aggregate-functions/reference/studentttest/ title=studentTTest class="nav-link text-light text-wrap d-inline-block w-100 px-0">studentTTest</a> <a href=../../../sql-reference/aggregate-functions/reference/welchttest/ title=welchTTest class="nav-link text-light text-wrap d-inline-block w-100 px-0">welchTTest</a> <a href=../../../sql-reference/aggregate-functions/reference/mannwhitneyutest/ title=mannWhitneyUTest class="nav-link text-light text-wrap d-inline-block w-100 px-0">mannWhitneyUTest</a> <a href=../../../sql-reference/aggregate-functions/reference/median/ title=median class="nav-link text-light text-wrap d-inline-block w-100 px-0">median</a> </nav> </div> <a href=../../../sql-reference/aggregate-functions/combinators/ title="Комбинаторы агрегатных функций" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Комбинаторы агрегатных функций</a> <a href=../../../sql-reference/aggregate-functions/parametric-functions/ title="Параметрические агрегатные функции" class="nav-link text-white active text-wrap d-inline-block w-100 px-0">Параметрические агрегатные функции</a> </nav> </div> <a href=#sidebar-sidebar-5-7 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-7 title="Табличные функции" class="nav-link text-light dropdown-toggle px-0">Табличные функции</a> <div id=sidebar-sidebar-5-7 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../sql-reference/table-functions/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../sql-reference/table-functions/file/ title=file class="nav-link text-light text-wrap d-inline-block w-100 px-0">file</a> <a href=../../../sql-reference/table-functions/merge/ title=merge class="nav-link text-light text-wrap d-inline-block w-100 px-0">merge</a> <a href=../../../sql-reference/table-functions/numbers/ title=numbers class="nav-link text-light text-wrap d-inline-block w-100 px-0">numbers</a> <a href=../../../sql-reference/table-functions/remote/ title=remote class="nav-link text-light text-wrap d-inline-block w-100 px-0">remote</a> <a href=../../../sql-reference/table-functions/url/ title=url class="nav-link text-light text-wrap d-inline-block w-100 px-0">url</a> <a href=../../../sql-reference/table-functions/mysql/ title=mysql class="nav-link text-light text-wrap d-inline-block w-100 px-0">mysql</a> <a href=../../../sql-reference/table-functions/postgresql/ title=postgresql class="nav-link text-light text-wrap d-inline-block w-100 px-0">postgresql</a> <a href=../../../sql-reference/table-functions/jdbc/ title=jdbc class="nav-link text-light text-wrap d-inline-block w-100 px-0">jdbc</a> <a href=../../../sql-reference/table-functions/odbc/ title=odbc class="nav-link text-light text-wrap d-inline-block w-100 px-0">odbc</a> <a href=../../../sql-reference/table-functions/hdfs/ title=hdfs class="nav-link text-light text-wrap d-inline-block w-100 px-0">hdfs</a> <a href=../../../sql-reference/table-functions/s3/ title=s3 class="nav-link text-light text-wrap d-inline-block w-100 px-0">s3</a> <a href=../../../sql-reference/table-functions/input/ title=input class="nav-link text-light text-wrap d-inline-block w-100 px-0">input</a> <a href=../../../sql-reference/table-functions/generate/ title=generateRandom class="nav-link text-light text-wrap d-inline-block w-100 px-0">generateRandom</a> <a href=../../../sql-reference/table-functions/cluster/ title=cluster class="nav-link text-light text-wrap d-inline-block w-100 px-0">cluster</a> <a href=../../../sql-reference/table-functions/null/ title="null функция" class="nav-link text-light text-wrap d-inline-block w-100 px-0">null функция</a> <a href=../../../sql-reference/table-functions/dictionary/ title=dictionary class="nav-link text-light text-wrap d-inline-block w-100 px-0">dictionary</a> <a href=../../../sql-reference/table-functions/view/ title=view class="nav-link text-light text-wrap d-inline-block w-100 px-0">view</a> </nav> </div> <a href=#sidebar-sidebar-5-8 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-8 title=Словари class="nav-link text-light dropdown-toggle px-0">Словари</a> <div id=sidebar-sidebar-5-8 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../sql-reference/dictionaries/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=#sidebar-sidebar-5-8-2 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-8-2 title="Внешние словари" class="nav-link text-light dropdown-toggle px-0">Внешние словари</a> <div id=sidebar-sidebar-5-8-2 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../sql-reference/dictionaries/external-dictionaries/external-dicts/ title="Внешние словари" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Внешние словари</a> <a href=../../../sql-reference/dictionaries/external-dictionaries/external-dicts-dict/ title="Настройка внешнего словаря" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Настройка внешнего словаря</a> <a href=../../../sql-reference/dictionaries/external-dictionaries/external-dicts-dict-layout/ title="Хранение словарей в памяти" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Хранение словарей в памяти</a> <a href=../../../sql-reference/dictionaries/external-dictionaries/external-dicts-dict-lifetime/ title="Обновление словарей" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Обновление словарей</a> <a href=../../../sql-reference/dictionaries/external-dictionaries/external-dicts-dict-sources/ title="Источники внешних словарей" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Источники внешних словарей</a> <a href=../../../sql-reference/dictionaries/external-dictionaries/external-dicts-dict-structure/ title="Ключ и поля словаря" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Ключ и поля словаря</a> <a href=../../../sql-reference/dictionaries/external-dictionaries/external-dicts-dict-hierarchical/ title="Иерархические словари" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Иерархические словари</a> <a href=../../../sql-reference/dictionaries/external-dictionaries/external-dicts-dict-polygon/ title="Cловари полигонов" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Cловари полигонов</a> </nav> </div> <a href=../../../sql-reference/dictionaries/internal-dicts/ title="Встроенные словари" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Встроенные словари</a> </nav> </div> <a href=#sidebar-sidebar-5-9 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-9 title="Типы данных" class="nav-link text-light dropdown-toggle px-0">Типы данных</a> <div id=sidebar-sidebar-5-9 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../sql-reference/data-types/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../sql-reference/data-types/int-uint/ title="UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64" class="nav-link text-light text-wrap d-inline-block w-100 px-0">UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64</a> <a href=../../../sql-reference/data-types/float/ title="Float32, Float64" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Float32, Float64</a> <a href=../../../sql-reference/data-types/decimal/ title=Decimal class="nav-link text-light text-wrap d-inline-block w-100 px-0">Decimal</a> <a href=../../../sql-reference/data-types/boolean/ title="Булевы значения" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Булевы значения</a> <a href=../../../sql-reference/data-types/string/ title=String class="nav-link text-light text-wrap d-inline-block w-100 px-0">String</a> <a href=../../../sql-reference/data-types/fixedstring/ title=FixedString(N) class="nav-link text-light text-wrap d-inline-block w-100 px-0">FixedString(N)</a> <a href=../../../sql-reference/data-types/uuid/ title=UUID class="nav-link text-light text-wrap d-inline-block w-100 px-0">UUID</a> <a href=../../../sql-reference/data-types/date/ title=Date class="nav-link text-light text-wrap d-inline-block w-100 px-0">Date</a> <a href=../../../sql-reference/data-types/datetime/ title=DateTime class="nav-link text-light text-wrap d-inline-block w-100 px-0">DateTime</a> <a href=../../../sql-reference/data-types/datetime64/ title=DateTime64 class="nav-link text-light text-wrap d-inline-block w-100 px-0">DateTime64</a> <a href=../../../sql-reference/data-types/enum/ title=Enum class="nav-link text-light text-wrap d-inline-block w-100 px-0">Enum</a> <a href=../../../sql-reference/data-types/lowcardinality/ title=LowCardinality class="nav-link text-light text-wrap d-inline-block w-100 px-0">LowCardinality</a> <a href=../../../sql-reference/data-types/array/ title=Array(T) class="nav-link text-light text-wrap d-inline-block w-100 px-0">Array(T)</a> <a href=../../../sql-reference/data-types/aggregatefunction/ title=AggregateFunction class="nav-link text-light text-wrap d-inline-block w-100 px-0">AggregateFunction</a> <a href=../../../sql-reference/data-types/tuple/ title="Tuple(T1, T2, ...)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Tuple(T1, T2, ...)</a> <a href=#sidebar-sidebar-5-9-17 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-9-17 title="Вложенные структуры данных" class="nav-link text-light dropdown-toggle px-0">Вложенные структуры данных</a> <div id=sidebar-sidebar-5-9-17 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../sql-reference/data-types/nested-data-structures/nested/ title="Nested(Name1 Type1, Name2 Type2, …)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nested(Name1 Type1, Name2 Type2, …)</a> </nav> </div> <a href=../../../sql-reference/data-types/nullable/ title=Nullable class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nullable</a> <a href=#sidebar-sidebar-5-9-19 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-9-19 title="Служебные типы данных" class="nav-link text-light dropdown-toggle px-0">Служебные типы данных</a> <div id=sidebar-sidebar-5-9-19 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../sql-reference/data-types/special-data-types/expression/ title=Expression class="nav-link text-light text-wrap d-inline-block w-100 px-0">Expression</a> <a href=../../../sql-reference/data-types/special-data-types/set/ title=Set class="nav-link text-light text-wrap d-inline-block w-100 px-0">Set</a> <a href=../../../sql-reference/data-types/special-data-types/nothing/ title=Nothing class="nav-link text-light text-wrap d-inline-block w-100 px-0">Nothing</a> <a href=../../../sql-reference/data-types/special-data-types/interval/ title=Interval class="nav-link text-light text-wrap d-inline-block w-100 px-0">Interval</a> </nav> </div> <a href=#sidebar-sidebar-5-9-20 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-9-20 title=Домены class="nav-link text-light dropdown-toggle px-0">Домены</a> <div id=sidebar-sidebar-5-9-20 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../sql-reference/data-types/domains/ title=Домены class="nav-link text-light text-wrap d-inline-block w-100 px-0">Домены</a> <a href=../../../sql-reference/data-types/domains/ipv4/ title=IPv4 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IPv4</a> <a href=../../../sql-reference/data-types/domains/ipv6/ title=IPv6 class="nav-link text-light text-wrap d-inline-block w-100 px-0">IPv6</a> </nav> </div> <a href=../../../sql-reference/data-types/multiword-types/ title="Составные типы" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Составные типы</a> <a href=../../../sql-reference/data-types/geo/ title="Географические структуры" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Географические структуры</a> <a href=../../../sql-reference/data-types/map/ title="Map(key, value)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Map(key, value)</a> <a href=../../../sql-reference/data-types/simpleaggregatefunction/ title="SimpleAggregateFunction(func, type)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">SimpleAggregateFunction(func, type)</a> </nav> </div> <a href=#sidebar-sidebar-5-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-5-10 title=Операторы class="nav-link text-light dropdown-toggle px-0">Операторы</a> <div id=sidebar-sidebar-5-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../sql-reference/operators/ title=Операторы class="nav-link text-light text-wrap d-inline-block w-100 px-0">Операторы</a> <a href=../../../sql-reference/operators/in/ title="Операторы IN" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Операторы IN</a> </nav> </div> <a href=../../../sql-reference/ansi/ title="ANSI Compatibility" class="nav-link text-light text-wrap d-inline-block w-100 px-0">ANSI Compatibility</a> </nav> </div> <a href=#sidebar-sidebar-6 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-6 title=Руководства class="nav-link text-light dropdown-toggle px-0">Руководства</a> <div id=sidebar-sidebar-6 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../guides/ title=Обзор class="nav-link text-light text-wrap d-inline-block w-100 px-0">Обзор</a> <a href=../../../guides/apply-catboost-model/ title="Применение модели CatBoost в ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Применение модели CatBoost в ClickHouse</a> </nav> </div> <a href=#sidebar-sidebar-7 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7 title=Эксплуатация class="nav-link text-light dropdown-toggle px-0">Эксплуатация</a> <div id=sidebar-sidebar-7 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../operations/ title=Эксплуатация class="nav-link text-light text-wrap d-inline-block w-100 px-0">Эксплуатация</a> <a href=../../../operations/requirements/ title=Требования class="nav-link text-light text-wrap d-inline-block w-100 px-0">Требования</a> <a href=../../../operations/monitoring/ title=Мониторинг class="nav-link text-light text-wrap d-inline-block w-100 px-0">Мониторинг</a> <a href=../../../operations/troubleshooting/ title="Устранение неисправностей" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Устранение неисправностей</a> <a href=../../../operations/update/ title="Обновление ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Обновление ClickHouse</a> <a href=#sidebar-sidebar-7-6 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7-6 title="Внешние аутентификаторы пользователей и каталоги" class="nav-link text-light dropdown-toggle px-0">Внешние аутентификаторы пользователей и каталоги</a> <div id=sidebar-sidebar-7-6 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../operations/external-authenticators/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../operations/external-authenticators/kerberos/ title=Kerberos class="nav-link text-light text-wrap d-inline-block w-100 px-0">Kerberos</a> <a href=../../../operations/external-authenticators/ldap/ title=LDAP class="nav-link text-light text-wrap d-inline-block w-100 px-0">LDAP</a> </nav> </div> <a href=../../../operations/access-rights/ title="Управление доступом" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Управление доступом</a> <a href=../../../operations/backup/ title="Резервное копирование данных" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Резервное копирование данных</a> <a href=../../../operations/configuration-files/ title="Конфигурационные файлы" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Конфигурационные файлы</a> <a href=../../../operations/quotas/ title=Квоты class="nav-link text-light text-wrap d-inline-block w-100 px-0">Квоты</a> <a href=#sidebar-sidebar-7-11 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7-11 title="Optimizing Performance" class="nav-link text-light dropdown-toggle px-0">Optimizing Performance</a> <div id=sidebar-sidebar-7-11 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../operations/optimizing-performance/sampling-query-profiler/ title="Query Profiling" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Query Profiling</a> </nav> </div> <a href=#sidebar-sidebar-7-12 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7-12 title="Системные таблицы" class="nav-link text-light dropdown-toggle px-0">Системные таблицы</a> <div id=sidebar-sidebar-7-12 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../operations/system-tables/ title="Системные таблицы" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Системные таблицы</a> <a href=../../../operations/system-tables/asynchronous_metric_log/ title=system.asynchronous_metric_log class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.asynchronous_metric_log</a> <a href=../../../operations/system-tables/asynchronous_metrics/ title=system.asynchronous_metrics class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.asynchronous_metrics</a> <a href=../../../operations/system-tables/clusters/ title=system.clusters class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.clusters</a> <a href=../../../operations/system-tables/columns/ title=system.columns class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.columns</a> <a href=../../../operations/system-tables/contributors/ title=system.contributors class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.contributors</a> <a href=../../../operations/system-tables/crash-log/ title=system.crash_log class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.crash_log</a> <a href=../../../operations/system-tables/current-roles/ title=system.current_roles class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.current_roles</a> <a href=../../../operations/system-tables/data_type_families/ title=system.data_type_families class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.data_type_families</a> <a href=../../../operations/system-tables/databases/ title=system.databases class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.databases</a> <a href=../../../operations/system-tables/detached_parts/ title=system.detached_parts class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.detached_parts</a> <a href=../../../operations/system-tables/dictionaries/ title=system.dictionaries class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.dictionaries</a> <a href=../../../operations/system-tables/disks/ title=system.disks class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.disks</a> <a href=../../../operations/system-tables/distributed_ddl_queue/ title=system.distributed_ddl_queue class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.distributed_ddl_queue</a> <a href=../../../operations/system-tables/distribution_queue/ title=system.distribution_queue class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.distribution_queue</a> <a href=../../../operations/system-tables/enabled-roles/ title=system.enabled_roles class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.enabled_roles</a> <a href=../../../operations/system-tables/errors/ title=system.errors class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.errors</a> <a href=../../../operations/system-tables/events/ title=system.events class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.events</a> <a href=../../../operations/system-tables/functions/ title=system.functions class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.functions</a> <a href=../../../operations/system-tables/grants/ title=system.grants class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.grants</a> <a href=../../../operations/system-tables/graphite_retentions/ title=system.graphite_retentions class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.graphite_retentions</a> <a href=../../../operations/system-tables/licenses/ title=system.licenses class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.licenses</a> <a href=../../../operations/system-tables/merges/ title=system.merges class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.merges</a> <a href=../../../operations/system-tables/metric_log/ title=system.metric_log class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.metric_log</a> <a href=../../../operations/system-tables/metrics/ title=system.metrics class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.metrics</a> <a href=../../../operations/system-tables/mutations/ title=system.mutations class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.mutations</a> <a href=../../../operations/system-tables/numbers/ title=system.numbers class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.numbers</a> <a href=../../../operations/system-tables/numbers_mt/ title=system.numbers_mt class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.numbers_mt</a> <a href=../../../operations/system-tables/one/ title=system.one class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.one</a> <a href=../../../operations/system-tables/opentelemetry_span_log/ title=system.opentelemetry_span_log class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.opentelemetry_span_log</a> <a href=../../../operations/system-tables/part_log/ title=system.part_log class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.part_log</a> <a href=../../../operations/system-tables/parts/ title=system.parts class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.parts</a> <a href=../../../operations/system-tables/parts_columns/ title=system.parts_columns class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.parts_columns</a> <a href=../../../operations/system-tables/processes/ title=system.processes class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.processes</a> <a href=../../../operations/system-tables/query_log/ title=system.query_log class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.query_log</a> <a href=../../../operations/system-tables/query_thread_log/ title=system.query_thread_log class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.query_thread_log</a> <a href=../../../operations/system-tables/quota_limits/ title=system.quota_limits class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.quota_limits</a> <a href=../../../operations/system-tables/quota_usage/ title=system.quota_usage class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.quota_usage</a> <a href=../../../operations/system-tables/quotas/ title=system.quotas class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.quotas</a> <a href=../../../operations/system-tables/quotas_usage/ title=system.quotas_usage class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.quotas_usage</a> <a href=../../../operations/system-tables/replicas/ title=system.replicas class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.replicas</a> <a href=../../../operations/system-tables/replicated_fetches/ title=system.replicated_fetches class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.replicated_fetches</a> <a href=../../../operations/system-tables/replication_queue/ title=system.replication_queue class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.replication_queue</a> <a href=../../../operations/system-tables/role-grants/ title=system.role_grants class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.role_grants</a> <a href=../../../operations/system-tables/roles/ title=system.roles class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.roles</a> <a href=../../../operations/system-tables/row_policies/ title=system.row_policies class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.row_policies</a> <a href=../../../operations/system-tables/settings/ title=system.settings class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.settings</a> <a href=../../../operations/system-tables/settings_profile_elements/ title=system.settings_profile_elements class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.settings_profile_elements</a> <a href=../../../operations/system-tables/settings_profiles/ title=system.settings_profiles class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.settings_profiles</a> <a href=../../../operations/system-tables/stack_trace/ title=system.stack_trace class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.stack_trace</a> <a href=../../../operations/system-tables/storage_policies/ title=system.storage_policies class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.storage_policies</a> <a href=../../../operations/system-tables/table_engines/ title=system.table_engines class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.table_engines</a> <a href=../../../operations/system-tables/tables/ title=system.tables class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.tables</a> <a href=../../../operations/system-tables/text_log/ title=system.text_log class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.text_log</a> <a href=../../../operations/system-tables/trace_log/ title=system.trace_log class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.trace_log</a> <a href=../../../operations/system-tables/users/ title=system.users class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.users</a> <a href=../../../operations/system-tables/zookeeper/ title=system.zookeeper class="nav-link text-light text-wrap d-inline-block w-100 px-0">system.zookeeper</a> </nav> </div> <a href=../../../operations/performance-test/ title="Testing Hardware" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Testing Hardware</a> <a href=#sidebar-sidebar-7-14 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7-14 title="Конфигурационные параметры сервера" class="nav-link text-light dropdown-toggle px-0">Конфигурационные параметры сервера</a> <div id=sidebar-sidebar-7-14 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../operations/server-configuration-parameters/ title=Введение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Введение</a> <a href=../../../operations/server-configuration-parameters/settings/ title="Конфигурационные параметры сервера" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Конфигурационные параметры сервера</a> </nav> </div> <a href=#sidebar-sidebar-7-15 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7-15 title=Settings class="nav-link text-light dropdown-toggle px-0">Settings</a> <div id=sidebar-sidebar-7-15 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../operations/settings/ title=Introduction class="nav-link text-light text-wrap d-inline-block w-100 px-0">Introduction</a> <a href=../../../operations/settings/permissions-for-queries/ title="Разрешения для запросов" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Разрешения для запросов</a> <a href=../../../operations/settings/query-complexity/ title="Ограничения на сложность запроса" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Ограничения на сложность запроса</a> <a href=../../../operations/settings/settings/ title=Настройки class="nav-link text-light text-wrap d-inline-block w-100 px-0">Настройки</a> <a href=../../../operations/settings/settings-profiles/ title="Профили настроек" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Профили настроек</a> <a href=../../../operations/settings/constraints-on-settings/ title="Ограничения на изменение настроек" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Ограничения на изменение настроек</a> <a href=../../../operations/settings/settings-users/ title="Настройки пользователей" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Настройки пользователей</a> <a href=../../../operations/settings/merge-tree-settings/ title="Настройки MergeTree таблиц" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Настройки MergeTree таблиц</a> </nav> </div> <a href=#sidebar-sidebar-7-16 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-7-16 title=Утилиты class="nav-link text-light dropdown-toggle px-0">Утилиты</a> <div id=sidebar-sidebar-7-16 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../operations/utilities/ title=Обзор class="nav-link text-light text-wrap d-inline-block w-100 px-0">Обзор</a> <a href=../../../operations/utilities/clickhouse-copier/ title=clickhouse-copier class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-copier</a> <a href=../../../operations/utilities/clickhouse-local/ title=clickhouse-local class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-local</a> <a href=../../../operations/utilities/clickhouse-benchmark/ title=clickhouse-benchmark class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-benchmark</a> <a href=../../../operations/utilities/clickhouse-format/ title=clickhouse-format class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-format</a> <a href=../../../operations/utilities/clickhouse-compressor/ title="ClickHouse compressor" class="nav-link text-light text-wrap d-inline-block w-100 px-0">ClickHouse compressor</a> <a href=../../../operations/utilities/odbc-bridge/ title=clickhouse-odbc-bridge class="nav-link text-light text-wrap d-inline-block w-100 px-0">clickhouse-odbc-bridge</a> <a href=../../../operations/utilities/clickhouse-obfuscator/ title="Обфускатор ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Обфускатор ClickHouse</a> </nav> </div> <a href=../../../operations/tips/ title="Usage Recommendations" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Usage Recommendations</a> <a href=../../../operations/opentelemetry/ title="Поддержка OpenTelemetry" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Поддержка OpenTelemetry</a> <a href=../../../operations/caches/ title=Кеши class="nav-link text-light text-wrap d-inline-block w-100 px-0">Кеши</a> </nav> </div> <a href=#sidebar-sidebar-8 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-8 title=Development class="nav-link text-light dropdown-toggle px-0">Development</a> <div id=sidebar-sidebar-8 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../development/developer-instruction/ title="Инструкция для разработчиков" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Инструкция для разработчиков</a> <a href=../../../development/architecture/ title="Обзор архитектуры ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Обзор архитектуры ClickHouse</a> <a href=../../../development/build/ title="Build on Linux" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Build on Linux</a> <a href=../../../development/build-osx/ title="Build on Mac OS X" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Build on Mac OS X</a> <a href=../../../development/build-cross-osx/ title="Build on Linux for Mac OS X" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Build on Linux for Mac OS X</a> <a href=../../../development/build-cross-arm/ title="Build on Linux for AARCH64 (ARM64)" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Build on Linux for AARCH64 (ARM64)</a> <a href=../../../development/style/ title="Как писать код на C++" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Как писать код на C++</a> <a href=../../../development/tests/ title=Testing class="nav-link text-light text-wrap d-inline-block w-100 px-0">Testing</a> <a href=../../../development/contrib/ title="Используемые сторонние библиотеки" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Используемые сторонние библиотеки</a> <a href=../../../development/browse-code/ title="Навигация по коду ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Навигация по коду ClickHouse</a> </nav> </div> <a href=#sidebar-sidebar-9 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-9 title="Коммерческие услуги" class="nav-link text-light dropdown-toggle px-0">Коммерческие услуги</a> <div id=sidebar-sidebar-9 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../commercial/cloud/ title="Поставщики облачных услуг ClickHouse" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Поставщики облачных услуг ClickHouse</a> <a href=../../../commercial/support/ title=Support class="nav-link text-light text-wrap d-inline-block w-100 px-0">Support</a> <a href=../../../commercial/ title="Коммерческие услуги" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Коммерческие услуги</a> </nav> </div> <a href=#sidebar-sidebar-10 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-10 title=F.A.Q. class="nav-link text-light dropdown-toggle px-0">F.A.Q.</a> <div id=sidebar-sidebar-10 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../faq/general/ title="Общие вопросы" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Общие вопросы</a> <a href=../../../faq/use-cases/ title=Применение class="nav-link text-light text-wrap d-inline-block w-100 px-0">Применение</a> <a href=../../../faq/operations/ title=Операции class="nav-link text-light text-wrap d-inline-block w-100 px-0">Операции</a> <a href=../../../faq/integration/ title=Интеграция class="nav-link text-light text-wrap d-inline-block w-100 px-0">Интеграция</a> </nav> </div> <a href=#sidebar-sidebar-11 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-11 title="Что нового?" class="nav-link text-light dropdown-toggle px-0">Что нового?</a> <div id=sidebar-sidebar-11 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=#sidebar-sidebar-11-1 data-toggle=collapse aria-expanded=false aria-controls=sidebar-sidebar-11-1 title=Changelog class="nav-link text-light dropdown-toggle px-0">Changelog</a> <div id=sidebar-sidebar-11-1 class="nav flex-column collapse"> <nav class="nav flex-column pl-2"> <a href=../../../whats-new/changelog/ title=2021 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2021</a> <a href=../../../whats-new/changelog/2019/ title=2019 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2019</a> <a href=../../../whats-new/changelog/2018/ title=2018 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2018</a> <a href=../../../whats-new/changelog/2017/ title=2017 class="nav-link text-light text-wrap d-inline-block w-100 px-0">2017</a> </nav> </div> <a href=../../../whats-new/extended-roadmap/ title=Roadmap class="nav-link text-light text-wrap d-inline-block w-100 px-0">Roadmap</a> <a href=../../../whats-new/security-changelog/ title="Security Changelog" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Security Changelog</a> <a href=../../../whats-new/ title="Что нового в ClickHouse?" class="nav-link text-light text-wrap d-inline-block w-100 px-0">Что нового в ClickHouse?</a> </nav> </div> <a href=../../../single/clickhouse_ru.pdf class="nav-link border-top border-secondary mt-3 px-0 pt-3 text-light"> <img src=/images/mkdocs/pdf.svg alt="PDF version" title="PDF version" height=24 class="d-block mr-1 float-left"><div>PDF version</div> </a> </nav> </div> </div> <div id=content-wrapper class="col-md-8 p-2 p-md-4"> <div id=content class=mt-md-n3> <nav class=text-muted aria-label=breadcrumb> <ol class="breadcrumb bg-transparent p-0"> <li class=breadcrumb-item><a href=../../ class=text-reset>Справка по SQL</a> </li> <li class=breadcrumb-item><a href=../ class=text-reset>Агрегатные функции</a> </li> </ol> </nav> <h1 id=aggregate_functions_parametric>Параметрические агрегатные функции<a class=headerlink href=#aggregate_functions_parametric title="Permanent link"> </a></h1> <p>Некоторые агрегатные функции могут принимать не только столбцы-аргументы (по которым производится свёртка), но и набор параметров - констант для инициализации. Синтаксис - две пары круглых скобок вместо одной. Первая - для параметров, вторая - для аргументов.</p> <h2 id=histogram>histogram<a class=headerlink href=#histogram title="Permanent link"> </a></h2> <p>Рассчитывает адаптивную гистограмму. Не гарантирует точного результата.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>histogram</span><span class=p>(</span><span class=n>number_of_bins</span><span class=p>)(</span><span class=k>values</span><span class=p>)</span>
</code></pre></div> <p>Функция использует <a href=http://jmlr.org/papers/volume11/ben-haim10a/ben-haim10a.pdf rel="external nofollow noreferrer" target=_blank>A Streaming Parallel Decision Tree Algorithm</a>. Границы столбцов устанавливаются по мере поступления новых данных в функцию. В общем случае столбцы имею разную ширину.</p> <p><strong>Аргументы</strong></p> <p><code class=syntax>values</code> — <a href=../../syntax/#syntax-expressions>выражение</a>, предоставляющее входные значения.</p> <p><strong>Параметры</strong></p> <p><code class=syntax>number_of_bins</code> — максимальное количество корзин в гистограмме. Функция автоматически вычисляет количество корзин. Она пытается получить указанное количество корзин, но если не получилось, то в результате корзин будет меньше.</p> <p><strong>Возвращаемые значения</strong></p> <ul> <li><a href=../../data-types/array/ >Массив</a> <a href=../../data-types/tuple/ >кортежей</a> следующего вида:<div class=codehilite><pre><span></span><code class=syntax><span class="n n-Quoted">`</span><span class="n n-Quoted n-Quoted-Escape">``</span><span class="n n-Quoted"></span>
<span class="n n-Quoted">[(lower_1, upper_1, height_1), ... (lower_N, upper_N, height_N)]</span>
<span class="n n-Quoted n-Quoted-Escape">``</span><span class="n n-Quoted">`</span>

<span class=o>-</span> <span class="n n-Quoted">`lower`</span> <span class=n>—</span> <span class=n>нижняя</span> <span class=n>граница</span> <span class=n>корзины</span><span class=p>.</span>
<span class=o>-</span> <span class="n n-Quoted">`upper`</span> <span class=n>—</span> <span class=n>верхняя</span> <span class=n>граница</span> <span class=n>корзины</span><span class=p>.</span>
<span class=o>-</span> <span class="n n-Quoted">`height`</span> <span class=n>—</span> <span class=n>количество</span> <span class=n>значений</span> <span class=n>в</span> <span class=n>корзине</span><span class=p>.</span>
</code></pre></div> </li> </ul> <p><strong>Пример</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>histogram</span><span class=p>(</span><span class=mi>5</span><span class=p>)(</span><span class=nb>number</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
<span class=k>FROM</span> <span class=p>(</span>
    <span class=k>SELECT</span> <span class=o>*</span>
    <span class=k>FROM</span> <span class=k>system</span><span class=p>.</span><span class=n>numbers</span>
    <span class=k>LIMIT</span> <span class=mi>20</span>
<span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─histogram(5)(plus(number, 1))───────────────────────────────────────────┐
│ [(1,4.5,4),(4.5,8.5,4),(8.5,12.75,4.125),(12.75,17,4.625),(17,20,3.25)] │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div> <p>С помощью функции <a href=./#function-bar>bar</a> можно визуализировать гистограмму, например:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>WITH</span> <span class=n>histogram</span><span class=p>(</span><span class=mi>5</span><span class=p>)(</span><span class=n>rand</span><span class=p>()</span> <span class=o>%</span> <span class=mi>100</span><span class=p>)</span> <span class=k>AS</span> <span class=n>hist</span>
<span class=k>SELECT</span>
    <span class=n>arrayJoin</span><span class=p>(</span><span class=n>hist</span><span class=p>).</span><span class=mi>3</span> <span class=k>AS</span> <span class=n>height</span><span class=p>,</span>
    <span class=n>bar</span><span class=p>(</span><span class=n>height</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span> <span class=k>AS</span> <span class=n>bar</span>
<span class=k>FROM</span>
<span class=p>(</span>
    <span class=k>SELECT</span> <span class=o>*</span>
    <span class=k>FROM</span> <span class=k>system</span><span class=p>.</span><span class=n>numbers</span>
    <span class=k>LIMIT</span> <span class=mi>20</span>
<span class=p>)</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─height─┬─bar───┐
│  2.125 │ █▋    │
│   3.25 │ ██▌   │
│  5.625 │ ████▏ │
│  5.625 │ ████▏ │
│  3.375 │ ██▌   │
└────────┴───────┘
</code></pre></div> <p>В этом случае необходимо помнить, что границы корзин гистограммы не известны.</p> <h2 id=function-sequencematch>sequenceMatch(pattern)(timestamp, cond1, cond2, …)<a class=headerlink href=#function-sequencematch title="Permanent link"> </a></h2> <p>Проверяет, содержит ли последовательность событий цепочку, которая соответствует указанному шаблону.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>sequenceMatch</span><span class=p>(</span><span class=n>pattern</span><span class=p>)(</span><span class=k>timestamp</span><span class=p>,</span> <span class=n>cond1</span><span class=p>,</span> <span class=n>cond2</span><span class=p>,</span> <span class=p>...)</span>
</code></pre></div> <div class="admonition warning alert pb-0 mb-4 alert-warning" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Предупреждение</p> <p>События, произошедшие в одну и ту же секунду, располагаются в последовательности в неопределенном порядке, что может повлиять на результат работы функции.</p> </div> <p><strong>Аргументы</strong></p> <ul> <li> <p><code class=syntax>timestamp</code> — столбец, содержащий метки времени. Типичный тип данных столбца — <code class=syntax>Date</code> или <code class=syntax>DateTime</code>. Также можно использовать любой из поддержанных типов данных <a href=./ >UInt</a>.</p> </li> <li> <p><code class=syntax>cond1</code>, <code class=syntax>cond2</code> — условия, описывающие цепочку событий. Тип данных — <code class=syntax>UInt8</code>. Можно использовать до 32 условий. Функция учитывает только те события, которые указаны в условиях. Функция пропускает данные из последовательности, если они не описаны ни в одном из условий.</p> </li> </ul> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>pattern</code> — строка с шаблоном. Смотрите <a href=#sequence-function-pattern-syntax>Синтаксис шаблонов</a>.</li> </ul> <p><strong>Возвращаемые значения</strong></p> <ul> <li>1, если цепочка событий, соответствующая шаблону найдена.</li> <li>0, если цепочка событий, соответствующая шаблону не найдена.</li> </ul> <p>Тип: <code class=syntax>UInt8</code>.</p> <p><a name=sequence-function-pattern-syntax></a><br> <strong>Синтаксис шаблонов</strong></p> <ul> <li> <p><code class=syntax>(?N)</code> — соответствует условию на позиции <code class=syntax>N</code>. Условия пронумерованы по порядку в диапазоне <code class=syntax>[1, 32]</code>. Например, <code class=syntax>(?1)</code> соответствует условию, заданному параметром <code class=syntax>cond1</code>.</p> </li> <li> <p><code class=syntax>.*</code> — соответствует любому количеству событий. Для этого элемента шаблона не надо задавать условия.</p> </li> <li> <p><code class=syntax>(?t operator value)</code> — устанавливает время в секундах, которое должно разделять два события. Например, шаблон <code class=syntax>(?1)(?t&gt;1800)(?2)</code> соответствует событиям, которые произошли более чем через 1800 секунд друг от друга. Между этими событиями может находиться произвольное количество любых событий. Операторы могут быть <code class=syntax>&gt;=</code>, <code class=syntax>&gt;</code>, <code class=syntax>&lt;</code>, <code class=syntax>&lt;=</code>, <code class=syntax>==</code>.</p> </li> </ul> <p><strong>Примеры</strong></p> <p>Пусть таблица <code class=syntax>t</code> содержит следующие данные:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─time─┬─number─┐
│    1 │      1 │
│    2 │      3 │
│    3 │      2 │
└──────┴────────┘
</code></pre></div> <p>Выполним запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>sequenceMatch</span><span class=p>(</span><span class=s1>'(?1)(?2)'</span><span class=p>)(</span><span class=k>time</span><span class=p>,</span> <span class=nb>number</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=nb>number</span> <span class=o>=</span> <span class=mi>2</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─sequenceMatch('(?1)(?2)')(time, equals(number, 1), equals(number, 2))─┐
│                                                                     1 │
└───────────────────────────────────────────────────────────────────────┘
</code></pre></div> <p>Функция нашла цепочку событий, в которой число 2 следует за числом 1. Число 3 между ними было пропущено, поскольку оно не было использовано ни в одном из условий.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>sequenceMatch</span><span class=p>(</span><span class=s1>'(?1)(?2)'</span><span class=p>)(</span><span class=k>time</span><span class=p>,</span> <span class=nb>number</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=nb>number</span> <span class=o>=</span> <span class=mi>2</span><span class=p>,</span> <span class=nb>number</span> <span class=o>=</span> <span class=mi>3</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─sequenceMatch('(?1)(?2)')(time, equals(number, 1), equals(number, 2), equals(number, 3))─┐
│                                                                                        0 │
└──────────────────────────────────────────────────────────────────────────────────────────┘
</code></pre></div> <p>В этом случае функция не может найти цепочку событий, соответствующую шаблону, поскольку событие для числа 3 произошло между 1 и 2. Если бы в этом же случае мы бы проверяли условие на событие для числа 4, то цепочка бы соответствовала шаблону.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>sequenceMatch</span><span class=p>(</span><span class=s1>'(?1)(?2)'</span><span class=p>)(</span><span class=k>time</span><span class=p>,</span> <span class=nb>number</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=nb>number</span> <span class=o>=</span> <span class=mi>2</span><span class=p>,</span> <span class=nb>number</span> <span class=o>=</span> <span class=mi>4</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─sequenceMatch('(?1)(?2)')(time, equals(number, 1), equals(number, 2), equals(number, 4))─┐
│                                                                                        1 │
└──────────────────────────────────────────────────────────────────────────────────────────┘
</code></pre></div> <p><strong>Смотрите также</strong></p> <ul> <li><a href=#function-sequencecount>sequenceCount</a></li> </ul> <h2 id=function-sequencecount>sequenceCount(pattern)(time, cond1, cond2, …)<a class=headerlink href=#function-sequencecount title="Permanent link"> </a></h2> <p>Вычисляет количество цепочек событий, соответствующих шаблону. Функция обнаруживает только непересекающиеся цепочки событий. Она начитает искать следующую цепочку только после того, как полностью совпала текущая цепочка событий.</p> <div class="admonition warning alert pb-0 mb-4 alert-warning" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Предупреждение</p> <p>События, произошедшие в одну и ту же секунду, располагаются в последовательности в неопределенном порядке, что может повлиять на результат работы функции.</p> </div> <div class=codehilite><pre><span></span><code class=syntax><span class=n>sequenceCount</span><span class=p>(</span><span class=n>pattern</span><span class=p>)(</span><span class=k>timestamp</span><span class=p>,</span> <span class=n>cond1</span><span class=p>,</span> <span class=n>cond2</span><span class=p>,</span> <span class=p>...)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li> <p><code class=syntax>timestamp</code> — столбец, содержащий метки времени. Типичный тип данных столбца — <code class=syntax>Date</code> или <code class=syntax>DateTime</code>. Также можно использовать любой из поддержанных типов данных <a href=./ >UInt</a>.</p> </li> <li> <p><code class=syntax>cond1</code>, <code class=syntax>cond2</code> — условия, описывающие цепочку событий. Тип данных — <code class=syntax>UInt8</code>. Можно использовать до 32 условий. Функция учитывает только те события, которые указаны в условиях. Функция пропускает данные из последовательности, если они не описаны ни в одном из условий.</p> </li> </ul> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>pattern</code> — строка с шаблоном. Смотрите <a href=#sequence-function-pattern-syntax>Синтаксис шаблонов</a>.</li> </ul> <p><strong>Возвращаемое значение</strong></p> <ul> <li>Число непересекающихся цепочек событий, соответствущих шаблону.</li> </ul> <p>Тип: <code class=syntax>UInt64</code>.</p> <p><strong>Пример</strong></p> <p>Пусть таблица <code class=syntax>t</code> содержит следующие данные:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─time─┬─number─┐
│    1 │      1 │
│    2 │      3 │
│    3 │      2 │
│    4 │      1 │
│    5 │      3 │
│    6 │      2 │
└──────┴────────┘
</code></pre></div> <p>Вычислим сколько раз число 2 стоит после числа 1, причем между 1 и 2 могут быть любые числа:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>sequenceCount</span><span class=p>(</span><span class=s1>'(?1).*(?2)'</span><span class=p>)(</span><span class=k>time</span><span class=p>,</span> <span class=nb>number</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=nb>number</span> <span class=o>=</span> <span class=mi>2</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>t</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax>┌─sequenceCount('(?1).*(?2)')(time, equals(number, 1), equals(number, 2))─┐
│                                                                       2 │
└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div> <p><strong>Смотрите также</strong></p> <ul> <li><a href=#function-sequencematch>sequenceMatch</a></li> </ul> <h2 id=windowfunnel>windowFunnel<a class=headerlink href=#windowfunnel title="Permanent link"> </a></h2> <p>Отыскивает цепочки событий в скользящем окне по времени и вычисляет максимальное количество произошедших событий из цепочки.</p> <p>Функция работает по алгоритму:</p> <ul> <li> <p>Функция отыскивает данные, на которых срабатывает первое условие из цепочки, и присваивает счетчику событий значение 1. С этого же момента начинается отсчет времени скользящего окна.</p> </li> <li> <p>Если в пределах окна последовательно попадаются события из цепочки, то счетчик увеличивается. Если последовательность событий нарушается, то счетчик не растет.</p> </li> <li> <p>Если в данных оказалось несколько цепочек разной степени завершенности, то функция выдаст только размер самой длинной цепочки.</p> </li> </ul> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>windowFunnel</span><span class=p>(</span><span class=n>window</span><span class=p>,</span> <span class=p>[</span><span class=k>mode</span><span class=p>,</span> <span class=p>[</span><span class=k>mode</span><span class=p>,</span> <span class=p>...</span> <span class=p>]])(</span><span class=k>timestamp</span><span class=p>,</span> <span class=n>cond1</span><span class=p>,</span> <span class=n>cond2</span><span class=p>,</span> <span class=p>...,</span> <span class=n>condN</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>timestamp</code> — имя столбца, содержащего временные отметки. <a href=./ >Date</a>, <a href=./#data_type-datetime>DateTime</a> и другие параметры с типом <code class=syntax>Integer</code>. В случае хранения меток времени в столбцах с типом <code class=syntax>UInt64</code>, максимально допустимое значение соответствует ограничению для типа <code class=syntax>Int64</code>, т.е. равно <code class=syntax>2^63-1</code>.</li> <li><code class=syntax>cond</code> — условия или данные, описывающие цепочку событий. <a href=./ >UInt8</a>.</li> </ul> <p><strong>Параметры</strong></p> <ul> <li><code class=syntax>window</code> — ширина скользящего окна по времени. Это время между первым и последним условием. Единица измерения зависит от <code class=syntax>timestamp</code> и может варьироваться. Должно соблюдаться условие <code class=syntax>timestamp события cond1 &lt;= timestamp события cond2 &lt;= ... &lt;= timestamp события condN &lt;= timestamp события cond1 + window</code>. </li> <li><code class=syntax>mode</code> — необязательный параметр. Может быть установленно несколько значений одновременно.<ul> <li><code class=syntax>'strict'</code> — не учитывать подряд идущие повторяющиеся события.</li> <li><code class=syntax>'strict_order'</code> — запрещает посторонние события в искомой последовательности. Например, при поиске цепочки <code class=syntax>A-&gt;B-&gt;C</code> в <code class=syntax>A-&gt;B-&gt;D-&gt;C</code> поиск будет остановлен на <code class=syntax>D</code> и функция вернет 2.</li> <li><code class=syntax>'strict_increase'</code> — условия прменяются только для событий со строго возрастающими временными метками.</li> </ul> </li> </ul> <p><strong>Возвращаемое значение</strong></p> <p>Максимальное количество последовательно сработавших условий из цепочки в пределах скользящего окна по времени. Исследуются все цепочки в выборке.</p> <p>Тип: <code class=syntax>Integer</code>.</p> <p><strong>Пример</strong></p> <p>Определим, успевает ли пользователь за установленный период выбрать телефон в интернет-магазине, купить его и сделать повторный заказ.</p> <p>Зададим следующую цепочку событий:</p> <ol> <li>Пользователь вошел в личный кабинет (<code class=syntax>eventID = 1001</code>).</li> <li>Пользователь ищет телефон (<code class=syntax>eventID = 1003, product = 'phone'</code>).</li> <li>Пользователь сделал заказ (<code class=syntax>eventID = 1009</code>)</li> <li>Пользователь сделал повторный заказ (<code class=syntax>eventID = 1010</code>).</li> </ol> <p>Входная таблица:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─event_date─┬─user_id─┬───────────timestamp─┬─eventID─┬─product─┐
│ 2019-01-28 │       1 │ 2019-01-29 10:00:00 │    1003 │ phone   │
└────────────┴─────────┴─────────────────────┴─────────┴─────────┘
┌─event_date─┬─user_id─┬───────────timestamp─┬─eventID─┬─product─┐
│ 2019-01-31 │       1 │ 2019-01-31 09:00:00 │    1007 │ phone   │
└────────────┴─────────┴─────────────────────┴─────────┴─────────┘
┌─event_date─┬─user_id─┬───────────timestamp─┬─eventID─┬─product─┐
│ 2019-01-30 │       1 │ 2019-01-30 08:00:00 │    1009 │ phone   │
└────────────┴─────────┴─────────────────────┴─────────┴─────────┘
┌─event_date─┬─user_id─┬───────────timestamp─┬─eventID─┬─product─┐
│ 2019-02-01 │       1 │ 2019-02-01 08:00:00 │    1010 │ phone   │
└────────────┴─────────┴─────────────────────┴─────────┴─────────┘
</code></pre></div> <p>Сделаем запрос и узнаем, как далеко пользователь <code class=syntax>user_id</code> смог пройти по цепочке за период в январе-феврале 2019-го года.</p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=k>level</span><span class=p>,</span>
    <span class=k>count</span><span class=p>()</span> <span class=k>AS</span> <span class=k>c</span>
<span class=k>FROM</span>
<span class=p>(</span>
    <span class=k>SELECT</span>
        <span class=n>user_id</span><span class=p>,</span>
        <span class=n>windowFunnel</span><span class=p>(</span><span class=mi>6048000000000000</span><span class=p>)(</span><span class=k>timestamp</span><span class=p>,</span> <span class=n>eventID</span> <span class=o>=</span> <span class=mi>1003</span><span class=p>,</span> <span class=n>eventID</span> <span class=o>=</span> <span class=mi>1009</span><span class=p>,</span> <span class=n>eventID</span> <span class=o>=</span> <span class=mi>1007</span><span class=p>,</span> <span class=n>eventID</span> <span class=o>=</span> <span class=mi>1010</span><span class=p>)</span> <span class=k>AS</span> <span class=k>level</span>
    <span class=k>FROM</span> <span class=n>trend</span>
    <span class=k>WHERE</span> <span class=p>(</span><span class=n>event_date</span> <span class=o>&gt;=</span> <span class=s1>'2019-01-01'</span><span class=p>)</span> <span class=k>AND</span> <span class=p>(</span><span class=n>event_date</span> <span class=o>&lt;=</span> <span class=s1>'2019-02-02'</span><span class=p>)</span>
    <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>user_id</span>
<span class=p>)</span>
<span class=k>GROUP</span> <span class=k>BY</span> <span class=k>level</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=k>level</span> <span class=k>ASC</span><span class=p>;</span>
</code></pre></div> <h2 id=retention>retention<a class=headerlink href=#retention title="Permanent link"> </a></h2> <p>Аналитическая функция, которая показывает, насколько<br> выдерживаются те или иные условия, например, удержание динамики/уровня <a href="https://yandex.ru/support/partner2/statistics/metrika-visitors-statistics.html?lang=ru" rel="external nofollow noreferrer" target=_blank>посещаемости сайта</a>.</p> <p>Функция принимает набор (от 1 до 32) логических условий, как в <a href=../../statements/select/where/#select-where>WHERE</a>, и применяет их к заданному набору данных.</p> <p>Условия, кроме первого, применяются попарно: результат второго будет истинным, если истинно первое и второе, третьего - если истинно первое и третье и т.д.</p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>retention</span><span class=p>(</span><span class=n>cond1</span><span class=p>,</span> <span class=n>cond2</span><span class=p>,</span> <span class=p>...,</span> <span class=n>cond32</span><span class=p>)</span>
</code></pre></div> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>cond</code> — вычисляемое условие или выражение, которое возвращает <code class=syntax>UInt8</code> результат (1/0).</li> </ul> <p><strong>Возвращаемое значение</strong></p> <p>Массив из 1 или 0.</p> <ul> <li>1 — условие выполнено.</li> <li>0 — условие не выполнено.</li> </ul> <p>Тип: <code class=syntax>UInt8</code>.</p> <p><strong>Пример</strong></p> <p>Рассмотрим пример расчета функции <code class=syntax>retention</code> для определения посещаемости сайта.</p> <p><strong>1.</strong> Создадим таблицу для илюстрации примера.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>retention_test</span><span class=p>(</span><span class=nb>date</span> <span class=nb>Date</span><span class=p>,</span> <span class=n>uid</span> <span class=n>Int32</span><span class=p>)</span><span class=n>ENGINE</span> <span class=o>=</span> <span class=n>Memory</span><span class=p>;</span>

<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>retention_test</span> <span class=k>SELECT</span> <span class=s1>'2020-01-01'</span><span class=p>,</span> <span class=nb>number</span> <span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>5</span><span class=p>);</span>
<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>retention_test</span> <span class=k>SELECT</span> <span class=s1>'2020-01-02'</span><span class=p>,</span> <span class=nb>number</span> <span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>10</span><span class=p>);</span>
<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>retention_test</span> <span class=k>SELECT</span> <span class=s1>'2020-01-03'</span><span class=p>,</span> <span class=nb>number</span> <span class=k>FROM</span> <span class=n>numbers</span><span class=p>(</span><span class=mi>15</span><span class=p>);</span>
</code></pre></div> <p>Входная таблица:</p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=o>*</span> <span class=k>FROM</span> <span class=n>retention_test</span>
</code></pre></div> <p>Ответ:</p> <div class=codehilite><pre><span></span><code class=syntax>┌───────date─┬─uid─┐
│ 2020-01-01 │   0 │
│ 2020-01-01 │   1 │
│ 2020-01-01 │   2 │
│ 2020-01-01 │   3 │
│ 2020-01-01 │   4 │
└────────────┴─────┘
┌───────date─┬─uid─┐
│ 2020-01-02 │   0 │
│ 2020-01-02 │   1 │
│ 2020-01-02 │   2 │
│ 2020-01-02 │   3 │
│ 2020-01-02 │   4 │
│ 2020-01-02 │   5 │
│ 2020-01-02 │   6 │
│ 2020-01-02 │   7 │
│ 2020-01-02 │   8 │
│ 2020-01-02 │   9 │
└────────────┴─────┘
┌───────date─┬─uid─┐
│ 2020-01-03 │   0 │
│ 2020-01-03 │   1 │
│ 2020-01-03 │   2 │
│ 2020-01-03 │   3 │
│ 2020-01-03 │   4 │
│ 2020-01-03 │   5 │
│ 2020-01-03 │   6 │
│ 2020-01-03 │   7 │
│ 2020-01-03 │   8 │
│ 2020-01-03 │   9 │
│ 2020-01-03 │  10 │
│ 2020-01-03 │  11 │
│ 2020-01-03 │  12 │
│ 2020-01-03 │  13 │
│ 2020-01-03 │  14 │
└────────────┴─────┘
</code></pre></div> <p><strong>2.</strong> Сгруппируем пользователей по уникальному идентификатору <code class=syntax>uid</code> с помощью функции <code class=syntax>retention</code>.</p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=n>uid</span><span class=p>,</span>
    <span class=n>retention</span><span class=p>(</span><span class=nb>date</span> <span class=o>=</span> <span class=s1>'2020-01-01'</span><span class=p>,</span> <span class=nb>date</span> <span class=o>=</span> <span class=s1>'2020-01-02'</span><span class=p>,</span> <span class=nb>date</span> <span class=o>=</span> <span class=s1>'2020-01-03'</span><span class=p>)</span> <span class=k>AS</span> <span class=n>r</span>
<span class=k>FROM</span> <span class=n>retention_test</span>
<span class=k>WHERE</span> <span class=nb>date</span> <span class=k>IN</span> <span class=p>(</span><span class=s1>'2020-01-01'</span><span class=p>,</span> <span class=s1>'2020-01-02'</span><span class=p>,</span> <span class=s1>'2020-01-03'</span><span class=p>)</span>
<span class=k>GROUP</span> <span class=k>BY</span> <span class=n>uid</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=n>uid</span> <span class=k>ASC</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─uid─┬─r───────┐
│   0 │ [1,1,1] │
│   1 │ [1,1,1] │
│   2 │ [1,1,1] │
│   3 │ [1,1,1] │
│   4 │ [1,1,1] │
│   5 │ [0,0,0] │
│   6 │ [0,0,0] │
│   7 │ [0,0,0] │
│   8 │ [0,0,0] │
│   9 │ [0,0,0] │
│  10 │ [0,0,0] │
│  11 │ [0,0,0] │
│  12 │ [0,0,0] │
│  13 │ [0,0,0] │
│  14 │ [0,0,0] │
└─────┴─────────┘
</code></pre></div> <p><strong>3.</strong> Рассчитаем количество посещений сайта за день.</p> <p>Запрос:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span>
    <span class=k>sum</span><span class=p>(</span><span class=n>r</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=k>AS</span> <span class=n>r1</span><span class=p>,</span>
    <span class=k>sum</span><span class=p>(</span><span class=n>r</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span> <span class=k>AS</span> <span class=n>r2</span><span class=p>,</span>
    <span class=k>sum</span><span class=p>(</span><span class=n>r</span><span class=p>[</span><span class=mi>3</span><span class=p>])</span> <span class=k>AS</span> <span class=n>r3</span>
<span class=k>FROM</span>
<span class=p>(</span>
    <span class=k>SELECT</span>
        <span class=n>uid</span><span class=p>,</span>
        <span class=n>retention</span><span class=p>(</span><span class=nb>date</span> <span class=o>=</span> <span class=s1>'2020-01-01'</span><span class=p>,</span> <span class=nb>date</span> <span class=o>=</span> <span class=s1>'2020-01-02'</span><span class=p>,</span> <span class=nb>date</span> <span class=o>=</span> <span class=s1>'2020-01-03'</span><span class=p>)</span> <span class=k>AS</span> <span class=n>r</span>
    <span class=k>FROM</span> <span class=n>retention_test</span>
    <span class=k>WHERE</span> <span class=nb>date</span> <span class=k>IN</span> <span class=p>(</span><span class=s1>'2020-01-01'</span><span class=p>,</span> <span class=s1>'2020-01-02'</span><span class=p>,</span> <span class=s1>'2020-01-03'</span><span class=p>)</span>
    <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>uid</span>
<span class=p>)</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─r1─┬─r2─┬─r3─┐
│  5 │  5 │  5 │
└────┴────┴────┘
</code></pre></div> <p>Где:</p> <ul> <li><code class=syntax>r1</code> - количество уникальных посетителей за 2020-01-01 (<code class=syntax>cond1</code>).</li> <li><code class=syntax>r2</code> - количество уникальных посетителей в период между 2020-01-01 и 2020-01-02 (<code class=syntax>cond1</code> и <code class=syntax>cond2</code>).</li> <li><code class=syntax>r3</code> - количество уникальных посетителей в период между 2020-01-01 и 2020-01-03 (<code class=syntax>cond1</code> и <code class=syntax>cond3</code>).</li> </ul> <h2 id=uniquptonx>uniqUpTo(N)(x)<a class=headerlink href=#uniquptonx title="Permanent link"> </a></h2> <p>Вычисляет количество различных значений аргумента, если оно меньше или равно N.<br> В случае, если количество различных значений аргумента больше N, возвращает N + 1.</p> <p>Рекомендуется использовать для маленьких N - до 10. Максимальное значение N - 100.</p> <p>Для состояния агрегатной функции используется количество оперативки равное 1 + N * размер одного значения байт.<br> Для строк запоминается не криптографический хэш, имеющий размер 8 байт. То есть, для строк вычисление приближённое.</p> <p>Функция также работает для нескольких аргументов.</p> <p>Работает максимально быстро за исключением патологических случаев, когда используется большое значение N и количество уникальных значений чуть меньше N.</p> <p>Пример применения:</p> <div class=codehilite><pre><span></span><code class=syntax>Задача: показывать в отчёте только поисковые фразы, по которым было хотя бы 5 уникальных посетителей.
Решение: пишем в запросе GROUP BY SearchPhrase HAVING uniqUpTo(4)(UserID) &gt;= 5
</code></pre></div> <h2 id=sequenceNextNode>sequenceNextNode<a class=headerlink href=#sequenceNextNode title="Permanent link"> </a></h2> <p>Возвращает значение следующего события, соответствующего цепочке событий.</p> <p><em>Экспериментальная функция, чтобы включить ее, выполните: <code class=syntax>SET allow_experimental_funnel_functions = 1</code>.</em></p> <p><strong>Синтаксис</strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>sequenceNextNode</span><span class=p>(</span><span class=n>direction</span><span class=p>,</span> <span class=n>base</span><span class=p>)(</span><span class=k>timestamp</span><span class=p>,</span> <span class=n>event_column</span><span class=p>,</span> <span class=n>base_condition</span><span class=p>,</span> <span class=n>event1</span><span class=p>,</span> <span class=n>event2</span><span class=p>,</span> <span class=n>event3</span><span class=p>,</span> <span class=p>...)</span>
</code></pre></div> <p><strong>Параметры</strong></p> <ul> <li> <p><code class=syntax>direction</code> — используется для навигации по направлениям.</p> <ul> <li>forward — двигаться вперед.</li> <li>backward — двигаться назад.</li> </ul> </li> <li> <p><code class=syntax>base</code> — используется для задания начальной точки.</p> <ul> <li>head — установить начальную точку на первое событие цепочки.</li> <li>tail — установить начальную точку на последнее событие цепочки.</li> <li>first_match — установить начальную точку на первое соответствующее событие <code class=syntax>event1</code>.</li> <li>last_match — установить начальную точку на последнее соответствующее событие <code class=syntax>event1</code>.</li> </ul> </li> </ul> <p><strong>Аргументы</strong></p> <ul> <li><code class=syntax>timestamp</code> — название столбца, содержащего <code class=syntax>timestamp</code>. Поддерживаемые типы данных: <a href=../../data-types/date/ >Date</a>, <a href=../../data-types/datetime/#data_type-datetime>DateTime</a> и другие беззнаковые целые типы.</li> <li><code class=syntax>event_column</code> — название столбца, содержащего значение следующего возвращаемого события. Поддерживаемые типы данных: <a href=../../data-types/string/ >String</a> и <a href=../../data-types/nullable/ >Nullable(String)</a>.</li> <li><code class=syntax>base_condition</code> — условие, которому должна соответствовать исходная точка.</li> <li><code class=syntax>event1</code>, <code class=syntax>event2</code>, ... — условия, описывающие цепочку событий. <a href=../../data-types/int-uint/ >UInt8</a>.</li> </ul> <p><strong>Возвращаемые значения</strong></p> <ul> <li><code class=syntax>event_column[next_index]</code> — если есть совпадение с шаблоном и существует следующее значение.</li> <li><code class=syntax>NULL</code> — если нет совпадений с шаблоном или следующего значения не существует.</li> </ul> <p>Тип: <a href=../../data-types/nullable/ >Nullable(String)</a>.</p> <p><strong>Пример</strong></p> <p>Функцию можно использовать, если есть цепочка событий A-&gt;B-&gt;C-&gt;D-&gt;E, и вы хотите определить событие, следующее за B-&gt;C, то есть D.</p> <p>Запрос ищет событие после A-&gt;B:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>test_flow</span> <span class=p>(</span>
    <span class=n>dt</span> <span class=n>DateTime</span><span class=p>,</span> 
    <span class=n>id</span> <span class=nb>int</span><span class=p>,</span> 
    <span class=n>page</span> <span class=n>String</span><span class=p>)</span>
<span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span><span class=p>()</span> 
<span class=n>PARTITION</span> <span class=k>BY</span> <span class=n>toYYYYMMDD</span><span class=p>(</span><span class=n>dt</span><span class=p>)</span> 
<span class=k>ORDER</span> <span class=k>BY</span> <span class=n>id</span><span class=p>;</span>

<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>test_flow</span> <span class=k>VALUES</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>'A'</span><span class=p>)</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>'B'</span><span class=p>)</span> <span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>'C'</span><span class=p>)</span> <span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>'D'</span><span class=p>)</span> <span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>'E'</span><span class=p>);</span>

<span class=k>SELECT</span> <span class=n>id</span><span class=p>,</span> <span class=n>sequenceNextNode</span><span class=p>(</span><span class=s1>'forward'</span><span class=p>,</span> <span class=s1>'head'</span><span class=p>)(</span><span class=n>dt</span><span class=p>,</span> <span class=n>page</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'A'</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'A'</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'B'</span><span class=p>)</span> <span class=k>as</span> <span class=n>next_flow</span> <span class=k>FROM</span> <span class=n>test_flow</span> <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>id</span><span class=p>;</span>
</code></pre></div> <p>Результат:</p> <div class=codehilite><pre><span></span><code class=syntax>┌─id─┬─next_flow─┐
│  1 │ C         │
└────┴───────────┘
</code></pre></div> <p><strong>Поведение для <code class=syntax>forward</code> и <code class=syntax>head</code></strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>test_flow</span> <span class=k>DELETE</span> <span class=k>WHERE</span> <span class=mi>1</span> <span class=o>=</span> <span class=mi>1</span> <span class=n>settings</span> <span class=n>mutations_sync</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>

<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>test_flow</span> <span class=k>VALUES</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>'Home'</span><span class=p>)</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>'Gift'</span><span class=p>)</span> <span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>'Exit'</span><span class=p>);</span>
<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>test_flow</span> <span class=k>VALUES</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>'Home'</span><span class=p>)</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>'Home'</span><span class=p>)</span> <span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>'Gift'</span><span class=p>)</span> <span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=s1>'Basket'</span><span class=p>);</span>
<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>test_flow</span> <span class=k>VALUES</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=s1>'Gift'</span><span class=p>)</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=s1>'Home'</span><span class=p>)</span> <span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=s1>'Gift'</span><span class=p>)</span> <span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=s1>'Basket'</span><span class=p>);</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>id</span><span class=p>,</span> <span class=n>sequenceNextNode</span><span class=p>(</span><span class=s1>'forward'</span><span class=p>,</span> <span class=s1>'head'</span><span class=p>)(</span><span class=n>dt</span><span class=p>,</span> <span class=n>page</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'Home'</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'Home'</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'Gift'</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>test_flow</span> <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>id</span><span class=p>;</span>

                  <span class=n>dt</span>   <span class=n>id</span>   <span class=n>page</span>
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>1</span>   <span class=n>Home</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span><span class=p>,</span> <span class=err>совпадение</span> <span class=err>с</span> <span class=n>Home</span>
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>1</span>   <span class=n>Gift</span> <span class=o>//</span> <span class=err>Совпадение</span> <span class=err>с</span> <span class=n>Gift</span>
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>1</span>   <span class=n>Exit</span> <span class=o>//</span> <span class=err>Результат</span> 

 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>2</span>   <span class=n>Home</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span><span class=p>,</span> <span class=err>совпадение</span> <span class=err>с</span> <span class=n>Home</span>
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>2</span>   <span class=n>Home</span> <span class=o>//</span> <span class=err>Несовпадение</span> <span class=err>с</span> <span class=n>Gift</span>
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>2</span>   <span class=n>Gift</span>
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>04</span>    <span class=mi>2</span>   <span class=n>Basket</span>    

 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>3</span>   <span class=n>Gift</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span><span class=p>,</span> <span class=err>несовпадение</span> <span class=err>с</span> <span class=n>Home</span>
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>3</span>   <span class=n>Home</span>      
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>3</span>   <span class=n>Gift</span>      
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>04</span>    <span class=mi>3</span>   <span class=n>Basket</span>    
</code></pre></div> <p><strong>Поведение для <code class=syntax>backward</code> и <code class=syntax>tail</code></strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>id</span><span class=p>,</span> <span class=n>sequenceNextNode</span><span class=p>(</span><span class=s1>'backward'</span><span class=p>,</span> <span class=s1>'tail'</span><span class=p>)(</span><span class=n>dt</span><span class=p>,</span> <span class=n>page</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'Basket'</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'Basket'</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'Gift'</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>test_flow</span> <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>id</span><span class=p>;</span>

                 <span class=n>dt</span>   <span class=n>id</span>   <span class=n>page</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>1</span>   <span class=n>Home</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>1</span>   <span class=n>Gift</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>1</span>   <span class=n>Exit</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span><span class=p>,</span> <span class=err>несовпадение</span> <span class=err>с</span> <span class=n>Basket</span>

<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>2</span>   <span class=n>Home</span> 
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>2</span>   <span class=n>Home</span> <span class=o>//</span> <span class=err>Результат</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>2</span>   <span class=n>Gift</span> <span class=o>//</span> <span class=err>Совпадение</span> <span class=err>с</span> <span class=n>Gift</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>04</span>    <span class=mi>2</span>   <span class=n>Basket</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span><span class=p>,</span> <span class=err>совпадение</span> <span class=err>с</span> <span class=n>Basket</span>

<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>3</span>   <span class=n>Gift</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>3</span>   <span class=n>Home</span> <span class=o>//</span> <span class=err>Результат</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>3</span>   <span class=n>Gift</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span><span class=p>,</span> <span class=err>совпадение</span> <span class=err>с</span> <span class=n>Gift</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>04</span>    <span class=mi>3</span>   <span class=n>Basket</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span><span class=p>,</span> <span class=err>совпадение</span> <span class=err>с</span> <span class=n>Basket</span>
</code></pre></div> <p><strong>Поведение для <code class=syntax>forward</code> и <code class=syntax>first_match</code></strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>id</span><span class=p>,</span> <span class=n>sequenceNextNode</span><span class=p>(</span><span class=s1>'forward'</span><span class=p>,</span> <span class=s1>'first_match'</span><span class=p>)(</span><span class=n>dt</span><span class=p>,</span> <span class=n>page</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'Gift'</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'Gift'</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>test_flow</span> <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>id</span><span class=p>;</span>

                 <span class=n>dt</span>   <span class=n>id</span>   <span class=n>page</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>1</span>   <span class=n>Home</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>1</span>   <span class=n>Gift</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>1</span>   <span class=n>Exit</span> <span class=o>//</span> <span class=err>Результат</span>

<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>2</span>   <span class=n>Home</span> 
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>2</span>   <span class=n>Home</span> 
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>2</span>   <span class=n>Gift</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>04</span>    <span class=mi>2</span>   <span class=n>Basket</span>  <span class=err>Результат</span>

<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>3</span>   <span class=n>Gift</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>3</span>   <span class=n>Home</span> <span class=o>//</span> <span class=err>Результат</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>3</span>   <span class=n>Gift</span>   
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>04</span>    <span class=mi>3</span>   <span class=n>Basket</span>    
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>id</span><span class=p>,</span> <span class=n>sequenceNextNode</span><span class=p>(</span><span class=s1>'forward'</span><span class=p>,</span> <span class=s1>'first_match'</span><span class=p>)(</span><span class=n>dt</span><span class=p>,</span> <span class=n>page</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'Gift'</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'Gift'</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'Home'</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>test_flow</span> <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>id</span><span class=p>;</span>

                 <span class=n>dt</span>   <span class=n>id</span>   <span class=n>page</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>1</span>   <span class=n>Home</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>1</span>   <span class=n>Gift</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>1</span>   <span class=n>Exit</span> <span class=o>//</span> <span class=err>Несовпадение</span> <span class=err>с</span> <span class=n>Home</span>

<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>2</span>   <span class=n>Home</span> 
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>2</span>   <span class=n>Home</span> 
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>2</span>   <span class=n>Gift</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>04</span>    <span class=mi>2</span>   <span class=n>Basket</span> <span class=o>//</span> <span class=err>Несовпадение</span> <span class=err>с</span> <span class=n>Home</span>

<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>3</span>   <span class=n>Gift</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>3</span>   <span class=n>Home</span> <span class=o>//</span> <span class=err>Совпадение</span> <span class=err>с</span> <span class=n>Home</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>3</span>   <span class=n>Gift</span> <span class=o>//</span> <span class=err>Результат</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>04</span>    <span class=mi>3</span>   <span class=n>Basket</span>    
</code></pre></div> <p><strong>Поведение для <code class=syntax>backward</code> и <code class=syntax>last_match</code></strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>id</span><span class=p>,</span> <span class=n>sequenceNextNode</span><span class=p>(</span><span class=s1>'backward'</span><span class=p>,</span> <span class=s1>'last_match'</span><span class=p>)(</span><span class=n>dt</span><span class=p>,</span> <span class=n>page</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'Gift'</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'Gift'</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>test_flow</span> <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>id</span><span class=p>;</span>

                 <span class=n>dt</span>   <span class=n>id</span>   <span class=n>page</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>1</span>   <span class=n>Home</span> <span class=o>//</span> <span class=err>Результат</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>1</span>   <span class=n>Gift</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>1</span>   <span class=n>Exit</span> 

<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>2</span>   <span class=n>Home</span> 
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>2</span>   <span class=n>Home</span> <span class=o>//</span> <span class=err>Результат</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>2</span>   <span class=n>Gift</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>04</span>    <span class=mi>2</span>   <span class=n>Basket</span>    

<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>3</span>   <span class=n>Gift</span> 
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>3</span>   <span class=n>Home</span> <span class=o>//</span> <span class=err>Результат</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>3</span>   <span class=n>Gift</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>04</span>    <span class=mi>3</span>   <span class=n>Basket</span>    
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>id</span><span class=p>,</span> <span class=n>sequenceNextNode</span><span class=p>(</span><span class=s1>'backward'</span><span class=p>,</span> <span class=s1>'last_match'</span><span class=p>)(</span><span class=n>dt</span><span class=p>,</span> <span class=n>page</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'Gift'</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'Gift'</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'Home'</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>test_flow</span> <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>id</span><span class=p>;</span>

                 <span class=n>dt</span>   <span class=n>id</span>   <span class=n>page</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>1</span>   <span class=n>Home</span> <span class=o>//</span> <span class=err>Совпадение</span> <span class=err>с</span> <span class=n>Home</span><span class=p>,</span> <span class=err>результат</span> <span class=o>`</span><span class=k>Null</span><span class=o>`</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>1</span>   <span class=n>Gift</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>1</span>   <span class=n>Exit</span> 

<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>2</span>   <span class=n>Home</span> <span class=o>//</span> <span class=err>Результат</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>2</span>   <span class=n>Home</span> <span class=o>//</span> <span class=err>Совпадение</span> <span class=err>с</span> <span class=n>Home</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>2</span>   <span class=n>Gift</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>04</span>    <span class=mi>2</span>   <span class=n>Basket</span>    

<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>3</span>   <span class=n>Gift</span> <span class=o>//</span> <span class=err>Результат</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>3</span>   <span class=n>Home</span> <span class=o>//</span> <span class=err>Совпадение</span> <span class=err>с</span> <span class=n>Home</span>
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>3</span>   <span class=n>Gift</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span> 
<span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>04</span>    <span class=mi>3</span>   <span class=n>Basket</span>    
</code></pre></div> <p><strong>Поведение для <code class=syntax>base_condition</code></strong></p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>CREATE</span> <span class=k>TABLE</span> <span class=n>test_flow_basecond</span>
<span class=p>(</span>
    <span class=o>`</span><span class=n>dt</span><span class=o>`</span> <span class=n>DateTime</span><span class=p>,</span>
    <span class=o>`</span><span class=n>id</span><span class=o>`</span> <span class=nb>int</span><span class=p>,</span>
    <span class=o>`</span><span class=n>page</span><span class=o>`</span> <span class=n>String</span><span class=p>,</span>
    <span class=o>`</span><span class=k>ref</span><span class=o>`</span> <span class=n>String</span>
<span class=p>)</span>
<span class=n>ENGINE</span> <span class=o>=</span> <span class=n>MergeTree</span>
<span class=n>PARTITION</span> <span class=k>BY</span> <span class=n>toYYYYMMDD</span><span class=p>(</span><span class=n>dt</span><span class=p>)</span>
<span class=k>ORDER</span> <span class=k>BY</span> <span class=n>id</span><span class=p>;</span>

<span class=k>INSERT</span> <span class=k>INTO</span> <span class=n>test_flow_basecond</span> <span class=k>VALUES</span> <span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>'A'</span><span class=p>,</span> <span class=s1>'ref4'</span><span class=p>)</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>'A'</span><span class=p>,</span> <span class=s1>'ref3'</span><span class=p>)</span> <span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>'B'</span><span class=p>,</span> <span class=s1>'ref2'</span><span class=p>)</span> <span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=s1>'B'</span><span class=p>,</span> <span class=s1>'ref1'</span><span class=p>);</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>id</span><span class=p>,</span> <span class=n>sequenceNextNode</span><span class=p>(</span><span class=s1>'forward'</span><span class=p>,</span> <span class=s1>'head'</span><span class=p>)(</span><span class=n>dt</span><span class=p>,</span> <span class=n>page</span><span class=p>,</span> <span class=k>ref</span> <span class=o>=</span> <span class=s1>'ref1'</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'A'</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>test_flow_basecond</span> <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>id</span><span class=p>;</span>

                  <span class=n>dt</span>   <span class=n>id</span>   <span class=n>page</span>   <span class=k>ref</span> 
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>1</span>   <span class=n>A</span>      <span class=n>ref4</span> <span class=o>//</span> <span class=err>Начало</span> <span class=err>не</span> <span class=err>может</span> <span class=err>быть</span> <span class=err>исходной</span> <span class=err>точкой</span><span class=p>,</span> <span class=err>поскольку</span> <span class=err>столбец</span> <span class=k>ref</span> <span class=err>не</span> <span class=err>соответствует</span> <span class=s1>'ref1'</span><span class=p>.</span>
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>1</span>   <span class=n>A</span>      <span class=n>ref3</span> 
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>1</span>   <span class=n>B</span>      <span class=n>ref2</span> 
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>04</span>    <span class=mi>1</span>   <span class=n>B</span>      <span class=n>ref1</span> 
 <span class=o>```</span>

<span class=o>```</span> <span class=k>sql</span>
<span class=k>SELECT</span> <span class=n>id</span><span class=p>,</span> <span class=n>sequenceNextNode</span><span class=p>(</span><span class=s1>'backward'</span><span class=p>,</span> <span class=s1>'tail'</span><span class=p>)(</span><span class=n>dt</span><span class=p>,</span> <span class=n>page</span><span class=p>,</span> <span class=k>ref</span> <span class=o>=</span> <span class=s1>'ref4'</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'B'</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>test_flow_basecond</span> <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>id</span><span class=p>;</span>

                  <span class=n>dt</span>   <span class=n>id</span>   <span class=n>page</span>   <span class=k>ref</span> 
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>1</span>   <span class=n>A</span>      <span class=n>ref4</span>
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>1</span>   <span class=n>A</span>      <span class=n>ref3</span> 
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>1</span>   <span class=n>B</span>      <span class=n>ref2</span> 
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>04</span>    <span class=mi>1</span>   <span class=n>B</span>      <span class=n>ref1</span> <span class=o>//</span> <span class=err>Конец</span> <span class=err>не</span> <span class=err>может</span> <span class=err>быть</span> <span class=err>исходной</span> <span class=err>точкой</span><span class=p>,</span> <span class=err>поскольку</span> <span class=err>столбец</span> <span class=k>ref</span> <span class=err>не</span> <span class=err>соответствует</span> <span class=s1>'ref4'</span><span class=p>.</span>
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>id</span><span class=p>,</span> <span class=n>sequenceNextNode</span><span class=p>(</span><span class=s1>'forward'</span><span class=p>,</span> <span class=s1>'first_match'</span><span class=p>)(</span><span class=n>dt</span><span class=p>,</span> <span class=n>page</span><span class=p>,</span> <span class=k>ref</span> <span class=o>=</span> <span class=s1>'ref3'</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'A'</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>test_flow_basecond</span> <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>id</span><span class=p>;</span>

                  <span class=n>dt</span>   <span class=n>id</span>   <span class=n>page</span>   <span class=k>ref</span> 
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>1</span>   <span class=n>A</span>      <span class=n>ref4</span> <span class=o>//</span> <span class=err>Эта</span> <span class=err>строка</span> <span class=err>не</span> <span class=err>может</span> <span class=err>быть</span> <span class=err>исходной</span> <span class=err>точкой</span><span class=p>,</span> <span class=err>поскольку</span> <span class=err>столбец</span> <span class=k>ref</span> <span class=err>не</span> <span class=err>соответствует</span> <span class=s1>'ref3'</span><span class=p>.</span>
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>1</span>   <span class=n>A</span>      <span class=n>ref3</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span>
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>1</span>   <span class=n>B</span>      <span class=n>ref2</span> <span class=o>//</span> <span class=err>Результат</span>
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>04</span>    <span class=mi>1</span>   <span class=n>B</span>      <span class=n>ref1</span> 
</code></pre></div> <div class=codehilite><pre><span></span><code class=syntax><span class=k>SELECT</span> <span class=n>id</span><span class=p>,</span> <span class=n>sequenceNextNode</span><span class=p>(</span><span class=s1>'backward'</span><span class=p>,</span> <span class=s1>'last_match'</span><span class=p>)(</span><span class=n>dt</span><span class=p>,</span> <span class=n>page</span><span class=p>,</span> <span class=k>ref</span> <span class=o>=</span> <span class=s1>'ref2'</span><span class=p>,</span> <span class=n>page</span> <span class=o>=</span> <span class=s1>'B'</span><span class=p>)</span> <span class=k>FROM</span> <span class=n>test_flow_basecond</span> <span class=k>GROUP</span> <span class=k>BY</span> <span class=n>id</span><span class=p>;</span>

                  <span class=n>dt</span>   <span class=n>id</span>   <span class=n>page</span>   <span class=k>ref</span> 
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span>    <span class=mi>1</span>   <span class=n>A</span>      <span class=n>ref4</span>
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>02</span>    <span class=mi>1</span>   <span class=n>A</span>      <span class=n>ref3</span> <span class=o>//</span> <span class=err>Результат</span>
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>03</span>    <span class=mi>1</span>   <span class=n>B</span>      <span class=n>ref2</span> <span class=o>//</span> <span class=err>Исходная</span> <span class=err>точка</span>
 <span class=mi>1970</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span> <span class=mi>09</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>04</span>    <span class=mi>1</span>   <span class=n>B</span>      <span class=n>ref1</span> <span class=o>//</span> <span class=err>Эта</span> <span class=err>строка</span> <span class=err>не</span> <span class=err>может</span> <span class=err>быть</span> <span class=err>исходной</span> <span class=err>точкой</span><span class=p>,</span> <span class=err>поскольку</span> <span class=err>столбец</span> <span class=k>ref</span> <span class=err>не</span> <span class=err>соответствует</span> <span class=s1>'ref2'</span><span class=p>.</span> 
</code></pre></div> </div> <div class="alert alert-light my-3"> <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p> <span class="alert-heading display-6">Was this content helpful?</span> <div id=rating-stars class="display-6 mb-0" data-titles="['Unusable', 'Poor', 'OK', 'Good', 'Excellent']" data-documentation=documentation>RATING_STARS</div> </div> <div id=content-footer class="text-muted pt-3 mb-5"> <div class=float-md-right>©2016–2021 Yandex LLC</div> <div>Built from <a href=https://github.com/ClickHouse/ClickHouse/commit/878a159538935028f2d2dce3eb3074d44eb191df rel="external nofollow noreferrer" target=_blank class=text-reset>878a159538</a> </div> </div> </div> <div id=toc class="col-xl-2 d-none d-xl-block d-print-none p-3 overflow-auto toc-right mb-5"> <nav class="nav flex-column text-wrap"> <label for=toc>Table of Contents</label> <a href=#histogram title=histogram class="nav-link text-wrap d-inline-block w-100"> histogram </a> <a href=#function-sequencematch title="sequenceMatch(pattern)(timestamp, cond1, cond2, …)" class="nav-link text-wrap d-inline-block w-100"> sequenceMatch(pattern)(timestamp, cond1, cond2, …) </a> <a href=#function-sequencecount title="sequenceCount(pattern)(time, cond1, cond2, …)" class="nav-link text-wrap d-inline-block w-100"> sequenceCount(pattern)(time, cond1, cond2, …) </a> <a href=#windowfunnel title=windowFunnel class="nav-link text-wrap d-inline-block w-100"> windowFunnel </a> <a href=#retention title=retention class="nav-link text-wrap d-inline-block w-100"> retention </a> <a href=#uniquptonx title=uniqUpTo(N)(x) class="nav-link text-wrap d-inline-block w-100"> uniqUpTo(N)(x) </a> <a href=#sequenceNextNode title=sequenceNextNode class="nav-link text-wrap d-inline-block w-100"> sequenceNextNode </a> </nav> </div> </div> </div> <script async type=text/javascript src=/js/base.js?da3fd50d></script> <noscript> <div><img src=https://mc.yandex.ru/watch/18343495 alt=Yandex></div> </noscript> </body> </html>