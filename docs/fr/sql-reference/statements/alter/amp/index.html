<!doctype html><html âš¡ lang=fr> <head><meta charset=utf-8><script async src=https://cdn.ampproject.org/v0.js></script><title>ALTER | Documentation ClickHouse</title><link href=https://clickhouse.tech/docs/fr/sql-reference/statements/alter/ rel=canonical><meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1"><script type=application/ld+json>[{
"@context": "http://schema.org",
"@type": "TechArticle",
"headline": "ALTER | Documentation ClickHouse",
"mainEntityOfPage": "https://clickhouse.tech/docs/fr/sql-reference/statements/alter/",




"image": "https://clickhouse.tech/images/logo-209x60.png",
"author": {
  "@type": "Project",
  "name": "ClickHouse"
},
"publisher": {
  "@type": "Organization",
  "name": "Yandex LLC",
  "logo": {
    "@type": "ImageObject",
    "url": "https://clickhouse.tech/images/yandex.png",
    "width": 163,
    "height": 60
  }
}}, {
"@context": "http://schema.org",
"@type": "Episode",
"name": "ALTER | Documentation ClickHouse",
"aggregateRating": {
  "@type": "AggregateRating",
  "ratingValue": RATING_VALUE,
  "ratingCount": RATING_COUNT
}
}]</script><style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript><style amp-custom>:root{--blue:#007bff;--indigo:#6610f2;--purple:#6f42c1;--pink:#e83e8c;--red:#dc3545;--orange:#fd7e14;--yellow:#ffc107;--green:#28a745;--teal:#20c997;--cyan:#17a2b8;--white:#fff;--gray:#6c757d;--gray-dark:#343a40;--primary:#007bff;--secondary:#6c757d;--success:#28a745;--info:#17a2b8;--warning:#ffc107;--danger:#dc3545;--light:#f8f9fa;--dark:#343a40;--breakpoint-xs:0;--breakpoint-sm:576px;--breakpoint-md:768px;--breakpoint-lg:992px;--breakpoint-xl:1200px;--font-family-sans-serif:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-family-monospace:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*,::after,::before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}article,footer,main,section{display:block}body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}[tabindex="-1"]:focus:not(:focus-visible){outline:0}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem}p{margin-top:0;margin-bottom:1rem}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}b{font-weight:bolder}a{color:#007bff;text-decoration:none;background-color:transparent}a:hover{color:#0056b3;text-decoration:underline}a:not([href]){color:inherit;text-decoration:none}a:not([href]):hover{color:inherit;text-decoration:none}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em}pre{margin-top:0;margin-bottom:1rem;overflow:auto}img{vertical-align:middle;border-style:none}svg{overflow:hidden;vertical-align:middle}table{border-collapse:collapse}select{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}select{text-transform:none}select{word-wrap:normal}[type=button],[type=reset],[type=submit]{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled){cursor:pointer}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner{padding:0;border-style:none}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:none}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}[hidden]{display:none}.h1,.h2,.h3,.h4,.h5,.h6,h1,h2,h3,h4,h5,h6{margin-bottom:.5rem;font-weight:500;line-height:1.2}.h1,h1{font-size:2rem}.h2,h2{font-size:1.5rem}.h3,h3{font-size:1.25rem}.h4,h4{font-size:1rem}.h5,h5{font-size:1rem}.h6,h6{font-size:1rem}.lead{font-size:1.25rem;font-weight:300}.display-1{font-size:6rem;font-weight:300;line-height:1.2}.display-2{font-size:5.5rem;font-weight:300;line-height:1.2}.display-3{font-size:4.5rem;font-weight:300;line-height:1.2}.display-4{font-size:3.5rem;font-weight:300;line-height:1.2}.img-fluid{max-width:100%;height:auto}code{font-size:87.5%;color:#e83e8c;word-wrap:break-word}a>code{color:inherit}pre{display:block;font-size:87.5%;color:#212529}pre code{font-size:inherit;color:inherit;word-break:normal}.container{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container{max-width:720px}}@media(min-width:992px){.container{max-width:960px}}@media(min-width:1200px){.container{max-width:1140px}}.container-fluid,.container-lg,.container-md{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media(min-width:576px){.container{max-width:540px}}@media(min-width:768px){.container,.container-md{max-width:720px}}@media(min-width:992px){.container,.container-lg,.container-md{max-width:960px}}@media(min-width:1200px){.container,.container-lg,.container-md{max-width:1140px}}.row{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-15px;margin-left:-15px}.col,.col-1,.col-10,.col-11,.col-12,.col-2,.col-3,.col-4,.col-5,.col-6,.col-7,.col-8,.col-9,.col-lg,.col-lg-1,.col-lg-10,.col-lg-11,.col-lg-12,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-md,.col-md-1,.col-md-10,.col-md-11,.col-md-12,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9{position:relative;width:100%;padding-right:15px;padding-left:15px}.col{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-0{-ms-flex-order:0;order:0}.order-1{-ms-flex-order:1;order:1}.order-2{-ms-flex-order:2;order:2}.order-3{-ms-flex-order:3;order:3}.order-4{-ms-flex-order:4;order:4}.order-5{-ms-flex-order:5;order:5}.order-6{-ms-flex-order:6;order:6}.order-7{-ms-flex-order:7;order:7}.order-8{-ms-flex-order:8;order:8}.order-9{-ms-flex-order:9;order:9}.order-10{-ms-flex-order:10;order:10}.order-11{-ms-flex-order:11;order:11}.order-12{-ms-flex-order:12;order:12}@media(min-width:768px){.col-md{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-md-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-md-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-md-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-md-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-md-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-md-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-md-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-md-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-md-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-md-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-md-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-md-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-md-0{-ms-flex-order:0;order:0}.order-md-1{-ms-flex-order:1;order:1}.order-md-2{-ms-flex-order:2;order:2}.order-md-3{-ms-flex-order:3;order:3}.order-md-4{-ms-flex-order:4;order:4}.order-md-5{-ms-flex-order:5;order:5}.order-md-6{-ms-flex-order:6;order:6}.order-md-7{-ms-flex-order:7;order:7}.order-md-8{-ms-flex-order:8;order:8}.order-md-9{-ms-flex-order:9;order:9}.order-md-10{-ms-flex-order:10;order:10}.order-md-11{-ms-flex-order:11;order:11}.order-md-12{-ms-flex-order:12;order:12}}@media(min-width:992px){.col-lg{-ms-flex-preferred-size:0;flex-basis:0;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-lg-1{-ms-flex:0 0 8.333333%;flex:0 0 8.333333%;max-width:8.333333%}.col-lg-2{-ms-flex:0 0 16.666667%;flex:0 0 16.666667%;max-width:16.666667%}.col-lg-3{-ms-flex:0 0 25%;flex:0 0 25%;max-width:25%}.col-lg-4{-ms-flex:0 0 33.333333%;flex:0 0 33.333333%;max-width:33.333333%}.col-lg-5{-ms-flex:0 0 41.666667%;flex:0 0 41.666667%;max-width:41.666667%}.col-lg-6{-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}.col-lg-7{-ms-flex:0 0 58.333333%;flex:0 0 58.333333%;max-width:58.333333%}.col-lg-8{-ms-flex:0 0 66.666667%;flex:0 0 66.666667%;max-width:66.666667%}.col-lg-9{-ms-flex:0 0 75%;flex:0 0 75%;max-width:75%}.col-lg-10{-ms-flex:0 0 83.333333%;flex:0 0 83.333333%;max-width:83.333333%}.col-lg-11{-ms-flex:0 0 91.666667%;flex:0 0 91.666667%;max-width:91.666667%}.col-lg-12{-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.order-lg-0{-ms-flex-order:0;order:0}.order-lg-1{-ms-flex-order:1;order:1}.order-lg-2{-ms-flex-order:2;order:2}.order-lg-3{-ms-flex-order:3;order:3}.order-lg-4{-ms-flex-order:4;order:4}.order-lg-5{-ms-flex-order:5;order:5}.order-lg-6{-ms-flex-order:6;order:6}.order-lg-7{-ms-flex-order:7;order:7}.order-lg-8{-ms-flex-order:8;order:8}.order-lg-9{-ms-flex-order:9;order:9}.order-lg-10{-ms-flex-order:10;order:10}.order-lg-11{-ms-flex-order:11;order:11}.order-lg-12{-ms-flex-order:12;order:12}}.table{width:100%;margin-bottom:1rem;color:#212529}.table-primary{background-color:#b8daff}.table-light{background-color:#fdfdfe}.table-dark{background-color:#c6c8ca}.table-dark{color:#fff;background-color:#343a40}.btn{display:inline-block;font-weight:400;color:#212529;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:.375rem .75rem;font-size:1rem;line-height:1.5;border-radius:.25rem}@media(prefers-reduced-motion:reduce){.btn{transition:none}}.btn:hover{color:#212529;text-decoration:none}.btn:focus{outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.btn:disabled{opacity:.65}.btn-primary{color:#fff;background-color:#007bff;border-color:#007bff}.btn-primary:hover{color:#fff;background-color:#0069d9;border-color:#0062cc}.btn-primary:focus{color:#fff;background-color:#0069d9;border-color:#0062cc;box-shadow:0 0 0 .2rem rgba(38,143,255,.5)}.btn-primary:disabled{color:#fff;background-color:#007bff;border-color:#007bff}.btn-light{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-light:hover{color:#212529;background-color:#e2e6ea;border-color:#dae0e5}.btn-light:focus{color:#212529;background-color:#e2e6ea;border-color:#dae0e5;box-shadow:0 0 0 .2rem rgba(216,217,219,.5)}.btn-light:disabled{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-dark{color:#fff;background-color:#343a40;border-color:#343a40}.btn-dark:hover{color:#fff;background-color:#23272b;border-color:#1d2124}.btn-dark:focus{color:#fff;background-color:#23272b;border-color:#1d2124;box-shadow:0 0 0 .2rem rgba(82,88,93,.5)}.btn-dark:disabled{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-primary{color:#007bff;border-color:#007bff}.btn-outline-primary:hover{color:#fff;background-color:#007bff;border-color:#007bff}.btn-outline-primary:focus{box-shadow:0 0 0 .2rem rgba(0,123,255,.5)}.btn-outline-primary:disabled{color:#007bff;background-color:transparent}.btn-outline-light{color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:hover{color:#212529;background-color:#f8f9fa;border-color:#f8f9fa}.btn-outline-light:focus{box-shadow:0 0 0 .2rem rgba(248,249,250,.5)}.btn-outline-light:disabled{color:#f8f9fa;background-color:transparent}.btn-outline-dark{color:#343a40;border-color:#343a40}.btn-outline-dark:hover{color:#fff;background-color:#343a40;border-color:#343a40}.btn-outline-dark:focus{box-shadow:0 0 0 .2rem rgba(52,58,64,.5)}.btn-outline-dark:disabled{color:#343a40;background-color:transparent}.btn-link{font-weight:400;color:#007bff;text-decoration:none}.btn-link:hover{color:#0056b3;text-decoration:underline}.btn-link:focus{text-decoration:underline;box-shadow:none}.btn-link:disabled{color:#6c757d;pointer-events:none}.btn-lg{padding:.5rem 1rem;font-size:1.25rem;line-height:1.5;border-radius:.3rem}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:.5rem}.custom-select{display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);padding:.375rem 1.75rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;vertical-align:middle;background:#fff url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='4' height='5' viewBox='0 0 4 5'%3e%3cpath fill='%23343a40' d='M2 0L0 2h4zm0 5L0 3h4z'/%3e%3c/svg%3e") no-repeat right .75rem center/8px 10px;border:1px solid #ced4da;border-radius:.25rem;-webkit-appearance:none;-moz-appearance:none;appearance:none}.custom-select:focus{border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.custom-select:focus::-ms-value{color:#495057;background-color:#fff}.custom-select[multiple],.custom-select[size]:not([size="1"]){height:auto;padding-right:.75rem;background-image:none}.custom-select:disabled{color:#6c757d;background-color:#e9ecef}.custom-select::-ms-expand{display:none}.custom-select:-moz-focusring{color:transparent;text-shadow:0 0 0 #495057}.custom-select-lg{height:calc(1.5em+1rem+2px);padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.25rem}.custom-file{position:relative;display:inline-block;width:100%;height:calc(1.5em+.75rem+2px);margin-bottom:0}@media(prefers-reduced-motion:reduce){.custom-select{transition:none}}.page-link{position:relative;display:block;padding:.5rem .75rem;margin-left:-1px;line-height:1.25;color:#007bff;background-color:#fff;border:1px solid #dee2e6}.page-link:hover{z-index:2;color:#0056b3;text-decoration:none;background-color:#e9ecef;border-color:#dee2e6}.page-link:focus{z-index:3;outline:0;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.alert{position:relative;padding:.75rem 1.25rem;margin-bottom:1rem;border:1px solid transparent;border-radius:.25rem}.alert-heading{color:inherit}.alert-link{font-weight:700}.alert-primary{color:#004085;background-color:#cce5ff;border-color:#b8daff}.alert-primary .alert-link{color:#002752}.alert-light{color:#818182;background-color:#fefefe;border-color:#fdfdfe}.alert-light .alert-link{color:#686868}.alert-dark{color:#1b1e21;background-color:#d6d8d9;border-color:#c6c8ca}.alert-dark .alert-link{color:#040505}@-webkit-keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@-webkit-keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-border{to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}@keyframes spinner-grow{0%{-webkit-transform:scale(0);transform:scale(0)}50%{opacity:1}}.bg-primary{background-color:#007bff}a.bg-primary:focus,a.bg-primary:hover{background-color:#0062cc}.bg-light{background-color:#f8f9fa}a.bg-light:focus,a.bg-light:hover{background-color:#dae0e5}.bg-dark{background-color:#343a40}a.bg-dark:focus,a.bg-dark:hover{background-color:#1d2124}.bg-white{background-color:#fff}.d-none{display:none}.d-inline{display:inline}.d-inline-block{display:inline-block}.d-block{display:block}.d-table{display:table}.d-table-row{display:table-row}@media(min-width:768px){.d-md-none{display:none}.d-md-inline{display:inline}.d-md-inline-block{display:inline-block}.d-md-block{display:block}.d-md-table{display:table}.d-md-table-row{display:table-row}}@media(min-width:992px){.d-lg-none{display:none}.d-lg-inline{display:inline}.d-lg-inline-block{display:inline-block}.d-lg-block{display:block}.d-lg-table{display:table}.d-lg-table-row{display:table-row}}.float-right{float:right}.float-none{float:none}@media(min-width:768px){.float-md-right{float:right}.float-md-none{float:none}}@media(min-width:992px){.float-lg-right{float:right}.float-lg-none{float:none}}.fixed-bottom{position:fixed;right:0;bottom:0;left:0;z-index:1030}.shadow{box-shadow:0 .5rem 1rem rgba(0,0,0,.15)}.shadow-lg{box-shadow:0 1rem 3rem rgba(0,0,0,.175)}.shadow-none{box-shadow:none}.h-25{height:25%}.h-50{height:50%}.h-75{height:75%}.h-100{height:100%}.m-0{margin:0}.my-0{margin-top:0}.mr-0{margin-right:0}.mb-0,.my-0{margin-bottom:0}.m-1{margin:.25rem}.my-1{margin-top:.25rem}.mr-1{margin-right:.25rem}.mb-1,.my-1{margin-bottom:.25rem}.m-2{margin:.5rem}.my-2{margin-top:.5rem}.mr-2{margin-right:.5rem}.mb-2,.my-2{margin-bottom:.5rem}.m-3{margin:1rem}.my-3{margin-top:1rem}.mr-3{margin-right:1rem}.mb-3,.my-3{margin-bottom:1rem}.m-4{margin:1.5rem}.my-4{margin-top:1.5rem}.mr-4{margin-right:1.5rem}.mb-4,.my-4{margin-bottom:1.5rem}.m-5{margin:3rem}.my-5{margin-top:3rem}.mr-5{margin-right:3rem}.mb-5,.my-5{margin-bottom:3rem}.p-0{padding:0}.pt-0,.py-0{padding-top:0}.pr-0{padding-right:0}.pb-0,.py-0{padding-bottom:0}.p-1{padding:.25rem}.pt-1,.py-1{padding-top:.25rem}.pr-1{padding-right:.25rem}.pb-1,.py-1{padding-bottom:.25rem}.p-2{padding:.5rem}.pt-2,.py-2{padding-top:.5rem}.pr-2{padding-right:.5rem}.pb-2,.py-2{padding-bottom:.5rem}.p-3{padding:1rem}.pt-3,.py-3{padding-top:1rem}.pr-3{padding-right:1rem}.pb-3,.py-3{padding-bottom:1rem}.p-4{padding:1.5rem}.pt-4,.py-4{padding-top:1.5rem}.pr-4{padding-right:1.5rem}.pb-4,.py-4{padding-bottom:1.5rem}.p-5{padding:3rem}.pt-5,.py-5{padding-top:3rem}.pr-5{padding-right:3rem}.pb-5,.py-5{padding-bottom:3rem}.m-n1{margin:-.25rem}.my-n1{margin-top:-.25rem}.mr-n1{margin-right:-.25rem}.mb-n1,.my-n1{margin-bottom:-.25rem}.m-n2{margin:-.5rem}.my-n2{margin-top:-.5rem}.mr-n2{margin-right:-.5rem}.mb-n2,.my-n2{margin-bottom:-.5rem}.m-n3{margin:-1rem}.my-n3{margin-top:-1rem}.mr-n3{margin-right:-1rem}.mb-n3,.my-n3{margin-bottom:-1rem}.m-n4{margin:-1.5rem}.my-n4{margin-top:-1.5rem}.mr-n4{margin-right:-1.5rem}.mb-n4,.my-n4{margin-bottom:-1.5rem}.m-n5{margin:-3rem}.my-n5{margin-top:-3rem}.mr-n5{margin-right:-3rem}.mb-n5,.my-n5{margin-bottom:-3rem}@media(min-width:768px){.m-md-0{margin:0}.my-md-0{margin-top:0}.mr-md-0{margin-right:0}.mb-md-0,.my-md-0{margin-bottom:0}.m-md-1{margin:.25rem}.my-md-1{margin-top:.25rem}.mr-md-1{margin-right:.25rem}.mb-md-1,.my-md-1{margin-bottom:.25rem}.m-md-2{margin:.5rem}.my-md-2{margin-top:.5rem}.mr-md-2{margin-right:.5rem}.mb-md-2,.my-md-2{margin-bottom:.5rem}.m-md-3{margin:1rem}.my-md-3{margin-top:1rem}.mr-md-3{margin-right:1rem}.mb-md-3,.my-md-3{margin-bottom:1rem}.m-md-4{margin:1.5rem}.my-md-4{margin-top:1.5rem}.mr-md-4{margin-right:1.5rem}.mb-md-4,.my-md-4{margin-bottom:1.5rem}.m-md-5{margin:3rem}.my-md-5{margin-top:3rem}.mr-md-5{margin-right:3rem}.mb-md-5,.my-md-5{margin-bottom:3rem}.p-md-0{padding:0}.pt-md-0,.py-md-0{padding-top:0}.pr-md-0{padding-right:0}.pb-md-0,.py-md-0{padding-bottom:0}.p-md-1{padding:.25rem}.pt-md-1,.py-md-1{padding-top:.25rem}.pr-md-1{padding-right:.25rem}.pb-md-1,.py-md-1{padding-bottom:.25rem}.p-md-2{padding:.5rem}.pt-md-2,.py-md-2{padding-top:.5rem}.pr-md-2{padding-right:.5rem}.pb-md-2,.py-md-2{padding-bottom:.5rem}.p-md-3{padding:1rem}.pt-md-3,.py-md-3{padding-top:1rem}.pr-md-3{padding-right:1rem}.pb-md-3,.py-md-3{padding-bottom:1rem}.p-md-4{padding:1.5rem}.pt-md-4,.py-md-4{padding-top:1.5rem}.pr-md-4{padding-right:1.5rem}.pb-md-4,.py-md-4{padding-bottom:1.5rem}.p-md-5{padding:3rem}.pt-md-5,.py-md-5{padding-top:3rem}.pr-md-5{padding-right:3rem}.pb-md-5,.py-md-5{padding-bottom:3rem}.m-md-n1{margin:-.25rem}.my-md-n1{margin-top:-.25rem}.mr-md-n1{margin-right:-.25rem}.mb-md-n1,.my-md-n1{margin-bottom:-.25rem}.m-md-n2{margin:-.5rem}.my-md-n2{margin-top:-.5rem}.mr-md-n2{margin-right:-.5rem}.mb-md-n2,.my-md-n2{margin-bottom:-.5rem}.m-md-n3{margin:-1rem}.my-md-n3{margin-top:-1rem}.mr-md-n3{margin-right:-1rem}.mb-md-n3,.my-md-n3{margin-bottom:-1rem}.m-md-n4{margin:-1.5rem}.my-md-n4{margin-top:-1.5rem}.mr-md-n4{margin-right:-1.5rem}.mb-md-n4,.my-md-n4{margin-bottom:-1.5rem}.m-md-n5{margin:-3rem}.my-md-n5{margin-top:-3rem}.mr-md-n5{margin-right:-3rem}.mb-md-n5,.my-md-n5{margin-bottom:-3rem}}@media(min-width:992px){.m-lg-0{margin:0}.my-lg-0{margin-top:0}.mr-lg-0{margin-right:0}.mb-lg-0,.my-lg-0{margin-bottom:0}.m-lg-1{margin:.25rem}.my-lg-1{margin-top:.25rem}.mr-lg-1{margin-right:.25rem}.mb-lg-1,.my-lg-1{margin-bottom:.25rem}.m-lg-2{margin:.5rem}.my-lg-2{margin-top:.5rem}.mr-lg-2{margin-right:.5rem}.mb-lg-2,.my-lg-2{margin-bottom:.5rem}.m-lg-3{margin:1rem}.my-lg-3{margin-top:1rem}.mr-lg-3{margin-right:1rem}.mb-lg-3,.my-lg-3{margin-bottom:1rem}.m-lg-4{margin:1.5rem}.my-lg-4{margin-top:1.5rem}.mr-lg-4{margin-right:1.5rem}.mb-lg-4,.my-lg-4{margin-bottom:1.5rem}.m-lg-5{margin:3rem}.my-lg-5{margin-top:3rem}.mr-lg-5{margin-right:3rem}.mb-lg-5,.my-lg-5{margin-bottom:3rem}.p-lg-0{padding:0}.pt-lg-0,.py-lg-0{padding-top:0}.pr-lg-0{padding-right:0}.pb-lg-0,.py-lg-0{padding-bottom:0}.p-lg-1{padding:.25rem}.pt-lg-1,.py-lg-1{padding-top:.25rem}.pr-lg-1{padding-right:.25rem}.pb-lg-1,.py-lg-1{padding-bottom:.25rem}.p-lg-2{padding:.5rem}.pt-lg-2,.py-lg-2{padding-top:.5rem}.pr-lg-2{padding-right:.5rem}.pb-lg-2,.py-lg-2{padding-bottom:.5rem}.p-lg-3{padding:1rem}.pt-lg-3,.py-lg-3{padding-top:1rem}.pr-lg-3{padding-right:1rem}.pb-lg-3,.py-lg-3{padding-bottom:1rem}.p-lg-4{padding:1.5rem}.pt-lg-4,.py-lg-4{padding-top:1.5rem}.pr-lg-4{padding-right:1.5rem}.pb-lg-4,.py-lg-4{padding-bottom:1.5rem}.p-lg-5{padding:3rem}.pt-lg-5,.py-lg-5{padding-top:3rem}.pr-lg-5{padding-right:3rem}.pb-lg-5,.py-lg-5{padding-bottom:3rem}.m-lg-n1{margin:-.25rem}.my-lg-n1{margin-top:-.25rem}.mr-lg-n1{margin-right:-.25rem}.mb-lg-n1,.my-lg-n1{margin-bottom:-.25rem}.m-lg-n2{margin:-.5rem}.my-lg-n2{margin-top:-.5rem}.mr-lg-n2{margin-right:-.5rem}.mb-lg-n2,.my-lg-n2{margin-bottom:-.5rem}.m-lg-n3{margin:-1rem}.my-lg-n3{margin-top:-1rem}.mr-lg-n3{margin-right:-1rem}.mb-lg-n3,.my-lg-n3{margin-bottom:-1rem}.m-lg-n4{margin:-1.5rem}.my-lg-n4{margin-top:-1.5rem}.mr-lg-n4{margin-right:-1.5rem}.mb-lg-n4,.my-lg-n4{margin-bottom:-1.5rem}.m-lg-n5{margin:-3rem}.my-lg-n5{margin-top:-3rem}.mr-lg-n5{margin-right:-3rem}.mb-lg-n5,.my-lg-n5{margin-bottom:-3rem}}.text-right{text-align:right}.text-center{text-align:center}@media(min-width:768px){.text-md-right{text-align:right}.text-md-center{text-align:center}}@media(min-width:992px){.text-lg-right{text-align:right}.text-lg-center{text-align:center}}.text-white{color:#fff}.text-primary{color:#007bff}a.text-primary:focus,a.text-primary:hover{color:#0056b3}.text-light{color:#f8f9fa}a.text-light:focus,a.text-light:hover{color:#cbd3da}.text-dark{color:#343a40}a.text-dark:focus,a.text-dark:hover{color:#121416}.text-body{color:#212529}.text-muted{color:#6c757d}.text-black-50{color:rgba(0,0,0,.5)}.text-white-50{color:rgba(255,255,255,.5)}.text-hide{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;border:0}.text-decoration-none{text-decoration:none}.text-reset{color:inherit}.visible{visibility:visible}@media print{*,::after,::before{text-shadow:none;box-shadow:none}a:not(.btn){text-decoration:underline}pre{white-space:pre-wrap}pre{border:1px solid #adb5bd;page-break-inside:avoid}img{page-break-inside:avoid}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}@page{size:a3}body{min-width:992px}.container{min-width:992px}.table{border-collapse:collapse}.table-dark{color:inherit}}@-webkit-keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}@keyframes sbx-reset-in{0%{-webkit-transform:translate3d(-20%,0,0);transform:translate3d(-20%,0,0);opacity:0}100%{-webkit-transform:none;transform:none;opacity:1}}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"}a:link,a:visited{color:#f14600;text-decoration:none}a:active,a:hover{text-decoration:underline}.btn:disabled{cursor:default;opacity:.4}#logo-text{width:180px;margin-left:12px}.display-5{font-size:2rem;font-weight:300;line-height:1.2}.display-6{font-size:1.75rem;font-weight:300;line-height:1.2}.bg-dark-alt,.bg-dark-alt:focus{background:#36363f}.bg-orange,.bg-orange:focus{background:#f14600}.text-dark-alt{color:#36363f}.btn-dark-alt{background:#36363f}.btn-dark-alt:focus{background:#36363f}.btn-outline-orange{border-color:#f14600;color:#f14600}.btn-orange,.btn-outline-orange:hover{background:#f14600;color:#fff}.btn:active,.btn:hover{text-decoration:none}.text-red{color:#ff3939}.text-orange{color:#f14600}.bg-number{position:absolute;font-size:900%;font-weight:700;color:rgba(241,70,0,.1);line-height:1;margin-top:-1rem}.headerlink{text-decoration:none;margin-left:.5rem}#content table{border:1px solid #dee2e6;width:100%;margin-bottom:1rem;overflow-x:auto}#content code{color:#000;background:#eee;padding:.125rem .25rem}#content code.syntax{padding:0}#content pre{background:#efefef;padding:1rem;line-height:1.25}@media print{body{min-width:0}code,h1,h2,h3,h4,h5,h6,img,li,p,pre{page-break-inside:avoid}}@media(prefers-color-scheme:dark){#to-full-website,body.amp,body[data-spy]{background:#1c1c1c;color:#efefef}.invert-dark{filter:invert(100%)}#content table{border:1px solid #2a2b2c}#content code{background:#444;color:#eee;padding:.125rem .25rem}#content pre{background:#444;color:#eee}}.syntax{background:#f8f9fa;color:#2f1e2e}.syntax .c{color:#8d8687}.syntax .k{color:#000;font-weight:700}.syntax .l{color:#08f}.syntax .n{color:#2f1e2e}.syntax .o{color:#800}.syntax .p{color:#2f1e2e}.syntax .c1{color:#8d8687}.syntax .ge{font-style:italic}.syntax .ld{color:#48b685}.syntax .m{color:#08f}.syntax .s{color:#48b685}.syntax .nb{color:#2f1e2e}.syntax .no{color:#ef6155}.syntax .ne{color:#ef6155}.syntax .py{color:#2f1e2e}.syntax .mi{color:#08f}.syntax .s2{color:#48b685}.syntax .se{color:#08f}.syntax .si{color:#08f}.syntax .s1{color:#080}.syntax .il{color:#08f}@media(prefers-color-scheme:dark){.syntax .k{color:#c78cff}.syntax .ld{color:#64ffbb}.syntax .s{color:#64ffbb}.syntax .s2{color:#64ffbb}.syntax .s1{color:#64ffbb}.syntax .c{color:#64ffbb}.syntax .n{color:#f8f9fa}.syntax .p{color:#f8f9fa}.syntax .nb{color:#f8f9fa}.syntax .py{color:#f8f9fa}}</style><script async custom-element=amp-analytics src=https://cdn.ampproject.org/v0/amp-analytics-0.1.js></script><script async custom-element=amp-iframe src=https://cdn.ampproject.org/v0/amp-iframe-0.1.js></script></head> <body class=amp dir=ltr> <div class="container-fluid container-lg pb-5"> <div class="row pt-3 mb-3"> <div class=col> <a href=/ class=text-decoration-none> <amp-img class="d-inline-block mr-3" layout=fixed width=40 height=36 src=/images/logo.svg alt="ClickHouse logo" title="ClickHouse logo"></amp-img><amp-img class="invert-dark d-inline-block" layout=fixed width=238 height=36 src=/images/clickhouse-black.svg alt=ClickHouse title=ClickHouse></amp-img> </a> </div> </div> <div class=row> <div id=content class=col> <div class="alert alert-primary" role=alert> <p class="display-5 mb-2">Help wanted!</p> <p class=lead>The following content of this documentation page has been machine-translated. But unlike other websites, it is not done on the fly. This translated text lives on GitHub repository alongside main ClickHouse codebase and waits for fellow native speakers to make it more human-readable. <a href=/docs/en/sql-reference/statements/alter/ class=alert-link>You can also use the original English version as a reference.</a></p> <p class=lead> <a class="btn btn-lg btn-primary text-white" href=https://github.com/ClickHouse/ClickHouse/edit/master/docs/fr/sql-reference/statements/alter.md target=_blank rel="external nofollow noreferrer"> Help ClickHouse documentation by editing this page </a> </p> </div> <h2 id=query_language_queries_alter>ALTER<a class=headerlink href=../amp/#query_language_queries_alter title="Permanent link">Â </a></h2> <p>Le <code class=syntax>ALTER</code> la requÃªte est prise en charge uniquement pour <code class=syntax>*MergeTree</code> des tables, ainsi que <code class=syntax>Merge</code>et<code class=syntax>Distributed</code>. La requÃªte a plusieurs variantes.</p> <h3 id=column-manipulations>Manipulations De Colonne<a class=headerlink href=../amp/#column-manipulations title="Permanent link">Â </a></h3> <p>Modification de la structure de la table.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=p>[</span><span class=n>db</span><span class=p>].</span><span class=n>name</span> <span class=p>[</span><span class=k>ON</span> <span class=k>CLUSTER</span> <span class=k>cluster</span><span class=p>]</span> <span class=k>ADD</span><span class=o>|</span><span class=k>DROP</span><span class=o>|</span><span class=n>CLEAR</span><span class=o>|</span><span class=k>COMMENT</span><span class=o>|</span><span class=k>MODIFY</span> <span class=k>COLUMN</span> <span class=p>...</span>
</code></pre></div> <p>Dans la requÃªte, spÃ©cifiez une liste d'une ou plusieurs actions sÃ©parÃ©es par des virgules.<br> Chaque action est une opÃ©ration sur une colonne.</p> <p>Les actions suivantes sont prises en charge:</p> <ul> <li><a href=../amp/#alter_add-column>ADD COLUMN</a> â€” Adds a new column to the table.</li> <li><a href=../amp/#alter_drop-column>DROP COLUMN</a> â€” Deletes the column.</li> <li><a href=../amp/#alter_clear-column>CLEAR COLUMN</a> â€” Resets column values.</li> <li><a href=../amp/#alter_comment-column>COMMENT COLUMN</a> â€” Adds a text comment to the column.</li> <li><a href=../amp/#alter_modify-column>MODIFY COLUMN</a> â€” Changes column's type, default expression and TTL.</li> </ul> <p>Ces actions sont dÃ©crites en dÃ©tail ci-dessous.</p> <h4 id=alter_add-column>ADD COLUMN<a class=headerlink href=../amp/#alter_add-column title="Permanent link">Â </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ADD</span> <span class=k>COLUMN</span> <span class=p>[</span><span class=k>IF</span> <span class=k>NOT</span> <span class=k>EXISTS</span><span class=p>]</span> <span class=n>name</span> <span class=p>[</span><span class=k>type</span><span class=p>]</span> <span class=p>[</span><span class=n>default_expr</span><span class=p>]</span> <span class=p>[</span><span class=n>codec</span><span class=p>]</span> <span class=p>[</span><span class=k>AFTER</span> <span class=n>name_after</span><span class=p>]</span>
</code></pre></div> <p>Ajoute une nouvelle colonne Ã  la table spÃ©cifiÃ©e <code class=syntax>name</code>, <code class=syntax>type</code>, <a href=../../create/amp/#codecs><code class=syntax>codec</code></a> et <code class=syntax>default_expr</code> (voir la section <a href=../../create/amp/#create-default-values>Expressions par dÃ©faut</a>).</p> <p>Si l' <code class=syntax>IF NOT EXISTS</code> la clause est incluse, la requÃªte ne retournera pas d'erreur si la colonne existe dÃ©jÃ . Si vous spÃ©cifiez <code class=syntax>AFTER name_after</code> (le nom d'une autre colonne), la colonne est ajoutÃ©e aprÃ¨s celle spÃ©cifiÃ©e dans la liste des colonnes de la table. Sinon, la colonne est ajoutÃ©e Ã  la fin de la table. Notez qu'il n'existe aucun moyen d'ajouter une colonne au dÃ©but d'un tableau. Pour une chaÃ®ne d'actions, <code class=syntax>name_after</code> peut Ãªtre le nom d'une colonne est ajoutÃ©e dans l'une des actions prÃ©cÃ©dentes.</p> <p>L'ajout d'une colonne modifie simplement la structure de la table, sans effectuer d'actions avec des donnÃ©es. Les donnÃ©es n'apparaissent pas sur le disque aprÃ¨s la <code class=syntax>ALTER</code>. Si les donnÃ©es sont manquantes pour une colonne lors de la lecture de la table, elles sont remplies avec des valeurs par dÃ©faut (en exÃ©cutant l'expression par dÃ©faut s'il y en a une, ou en utilisant des zÃ©ros ou des chaÃ®nes vides). La colonne apparaÃ®t sur le disque aprÃ¨s la fusion des parties de donnÃ©es (voir <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/ >MergeTree</a>).</p> <p>Cette approche nous permet de complÃ©ter le <code class=syntax>ALTER</code> requÃªte instantanÃ©ment, sans augmenter le volume de donnÃ©es anciennes.</p> <p>Exemple:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>visits</span> <span class=k>ADD</span> <span class=k>COLUMN</span> <span class=n>browser</span> <span class=n>String</span> <span class=k>AFTER</span> <span class=n>user_id</span>
</code></pre></div> <h4 id=alter_drop-column>DROP COLUMN<a class=headerlink href=../amp/#alter_drop-column title="Permanent link">Â </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>DROP</span> <span class=k>COLUMN</span> <span class=p>[</span><span class=k>IF</span> <span class=k>EXISTS</span><span class=p>]</span> <span class=n>name</span>
</code></pre></div> <p>Supprime la colonne avec le nom <code class=syntax>name</code>. Si l' <code class=syntax>IF EXISTS</code> la clause est spÃ©cifiÃ©e, la requÃªte ne retournera pas d'erreur si la colonne n'existe pas.</p> <p>Supprime les donnÃ©es du systÃ¨me de fichiers. Comme cela supprime des fichiers entiers, la requÃªte est terminÃ©e presque instantanÃ©ment.</p> <p>Exemple:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>visits</span> <span class=k>DROP</span> <span class=k>COLUMN</span> <span class=n>browser</span>
</code></pre></div> <h4 id=alter_clear-column>CLEAR COLUMN<a class=headerlink href=../amp/#alter_clear-column title="Permanent link">Â </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=n>CLEAR</span> <span class=k>COLUMN</span> <span class=p>[</span><span class=k>IF</span> <span class=k>EXISTS</span><span class=p>]</span> <span class=n>name</span> <span class=k>IN</span> <span class=n>PARTITION</span> <span class=n>partition_name</span>
</code></pre></div> <p>RÃ©initialise toutes les donnÃ©es dans une colonne pour une partition spÃ©cifiÃ©e. En savoir plus sur la dÃ©finition du nom de la partition dans la section <a href=../amp/#alter-how-to-specify-part-expr>Comment spÃ©cifier l'expression de partition</a>.</p> <p>Si l' <code class=syntax>IF EXISTS</code> la clause est spÃ©cifiÃ©e, la requÃªte ne retournera pas d'erreur si la colonne n'existe pas.</p> <p>Exemple:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>visits</span> <span class=n>CLEAR</span> <span class=k>COLUMN</span> <span class=n>browser</span> <span class=k>IN</span> <span class=n>PARTITION</span> <span class=n>tuple</span><span class=p>()</span>
</code></pre></div> <h4 id=alter_comment-column>COMMENT COLUMN<a class=headerlink href=../amp/#alter_comment-column title="Permanent link">Â </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>COMMENT</span> <span class=k>COLUMN</span> <span class=p>[</span><span class=k>IF</span> <span class=k>EXISTS</span><span class=p>]</span> <span class=n>name</span> <span class=s1>'comment'</span>
</code></pre></div> <p>Ajoute un commentaire Ã  la colonne. Si l' <code class=syntax>IF EXISTS</code> la clause est spÃ©cifiÃ©e, la requÃªte ne retournera pas d'erreur si la colonne n'existe pas.</p> <p>Chaque colonne peut avoir un commentaire. Si un commentaire existe dÃ©jÃ  pour la colonne, un nouveau commentaire remplace le prÃ©cÃ©dent commentaire.</p> <p>Les commentaires sont stockÃ©s dans le <code class=syntax>comment_expression</code> colonne renvoyÃ©e par le <a href=../../misc/amp/#misc-describe-table>DESCRIBE TABLE</a> requÃªte.</p> <p>Exemple:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>visits</span> <span class=k>COMMENT</span> <span class=k>COLUMN</span> <span class=n>browser</span> <span class=s1>'The table shows the browser used for accessing the site.'</span>
</code></pre></div> <h4 id=alter_modify-column>MODIFY COLUMN<a class=headerlink href=../amp/#alter_modify-column title="Permanent link">Â </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>MODIFY</span> <span class=k>COLUMN</span> <span class=p>[</span><span class=k>IF</span> <span class=k>EXISTS</span><span class=p>]</span> <span class=n>name</span> <span class=p>[</span><span class=k>type</span><span class=p>]</span> <span class=p>[</span><span class=n>default_expr</span><span class=p>]</span> <span class=p>[</span><span class=n>TTL</span><span class=p>]</span>
</code></pre></div> <p>Cette requÃªte modifie le <code class=syntax>name</code> les propriÃ©tÃ©s de la colonne:</p> <ul> <li> <p>Type</p> </li> <li> <p>Expression par dÃ©faut</p> </li> <li> <p>TTL</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>For</span> <span class=n>examples</span> <span class=n>of</span> <span class=n>columns</span> <span class=n>TTL</span> <span class=n>modifying</span><span class=p>,</span> <span class=n>see</span> <span class=p>[</span><span class=n>Column</span> <span class=n>TTL</span><span class=p>](..</span><span class=o>/</span><span class=n>engines</span><span class=o>/</span><span class=n>table_engines</span><span class=o>/</span><span class=n>mergetree_family</span><span class=o>/</span><span class=n>mergetree</span><span class=p>.</span><span class=n>md</span><span class=err>#</span><span class=n>mergetree</span><span class=o>-</span><span class=n>column</span><span class=o>-</span><span class=n>ttl</span><span class=p>).</span>
</code></pre></div> </li> </ul> <p>Si l' <code class=syntax>IF EXISTS</code> la clause est spÃ©cifiÃ©e, la requÃªte ne retournera pas d'erreur si la colonne n'existe pas.</p> <p>Lors de la modification du type, les valeurs sont converties comme si <a href=../../../functions/type-conversion-functions/amp/ >toType</a> les fonctions ont Ã©tÃ© appliquÃ©es. Si seule l'expression par dÃ©faut est modifiÃ©e, la requÃªte ne fait rien de complexe et est terminÃ©e presque instantanÃ©ment.</p> <p>Exemple:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>visits</span> <span class=k>MODIFY</span> <span class=k>COLUMN</span> <span class=n>browser</span> <span class=nb>Array</span><span class=p>(</span><span class=n>String</span><span class=p>)</span>
</code></pre></div> <p>Changing the column type is the only complex action â€“ it changes the contents of files with data. For large tables, this may take a long time.</p> <p>Il y a plusieurs Ã©tapes de traitement:</p> <ul> <li>PrÃ©paration de (nouveaux) fichiers temporaires avec des donnÃ©es modifiÃ©es.</li> <li>Renommer les anciens fichiers.</li> <li>Renommer les (nouveaux) fichiers temporaires en anciens noms.</li> <li>Suppression des anciens fichiers.</li> </ul> <p>Seule la premiÃ¨re Ã©tape prend du temps. Si il y a un Ã©chec Ã  ce stade, les donnÃ©es ne sont pas modifiÃ©es.<br> En cas d'Ã©chec au cours d'une des Ã©tapes successives, les donnÃ©es peuvent Ãªtre restaurÃ©es manuellement. L'exception est si les anciens fichiers ont Ã©tÃ© supprimÃ©s du systÃ¨me de fichiers mais que les donnÃ©es des nouveaux fichiers n'ont pas Ã©tÃ© Ã©crites sur le disque et ont Ã©tÃ© perdues.</p> <p>Le <code class=syntax>ALTER</code> la requÃªte de modification des colonnes est rÃ©pliquÃ©e. Les instructions sont enregistrÃ©es dans ZooKeeper, puis chaque rÃ©plique les applique. Tout <code class=syntax>ALTER</code> les requÃªtes sont exÃ©cutÃ©es dans le mÃªme ordre. La requÃªte attend que les actions appropriÃ©es soient terminÃ©es sur les autres rÃ©pliques. Cependant, une requÃªte pour modifier des colonnes dans une table rÃ©pliquÃ©e peut Ãªtre interrompue, et toutes les actions seront effectuÃ©es de maniÃ¨re asynchrone.</p> <h4 id=alter-query-limitations>Modifier les limites de la requÃªte<a class=headerlink href=../amp/#alter-query-limitations title="Permanent link">Â </a></h4> <p>Le <code class=syntax>ALTER</code> query vous permet de crÃ©er et de supprimer des Ã©lÃ©ments distincts (colonnes) dans des structures de donnÃ©es imbriquÃ©es, mais pas des structures de donnÃ©es imbriquÃ©es entiÃ¨res. Pour ajouter une structure de donnÃ©es imbriquÃ©e, vous pouvez ajouter des colonnes avec un nom comme <code class=syntax>name.nested_name</code> et le type <code class=syntax>Array(T)</code>. Une structure de donnÃ©es imbriquÃ©e est Ã©quivalente Ã  plusieurs colonnes de tableau avec un nom qui a le mÃªme prÃ©fixe avant le point.</p> <p>Il n'y a pas de support pour supprimer des colonnes dans la clÃ© primaire ou la clÃ© d'Ã©chantillonnage (colonnes qui sont utilisÃ©es dans le <code class=syntax>ENGINE</code> expression). La modification du type des colonnes incluses dans la clÃ© primaire n'est possible que si cette modification n'entraÃ®ne pas la modification des donnÃ©es (par exemple, vous Ãªtes autorisÃ© Ã  ajouter des valeurs Ã  une Ã©numÃ©ration ou Ã  modifier un type de <code class=syntax>DateTime</code> de <code class=syntax>UInt32</code>).</p> <p>Si l' <code class=syntax>ALTER</code> la requÃªte n'est pas suffisante pour apporter les modifications de table dont vous avez besoin, vous pouvez crÃ©er une nouvelle table, y copier les donnÃ©es en utilisant le <a href=../../insert-into/amp/#insert_query_insert-select>INSERT SELECT</a> requÃªte, puis changer les tables en utilisant le <a href=../../misc/amp/#misc_operations-rename>RENAME</a> requÃªte et supprimer l'ancienne table. Vous pouvez utiliser l' <a href=../../../../operations/utilities/clickhouse-copier/amp/ >clickhouse-copieur</a> comme une alternative Ã  la <code class=syntax>INSERT SELECT</code> requÃªte.</p> <p>Le <code class=syntax>ALTER</code> query bloque toutes les lectures et Ã©critures pour la table. En d'autres termes, si une longue <code class=syntax>SELECT</code> est en cours d'exÃ©cution au moment de la <code class=syntax>ALTER</code> requÃªte, la <code class=syntax>ALTER</code> la requÃªte va attendre qu'elle se termine. Dans le mÃªme temps, toutes les nouvelles requÃªtes Ã  la mÃªme table attendre que ce <code class=syntax>ALTER</code> est en cours d'exÃ©cution.</p> <p>Pour les tables qui ne stockent pas les donnÃ©es elles-mÃªmes (telles que <code class=syntax>Merge</code> et <code class=syntax>Distributed</code>), <code class=syntax>ALTER</code> change simplement la structure de la table, et ne change pas la structure des tables subordonnÃ©es. Par exemple, lors de L'exÃ©cution de ALTER pour un <code class=syntax>Distributed</code> table, vous devrez Ã©galement exÃ©cuter <code class=syntax>ALTER</code> pour les tables sur tous les serveurs distants.</p> <h3 id=manipulations-with-key-expressions>Manipulations avec des Expressions clÃ©s<a class=headerlink href=../amp/#manipulations-with-key-expressions title="Permanent link">Â </a></h3> <p>La commande suivante est prise en charge:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>MODIFY</span> <span class=k>ORDER</span> <span class=k>BY</span> <span class=n>new_expression</span>
</code></pre></div> <p>Cela ne fonctionne que pour les tables du <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/ ><code class=syntax>MergeTree</code></a> de la famille (y compris les<br> <a href=../../../../engines/table-engines/mergetree-family/replication/amp/ >rÃ©pliquÃ©</a> table). La commande change l'<br> <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/ >clÃ© de tri</a> de la table<br> de <code class=syntax>new_expression</code> (une expression ou un tuple d'expressions). ClÃ© primaire reste le mÃªme.</p> <p>La commande est lÃ©gÃ¨re en ce sens qu'elle ne modifie que les mÃ©tadonnÃ©es. Pour conserver la propriÃ©tÃ© cette partie de donnÃ©es<br> les lignes sont ordonnÃ©es par l'expression de clÃ© de tri vous ne pouvez pas ajouter d'expressions contenant des colonnes existantes<br> Ã  la clÃ© de tri (seules les colonnes ajoutÃ©es par <code class=syntax>ADD COLUMN</code> commande dans le mÃªme <code class=syntax>ALTER</code> requÃªte).</p> <h3 id=manipulations-with-data-skipping-indices>Manipulations avec des Indices de saut de donnÃ©es<a class=headerlink href=../amp/#manipulations-with-data-skipping-indices title="Permanent link">Â </a></h3> <p>Cela ne fonctionne que pour les tables du <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/ ><code class=syntax>*MergeTree</code></a> de la famille (y compris les<br> <a href=../../../../engines/table-engines/mergetree-family/replication/amp/ >rÃ©pliquÃ©</a> table). Les opÃ©rations suivantes<br> sont disponibles:</p> <ul> <li> <p><code class=syntax>ALTER TABLE [db].name ADD INDEX name expression TYPE type GRANULARITY value AFTER name [AFTER name2]</code> - Ajoute la description de l'index aux mÃ©tadonnÃ©es des tables.</p> </li> <li> <p><code class=syntax>ALTER TABLE [db].name DROP INDEX name</code> - Supprime la description de l'index des mÃ©tadonnÃ©es des tables et supprime les fichiers d'index du disque.</p> </li> </ul> <p>Ces commandes sont lÃ©gÃ¨res dans le sens oÃ¹ elles ne modifient que les mÃ©tadonnÃ©es ou suppriment des fichiers.<br> En outre, ils sont rÃ©pliquÃ©s (synchronisation des mÃ©tadonnÃ©es des indices via ZooKeeper).</p> <h3 id=manipulations-with-constraints>Manipulations avec contraintes<a class=headerlink href=../amp/#manipulations-with-constraints title="Permanent link">Â </a></h3> <p>En voir plus sur <a href=../../create/amp/#constraints>contraintes</a></p> <p>Les contraintes peuvent Ãªtre ajoutÃ©es ou supprimÃ©es Ã  l'aide de la syntaxe suivante:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=p>[</span><span class=n>db</span><span class=p>].</span><span class=n>name</span> <span class=k>ADD</span> <span class=k>CONSTRAINT</span> <span class=k>constraint_name</span> <span class=k>CHECK</span> <span class=n>expression</span><span class=p>;</span>
<span class=k>ALTER</span> <span class=k>TABLE</span> <span class=p>[</span><span class=n>db</span><span class=p>].</span><span class=n>name</span> <span class=k>DROP</span> <span class=k>CONSTRAINT</span> <span class=k>constraint_name</span><span class=p>;</span>
</code></pre></div> <p>Les requÃªtes ajouteront ou supprimeront des mÃ©tadonnÃ©es sur les contraintes de la table afin qu'elles soient traitÃ©es immÃ©diatement.</p> <p>Contrainte de vÃ©rifier <em>ne sera pas exÃ©cutÃ©</em> sur les donnÃ©es existantes si elle a Ã©tÃ© ajoutÃ©e.</p> <p>Toutes les modifications sur les tables rÃ©pliquÃ©es sont diffusÃ©es sur ZooKeeper et seront donc appliquÃ©es sur d'autres rÃ©pliques.</p> <h3 id=alter_manipulations-with-partitions>Manipulations avec des Partitions et des piÃ¨ces<a class=headerlink href=../amp/#alter_manipulations-with-partitions title="Permanent link">Â </a></h3> <p>Les opÃ©rations suivantes avec <a href=../../../../engines/table-engines/mergetree-family/custom-partitioning-key/amp/ >partition</a> sont disponibles:</p> <ul> <li><a href=../amp/#alter_detach-partition>DETACH PARTITION</a> â€“ Moves a partition to the <code class=syntax>detached</code> rÃ©pertoire et de l'oublier.</li> <li><a href=../amp/#alter_drop-partition>DROP PARTITION</a> â€“ Deletes a partition.</li> <li><a href=../amp/#alter_attach-partition>ATTACH PART|PARTITION</a> â€“ Adds a part or partition from the <code class=syntax>detached</code> rÃ©pertoire Ã  la table.</li> <li><a href=../amp/#alter_attach-partition-from>ATTACH PARTITION FROM</a> â€“ Copies the data partition from one table to another and adds.</li> <li><a href=../amp/#alter_replace-partition>REPLACE PARTITION</a> - Copie la partition de donnÃ©es d'une table Ã  l'autre et la remplace.</li> <li><a href=../amp/#alter_move_to_table-partition>MOVE PARTITION TO TABLE</a>(#alter_move_to_table-partition) - dÃ©place la partition de donnÃ©es d'une table Ã  l'autre.</li> <li><a href=../amp/#alter_clear-column-partition>CLEAR COLUMN IN PARTITION</a> - RÃ©tablit la valeur d'une colonne spÃ©cifiÃ©e dans une partition.</li> <li><a href=../amp/#alter_clear-index-partition>CLEAR INDEX IN PARTITION</a> - RÃ©initialise l'index secondaire spÃ©cifiÃ© dans une partition.</li> <li><a href=../amp/#alter_freeze-partition>FREEZE PARTITION</a> â€“ Creates a backup of a partition.</li> <li><a href=../amp/#alter_fetch-partition>FETCH PARTITION</a> â€“ Downloads a partition from another server.</li> <li><a href=../amp/#alter_move-partition>MOVE PARTITION|PART</a> â€“ Move partition/data part to another disk or volume.</li> </ul> <!-- --> <h4 id=alter_detach-partition>DETACH PARTITION<a class=headerlink href=../amp/#alter_detach-partition title="Permanent link">Â </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=k>table_name</span> <span class=n>DETACH</span> <span class=n>PARTITION</span> <span class=n>partition_expr</span>
</code></pre></div> <p>DÃ©place toutes les donnÃ©es de la partition spÃ©cifiÃ©e vers <code class=syntax>detached</code> rÃ©pertoire. Le serveur oublie la partition de donnÃ©es dÃ©tachÃ©e comme si elle n'existait pas. Le serveur ne connaÃ®tra pas ces donnÃ©es tant que vous n'aurez pas <a href=../amp/#alter_attach-partition>ATTACH</a> requÃªte.</p> <p>Exemple:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>visits</span> <span class=n>DETACH</span> <span class=n>PARTITION</span> <span class=mi>201901</span>
</code></pre></div> <p>Lisez Ã  propos de la dÃ©finition de l'expression de partition dans une section <a href=../amp/#alter-how-to-specify-part-expr>Comment spÃ©cifier l'expression de partition</a>.</p> <p>Une fois la requÃªte exÃ©cutÃ©e, vous pouvez faire ce que vous voulez avec les donnÃ©es du <code class=syntax>detached</code> directory â€” delete it from the file system, or just leave it.</p> <p>This query is replicated â€“ it moves the data to the <code class=syntax>detached</code> rÃ©pertoire sur toutes les rÃ©pliques. Notez que vous ne pouvez exÃ©cuter cette requÃªte que sur un rÃ©plica leader. Pour savoir si une rÃ©plique est un leader, effectuez le <code class=syntax>SELECT</code> requÃªte Ã  l' <a href=../../../../operations/system-tables/amp/#system_tables-replicas>systÃ¨me.rÃ©plique</a> table. Alternativement, il est plus facile de faire une <code class=syntax>DETACH</code> requÃªte sur toutes les rÃ©pliques - toutes les rÃ©pliques lancent une exception, Ã  l'exception de la rÃ©plique leader.</p> <h4 id=alter_drop-partition>DROP PARTITION<a class=headerlink href=../amp/#alter_drop-partition title="Permanent link">Â </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=k>table_name</span> <span class=k>DROP</span> <span class=n>PARTITION</span> <span class=n>partition_expr</span>
</code></pre></div> <p>Supprime la partition spÃ©cifiÃ©e de la table. Cette requÃªte marque la partition comme inactive et supprime complÃ¨tement les donnÃ©es, environ en 10 minutes.</p> <p>Lisez Ã  propos de la dÃ©finition de l'expression de partition dans une section <a href=../amp/#alter-how-to-specify-part-expr>Comment spÃ©cifier l'expression de partition</a>.</p> <p>The query is replicated â€“ it deletes data on all replicas.</p> <h4 id=alter_drop-detached>DROP DETACHED PARTITION|PART<a class=headerlink href=../amp/#alter_drop-detached title="Permanent link">Â </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=k>table_name</span> <span class=k>DROP</span> <span class=n>DETACHED</span> <span class=n>PARTITION</span><span class=o>|</span><span class=n>PART</span> <span class=n>partition_expr</span>
</code></pre></div> <p>Supprime la partie spÃ©cifiÃ©e ou toutes les parties de la partition spÃ©cifiÃ©e de <code class=syntax>detached</code>.<br> En savoir plus sur la dÃ©finition de l'expression de partition dans une section <a href=../amp/#alter-how-to-specify-part-expr>Comment spÃ©cifier l'expression de partition</a>.</p> <h4 id=alter_attach-partition>ATTACH PARTITION|PART<a class=headerlink href=../amp/#alter_attach-partition title="Permanent link">Â </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=k>table_name</span> <span class=n>ATTACH</span> <span class=n>PARTITION</span><span class=o>|</span><span class=n>PART</span> <span class=n>partition_expr</span>
</code></pre></div> <p>Ajoute des donnÃ©es Ã  la table Ã  partir du <code class=syntax>detached</code> rÃ©pertoire. Il est possible d'ajouter des donnÃ©es dans une partition entiÃ¨re ou pour une partie distincte. Exemple:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>visits</span> <span class=n>ATTACH</span> <span class=n>PARTITION</span> <span class=mi>201901</span><span class=p>;</span>
<span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>visits</span> <span class=n>ATTACH</span> <span class=n>PART</span> <span class=mi>201901</span><span class=n>_2_2_0</span><span class=p>;</span>
</code></pre></div> <p>En savoir plus sur la dÃ©finition de l'expression de partition dans une section <a href=../amp/#alter-how-to-specify-part-expr>Comment spÃ©cifier l'expression de partition</a>.</p> <p>Cette requÃªte est rÃ©pliquÃ©e. L'initiateur de rÃ©plica vÃ©rifie s'il y a des donnÃ©es dans le <code class=syntax>detached</code> rÃ©pertoire. Si des donnÃ©es existent, la requÃªte vÃ©rifie son intÃ©gritÃ©. Si tout est correct, la requÃªte ajoute les donnÃ©es Ã  la table. Tous les autres rÃ©plicas tÃ©lÃ©chargent les donnÃ©es de l'initiateur de rÃ©plica.</p> <p>Ainsi, vous pouvez mettre des donnÃ©es Ã  la <code class=syntax>detached</code> rÃ©pertoire sur une rÃ©plique, et utilisez le <code class=syntax>ALTER ... ATTACH</code> requÃªte pour l'ajouter Ã  la table sur tous les rÃ©plicas.</p> <h4 id=alter_attach-partition-from>ATTACH PARTITION FROM<a class=headerlink href=../amp/#alter_attach-partition-from title="Permanent link">Â </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>table2</span> <span class=n>ATTACH</span> <span class=n>PARTITION</span> <span class=n>partition_expr</span> <span class=k>FROM</span> <span class=n>table1</span>
</code></pre></div> <p>Cette requÃªte copie la partition de donnÃ©es du <code class=syntax>table1</code> de <code class=syntax>table2</code> ajoute des donnÃ©es de gratuit dans la <code class=syntax>table2</code>. Notez que les donnÃ©es ne seront pas supprimÃ©es de <code class=syntax>table1</code>.</p> <p>Pour que la requÃªte s'exÃ©cute correctement, les conditions suivantes doivent Ãªtre remplies:</p> <ul> <li>Les deux tables doivent avoir la mÃªme structure.</li> <li>Les deux tables doivent avoir la mÃªme clÃ© de partition.</li> </ul> <h4 id=alter_replace-partition>REPLACE PARTITION<a class=headerlink href=../amp/#alter_replace-partition title="Permanent link">Â </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>table2</span> <span class=k>REPLACE</span> <span class=n>PARTITION</span> <span class=n>partition_expr</span> <span class=k>FROM</span> <span class=n>table1</span>
</code></pre></div> <p>Cette requÃªte copie la partition de donnÃ©es du <code class=syntax>table1</code> de <code class=syntax>table2</code> et remplace la partition existante dans le <code class=syntax>table2</code>. Notez que les donnÃ©es ne seront pas supprimÃ©es de <code class=syntax>table1</code>.</p> <p>Pour que la requÃªte s'exÃ©cute correctement, les conditions suivantes doivent Ãªtre remplies:</p> <ul> <li>Les deux tables doivent avoir la mÃªme structure.</li> <li>Les deux tables doivent avoir la mÃªme clÃ© de partition.</li> </ul> <h4 id=alter_move_to_table-partition>MOVE PARTITION TO TABLE<a class=headerlink href=../amp/#alter_move_to_table-partition title="Permanent link">Â </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>table_source</span> <span class=k>MOVE</span> <span class=n>PARTITION</span> <span class=n>partition_expr</span> <span class=k>TO</span> <span class=k>TABLE</span> <span class=n>table_dest</span>
</code></pre></div> <p>Cette requÃªte dÃ©place la partition de donnÃ©es du <code class=syntax>table_source</code> de <code class=syntax>table_dest</code> avec la suppression des donnÃ©es de <code class=syntax>table_source</code>.</p> <p>Pour que la requÃªte s'exÃ©cute correctement, les conditions suivantes doivent Ãªtre remplies:</p> <ul> <li>Les deux tables doivent avoir la mÃªme structure.</li> <li>Les deux tables doivent avoir la mÃªme clÃ© de partition.</li> <li>Les deux tables doivent appartenir Ã  la mÃªme famille de moteurs. (rÃ©pliquÃ© ou non rÃ©pliquÃ©)</li> <li>Les deux tables doivent avoir la mÃªme stratÃ©gie de stockage.</li> </ul> <h4 id=alter_clear-column-partition>CLEAR COLUMN IN PARTITION<a class=headerlink href=../amp/#alter_clear-column-partition title="Permanent link">Â </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=k>table_name</span> <span class=n>CLEAR</span> <span class=k>COLUMN</span> <span class=k>column_name</span> <span class=k>IN</span> <span class=n>PARTITION</span> <span class=n>partition_expr</span>
</code></pre></div> <p>RÃ©initialise toutes les valeurs de la colonne spÃ©cifiÃ©e dans une partition. Si l' <code class=syntax>DEFAULT</code> la clause a Ã©tÃ© dÃ©terminÃ©e lors de la crÃ©ation d'une table, cette requÃªte dÃ©finit la valeur de la colonne Ã  une valeur par dÃ©faut spÃ©cifiÃ©e.</p> <p>Exemple:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>visits</span> <span class=n>CLEAR</span> <span class=k>COLUMN</span> <span class=n>hour</span> <span class=k>in</span> <span class=n>PARTITION</span> <span class=mi>201902</span>
</code></pre></div> <h4 id=alter_freeze-partition>FREEZE PARTITION<a class=headerlink href=../amp/#alter_freeze-partition title="Permanent link">Â </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=k>table_name</span> <span class=k>FREEZE</span> <span class=p>[</span><span class=n>PARTITION</span> <span class=n>partition_expr</span><span class=p>]</span>
</code></pre></div> <p>Cette requÃªte crÃ©e une sauvegarde locale d'une partition spÃ©cifiÃ©e. Si l' <code class=syntax>PARTITION</code> la clause est omise, la requÃªte crÃ©e la sauvegarde de toutes les partitions Ã  la fois.</p> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Note</p> <p>L'ensemble du processus de sauvegarde est effectuÃ©e sans arrÃªter le serveur.</p> </div> <p>Notez que pour les tables de style ancien, vous pouvez spÃ©cifier le prÃ©fixe du nom de la partition (par exemple, â€˜2019â€™)- ensuite, la requÃªte crÃ©e la sauvegarde pour toutes les partitions correspondantes. Lisez Ã  propos de la dÃ©finition de l'expression de partition dans une section <a href=../amp/#alter-how-to-specify-part-expr>Comment spÃ©cifier l'expression de partition</a>.</p> <p>Au moment de l'exÃ©cution, pour un instantanÃ© de donnÃ©es, la requÃªte crÃ©e des liens rigides vers des donnÃ©es de table. Les liens sont placÃ©s dans le rÃ©pertoire <code class=syntax>/var/lib/clickhouse/shadow/N/...</code>, oÃ¹:</p> <ul> <li><code class=syntax>/var/lib/clickhouse/</code> est le rÃ©pertoire de travail clickhouse spÃ©cifiÃ© dans la configuration.</li> <li><code class=syntax>N</code> est le numÃ©ro incrÃ©mental de la sauvegarde.</li> </ul> <div class="admonition note alert pb-0 mb-4 alert-primary" role=alert> <p class="admonition-title alert-heading display-6 mb-2">Note</p> <p>Si vous utilisez <a class=alert-link href=../../../../engines/table-engines/mergetree-family/mergetree/amp/#table_engine-mergetree-multiple-volumes>un ensemble de disques pour le stockage des donnÃ©es dans une table</a>, le <code class=syntax>shadow/N</code> le rÃ©pertoire apparaÃ®t sur chaque disque, stockant les parties de donnÃ©es correspondant <code class=syntax>PARTITION</code> expression.</p> </div> <p>La mÃªme structure de rÃ©pertoires est crÃ©Ã©e Ã  l'intÃ©rieur de la sauvegarde qu'Ã  l'intÃ©rieur <code class=syntax>/var/lib/clickhouse/</code>. La requÃªte effectue â€˜chmodâ€™ pour tous les fichiers, interdisant d'Ã©crire en eux.</p> <p>AprÃ¨s avoir crÃ©Ã© la sauvegarde, vous pouvez copier les donnÃ©es depuis <code class=syntax>/var/lib/clickhouse/shadow/</code> sur le serveur distant, puis supprimez-le du serveur local. Notez que l' <code class=syntax>ALTER t FREEZE PARTITION</code> la requÃªte n'est pas rÃ©pliquÃ©. Il crÃ©e une sauvegarde locale uniquement sur le serveur local.</p> <p>La requÃªte crÃ©e une sauvegarde presque instantanÃ©ment (mais elle attend d'abord que les requÃªtes en cours Ã  la table correspondante se terminent).</p> <p><code class=syntax>ALTER TABLE t FREEZE PARTITION</code> copie uniquement les donnÃ©es, pas les mÃ©tadonnÃ©es de la table. Faire une sauvegarde des mÃ©tadonnÃ©es de la table, copiez le fichier <code class=syntax>/var/lib/clickhouse/metadata/database/table.sql</code></p> <p>Pour restaurer des donnÃ©es Ã  partir d'une sauvegarde, procÃ©dez comme suit:</p> <ol> <li>CrÃ©er la table si elle n'existe pas. Pour afficher la requÃªte, utilisez la .fichier sql (remplacer <code class=syntax>ATTACH</code> avec <code class=syntax>CREATE</code>).</li> <li>Copier les donnÃ©es de la <code class=syntax>data/database/table/</code> rÃ©pertoire Ã  l'intÃ©rieur de la sauvegarde <code class=syntax>/var/lib/clickhouse/data/database/table/detached/</code> rÃ©pertoire.</li> <li>ExÃ©cuter <code class=syntax>ALTER TABLE t ATTACH PARTITION</code> les requÃªtes pour ajouter les donnÃ©es Ã  une table.</li> </ol> <p>La restauration Ã  partir d'une sauvegarde ne nÃ©cessite pas l'arrÃªt du serveur.</p> <p>Pour plus d'informations sur les sauvegardes et la restauration <a href=../../../../operations/backup/amp/ >La Sauvegarde Des DonnÃ©es</a> section.</p> <h4 id=alter_clear-index-partition>CLEAR INDEX IN PARTITION<a class=headerlink href=../amp/#alter_clear-index-partition title="Permanent link">Â </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=k>table_name</span> <span class=n>CLEAR</span> <span class=k>INDEX</span> <span class=n>index_name</span> <span class=k>IN</span> <span class=n>PARTITION</span> <span class=n>partition_expr</span>
</code></pre></div> <p>La requÃªte fonctionne de maniÃ¨re similaire Ã  <code class=syntax>CLEAR COLUMN</code> mais il remet un index au lieu d'une colonne de donnÃ©es.</p> <h4 id=alter_fetch-partition>FETCH PARTITION<a class=headerlink href=../amp/#alter_fetch-partition title="Permanent link">Â </a></h4> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=k>table_name</span> <span class=k>FETCH</span> <span class=n>PARTITION</span> <span class=n>partition_expr</span> <span class=k>FROM</span> <span class=s1>'path-in-zookeeper'</span>
</code></pre></div> <p>TÃ©lÃ©charge une partition depuis un autre serveur. Cette requÃªte ne fonctionne que pour les tables rÃ©pliquÃ©es.</p> <p>La requÃªte effectue les opÃ©rations suivantes:</p> <ol> <li>TÃ©lÃ©charge la partition Ã  partir du fragment spÃ©cifiÃ©. Dans â€˜path-in-zookeeperâ€™ vous devez spÃ©cifier un chemin vers le fragment dans ZooKeeper.</li> <li>Ensuite, la requÃªte met les donnÃ©es tÃ©lÃ©chargÃ©es dans le <code class=syntax>detached</code> rÃ©pertoire de la <code class=syntax>table_name</code> table. L'utilisation de la <a href=../amp/#alter_attach-partition>ATTACH PARTITION|PART</a> requÃªte pour ajouter les donnÃ©es Ã  la table.</li> </ol> <p>Exemple:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>users</span> <span class=k>FETCH</span> <span class=n>PARTITION</span> <span class=mi>201902</span> <span class=k>FROM</span> <span class=s1>'/clickhouse/tables/01-01/visits'</span><span class=p>;</span>
<span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>users</span> <span class=n>ATTACH</span> <span class=n>PARTITION</span> <span class=mi>201902</span><span class=p>;</span>
</code></pre></div> <p>Notez que:</p> <ul> <li>Le <code class=syntax>ALTER ... FETCH PARTITION</code> la requÃªte n'est pas rÃ©pliquÃ©. Il place la partition Ã  la <code class=syntax>detached</code> rÃ©pertoire sur le serveur local.</li> <li>Le <code class=syntax>ALTER TABLE ... ATTACH</code> la requÃªte est rÃ©pliquÃ©e. Il ajoute les donnÃ©es Ã  toutes les rÃ©pliques. Les donnÃ©es sont ajoutÃ©es Ã  l'une des rÃ©pliques <code class=syntax>detached</code> rÃ©pertoire, et aux autres-des rÃ©pliques voisines.</li> </ul> <p>Avant le tÃ©lÃ©chargement, le systÃ¨me vÃ©rifie si la partition existe et si la structure de la table correspond. La rÃ©plique la plus appropriÃ©e est sÃ©lectionnÃ©e automatiquement parmi les rÃ©pliques saines.</p> <p>Bien que la requÃªte soit appelÃ©e <code class=syntax>ALTER TABLE</code>, il ne modifie pas la structure de la table et ne modifie pas immÃ©diatement les donnÃ©es disponibles dans la table.</p> <h4 id=alter_move-partition>MOVE PARTITION|PART<a class=headerlink href=../amp/#alter_move-partition title="Permanent link">Â </a></h4> <p>DÃ©place des partitions ou des parties de donnÃ©es vers un autre volume ou disque pour <code class=syntax>MergeTree</code>-tables de moteur. Voir <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/#table_engine-mergetree-multiple-volumes>Utilisation de plusieurs pÃ©riphÃ©riques de bloc pour le stockage de donnÃ©es</a>.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=k>table_name</span> <span class=k>MOVE</span> <span class=n>PARTITION</span><span class=o>|</span><span class=n>PART</span> <span class=n>partition_expr</span> <span class=k>TO</span> <span class=n>DISK</span><span class=o>|</span><span class=n>VOLUME</span> <span class=s1>'disk_name'</span>
</code></pre></div> <p>Le <code class=syntax>ALTER TABLE t MOVE</code> requÃªte:</p> <ul> <li>Non rÃ©pliquÃ©, car diffÃ©rentes rÃ©pliques peuvent avoir des stratÃ©gies de stockage diffÃ©rentes.</li> <li>Renvoie une erreur si le disque ou le volume n'est pas configurÃ©. Query renvoie Ã©galement une erreur si les conditions de dÃ©placement des donnÃ©es, spÃ©cifiÃ©es dans la stratÃ©gie de stockage, ne peuvent pas Ãªtre appliquÃ©es.</li> <li>Peut renvoyer une erreur dans le cas, lorsque les donnÃ©es Ã  dÃ©placer sont dÃ©jÃ  dÃ©placÃ©es par un processus en arriÃ¨re-plan, simultanÃ© <code class=syntax>ALTER TABLE t MOVE</code> requÃªte ou Ã  la suite de la fusion de donnÃ©es d'arriÃ¨re-plan. Un utilisateur ne doit effectuer aucune action supplÃ©mentaire dans ce cas.</li> </ul> <p>Exemple:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>hits</span> <span class=k>MOVE</span> <span class=n>PART</span> <span class=s1>'20190301_14343_16206_438'</span> <span class=k>TO</span> <span class=n>VOLUME</span> <span class=s1>'slow'</span>
<span class=k>ALTER</span> <span class=k>TABLE</span> <span class=n>hits</span> <span class=k>MOVE</span> <span class=n>PARTITION</span> <span class=s1>'2019-09-01'</span> <span class=k>TO</span> <span class=n>DISK</span> <span class=s1>'fast_ssd'</span>
</code></pre></div> <h4 id=alter-how-to-specify-part-expr>Comment dÃ©finir L'Expression de la Partition<a class=headerlink href=../amp/#alter-how-to-specify-part-expr title="Permanent link">Â </a></h4> <p>Vous pouvez spÃ©cifier l'expression de partition dans <code class=syntax>ALTER ... PARTITION</code> requÃªtes de diffÃ©rentes maniÃ¨res:</p> <ul> <li>Comme une valeur de l' <code class=syntax>partition</code> la colonne de la <code class=syntax>system.parts</code> table. Exemple, <code class=syntax>ALTER TABLE visits DETACH PARTITION 201901</code>.</li> <li>Comme expression de la colonne de la table. Les constantes et les expressions constantes sont prises en charge. Exemple, <code class=syntax>ALTER TABLE visits DETACH PARTITION toYYYYMM(toDate('2019-01-25'))</code>.</li> <li>Ã€ l'aide de l'ID de partition. Partition ID est un identifiant de chaÃ®ne de la partition (lisible par l'homme, si possible) qui est utilisÃ© comme noms de partitions dans le systÃ¨me de fichiers et dans ZooKeeper. L'ID de partition doit Ãªtre spÃ©cifiÃ© dans <code class=syntax>PARTITION ID</code> clause, entre guillemets simples. Exemple, <code class=syntax>ALTER TABLE visits DETACH PARTITION ID '201901'</code>.</li> <li>Dans le <a href=../amp/#alter_attach-partition>ALTER ATTACH PART</a> et <a href=../amp/#alter_drop-detached>DROP DETACHED PART</a> requÃªte, pour spÃ©cifier le nom d'une partie, utilisez le littÃ©ral de chaÃ®ne avec une valeur de <code class=syntax>name</code> la colonne de la <a href=../../../../operations/system-tables/amp/#system_tables-detached_parts>systÃ¨me.detached_parts</a> table. Exemple, <code class=syntax>ALTER TABLE visits ATTACH PART '201901_1_1_0'</code>.</li> </ul> <p>L'utilisation de guillemets lors de la spÃ©cification de la partition dÃ©pend du type d'expression de partition. Par exemple, pour la <code class=syntax>String</code> type, vous devez spÃ©cifier son nom entre guillemets (<code class=syntax>'</code>). Pour l' <code class=syntax>Date</code> et <code class=syntax>Int*</code> types aucune citation n'est nÃ©cessaire.</p> <p>Pour les tables de style ancien, vous pouvez spÃ©cifier la partition sous forme de nombre <code class=syntax>201901</code> ou une chaÃ®ne de caractÃ¨res <code class=syntax>'201901'</code>. La syntaxe des tables new-style est plus stricte avec les types (similaire Ã  l'analyseur pour le format D'entrÃ©e des valeurs).</p> <p>Toutes les rÃ¨gles ci-dessus sont aussi valables pour la <a href=../../misc/amp/#misc_operations-optimize>OPTIMIZE</a> requÃªte. Si vous devez spÃ©cifier la seule partition lors de l'optimisation d'une table non partitionnÃ©e, dÃ©finissez l'expression <code class=syntax>PARTITION tuple()</code>. Exemple:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=n>OPTIMIZE</span> <span class=k>TABLE</span> <span class=n>table_not_partitioned</span> <span class=n>PARTITION</span> <span class=n>tuple</span><span class=p>()</span> <span class=k>FINAL</span><span class=p>;</span>
</code></pre></div> <p>Les exemples de <code class=syntax>ALTER ... PARTITION</code> les requÃªtes sont dÃ©montrÃ©es dans les tests <a href=https://github.com/ClickHouse/ClickHouse/blob/master/tests/queries/0_stateless/00502_custom_partitioning_local.sql rel="external nofollow noreferrer" target=_blank><code class=syntax>00502_custom_partitioning_local</code></a> et <a href=https://github.com/ClickHouse/ClickHouse/blob/master/tests/queries/0_stateless/00502_custom_partitioning_replicated_zookeeper.sql rel="external nofollow noreferrer" target=_blank><code class=syntax>00502_custom_partitioning_replicated_zookeeper</code></a>.</p> <h3 id=manipulations-with-table-ttl>Manipulations avec Table TTL<a class=headerlink href=../amp/#manipulations-with-table-ttl title="Permanent link">Â </a></h3> <p>Vous pouvez modifier <a href=../../../../engines/table-engines/mergetree-family/mergetree/amp/#mergetree-table-ttl>tableau TTL</a> avec une demande du formulaire suivant:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=k>table</span><span class=o>-</span><span class=n>name</span> <span class=k>MODIFY</span> <span class=n>TTL</span> <span class=n>ttl</span><span class=o>-</span><span class=n>expression</span>
</code></pre></div> <h3 id=synchronicity-of-alter-queries>SynchronicitÃ© des requÃªtes ALTER<a class=headerlink href=../amp/#synchronicity-of-alter-queries title="Permanent link">Â </a></h3> <p>Pour les tables non rÃ©plicables, tous <code class=syntax>ALTER</code> les requÃªtes sont exÃ©cutÃ©es simultanÃ©ment. Pour les tables rÃ©plicables, la requÃªte ajoute simplement des instructions pour les actions appropriÃ©es Ã  <code class=syntax>ZooKeeper</code> et les actions elles-mÃªmes sont effectuÃ©es dÃ¨s que possible. Cependant, la requÃªte peut attendre que ces actions soient terminÃ©es sur tous les rÃ©plicas.</p> <p>Pour <code class=syntax>ALTER ... ATTACH|DETACH|DROP</code> les requÃªtes, vous pouvez utiliser le <code class=syntax>replication_alter_partitions_sync</code> configuration pour configurer l'attente.<br> Valeurs possibles: <code class=syntax>0</code> â€“ do not wait; <code class=syntax>1</code> â€“ only wait for own execution (default); <code class=syntax>2</code> â€“ wait for all.</p> <h3 id=alter-mutations>Mutation<a class=headerlink href=../amp/#alter-mutations title="Permanent link">Â </a></h3> <p>Les Mutations sont une variante ALTER query qui permet de modifier ou de supprimer des lignes dans une table. Contrairement Ã  la norme <code class=syntax>UPDATE</code> et <code class=syntax>DELETE</code> les requÃªtes qui sont destinÃ©es aux changements de donnÃ©es de point, les mutations sont destinÃ©es aux opÃ©rations lourdes qui modifient beaucoup de lignes dans une table. Pris en charge pour le <code class=syntax>MergeTree</code> famille de moteurs de table, y compris les moteurs avec support de rÃ©plication.</p> <p>Les tables existantes sont prÃªtes pour les mutations telles quelles (aucune conversion nÃ©cessaire), mais aprÃ¨s l'application de la premiÃ¨re mutation Ã  une table, son format de mÃ©tadonnÃ©es devient incompatible avec les versions prÃ©cÃ©dentes du serveur et il devient impossible de revenir Ã  une version prÃ©cÃ©dente.</p> <p>Commandes actuellement disponibles:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table</span> <span class=k>DELETE</span> <span class=k>WHERE</span> <span class=n>filter_expr</span>
</code></pre></div> <p>Le <code class=syntax>filter_expr</code> doit Ãªtre de type <code class=syntax>UInt8</code>. La requÃªte supprime les lignes de la table pour lesquelles cette expression prend une valeur diffÃ©rente de zÃ©ro.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table</span> <span class=k>UPDATE</span> <span class=n>column1</span> <span class=o>=</span> <span class=n>expr1</span> <span class=p>[,</span> <span class=p>...]</span> <span class=k>WHERE</span> <span class=n>filter_expr</span>
</code></pre></div> <p>Le <code class=syntax>filter_expr</code> doit Ãªtre de type <code class=syntax>UInt8</code>. Cette requÃªte met Ã  jour les valeurs des colonnes spÃ©cifiÃ©es en les valeurs des expressions correspondantes dans les lignes pour lesquelles <code class=syntax>filter_expr</code> prend une valeur non nulle. Les valeurs sont converties en type de colonne Ã  l'aide <code class=syntax>CAST</code> opÃ©rateur. La mise Ã  jour des colonnes utilisÃ©es dans le calcul de la clÃ© primaire ou de la clÃ© de partition n'est pas prise en charge.</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>TABLE</span> <span class=p>[</span><span class=n>db</span><span class=p>.]</span><span class=k>table</span> <span class=n>MATERIALIZE</span> <span class=k>INDEX</span> <span class=n>name</span> <span class=k>IN</span> <span class=n>PARTITION</span> <span class=n>partition_name</span>
</code></pre></div> <p>La requÃªte reconstruit l'index secondaire <code class=syntax>name</code> dans la partition <code class=syntax>partition_name</code>.</p> <p>Une requÃªte peut contenir plusieurs commandes sÃ©parÃ©es par des virgules.</p> <p>Pour les tables * MergeTree, les mutations s'exÃ©cutent en rÃ©Ã©crivant des parties de donnÃ©es entiÃ¨res. Il n'y a pas d'atomicitÃ©-les piÃ¨ces sont substituÃ©es aux piÃ¨ces mutÃ©es dÃ¨s qu'elles sont prÃªtes et un <code class=syntax>SELECT</code> la requÃªte qui a commencÃ© Ã  s'exÃ©cuter pendant une mutation verra les donnÃ©es des parties qui ont dÃ©jÃ  Ã©tÃ© mutÃ©es ainsi que les donnÃ©es des parties qui n'ont pas encore Ã©tÃ© mutÃ©es.</p> <p>Les Mutations sont totalement ordonnÃ©es par leur ordre de crÃ©ation et sont appliquÃ©es Ã  chaque partie dans cet ordre. Les Mutations sont Ã©galement partiellement ordonnÃ©es avec des insertions - les donnÃ©es insÃ©rÃ©es dans la table avant la soumission de la mutation seront mutÃ©es et les donnÃ©es insÃ©rÃ©es aprÃ¨s ne seront pas mutÃ©es. Notez que les mutations ne bloquent en aucune faÃ§on les INSERTs.</p> <p>Une requÃªte de mutation retourne immÃ©diatement aprÃ¨s l'ajout de l'entrÃ©e de mutation (dans le cas de tables rÃ©pliquÃ©es Ã  ZooKeeper, pour les tables non compliquÃ©es - au systÃ¨me de fichiers). La mutation elle-mÃªme s'exÃ©cute de maniÃ¨re asynchrone en utilisant les paramÃ¨tres du profil systÃ¨me. Pour suivre l'avancement des mutations vous pouvez utiliser la <a href=../../../../operations/system-tables/amp/#system_tables-mutations><code class=syntax>system.mutations</code></a> table. Une mutation qui a Ã©tÃ© soumise avec succÃ¨s continuera Ã  s'exÃ©cuter mÃªme si les serveurs ClickHouse sont redÃ©marrÃ©s. Il n'y a aucun moyen de faire reculer la mutation une fois qu'elle est soumise, mais si la mutation est bloquÃ©e pour une raison quelconque, elle peut Ãªtre annulÃ©e avec le <a href=../../misc/amp/#kill-mutation><code class=syntax>KILL MUTATION</code></a> requÃªte.</p> <p>Les entrÃ©es pour les mutations finies ne sont pas supprimÃ©es immÃ©diatement (le nombre d'entrÃ©es conservÃ©es est dÃ©terminÃ© par <code class=syntax>finished_mutations_to_keep</code> le moteur de stockage de paramÃ¨tre). Les anciennes entrÃ©es de mutation sont supprimÃ©es.</p> <h2 id=alter-user-statement>ALTER USER<a class=headerlink href=../amp/#alter-user-statement title="Permanent link">Â </a></h2> <p>Changements clickhouse comptes d'utilisateurs.</p> <h3 id=alter-user-syntax>Syntaxe<a class=headerlink href=../amp/#alter-user-syntax title="Permanent link">Â </a></h3> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>USER</span> <span class=p>[</span><span class=k>IF</span> <span class=k>EXISTS</span><span class=p>]</span> <span class=n>name</span> <span class=p>[</span><span class=k>ON</span> <span class=k>CLUSTER</span> <span class=n>cluster_name</span><span class=p>]</span>
    <span class=p>[</span><span class=k>RENAME</span> <span class=k>TO</span> <span class=n>new_name</span><span class=p>]</span>
    <span class=p>[</span><span class=n>IDENTIFIED</span> <span class=p>[</span><span class=k>WITH</span> <span class=err>{</span><span class=n>PLAINTEXT_PASSWORD</span><span class=o>|</span><span class=n>SHA256_PASSWORD</span><span class=o>|</span><span class=n>DOUBLE_SHA1_PASSWORD</span><span class=err>}</span><span class=p>]</span> <span class=k>BY</span> <span class=err>{</span><span class=s1>'password'</span><span class=o>|</span><span class=s1>'hash'</span><span class=err>}</span><span class=p>]</span>
    <span class=p>[[</span><span class=k>ADD</span><span class=o>|</span><span class=k>DROP</span><span class=p>]</span> <span class=k>HOST</span> <span class=err>{</span><span class=k>LOCAL</span> <span class=o>|</span> <span class=n>NAME</span> <span class=s1>'name'</span> <span class=o>|</span> <span class=n>REGEXP</span> <span class=s1>'name_regexp'</span> <span class=o>|</span> <span class=n>IP</span> <span class=s1>'address'</span> <span class=o>|</span> <span class=k>LIKE</span> <span class=s1>'pattern'</span><span class=err>}</span> <span class=p>[,...]</span> <span class=o>|</span> <span class=k>ANY</span> <span class=o>|</span> <span class=k>NONE</span><span class=p>]</span>
    <span class=p>[</span><span class=k>DEFAULT</span> <span class=k>ROLE</span> <span class=k>role</span> <span class=p>[,...]</span> <span class=o>|</span> <span class=k>ALL</span> <span class=o>|</span> <span class=k>ALL</span> <span class=k>EXCEPT</span> <span class=k>role</span> <span class=p>[,...]</span> <span class=p>]</span>
    <span class=p>[</span><span class=n>SETTINGS</span> <span class=k>variable</span> <span class=p>[</span><span class=o>=</span> <span class=n>value</span><span class=p>]</span> <span class=p>[</span><span class=k>MIN</span> <span class=p>[</span><span class=o>=</span><span class=p>]</span> <span class=n>min_value</span><span class=p>]</span> <span class=p>[</span><span class=k>MAX</span> <span class=p>[</span><span class=o>=</span><span class=p>]</span> <span class=n>max_value</span><span class=p>]</span> <span class=p>[</span><span class=n>READONLY</span><span class=o>|</span><span class=n>WRITABLE</span><span class=p>]</span> <span class=o>|</span> <span class=n>PROFILE</span> <span class=s1>'profile_name'</span><span class=p>]</span> <span class=p>[,...]</span>
</code></pre></div> <h3 id=alter-user-dscr>Description<a class=headerlink href=../amp/#alter-user-dscr title="Permanent link">Â </a></h3> <p>Utiliser <code class=syntax>ALTER USER</code> vous devez avoir le <a href=../../grant/amp/#grant-access-management>ALTER USER</a> privilÃ¨ge.</p> <h3 id=alter-user-examples>Exemple<a class=headerlink href=../amp/#alter-user-examples title="Permanent link">Â </a></h3> <p>DÃ©finir les rÃ´les accordÃ©s par dÃ©faut:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>USER</span> <span class=k>user</span> <span class=k>DEFAULT</span> <span class=k>ROLE</span> <span class=n>role1</span><span class=p>,</span> <span class=n>role2</span>
</code></pre></div> <p>Si les rÃ´les ne sont pas prÃ©cÃ©demment accordÃ©s Ã  un utilisateur, ClickHouse lÃ¨ve une exception.</p> <p>DÃ©finissez tous les rÃ´les accordÃ©s Ã  dÃ©faut:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>USER</span> <span class=k>user</span> <span class=k>DEFAULT</span> <span class=k>ROLE</span> <span class=k>ALL</span>
</code></pre></div> <p>Si un rÃ´le seront accordÃ©s Ã  un utilisateur dans l'avenir, il deviendra automatiquement par dÃ©faut.</p> <p>DÃ©finissez tous les rÃ´les accordÃ©s sur default excepting <code class=syntax>role1</code> et <code class=syntax>role2</code>:</p> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>USER</span> <span class=k>user</span> <span class=k>DEFAULT</span> <span class=k>ROLE</span> <span class=k>ALL</span> <span class=k>EXCEPT</span> <span class=n>role1</span><span class=p>,</span> <span class=n>role2</span>
</code></pre></div> <h2 id=alter-role-statement>ALTER ROLE<a class=headerlink href=../amp/#alter-role-statement title="Permanent link">Â </a></h2> <p>Les changements de rÃ´les.</p> <h3 id=alter-role-syntax>Syntaxe<a class=headerlink href=../amp/#alter-role-syntax title="Permanent link">Â </a></h3> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=k>ROLE</span> <span class=p>[</span><span class=k>IF</span> <span class=k>EXISTS</span><span class=p>]</span> <span class=n>name</span> <span class=p>[</span><span class=k>ON</span> <span class=k>CLUSTER</span> <span class=n>cluster_name</span><span class=p>]</span>
    <span class=p>[</span><span class=k>RENAME</span> <span class=k>TO</span> <span class=n>new_name</span><span class=p>]</span>
    <span class=p>[</span><span class=n>SETTINGS</span> <span class=k>variable</span> <span class=p>[</span><span class=o>=</span> <span class=n>value</span><span class=p>]</span> <span class=p>[</span><span class=k>MIN</span> <span class=p>[</span><span class=o>=</span><span class=p>]</span> <span class=n>min_value</span><span class=p>]</span> <span class=p>[</span><span class=k>MAX</span> <span class=p>[</span><span class=o>=</span><span class=p>]</span> <span class=n>max_value</span><span class=p>]</span> <span class=p>[</span><span class=n>READONLY</span><span class=o>|</span><span class=n>WRITABLE</span><span class=p>]</span> <span class=o>|</span> <span class=n>PROFILE</span> <span class=s1>'profile_name'</span><span class=p>]</span> <span class=p>[,...]</span>
</code></pre></div> <h2 id=alter-row-policy-statement>ALTER ROW POLICY<a class=headerlink href=../amp/#alter-row-policy-statement title="Permanent link">Â </a></h2> <p>Modifie la stratÃ©gie de ligne.</p> <h3 id=alter-row-policy-syntax>Syntaxe<a class=headerlink href=../amp/#alter-row-policy-syntax title="Permanent link">Â </a></h3> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=p>[</span><span class=k>ROW</span><span class=p>]</span> <span class=n>POLICY</span> <span class=p>[</span><span class=k>IF</span> <span class=k>EXISTS</span><span class=p>]</span> <span class=n>name</span> <span class=p>[</span><span class=k>ON</span> <span class=k>CLUSTER</span> <span class=n>cluster_name</span><span class=p>]</span> <span class=k>ON</span> <span class=p>[</span><span class=k>database</span><span class=p>.]</span><span class=k>table</span>
    <span class=p>[</span><span class=k>RENAME</span> <span class=k>TO</span> <span class=n>new_name</span><span class=p>]</span>
    <span class=p>[</span><span class=k>AS</span> <span class=err>{</span><span class=n>PERMISSIVE</span> <span class=o>|</span> <span class=n>RESTRICTIVE</span><span class=err>}</span><span class=p>]</span>
    <span class=p>[</span><span class=k>FOR</span> <span class=k>SELECT</span><span class=p>]</span>
    <span class=p>[</span><span class=k>USING</span> <span class=err>{</span><span class=n>condition</span> <span class=o>|</span> <span class=k>NONE</span><span class=err>}</span><span class=p>][,...]</span>
    <span class=p>[</span><span class=k>TO</span> <span class=err>{</span><span class=k>role</span> <span class=p>[,...]</span> <span class=o>|</span> <span class=k>ALL</span> <span class=o>|</span> <span class=k>ALL</span> <span class=k>EXCEPT</span> <span class=k>role</span> <span class=p>[,...]</span><span class=err>}</span><span class=p>]</span>
</code></pre></div> <h2 id=alter-quota-statement>ALTER QUOTA<a class=headerlink href=../amp/#alter-quota-statement title="Permanent link">Â </a></h2> <p>Les changements de quotas.</p> <h3 id=alter-quota-syntax>Syntaxe<a class=headerlink href=../amp/#alter-quota-syntax title="Permanent link">Â </a></h3> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=n>QUOTA</span> <span class=p>[</span><span class=k>IF</span> <span class=k>EXISTS</span><span class=p>]</span> <span class=n>name</span> <span class=p>[</span><span class=k>ON</span> <span class=k>CLUSTER</span> <span class=n>cluster_name</span><span class=p>]</span>
    <span class=p>[</span><span class=k>RENAME</span> <span class=k>TO</span> <span class=n>new_name</span><span class=p>]</span>
    <span class=p>[</span><span class=n>KEYED</span> <span class=k>BY</span> <span class=err>{</span><span class=s1>'none'</span> <span class=o>|</span> <span class=s1>'user name'</span> <span class=o>|</span> <span class=s1>'ip address'</span> <span class=o>|</span> <span class=s1>'client key'</span> <span class=o>|</span> <span class=s1>'client key or user name'</span> <span class=o>|</span> <span class=s1>'client key or ip address'</span><span class=err>}</span><span class=p>]</span>
    <span class=p>[</span><span class=k>FOR</span> <span class=p>[</span><span class=n>RANDOMIZED</span><span class=p>]</span> <span class=nb>INTERVAL</span> <span class=nb>number</span> <span class=err>{</span><span class=k>SECOND</span> <span class=o>|</span> <span class=k>MINUTE</span> <span class=o>|</span> <span class=n>HOUR</span> <span class=o>|</span> <span class=k>DAY</span> <span class=o>|</span> <span class=n>WEEK</span> <span class=o>|</span> <span class=k>MONTH</span> <span class=o>|</span> <span class=n>QUARTER</span> <span class=o>|</span> <span class=k>YEAR</span><span class=err>}</span>
        <span class=err>{</span><span class=k>MAX</span> <span class=err>{</span> <span class=err>{</span><span class=n>QUERIES</span> <span class=o>|</span> <span class=n>ERRORS</span> <span class=o>|</span> <span class=k>RESULT</span> <span class=k>ROWS</span> <span class=o>|</span> <span class=k>RESULT</span> <span class=n>BYTES</span> <span class=o>|</span> <span class=k>READ</span> <span class=k>ROWS</span> <span class=o>|</span> <span class=k>READ</span> <span class=n>BYTES</span> <span class=o>|</span> <span class=n>EXECUTION</span> <span class=n>TIME</span><span class=err>}</span> <span class=o>=</span> <span class=nb>number</span> <span class=err>}</span> <span class=p>[,...]</span> <span class=o>|</span>
        <span class=k>NO</span> <span class=n>LIMITS</span> <span class=o>|</span> <span class=n>TRACKING</span> <span class=k>ONLY</span><span class=err>}</span> <span class=p>[,...]]</span>
    <span class=p>[</span><span class=k>TO</span> <span class=err>{</span><span class=k>role</span> <span class=p>[,...]</span> <span class=o>|</span> <span class=k>ALL</span> <span class=o>|</span> <span class=k>ALL</span> <span class=k>EXCEPT</span> <span class=k>role</span> <span class=p>[,...]</span><span class=err>}</span><span class=p>]</span>
</code></pre></div> <h2 id=alter-settings-profile-statement>ALTER SETTINGS PROFILE<a class=headerlink href=../amp/#alter-settings-profile-statement title="Permanent link">Â </a></h2> <p>Les changements de quotas.</p> <h3 id=alter-settings-profile-syntax>Syntaxe<a class=headerlink href=../amp/#alter-settings-profile-syntax title="Permanent link">Â </a></h3> <div class=codehilite><pre><span></span><code class=syntax><span class=k>ALTER</span> <span class=n>SETTINGS</span> <span class=n>PROFILE</span> <span class=p>[</span><span class=k>IF</span> <span class=k>EXISTS</span><span class=p>]</span> <span class=n>name</span> <span class=p>[</span><span class=k>ON</span> <span class=k>CLUSTER</span> <span class=n>cluster_name</span><span class=p>]</span>
    <span class=p>[</span><span class=k>RENAME</span> <span class=k>TO</span> <span class=n>new_name</span><span class=p>]</span>
    <span class=p>[</span><span class=n>SETTINGS</span> <span class=k>variable</span> <span class=p>[</span><span class=o>=</span> <span class=n>value</span><span class=p>]</span> <span class=p>[</span><span class=k>MIN</span> <span class=p>[</span><span class=o>=</span><span class=p>]</span> <span class=n>min_value</span><span class=p>]</span> <span class=p>[</span><span class=k>MAX</span> <span class=p>[</span><span class=o>=</span><span class=p>]</span> <span class=n>max_value</span><span class=p>]</span> <span class=p>[</span><span class=n>READONLY</span><span class=o>|</span><span class=n>WRITABLE</span><span class=p>]</span> <span class=o>|</span> <span class=n>INHERIT</span> <span class=s1>'profile_name'</span><span class=p>]</span> <span class=p>[,...]</span>
</code></pre></div> <p><a href=https://clickhouse.tech/docs/en/query_language/alter/ target=_blank>Article Original</a> <!--hide--></p> </div> </div> <div class=row> <div class=col> <div class="alert alert-light my-3"> <p class="float-right mb-0">Rating: RATING_VALUE - RATING_COUNT votes</p> <span class="alert-heading display-6">Article Rating</span> <div id=rating-stars class="display-6 mb-0">RATING_STARS</div> </div> <div id=content-footer class="text-muted pt-3 mb-5"> <div class=float-md-right>Â©2016â€“2020 Yandex LLC</div> <div>Built from <a href=https://github.com/ClickHouse/ClickHouse/commit/b030bfedd7db4603034643fd183cf7784a820193 rel="external nofollow noreferrer" target=_blank class=text-reset>b030bfedd7</a> </div> </div> </div> </div> <div id=to-full-website class="row fixed-bottom text-center bg-white py-3"> <div class=col> <a href=https://clickhouse.tech/docs/fr/sql-reference/statements/alter/ class="btn btn-lg btn-outline-orange">To full website</a> </div> </div> </div> <amp-analytics type=metrika> <script type=application/json>{
"vars": {
  "counterId": "18343495",
  "triggers": {
    "notBounce": {
      "on": "timer",
      "timerSpec": {
        "immediate": false,
        "interval": 15,
        "maxTimerLength": 16
      },
      "request": "notBounce"
    }
  }
}
}</script> </amp-analytics> </body> </html> 